---
title: "ADS - Banco de dados e No-SQL - 2026 - AnotaÃ§Ãµes de aula"
author: "Professor MiguÃ©l Suares"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
bibliography: [book.bib]
url: your book url like https://bookdown.org/yihui/bookdown
cover-image: images/cover.jpg
description: |
  Este livreto reÃºne anotaÃ§Ãµes, reflexÃµes e conteÃºdos desenvolvidos ao longo das aulas da  disciplina Banco de Dados, ministrada pelo Professor MiguÃ©l Suares. Elaborado com base em experiÃªncias prÃ¡ticas, referÃªncias acadÃªmicas e diretrizes atualizadas sobre o tema, o material busca fornecer uma visÃ£o crÃ­tica e aplicada sobre anÃ¡lise de dados nas organizaÃ§Ãµes contemporÃ¢neas.
link-citations: yes
github-repo: miguel7penteado/2026-1sem-ADS-BancoDeDados
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(plantuml)


# Detectar o sistema operacional
so <- Sys.info()[["sysname"]]

if (so == "Linux")
{
  plantumlOptions(jar_path = "/usr/share/java/plantuml.jar")  
}else 
  if (so == "Windows") 
  {
    plantumlOptions(jar_path = "C:/PROGRA~1/COMMON~1/Oracle/Java/libs/plantuml-1.2025.4.jar")
  }else
  {
    print(paste("Sistema nÃ£o reconhecido:", so))
  }


knitr::knit_engines$set(plantuml = function(options)
{
    code <- paste(options$code, collapse = "\n")
  
  if (is.null(options$plantuml.path)) 
  {
    path <-  "."
  } else
    {
      path <- options$plantuml.path
    }
  
  dir.create(path, showWarnings = FALSE, recursive = TRUE)
  fig <- paste0(options$label, ".", "svg")
  fig <- file.path(path, fig)
  if (options$eval) plot(x = plantuml(code), vector=FALSE, file=fig)
  knitr::engine_output(options, out = list(knitr::include_graphics(fig)))
})
```

# Sobre estas anotaÃ§Ãµes {.unnumbered}

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

Estas anotaÃ§Ãµes sÃ£o apenas lembretes das aulas expostas em sala, durante a disciplina de Banco de dados.

## ACESSO AO GITBOOK CELULAR

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

#### <https://github.com/miguel7penteado/2026-1sem-ADS-BancoDeDados>

![](images/qr-code-disciplina.jpg)

## Leitores de formato de arquivo EPUB para SmartPhone

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

### ANDROID

#### **Moon+ Reader**

![](images/qrcode/leitor_epub/MoonReaderPlus.jpg){width="340"}

## Livros Texto da Disciplina

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

### ["IntroduÃ§Ã£o a sistemas de bancos de dados" do autor "**Christopher John Date**"](https://www.kufunda.net/publicdocs/Introdu%C3%A7%C3%A3o%20a%20Sistemas%20de%20Bancos%20de%20Dados%20(C.%20J.%20Date)%20(z-lib.org).pdf)

![](images/livros/livro1.jpg)

+-----------------------+------------------------------------------------------------------------------------+
| **Autor(es)**         | ### [**Christopher John Date**](https://en.wikipedia.org/wiki/Christopher_J._Date) |
+-----------------------+------------------------------------------------------------------------------------+
| **Editora**           | LTC                                                                                |
+-----------------------+------------------------------------------------------------------------------------+
| **Idioma**            | PortuguÃªs                                                                          |
+-----------------------+------------------------------------------------------------------------------------+
| **ISBN**              | 978-85-352-8445-4                                                                  |
+-----------------------+------------------------------------------------------------------------------------+
| **Formato**           | Capa dura                                                                          |
+-----------------------+------------------------------------------------------------------------------------+
| **PÃ¡ginas**           | 1623                                                                               |
+-----------------------+------------------------------------------------------------------------------------+
| **CÃ³digo Biblioteca** |                                                                                    |
+-----------------------+------------------------------------------------------------------------------------+

### ["**Projeto de bancos de dados**" do autor "Carlos Alberto HEUSER"](https://drive.google.com/file/d/0B452rmbcudPSVFdCZ09vVkJUUUd2dlpMNS1vaEczUQ/view?pli=1&resourcekey=0-3MTcHlAYjPX6YSvBQGweUQ)

![](images/livros/livro2.jpg)

+-----------------------+-------------------------------------------------------------------------------------------+
| **Autor(es)**         | ### [Carlos Alberto HEUSER](https://www.inf.ufrgs.br/site/docente/carlos-alberto-heuser/) |
+-----------------------+-------------------------------------------------------------------------------------------+
| **Editora**           | Bookman                                                                                   |
+-----------------------+-------------------------------------------------------------------------------------------+
| **Idioma**            | PortuguÃªs                                                                                 |
+-----------------------+-------------------------------------------------------------------------------------------+
| **ISBN-10**           | 8577803821                                                                                |
+-----------------------+-------------------------------------------------------------------------------------------+
| **Formato**           | Impresso                                                                                  |
+-----------------------+-------------------------------------------------------------------------------------------+
| **PÃ¡ginas**           | 282                                                                                       |
+-----------------------+-------------------------------------------------------------------------------------------+
| **CÃ³digo Biblioteca** |                                                                                           |
+-----------------------+-------------------------------------------------------------------------------------------+

## CalendÃ¡rio das aulas

### Fevereiro de 2026
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

| Data       | Dia da Semana | Aulas          | ConteÃºdo                           |
| ---------- | ------------- | -------------- | ---------------------------------- |
| 10/02/2026 | TerÃ§a-Feira   | Aula Inaugural | ApresentaÃ§Ã£o da disciplina         |
| 17/02/2026 | TerÃ§a-Feira   | â€”              | **Carnaval â€“ NÃ£o haverÃ¡ aula**     |
| 24/02/2026 | TerÃ§a-Feira   | Aula 2         | **Fundamentos de Bancos de Dados** |


### MarÃ§o de 2026
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

| Data       | Dia da Semana | Aulas  | ConteÃºdo                                            |
| ---------- | ------------- | ------ | --------------------------------------------------- |
| 03/03/2026 | TerÃ§a-Feira   | Aula 3 | **Modelagem de Banco de Dados (I)**                 |
| 10/03/2026 | TerÃ§a-Feira   | Aula 4 | **Modelagem de Banco de Dados (II)**                |
| 17/03/2026 | TerÃ§a-Feira   | Aula 5 | **AdministraÃ§Ã£o e Gerenciamento de Banco de Dados** |
| 24/03/2026 | TerÃ§a-Feira   | Aula 6 | **AplicaÃ§Ã£o CRUD**                                  |
| 31/03/2026 | TerÃ§a-Feira   | NP1    | **PROVA**                                           |



### Abril de 2026
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

| Data       | Dia da Semana | Aulas  | ConteÃºdo                                |
| ---------- | ------------- | ------ | --------------------------------------- |
| 07/04/2026 | TerÃ§a-Feira   | Aula 7 | **MySQL**                               |
| 14/04/2026 | TerÃ§a-Feira   | Aula 8 | **PostgreSQL**                          |
| 21/04/2026 | TerÃ§a-Feira   | â€”      | **Dia de Tiradentes â€“ NÃ£o haverÃ¡ aula** |
| 28/04/2026 | TerÃ§a-Feira   | Aula 9 | **SGBD Espacial â€“ Python**              |



### Maio de 2026
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

| Data       | Dia da Semana | Aulas   | ConteÃºdo               |
| ---------- | ------------- | ------- | ---------------------- |
| 05/05/2026 | TerÃ§a-Feira   | Aula 10 | **SGBD e linguagem R** |
| 12/05/2026 | TerÃ§a-Feira   | Aula 11 | **AnÃ¡lise 1**          |
| 19/05/2026 | TerÃ§a-Feira   | NP2     | **PROVA**              |
| 26/05/2026 | TerÃ§a-Feira   | SUB     | **PROVA SUBSTITUTIVA** |




### Junho de 2026
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

| Data       | Dia da Semana | Aulas   | ConteÃºdo                       |
| ---------- | ------------- | ------- | ------------------------------ |
| 02/06/2026 | TerÃ§a-Feira   | Aula 12 | **AnÃ¡lise 2**                  |
| 09/06/2026 | TerÃ§a-Feira   | EXA     | **EXAME â€“ PROVA SUBSTITUTIVA** |
| 16/06/2026 | TerÃ§a-Feira   | Aula 13 | **AnÃ¡lise 3**                  |
| 23/06/2026 | TerÃ§a-Feira   | Aula 14 | **AnÃ¡lise 4**                  |
| 30/06/2026 | TerÃ§a-Feira   | Aula 15 | Encerramento da disciplina     |




## Alunos 2026 - 1o Semestre

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

### Campus ChÃ¡cara Santo AntÃ´nio





# Postgres (Zip Version) Windows Starting Guide

Download postgresql from <https://www.enterprisedb.com/download-postgresql-binaries>;

Unzip it;

Open a cmd;

Enter into the â€˜binâ€™ directory;

Init the database:

``` powershell
initdb.exe -D ../data â€“username=postgres â€“auth=trust
```

Start the database:

``` powershell
pg_ctl.exe start -D ../data
```

Open another cmd;

Enter into the â€˜binâ€™ directory;

Log into the database:

``` cmd
psql.exe â€“username=postgres
```

Create a password for your user:

``` sql
ALTER USER postgres WITH PASSWORD â€˜VeryVerySecretâ€™;
```

Install adminpack extension:

``` sql
CREATE EXTENSION adminpack;
```

Reference: <https://feilerdev.wordpress.com/2017/12/05/installing-postgresql-on-windows-using-zip-archive-without-the-installer/>

```{r indice, eval=FALSE, include=FALSE}
rmarkdown::render("index.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; utils::browseURL("docs/temporario.html")
```



<!--chapter:end:index.Rmd-->

---
output: 
  html_document: 
    highlight: tango
    theme: cerulean
    df_print: kable
---

# **Aula Inaugural**

#### **2026/10/02** {.unnumbered}

#### Professor **MiguÃ©l Suares** {.unnumbered}

## Disciplina: **Banco de Dados**

-   Curso: AnÃ¡lise e Desenvolvimento de Sistemas (ADS)
-   PerÃ­odo: **Noturno**
-   Turma: **1Âº semestre de 2026**
-   Campus: **ChÃ¡cara Santo AntÃ´nio**

> "Dados sÃ£o o novo petrÃ³leo." â€“ Clive Humby!

 

------------------------------------------------------------------------

## ğŸ‘¨â€ğŸ« Sobre o Professor

-   Nome: Prof. MiguÃ©l Suares
-   FormaÃ§Ã£o: Mestre em Engenharia da ComputaÃ§Ã£o e Energia da Agricultura
-   ExperiÃªncia: +10 anos com bancos de dados relacionais e anÃ¡lise de dados
-   Contato: [miguel.penteado\@docente.unip.br](mailto:miguel.penteado@docente.unip.br)

------------------------------------------------------------------------

## ğŸ¯ Objetivos da Disciplina

-   Compreender os fundamentos de bancos de dados

-   Modelar dados com diagramas ER

-   Implementar e consultar bases de dados com SQL

-   Utilizar ferramentas como MySQL, PostgreSQL, QGIS e R

-   Desenvolver raciocÃ­nio lÃ³gico para resolver problemas com dados

    ![](media/logos.jpg)

------------------------------------------------------------------------

## ğŸ“… CalendÃ¡rio da Disciplina

| Data       | Aula    | Tema                          |
|------------|---------|-------------------------------|
| 04/08/2025 | Aula 1  | Aula Inaugural                |
| 11/08/2025 | Aula 2  | Fundamentos                   |
| 18/08/2025 | Aula 3  | Modelagem e Diagramas         |
| 25/08/2025 | Aula 4  | AdministraÃ§Ã£o e Gerenciamento |
| 01/09/2025 | Aula 5  | AplicaÃ§Ã£o CRUD                |
| 08/09/2025 | Aula 6  | MySQL                         |
| 15/09/2025 | **NP1** | **Prova**                     |
| 22/09/2025 | Aula 7  | Postgres                      |
| 29/09/2025 | Aula 8  | QGIS                          |
| 06/10/2025 | Aula 9  | RStudio                       |
| 13/10/2025 | Aula 10 | AnÃ¡lise I                     |
| 20/10/2025 | Aula 11 | AnÃ¡lise II                    |
| 27/10/2025 | Aula 12 | AnÃ¡lise III                   |
| 03/11/2025 | **NP2** | **Prova**                     |

------------------------------------------------------------------------

## ğŸ“š Ementa Resumida

-   IntroduÃ§Ã£o a bancos de dados relacionais (RDBMS)

-   Modelagem de dados (M.E.R.) e diagramas Entidade Relacionamento (D.E.R.)

-   Linguagem SQL: DDL, DML, DCL

-   Ferramentas: MySQL, PostgreSQL

-   VisualizaÃ§Ã£o geoespacial (QGIS)

-   AnÃ¡lise e exploraÃ§Ã£o de dados (R e RStudio)

    ![](media/modelagem.jpg){width="331"}

------------------------------------------------------------------------

## ğŸ“ AvaliaÃ§Ã£o

-   **Provas (NP1 + NP2)**
-   **Prova Substitutiva**
-   **Exame**

------------------------------------------------------------------------

## ğŸ› ï¸ Ferramentas da Disciplina

-   **Servidores de Banco de Dados**: MySQL, PostgreSQL
-   **Servidores de Banco de Dados**: pgAdmin, MySQL Workbench, DBeaver\\
-   **Geoprocessamento**: QGIS\\
-   **AnÃ¡lise de Dados**: R + RStudio\\
-   **Versionamento e OrganizaÃ§Ã£o**: GitHub, Teams

------------------------------------------------------------------------

## ğŸ“Œ Expectativas e Regras

-   Pontualidade e entrega de atividades no prazo
-   Trabalhos devem ser originais (sem plÃ¡gio)
-   ParticipaÃ§Ã£o ativa nas discussÃµes e prÃ¡ticas
-   Uso responsÃ¡vel das ferramentas
-   Respeito e colaboraÃ§Ã£o entre colegas

------------------------------------------------------------------------

## ğŸ’¡ Dicas para Mandar Bem

-   FaÃ§a os exercÃ­cios logo apÃ³s a aula
-   Participe das prÃ¡ticas com base real
-   Mantenha o repositÃ³rio do projeto atualizado
-   RefaÃ§a consultas SQL atÃ© entender
-   Teste e documente suas soluÃ§Ãµes

------------------------------------------------------------------------

## ğŸ™Œ Encerramento

## Estamos prontos?

ğŸ“§ DÃºvidas? Estou Ã  disposiÃ§Ã£o\
ğŸ“Š Vamos construir conhecimento juntos!

```{r 01-2026-02-10_Inaugural-html , eval=FALSE, include=FALSE}
rmarkdown::render("01-2026-02-10_Inaugural.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; utils::browseURL("docs/temporario.html")
```

```{r 01-2026-02-10_Inaugural-pdf , eval=FALSE, include=FALSE}
rmarkdown::render("01-2026-02-10_Inaugural.Rmd", output_dir="docs", output_file ="temporario.pdf" , output_format = rmarkdown::pdf_document( toc = TRUE, number_sections = TRUE, latex_engine = "xelatex" )) ; utils::browseURL("docs/temporario.pdf")
```

<!--chapter:end:01-aula01/01-2026-02-10_Inaugural.Rmd-->

---
output: 
  html_document: 
    highlight: tango
    theme: cerulean
---

# Fundamentos de Sistemas de Bancos de Dados

#### 24/02/2026 {.unnumbered}

#### Professor Miguel Suares {.unnumbered}

## Parte I â€” Linha do Tempo dos SGBDs

### O InÃ­cio do Modelo Relacional

### Edgar F. Codd (1923â€“2003)

![](media/01-codd.jpg){width="350"}

-   MatemÃ¡tico da IBM
-   1970: Publica o artigo:

> **â€œA Relational Model of Data for Large Shared Data Banksâ€** (Um modelo relacional de dados para grandes bancos de dados compartilhados)

Base matemÃ¡tica do modelo:

-   Teoria dos Conjuntos
-   LÃ³gica de Predicados
-   Ãlgebra Relacional

### System R e SQL

-   1970â€“1974: Desenvolvimento do **System R**
-   1974: CriaÃ§Ã£o da linguagem **SQL**

### Raymond F. Boyce

![](media/05-Boyce.jpg){width="300"}

### Donald D. Chamberlin

### Modelo Entidade-Relacionamento

### Peter Chen

![](media/modelagem.jpg){width="400"}

-   1976: Modelo ER
-   Ponte entre modelagem conceitual e implementaÃ§Ã£o relacional

### Escola de Berkeley

### Prof Michael Stonebraker

![](media/07-Michael_StoneBraker.jpg){width="350"}

-   Projeto INGRES
-   Origem do Postgres

### DÃ©cadas de ConsolidaÃ§Ã£o

#### 1980

-   IBM DB2
-   Oracle
-   Sybase
-   Postgres

#### 1990

-   PostgreSQL
-   MySQL

![](media/09-mysql.jpg){width="350"} ![](media/10-postgresql.jpg){width="350"}

### Anos 2000 â€” Big Data e NoSQL

![](media/11-mongodb.jpg){width="350"} ![](media/12-cassandra.jpg){width="350"} ![](media/13-hadoop.jpg){width="350"}

## Parte II â€” Fundamentos MatemÃ¡ticos do Modelo Relacional

Agora entramos na base formal que sustenta os SGBDs.

## 1. Conceito de RelaÃ§Ã£o

Codd queria utilizar a MatemÃ¡tica, mais especÃ­ficamente, a teoria de conjuntos para criar um Sistema de Banco de Dados. A MatemÃ¡tica trataria de garantir a consistÃªncia dos dados armazenados.

| OperaÃ§Ã£o           | SÃ­mbolo | DescriÃ§Ã£o                                  |
|--------------------|---------|--------------------------------------------|
| UniÃ£o              | âˆª       | Elementos que pertencem a A ou B           |
| InterseÃ§Ã£o         | âˆ©       | Elementos comuns a A e B                   |
| DiferenÃ§a          | âˆ’       | Elementos de A que nÃ£o pertencem a B       |
| Produto Cartesiano | Ã—       | Conjunto de todos os pares ordenados (a,b) |

Inicialmente a idÃ©ia era associar conjuntos de dados e garantir a consistÃªncia da informaÃ§Ã£o. Assim nasceu o conceito de **RELAÃ‡ÃƒO**

Sejam dois conjuntos A e B.

O **produto cartesiano** Ã©:

```         
A Ã— B = { (a,b) | a âˆˆ A e b âˆˆ B }
```

Uma **relaÃ§Ã£o R de A em B** Ã© qualquer subconjunto de A Ã— B.

```         
R âŠ† A Ã— B
```

*(lembrando que o simbolo "âŠ†" significa "estÃ¡ contido em" ou "Ã© subconjunto de")*

#### Exemplo 1.

Uma website vende camisetas **bÃ¡sicas** e camisetas **esportivas** nos tamanhos **pequeno**, **mÃ©dio** e **grande**. Usando matemÃ¡tica, coloque as camisetas no **conjunto A** e os tamanhos no **conjunto B**. Utilize o **produto cartesiano** para gerar toda a **grade de camisetas e tamanhos** na pÃ¡gina do website.

```{r aula02-exemplo-01, engine='tikz', echo=FALSE, fig.cap="Camisetas X Tamanhos"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}
[
  every node/.style={on grid},
  setA/.style={fill=blue,               circle,  inner sep=3pt },
  setB/.style={fill=green!70!black,     circle,  inner sep=3pt },
  setC/.style={fill=red!70!black,       circle,  inner sep=3pt },
  every fit/.style={draw, fill=gray!10, ellipse, inner sep=8pt},
  >=latex
]

% --- Conjunto A (Camisetas) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setA, label=left:BÃ¡sica]     (a1) {};
  \node [setA, below=of a1, label=left:Esportiva] (a2) {};
  \node [above=1.5cm of a1, font=\bfseries, align=center] {Conjunto A\\Camisetas};
\end{scope}

% --- Conjunto B (Tamanhos) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setB, right=of a1, label=right:P] (b1) {};
  \node [setB, below=of b1, label=right:M] (b2) {};
  \node [setB, below=of b2, label=right:G] (b3) {};
  \node [above=1.5cm of b1, font=\bfseries, align=center] {Conjunto B\\Tamanhos};
\end{scope}


% As setas (funÃ§Ãµes)
%\draw[<->,shorten >=3pt] (a1) -- node[above]  {} (b1);
%\draw[<->,shorten >=3pt] (a1) -- node[above]  {} (b2);
%\draw[<->,shorten >=3pt] (a1) -- node[above]  {} (b3);
%\draw[<->,shorten >=3pt] (a2) -- node[above]  {} (b1);
%\draw[<->,shorten >=3pt] (a2) -- node[above]  {} (b2);
%\draw[<->,shorten >=3pt] (a2) -- node[above]  {} (b3);


% ----------------------------
% --- Conjunto C: C = A x B ---
% ----------------------------

\def\dx{1.5pt}
\def\dy{5mm}

% Linha 1: (BÃ¡sica, P)
\node [setC, below=4cm of a2, xshift=3cm, label=left:BÃ¡sica] (cA11) {};
\node [font=\bfseries] (cComma11) at ([xshift=\dx] cA11.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:P] (cB11) at (cComma11.east) {};

% Linha 2: (BÃ¡sica, M)
\node [setC, below=\dy of cA11, label=left:BÃ¡sica] (cA12) {};
\node [font=\bfseries] (cComma12) at ([xshift=\dx] cA12.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:M] (cB12) at (cComma12.east) {};

% Linha 3: (BÃ¡sica, G)
\node [setC, below=\dy of cA12, label=left:BÃ¡sica] (cA13) {};
\node [font=\bfseries] (cComma13) at ([xshift=\dx] cA13.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:G] (cB13) at (cComma13.east) {};

% Linha 4: (Esportiva, P)
\node [setC, below=\dy of cA13, label=left:Esportiva] (cA21) {};
\node [font=\bfseries] (cComma21) at ([xshift=\dx] cA21.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:P] (cB21) at (cComma21.east) {};

% Linha 5: (Esportiva, M)
\node [setC, below=\dy of cA21, label=left:Esportiva] (cA22) {};
\node [font=\bfseries] (cComma22) at ([xshift=\dx] cA22.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:M] (cB22) at (cComma22.east) {};

% Linha 6: (Esportiva, G)
\node [setC, below=\dy of cA22, label=left:Esportiva] (cA23) {};
\node [font=\bfseries] (cComma23) at ([xshift=\dx] cA23.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:G] (cB23) at (cComma23.east) {};

\node [above=1.5cm of cA11, xshift=-\dx, font=\bfseries, align=center] (titleC) {Conjunto C = A $\times$ B \\Grade de Camisetas};

% --- Camada de Fundo ---
\begin{pgfonlayer}{background}
  \node[fit=(a1) (a2)] {};
  \node[fit=(b1) (b2) (b3)] {};
  \node[fit=
    (titleC)
    (cA11)(cComma11)(cB11)
    (cA12)(cComma12)(cB12)
    (cA13)(cComma13)(cB13)
    (cA21)(cComma21)(cB21)
    (cA22)(cComma22)(cB22)
    (cA23)(cComma23)(cB23)
  ] {};
\end{pgfonlayer}

\end{tikzpicture}
```

No exemplo anterior, o conjunto C foi criado fazendo produto cartesiano de A x B. O **conjunto C** Ã© uma **RelaÃ§Ã£o.**

Contudo as operaÃ§Ãµes da teoria dos conjuntos da matemÃ¡tica nÃ£o eram suficientes para resolver algumas situaÃ§Ãµes:

#### Exemplo 2.

Considere uma **cadastro de paÃ­ses** denominado **conjunto A = {Brasil, Argentina, Chile }** e um **cadastro de capitais** chamado **conjunto B = {Brasilia, Buenos Aires, Santiago}**. `Verifique se Ã© possÃ­vel` criar um **conjunto C** utilizando o **produto cartesiano** entre **A x B**, ou seja, uma **RelaÃ§Ã£o**. Nesta **relaÃ§Ã£o C**, **`cada paÃ­s deve estar associado a sua capital`**.

```{r aula02-exemplo-02, engine='tikz', echo=FALSE, fig.cap="Capital X PaÃ­ses"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}



\begin{tikzpicture}
[
  every node/.style={on grid},
  setA/.style={fill=blue,               circle,  inner sep=3pt },
  setB/.style={fill=green!70!black,     circle,  inner sep=3pt },
  setC/.style={fill=red!70!black,       circle,  inner sep=3pt },
  every fit/.style={draw, fill=gray!10, ellipse, inner sep=12pt},
  >=latex
]


% --- Conjunto A (PaÃ­ses) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setA, label=left:Brasil]    (a1) {};
  \node [setA, below=of a1, label=left:Argentina] (a2) {};
  \node [setA, below=of a2, label=left:Chile]     (a3) {};
  \node [above=1.5cm of a1, font=\bfseries]            {PaÃ­ses};
\end{scope}

% --- Conjunto B (Capitais) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setB, right=of a1, label=right:BrasÃ­lia]       (b1) {};
  \node [setB, below=of b1, label=right:{Buenos Aires}] (b2) {};
  \node [setB, below=of b2, label=right:{Santiago}]     (b3) {};
  \node [above=1.5cm of b1, font=\bfseries] {Capitais};
\end{scope}

% --- As Setas (Mapeamento) ---
%\draw[->, shorten >= 3pt, shorten <= 3pt, thick, gray!80] (a1) -- (b1);
%\draw[->, shorten >= 3pt, shorten <= 3pt, thick, gray!80] (a2) -- (b2);
%\draw[->, shorten >= 3pt, shorten <= 3pt, thick, gray!80] (a3) -- (b3);


% --- Conjunto C (layout: c1 ao lado de c2; c3 abaixo do par) ---
% --- Conjunto C: C = A x B (todos os pares ordenados) ---

% Ã‚ncoras e deslocamentos para ficar "quase encostado"
\def\dx{1.5pt}      % distÃ¢ncia do c1 atÃ© a vÃ­rgula e da vÃ­rgula atÃ© c2
\def\dy{5mm}        % espaÃ§amento vertical entre linhas (pares)

% TÃ­tulo
%\node [below=3cm of b1, font=\bfseries] (titleC) {C = A \times B};

% Linha 1: (Brasil, BrasÃ­lia)
\node [setC, below=4cm of a3, xshift=3cm, label=left:Brasil, fill=blue] (cA11) {};
\node [font=\bfseries] (cComma11) at ([xshift=\dx] cA11.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:BrasÃ­lia, fill=blue] (cB11) at (cComma11.east) {};

% Linha 2: (Brasil, Buenos Aires)
\node [setC, below=\dy of cA11, label=left:Brasil] (cA12) {};
\node [font=\bfseries] (cComma12) at ([xshift=\dx] cA12.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:{Buenos Aires}] (cB12) at (cComma12.east) {};

% Linha 3: (Brasil, Santiago)
\node [setC, below=\dy of cA12, label=left:Brasil] (cA13) {};
\node [font=\bfseries] (cComma13) at ([xshift=\dx] cA13.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Santiago] (cB13) at (cComma13.east) {};

% Linha 4: (Argentina, BrasÃ­lia)
\node [setC, below=\dy of cA13, label=left:Argentina] (cA21) {};
\node [font=\bfseries] (cComma21) at ([xshift=\dx] cA21.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:BrasÃ­lia] (cB21) at (cComma21.east) {};

% Linha 5: (Argentina, Buenos Aires)
\node [setC, below=\dy of cA21, label=left:Argentina, fill=blue] (cA22) {};
\node [font=\bfseries] (cComma22) at ([xshift=\dx] cA22.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:{Buenos Aires}, fill=blue] (cB22) at (cComma22.east) {};

% Linha 6: (Argentina, Santiago)
\node [setC, below=\dy of cA22, label=left:Argentina] (cA23) {};
\node [font=\bfseries] (cComma23) at ([xshift=\dx] cA23.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Santiago] (cB23) at (cComma23.east) {};

% Linha 7: (Chile, BrasÃ­lia)
\node [setC, below=\dy of cA23, label=left:Chile] (cA31) {};
\node [font=\bfseries] (cComma31) at ([xshift=\dx] cA31.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:BrasÃ­lia] (cB31) at (cComma31.east) {};

% Linha 8: (Chile, Buenos Aires)
\node [setC, below=\dy of cA31, label=left:Chile] (cA32) {};
\node [font=\bfseries] (cComma32) at ([xshift=\dx] cA32.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:{Buenos Aires}] (cB32) at (cComma32.east) {};

% Linha 9: (Chile, Santiago)
\node [setC, below=\dy of cA32, label=left:Chile, fill=blue] (cA33) {};
\node [font=\bfseries] (cComma33) at ([xshift=\dx] cA33.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Santiago, fill=blue] (cB33) at (cComma33.east) {};

\node [above=1.5cm of cA11, xshift=-\dx, font=\bfseries] (titleC) {PaÃ­ses X Capitais};


% --- Camada de Fundo (Elipses) ---
\begin{pgfonlayer}{background}
  \node[fit=(a1) (a2) (a3)] {};
  \node[fit=(b1) (b2) (b3)] {};
  \node[fit= (titleC) (cComma11) (cComma12) (cComma13) (cComma21) (cComma22)  (cComma23)  (cComma31)  (cComma32) (cComma33) ] {};
\end{pgfonlayer}

\end{tikzpicture}


```

Verificando a operaÃ§Ã£o de **produto cartesiano** que gerou o **conjunto C** produziu **9 pares ordenados**. Mas para nosso contexto (**associar paÃ­ses e suas capitais**) dos **9 pares** gerados, apenas **`3 pares ordenados fazem sentido`**: C= {(**Brasil, Brasilia**), (**Argentina, Buenos Aires**), (**Chile, Santiago**)} ; os outros **6 pares nÃ£o fazem sentido** na associaÃ§Ã£o de PaÃ­ses e Capitais.

Portanto, para este contexto, apenas a operaÃ§Ã£o de produto cartesiano nÃ£o atendeu os requisitos para gerar um conjunto de dados consistente a partir de dois cadastros (dois conjuntos) fornecidos.

### A SoluÃ§Ã£o vem da MatemÃ¡tica: FUNÃ‡Ã•ES como RELACIONAMENTOS:

Uma **funÃ§Ã£o** Ã© uma relaÃ§Ã£o especial entre dois conjuntos.

Sejam ( A ) e ( B ) conjuntos.

Uma funÃ§Ã£o

$f: A \to B$

Ã© um subconjunto do produto cartesiano

$f \subseteq A \times B$

em bom portuguÃªs: \>\> Uma funÃ§Ã£o f(x) Ã© uma regra que associa cada elemento de A a exatamente um elemento de B.

As funÃ§Ãµes f(x) agem como uma filtragem para selecionar do produto cartesiano apenas os pares de elementos que fazem sentido:

As funÃ§Ãµes podem ser vistas como setas mapeando cada ponto de um conjunto no outro.

No exemplo da loja de camisetas, temos cada elemento do "conjunto A" mapeando todos os elementos do "conjunto B". Ã‰ a representaÃ§Ã£o grÃ¡fica do produto cartesiano e seus pares ordenados.

```{r aula02-exemplo-03, engine='tikz', echo=FALSE, fig.cap="camisetas X Tamanhos"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}
[
  every node/.style={on grid},
  setA/.style={fill=blue,               circle,  inner sep=3pt },
  setB/.style={fill=green!70!black,     circle,  inner sep=3pt },
  setC/.style={fill=red!70!black,       circle,  inner sep=3pt },
  every fit/.style={draw, fill=gray!10, ellipse, inner sep=8pt},
  >=latex
]

% --- Conjunto A (Camisetas) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setA, label=left:BÃ¡sica]     (a1) {};
  \node [setA, below=of a1, label=left:Esportiva] (a2) {};
  \node [above=1.5cm of a1, font=\bfseries, align=center] {Conjunto A\\Camisetas};
\end{scope}

% --- Conjunto B (Tamanhos) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setB, right=of a1, label=right:P] (b1) {};
  \node [setB, below=of b1, label=right:M] (b2) {};
  \node [setB, below=of b2, label=right:G] (b3) {};
  \node [above=1.5cm of b1, font=\bfseries, align=center] {Conjunto B\\Tamanhos};
\end{scope}


% As setas (funÃ§Ãµes)
\draw[<->,shorten >=3pt] (a1) -- node[near start , above, sloped, text=blue] {$f(\text{BÃ¡sica})$} (b1);
\draw[<->,shorten >=3pt] (a1) -- node[near start , above, sloped, text=blue] {$f(\text{BÃ¡sica})$} (b2);
\draw[<->,shorten >=3pt] (a1) -- node[near start , above, sloped, text=blue] {$f(\text{BÃ¡sica})$} (b3);
\draw[<->,shorten >=3pt] (a2) -- node[near end   , above, sloped, text=red] {$g(\text{Esportiva})$} (b1);
\draw[<->,shorten >=3pt] (a2) -- node[near end   , above, sloped, text=red] {$g(\text{Esportiva})$} (b2);
\draw[<->,shorten >=3pt] (a2) -- node[near end   , above, sloped, text=red] {$g(\text{Esportiva})$} (b3);

% --- Camada de Fundo (Elipses) ---
\begin{pgfonlayer}{background}
  \node[fit=(a1) (a2) ] {};
  \node[fit=(b1) (b2) (b3)] {};
\end{pgfonlayer}

\end{tikzpicture}

```

No exemplo dos paÃ­ses e suas capitais, temos um elemento do "conjunto A" mapeando um elemento do "conjunto B". Ã‰ um subconjunto do produto cartesiano de A X B, ou seja, uma filtragem aplicada ao produto cartesiano. Na terminologia das funÃ§Ãµes, Ã© uma funÃ§Ã£o bijetora.

```{r aula02-exemplo-04, engine='tikz', echo=FALSE, fig.cap="PaÃ­ses X Capitais"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}



\begin{tikzpicture}
[
  every node/.style={on grid},
  setA/.style={fill=blue,               circle,  inner sep=3pt },
  setB/.style={fill=green!70!black,     circle,  inner sep=3pt },
  setC/.style={fill=red!70!black,       circle,  inner sep=3pt },
  every fit/.style={draw, fill=gray!10, ellipse, inner sep=12pt},
  >=latex
]


% --- Conjunto A (PaÃ­ses) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setA, label=left:Brasil]    (a1) {};
  \node [setA, below=of a1, label=left:Argentina] (a2) {};
  \node [setA, below=of a2, label=left:Chile]     (a3) {};
  \node [above=1.5cm of a1, font=\bfseries]            {PaÃ­ses};
\end{scope}

% --- Conjunto B (Capitais) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setB, right=of a1, label=right:BrasÃ­lia]       (b1) {};
  \node [setB, below=of b1, label=right:{Buenos Aires}] (b2) {};
  \node [setB, below=of b2, label=right:{Santiago}]     (b3) {};
  \node [above=1.5cm of b1, font=\bfseries] {Capitais};
\end{scope}

% --- As Setas (Mapeamento) ---
\draw[<->,shorten >=3pt] (a1) -- node[near start , above, sloped, text=red] {$f(\text{Brasil})$} (b1);
\draw[<->,shorten >=3pt] (a2) -- node[near start , above, sloped, text=red] {$f(\text{Argentina})$} (b2);
\draw[<->,shorten >=3pt] (a3) -- node[near start , above, sloped, text=red] {$f(\text{Chile})$} (b3);


% --- Conjunto C (layout: c1 ao lado de c2; c3 abaixo do par) ---
% --- Conjunto C: C = A x B (todos os pares ordenados) ---

% Ã‚ncoras e deslocamentos para ficar "quase encostado"
\def\dx{1.5pt}      % distÃ¢ncia do c1 atÃ© a vÃ­rgula e da vÃ­rgula atÃ© c2
\def\dy{5mm}        % espaÃ§amento vertical entre linhas (pares)



% --- Camada de Fundo (Elipses) ---
\begin{pgfonlayer}{background}
  \node[fit=(a1) (a2) (a3)] {};
  \node[fit=(b1) (b2) (b3)] {};
\end{pgfonlayer}

\end{tikzpicture}
```

ConclusÃ£o de Codd: apenas as operaÃ§Ãµes convencionais da teoria de conjuntos nÃ£o seria suficiente para projetar sistema de banco de dados. Seria necessÃ¡ria a adiÃ§Ã£o de elementos teoria das funÃ§Ãµes aplicada a teoria das relaÃ§Ãµes.

Professor Codd cria as operaÃ§Ãµes de Algebra Relacional associada a RelaÃ§Ãµes.

Nasce o conceito de Banco de Dados Relacional e os conceitos que irÃ£o criar a linguagem SQL (Structured Query Language).

### RelaÃ§Ã£o em Banco de Dados

Considere:

| Terminologia Relacional | Banco de Dados | Origem MatemÃ¡tica |
|:-----------------:|:---------------:|:----------------------------------:|
| RELAÃ‡ÃƒO | **TABELA** | CONJUNTO ou SUBCONJUNTO |
| ATRIBUTO | **COLUNAS** | NÃ£o aparece explicitamente |
| TUPLA | **LINHA** | ELEMENTO DO CONJUNTO OU PAR ORDENADO |

## 2. OperaÃ§Ãµes Relacionais

Baseadas na Ãlgebra Relacional de Codd.

| OperaÃ§Ã£o           | SÃ­mbolo | DescriÃ§Ã£o                    |
|--------------------|---------|------------------------------|
| SeleÃ§Ã£o            | Ïƒ       | Filtra linhas                |
| ProjeÃ§Ã£o           | Ï€       | Seleciona colunas            |
| UniÃ£o              | âˆª       | Combina relaÃ§Ãµes compatÃ­veis |
| InterseÃ§Ã£o         | âˆ©       | Elementos comuns             |
| DiferenÃ§a          | âˆ’       | SubtraÃ§Ã£o                    |
| Produto Cartesiano | Ã—       | CombinaÃ§Ã£o total             |
| JunÃ§Ã£o             | â‹ˆ       | Produto + SeleÃ§Ã£o            |
| DivisÃ£o            | Ã·       | Consulta universal           |

Todas as operaÃ§Ãµes Relacionais sÃ£o operaÃ§Ãµes SQL e serÃ£o estudadas na aula 4 (Modelagem parte 2).

## 3. Propriedades de RelaÃ§Ãµes

Seja R âŠ† A Ã— A.

### 3.1 Reflexiva

"Todo elemento Ã© equivalente a si mesmo"

```         
âˆ€x âˆˆ A, (x,x) âˆˆ R
```

#### Exemplo "Cadastro de Produtos - Popriedade "Reflexiva" da RelaÃ§Ã£o:
Em um cadastro de produtos, o produto Teclado tem a mesma categoria que o produto Teclado (ele mesmo). Consequentemente, em uma tabela do Banco de Dados, o valor da coluna "CategoriaID" de um registro Ã© sempre igual ao "CategoriaID" dele mesmo.

![](media/20-teclado-1.jpg){width="255"}

### 3.2 SimÃ©trica

"Se o **primeiro equivale ao segundo**, entÃ£o o **segundo equivale ao primeiro**"

```         
Se (x,y) âˆˆ R entÃ£o (y,x) âˆˆ R
```

#### Exemplo: "Cadastro de Produtos - Popriedade "SimÃ©trica" da RelaÃ§Ã£o:
Se o **Teclado** (1) **Ã© equivalente** ao **Mouse** (2) (ambos sÃ£o da categoria **EletrÃ´nicos**), entÃ£o o **Mouse** (2) **Ã© equivalente** ao **Teclado** (1). Consequentemente, no Banco de Dados, **Teclado.CategoriaID** = **Mouse.CategoriaID.**

![](media/21-teclado-mouse.jpg){width="327"}

Essa propriedade Ã© utilizada para fazer "pareamento" entre tabelas.

### 3.3 Transitiva

"Se o **primeiro equivale ao segundo**, e o **segundo equivale ao terceiro**", entÃ£o **primeiro equivale ao terceiro."**

```         
Se (x,y) âˆˆ R e (y,z) âˆˆ R entÃ£o (x,z) âˆˆ R
```

#### Exemplo: "Cadastro de Produtos - Popriedade "Transitiva" da RelaÃ§Ã£o:
Se **Teclado** (1) **Ã© equivalente** ao **Mouse** (2) e **Mouse** (2) **Ã© equivalente** ao **Monitor** (3), entÃ£o obrigatoriamente **Teclado** (1) **Ã© equivalente** ao **Monitor** (3), **pois todos sÃ£o da categoria "EletrÃ´nicos"**.

|  |  |  |
|------------------------|------------------------|------------------------|
| ![](media/21-teclado-mouse.jpg) | ![](media/22-mouse-monitor.jpg) | ![](media/23-teclado-monitor.jpg) |

Isso garante que todos os elementos de uma categoria formem um grupo fechado e coeso.

### 3.4 AntissimÃ©trica

"Se o **primeiro equivale ao segundo**, entÃ£o o **segundo NÃƒO PODE equivaler ao primeiro**"

```         
Se (x,y) âˆˆ R e (y,x) âˆˆ R entÃ£o x = y
```

#### Exemplo: "Cadastro de FuncionÃ¡rios - Popriedade "Anti-SimÃ©trica" da RelaÃ§Ã£o:
Se o **JoÃ£o Ã© gerente da Maria**, a **Maria NÃƒO PODE ser gerente do JoÃ£o**. Em uma tabela de funcionÃ¡rios, o Banco de dados garante HIERARQUIA na regra de negÃ³cio.

![](media/24-joao-maria.jpg){width="467"}

## 4. RelaÃ§Ã£o de EquivalÃªncia

Uma relaÃ§Ã£o Ã© de equivalÃªncia se Ã©:

-   Reflexiva
-   SimÃ©trica
-   Transitiva

#### Exemplo: "Cadastro de Produtos - "Teste de RelaÃ§Ã£o e EquivalÃªncia":
Tenho uma tabela de produtos. Todos os produtos estÃ£o classificados em categorias. Prove nesta tabela que 2 produtos sÃ£o equivalentes.

|                   |                     |                          |
|-------------------|---------------------|--------------------------|
| **ID (Elemento)** | **Nome do Produto** | **CategoriaID (Classe)** |
| 1                 | Teclado             | 1 (EletrÃ´nicos)          |
| 2                 | Mouse               | 1 (EletrÃ´nicos)          |
| 3                 | Monitor             | 1 (EletrÃ´nicos)          |
| 4                 | Camisa              | 2 (VestuÃ¡rio)            |
| 5                 | CalÃ§a               | 2 (VestuÃ¡rio)            |
| 6                 | TÃªnis               | 2 (VestuÃ¡rio)            |
| 7                 | Livro SQL           | 3 (Livraria)             |
| 8                 | Livro Java          | 3 (Livraria)             |
| 9                 | Livro Redes         | 3 (Livraria)             |
| 10                | Cadeira             | 4 (MÃ³veis)               |
| 11                | Mesa                | 4 (MÃ³veis)               |
| 12                | SofÃ¡                | 4 (MÃ³veis)               |

##### ResoluÃ§Ã£o:

"Dois produtos sÃ£o equivalentes se pertencerem Ã  mesma categoria."

"Dois produtos nÃ£o sÃ£o equivalentes se pertencerem a categorias diferentes."

Para provar isso, Ã© preciso testar as 3 propriedades de relaÃ§Ãµes (Reflexiva, SimÃ©trica e Transitiva) em relaÃ§Ã£o ao ponto comum entre eles, que Ã© no caso "categoria".

Tomarei como exemplo "Cadeira, Mesa, SofÃ¡". Analisarei segundo a caracteristica comum "categoria":

1)  

    -   Reflexiva - Cadeira Ã© da mesma categoria que cadeira ? Sim - OK

2)  

    -   SimÃ©trica - Cadeira Ã© da mesma categoria que mesa e Mesa Ã© da mesma categoria que Cadeira ? Sim - OK

3)  

    -   Transitiva - Cadeira Ã© da mesma categoria que mesa; Mesa Ã© da mesma categira que sofÃ¡; portanto cadeira Ã© da mesma categoria que sofÃ¡ ? Sim - OK

Considerando que cadeira, mesa e sofÃ¡ atendem as propriedades "Reflexiva", "SimÃ©trica" e "Transitiva", entÃ£o "Cadeira, Mesa, SofÃ¡" constituem a mesma classe de equivalencia.

### Classes de EquivalÃªncia

Dada relaÃ§Ã£o \~ em A:

A classe de equivalÃªncia de x Ã©:

```         
[x] = { y âˆˆ A | y ~ x }
```

Exemplo em uma relaÃ§Ã£o de Banco de Dados formada pelo `conjunto A Produtos` e pelo
`conjunto B Categorias`:

R âŠ† A Ã— B :

```{r aula02-exemplo-05, engine='tikz', echo=FALSE, fig.cap="Produtos X Categorias"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}
[
 every node/.style={on grid},
  setA/.style={fill=blue!60,            circle,  inner sep=3pt},
  setB/.style={                         circle,  inner sep=3pt},
  setC/.style={fill=red!70!black,       circle,  inner sep=3pt },
  every fit/.style={draw, fill=gray!10, ellipse, inner sep=10pt, minimum width=8cm,
    minimum height=3cm},
  >=latex
]

% --- Conjunto A (Produtos) ---
\begin{scope}[node distance=0.9cm and 7.5cm]
  \node [setA, label=left:Teclado]     (a1)  {};
  \node [setA, below=of a1, label=left:Mouse]       (a2)  {};
  \node [setA, below=of a2, label=left:Monitor]     (a3)  {};
  \node [setA, below=of a3, label=left:Camisa]      (a4)  {};
  \node [setA, below=of a4, label=left:CalÃ§a]       (a5)  {};
  \node [setA, below=of a5, label=left:TÃªnis]       (a6)  {};
  \node [setA, below=of a6, label=left:Livro SQL]   (a7)  {};
  \node [setA, below=of a7, label=left:Livro Java]  (a8)  {};
  \node [setA, below=of a8, label=left:Livro Redes] (a9)  {};
  \node [setA, below=of a9, label=left:Cadeira]     (a10) {};
  \node [setA, below=of a10,label=left:Mesa]        (a11) {};
  \node [setA, below=of a11,label=left:SofÃ¡]        (a12) {};

  \node [above=3cm of a1, font=\bfseries, align=center]
  {Conjunto A\\Produtos de venda};
\end{scope}

% --- Conjunto B (Categorias com cores diferentes) ---
\begin{scope}[node distance=1.4cm and 7.5cm]
  \node [setB, fill=blue!70, right=9cm of a1, label=right:EletrÃ´nicos] (b1) {};
  \node [setB, fill=green!70!black, below=of b1, label=right:VestuÃ¡rio]   (b2) {};
  \node [setB, fill=purple!70, below=of b2, label=right:Livraria]    (b3) {};
  \node [setB, fill=red!70, below=of b3, label=right:MÃ³veis]      (b4) {};

  \node [above=2cm of b1, font=\bfseries, align=center]
  {Conjunto B\\Categorias};
\end{scope}

% --- RelaÃ§Ã£o real R âŠ† AÃ—B ---

% EletrÃ´nicos (azul)
\draw[->,shorten >=3pt, thick, blue] (a1) -- node[near start , above, sloped, text=blue] {$f(\text{Teclado})=\text{EletrÃ´nicos}$} (b1);
\draw[->,shorten >=3pt, thick, blue] (a2) -- node[near start , above, sloped, text=blue] {$f(\text{Mouse})=\text{EletrÃ´nicos}$} (b1);
\draw[->,shorten >=3pt, thick, blue] (a3) -- node[near start , above, sloped, text=blue] {$f(\text{Monitor})=\text{EletrÃ´nicos}$} (b1);

% VestuÃ¡rio (verde)
\draw[->,shorten >=3pt, thick, green!70!black] (a4) -- node[near start , above, sloped, text=green] {$f(\text{Camisa})=\text{VestuÃ¡rio}$} (b2);
\draw[->,shorten >=3pt, thick, green!70!black] (a5) -- node[near start , above, sloped, text=green] {$f(\text{CalÃ§a})=\text{VestuÃ¡rio}$} (b2);
\draw[->,shorten >=3pt, thick, green!70!black] (a6) -- node[near start , above, sloped, text=green] {$f(\text{TÃªnis})=\text{VestuÃ¡rio}$} (b2);

% Livraria (roxo)
\draw[->,shorten >=3pt, thick, purple] (a7) -- node[near start , above, sloped, text=purple] {$f(\text{Livro SQL})=\text{Livraria}$} (b3);
\draw[->,shorten >=3pt, thick, purple] (a8) -- node[near start , above, sloped, text=purple] {$f(\text{Livro JAVA})=\text{Livraria}$} (b3);
\draw[->,shorten >=3pt, thick, purple] (a9) -- node[near start , above, sloped, text=purple] {$f(\text{Livro REDES})=\text{Livraria}$} (b3);

% MÃ³veis (vermelho)
\draw[->,shorten >=3pt, thick, red] (a10) -- node[near start , above, sloped, text=red] {$f(\text{Cadeira})=\text{MÃ³veis}$} (b4);
\draw[->,shorten >=3pt, thick, red] (a11) -- node[near start , above, sloped, text=red] {$f(\text{Mesa})=\text{MÃ³veis}$} (b4);
\draw[->,shorten >=3pt, thick, red] (a12) -- node[near start , above, sloped, text=red] {$f(\text{SofÃ¡})=\text{MÃ³veis}$} (b4);


% --- Conjunto C (layout: lista de pares ordenados de R) ---
% Aqui mostramos explicitamente os pares (produto, categoria) pertencentes a R.
\def\dx{1.5pt}
\def\dy{8.0mm}


\node [below=4cm of b4, yshift=-2cm] (anchorC) {};


% Linha 1: (Teclado, EletrÃ´nicos)
\node [setC, below=0cm of anchorC, xshift=-0.5cm, label=left:Teclado, fill=blue!80] (cA1) {};
\node [font=\bfseries] (cComma1) at ([xshift=\dx] cA1.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Eletr\^onicos, fill=blue!80] (cB1) at (cComma1.east) {};

% Linha 2: (Mouse, EletrÃ´nicos)
\node [setC, below=\dy of cA1, label=left:Mouse, fill=blue!80] (cA2) {};
\node [font=\bfseries] (cComma2) at ([xshift=\dx] cA2.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Eletr\^onicos, fill=blue!80] (cB2) at (cComma2.east) {};

% Linha 3: (Monitor, EletrÃ´nicos)
\node [setC, below=\dy of cA2, label=left:Monitor, fill=blue!80] (cA3) {};
\node [font=\bfseries] (cComma3) at ([xshift=\dx] cA3.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Eletr\^onicos, fill=blue!80] (cB3) at (cComma3.east) {};

% Linha 4: (Camisa, VestuÃ¡rio)
\node [setC, below=\dy of cA3, label=left:Camisa, fill=green!70!black] (cA4) {};
\node [font=\bfseries] (cComma4) at ([xshift=\dx] cA4.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Vestu\'ario, fill=green!70!black] (cB4) at (cComma4.east) {};

% Linha 5: (CalÃ§a, VestuÃ¡rio)
\node [setC, below=\dy of cA4, label=left:Cal\c ca, fill=green!70!black] (cA5) {};
\node [font=\bfseries] (cComma5) at ([xshift=\dx] cA5.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Vestu\'ario, fill=green!70!black] (cB5) at (cComma5.east) {};

% Linha 6: (TÃªnis, VestuÃ¡rio)
\node [setC, below=\dy of cA5, label=left:T\^enis, fill=green!70!black] (cA6) {};
\node [font=\bfseries] (cComma6) at ([xshift=\dx] cA6.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Vestu\'ario, fill=green!70!black] (cB6) at (cComma6.east) {};

% Linha 7: (Livro SQL, Livraria)
\node [setC, below=\dy of cA6, label=left:Livro SQL, fill=purple!80] (cA7) {};
\node [font=\bfseries] (cComma7) at ([xshift=\dx] cA7.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Livraria, fill=purple!80] (cB7) at (cComma7.east) {};

% Linha 8: (Livro Java, Livraria)
\node [setC, below=\dy of cA7, label=left:Livro Java, fill=purple!80] (cA8) {};
\node [font=\bfseries] (cComma8) at ([xshift=\dx] cA8.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Livraria, fill=purple!80] (cB8) at (cComma8.east) {};

% Linha 9: (Livro Redes, Livraria)
\node [setC, below=\dy of cA8, label=left:Livro Redes, fill=purple!80] (cA9) {};
\node [font=\bfseries] (cComma9) at ([xshift=\dx] cA9.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Livraria, fill=purple!80] (cB9) at (cComma9.east) {};

% Linha 10: (Cadeira, MÃ³veis)
\node [setC, below=\dy of cA9, label=left:Cadeira, fill=red!80] (cA10) {};
\node [font=\bfseries] (cComma10) at ([xshift=\dx] cA10.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:M\'oveis, fill=red!80] (cB10) at (cComma10.east) {};

% Linha 11: (Mesa, MÃ³veis)
\node [setC, below=\dy of cA10, label=left:Mesa, fill=red!80] (cA11) {};
\node [font=\bfseries] (cComma11) at ([xshift=\dx] cA11.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:M\'oveis, fill=red!80] (cB11) at (cComma11.east) {};

% Linha 12: (SofÃ¡, MÃ³veis)
\node [setC, below=\dy of cA11, label=left:Sof\'a, fill=red!80] (cA12) {};
\node [font=\bfseries] (cComma12) at ([xshift=\dx] cA12.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:M\'oveis, fill=red!80] (cB12) at (cComma12.east) {};

% --- Fundo ---
\begin{pgfonlayer}{background}
  \node[fit=(a1) (a12), draw, fill=gray!10, ellipse, inner sep=8pt] {};
  \node[fit=(b1) (b4),  draw, fill=gray!10, ellipse, inner sep=8pt] {};
  \node[fit=(cComma1) (cComma2) (cComma3) (cComma4) (cComma5) (cComma6) 
                 (cComma7) (cComma8) (cComma9) (cComma10) (cComma11) (cComma12)] {};
  \node[fit=(cA1) (cA12) (cB1) (cB12) (cComma1) (cComma12), name=fitC] {};
\end{pgfonlayer}

\node[above=6mm of fitC.north, font=\bfseries, align=center] (titleC)
{Conjunto C\\ $R \subseteq A \times B$};


\end{tikzpicture}
```


Chamamos de *Classes de EquivalÃªncia* todas as *relaÃ§Ãµes de equivalÃªncia* que se
formam dentro da RelaÃ§Ã£o.

SÃ£o as "panelinhas" que se formam dentro do conjunto.

No nosso exemplo temas as seguintes Classes de EquivalÃªncia:

| Classe | Categoria   | Pares Ordenados                                                                     |
| ------ | ----------- | ----------------------------------------------------------------------------------- |
| 1      | EletrÃ´nicos | 1. (Teclado, EletrÃ´nicos)<br>2. (Mouse, EletrÃ´nicos)<br>3. (Monitor, EletrÃ´nicos)   |
| 2      | VestuÃ¡rio   | 1. (Camisa, VestuÃ¡rio)<br>2. (CalÃ§a, VestuÃ¡rio)<br>3. (TÃªnis, VestuÃ¡rio)            |
| 3      | Livraria    | 1. (Livro SQL, Livraria)<br>2. (Livro Java, Livraria)<br>3. (Livro Redes, Livraria) |
| 4      | MÃ³veis      | 1. (Cadeira, MÃ³veis)<br>2. (Mesa, MÃ³veis)<br>3. (SofÃ¡, MÃ³veis)                      |

ObservaÃ§Ãµes importantes:

1-As classes sÃ£o *disjuntas*;
2-A *uniÃ£o das quatro classes* Ã© exatamente a relaÃ§Ã£o $ R $;
3-Cada *par ordenado* pertence a uma *Ãºnica classe*;


## 5. DependÃªncias Funcionais

SÃ£o os atributos de uma relaÃ§Ã£o (colunas de uma tabela) cujos valores determinam
 os valores de outras colunas.

Exemplo: Imagine a RelaÃ§Ã£o (Tabela) chamada *CursoProgramacao*.

| ID_Aluno | Nome_Aluno     | Cod_Curso | Nome_Curso      | ID_Instrutor | Nota_Final |
|----------|----------------|-----------|-----------------|--------------|------------|
| 10       | Alan Turing    | SQL-01    | Banco de Dados  | 500          | 9.5        |
| 20       | Ada Lovelace   | PY-02     | Python AvanÃ§ado | 600          | 10.0       |
| 10       | Alan Turing    | PY-02     | Python AvanÃ§ado | 600          | 8.0        |
| 30       | Grace Hopper   | SQL-01    | Banco de Dados  | 500          | 9.0        |
| 40       | Linus Torvalds | JS-03     | JavaScript      | 700          | 7.5        |

Considere as seguintes *Regras de NegÃ³cio*

- Cada aluno tem apenas um nome oficial.

- Cada cÃ³digo de curso pertence a apenas um nome de curso.

- Cada curso Ã© ministrado por apenas um instrutor especÃ­fico (um instrutor nÃ£o muda de curso).

- Um aluno pode fazer vÃ¡rios cursos, e terÃ¡ uma nota diferente para cada um.

Tendo estas informaÃ§Ãµes identifique as DEPENDÃŠNCIAS FUNCIONAIS dos atributos da 
tabela.

Quais sÃ£o os atributos da tabela?

| ID_Aluno | Nome_Aluno | Cod_Curso | Nome_Curso | ID_Instrutor | Nota_Final |
|----------|------------|-----------|------------|--------------|------------|

1) Quais destes atributos o valor identificam unicamente o valor de outro atributo?

| Atributo1 | DependÃªncia Funcional |   Atributo2   | Resultado |
|:---------:|:---------------------:|:-------------:|:---------:|
|  ID_Aluno |        determina      |   Nome_Aluno  |     ?     |
| Cod_Curso |        determina      |   Nome_Curso  |     ?     |
| Cod_Curso |        determina      |  ID_Instrutor |     ?     |
|  ID_Aluno |        determina      |   Nota_Final  |     ?     |

2) Qual Ã© a combinaÃ§Ã£o de colunas necessÃ¡ria para determinar a *Nota_Final*?

### ResoluÃ§Ã£o

1) Quais destes atributos o valor identificam unicamente o valor de outro atributo?

| Atributo1 | DependÃªncia Funcional |   Atributo2   | Resultado | ComentÃ¡rio                                                                                                     |
|:---------:|:---------------------:|:-------------:|:---------:|----------------------------------------------------------------------------------------------------------------|
|  ID_Aluno |       determina       |   Nome_Aluno  |    SIM    | ID_Aluno valendo "10" determina Nome_Aluno "Alan Turing"                                                       |
| Cod_Curso |        determina      |   Nome_Curso  |    SIM    | Cod_Curso valendo "SQL-01" determina Nome_Curso "Banco de Dados"                                               |
| Cod_Curso |        determina      |  ID_Instrutor |    SIM    | Pela regra de negÃ³cio #3, Cod_Curso determina ID_Instrutor. Aqui temos um caso especial de DependÃªncia Parcial |
|  ID_Aluno |        determina      |   Nota_Final  |    NÃƒO    | Olhe o Alan Turing (ID 10). Ele tem nota 9.5 e nota 8.0. ID_Aluno sozinho nÃ£o determina a nota do aluno.       |

2) Qual Ã© a combinaÃ§Ã£o de colunas necessÃ¡ria para determinar a *Nota_Final*?

Eu preciso saber QUEM (Aluno) e em QUAL MATÃ‰RIA (Curso) para te dar a nota exata. A combinaÃ§Ã£o dos atributos {ID_Aluno, Cod_Curso} determinam Nota_Final! Esta Ã© um caso de *DependÃªncia Total*. 

## 6. Conceito de Fecho

Dado conjunto de atributos X e conjunto de dependÃªncias funcionais F:

O **fecho de X** (Xâº) Ã© o conjunto de todos os atributos funcionalmente determinados por X.

Exemplo:

DependÃªncias:

```         
A â†’ B
B â†’ C
```

EntÃ£o:

```         
Aâº = {A, B, C}
```

## 6. NormalizaÃ§Ã£o

Processo de organizaÃ§Ã£o de relaÃ§Ãµes para:

-   Eliminar redundÃ¢ncia
-   Evitar anomalias
-   Garantir consistÃªncia

### 1Âª Forma Normal (1FN)

-   Atributos atÃ´micos
-   Sem grupos repetitivos

### 2Âª Forma Normal (2FN)

-   1FN
-   Sem dependÃªncia parcial de chave composta

### 3Âª Forma Normal (3FN)

-   2FN
-   Sem dependÃªncia transitiva

### BCNF

Forma mais forte que 3FN:

Para toda dependÃªncia:

```         
X â†’ Y
```

X deve ser superchave.


### RelaÃ§Ãµes de EquivalÃªncia e NormalizaÃ§Ã£o

DependÃªncias funcionais induzem partiÃ§Ãµes do conjunto de tuplas.

Quando:

```         
A â†’ B
```

Significa que valores iguais de A geram classes de equivalÃªncia nas tuplas.




## ConexÃ£o Final â€” A Base MatemÃ¡tica do SGBD

| Conceito MatemÃ¡tico     | AplicaÃ§Ã£o em BD            |
|-------------------------|----------------------------|
| RelaÃ§Ã£o                 | Tabela                     |
| Produto cartesiano      | CombinaÃ§Ã£o de domÃ­nios     |
| RelaÃ§Ã£o de equivalÃªncia | Particionamento por chave  |
| Fecho                   | Descoberta de dependÃªncias |
| Transitiva              | AnÃ¡lise de dependÃªncias    |
| AntissimÃ©trica          | Ordem parcial              |
| Ãlgebra relacional      | SQL                        |

```{r impressao-01, eval=FALSE, include=FALSE}
rmarkdown::render("02-2026-02-24_Fubdamentos_SGBD-aula.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; utils::browseURL("docs/temporario.html")
```


```{r impressao-02, eval=FALSE, include=FALSE}
rmarkdown::render("02-2026-02-24_Fubdamentos_SGBD-aula.Rmd", output_dir="docs", output_file ="temporario.docx" , output_format = "word_document") ; utils::browseURL("docs/temporario.docx")
```



<!--chapter:end:02-aula02/02-2026-02-24_Fubdamentos_SGBD-aula.Rmd-->

## ExercÃ­cios

```{r geracao_arquivos, eval=FALSE, include=FALSE}
rmarkdown::render("03-2025-08-19_20_.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; utils::browseURL("docs/temporario.html")
```

<!--chapter:end:02-aula02/02-2026-02-24_Fubdamentos_SGBD-exercicio.Rmd-->

---
output: 
  html_document: 
    highlight: tango
    theme: cerulean
    fig_caption: true
---

# Modelagem de Bancos de Dados parte 01

#### 18/08/2025 {.unnumbered}

#### Professor MiguÃ©l Suares {.unnumbered}

## IntroduÃ§Ã£o: Visitando a teoria de Bancos de Dados

![](media/01-banco-de-dados.jpg)

> **Banco de Dados** Um banco de dados Ã© uma coleÃ§Ã£o compartilhada de dados logicamente relacionados, projetada para atender Ã s necessidades informacionais de uma organizaÃ§Ã£o. - *DATE, C. J. An Introduction to Database Systems. 8. ed. Boston: Addison-Wesley, 2003*.

Ou seja, alguns pontos-chave da definiÃ§Ã£o de Date:

-   "ColeÃ§Ã£o de dados ..." â†’ nÃ£o Ã© um conjunto de arquivos soltos, mas dados organizados.

-   "Compartilhada ..." â†’ nÃ£o pertence a apenas um usuÃ¡rio ou aplicaÃ§Ã£o; Ã© usada por vÃ¡rios.

-   "Dados logicamente relacionados ..." â†’ os dados tÃªm um relacionamento semÃ¢ntico, nÃ£o sÃ£o apenas agrupamentos arbitrÃ¡rios.

-   "Projetada para atender necessidades ..." â†’ o banco existe para suportar os processos de uma organizaÃ§Ã£o (consultas, relatÃ³rios, controle, tomada de decisÃ£o).

![](media/07-tabela_relacional.jpg)

> **Banco de Dados Relacional** Um banco de dados relacional Ã© um banco de dados baseado em um modelo de dados relacional, no qual os dados sÃ£o representados como um conjunto de relaÃ§Ãµes (tabelas), e cada relaÃ§Ã£o consiste em tuplas (linhas) e atributos (colunas). - *SILBERSCHATZ, Abraham; KORTH, Henry F.; SUDARSHAN, S. Database System Concepts. 6. ed. New York: McGraw-Hill, 2010.*

Agora, alguns pontos-chave da definiÃ§Ã£o de *Abraham Silberschatz* :

-   Base no modelo relacional de Codd (1970).

-   Dados representados em tabelas (relaÃ§Ãµes).

-   Cada tabela Ã© composta de tuplas (linhas) e atributos (colunas).

-   Integridade garantida por restriÃ§Ãµes (chaves, integridade referencial, domÃ­nio de atributos).

-   ManipulaÃ§Ã£o feita por linguagens relacionais (Ã¡lgebra relacional, cÃ¡lculo relacional, SQL).

O Banco de Dados Relacional organiza as informaÃ§Ãµes em **tabelas bidiomensionais** constituÃ­das de **linhas e colunas** chamadas e essas tabelas recebem o nome de **relaÃ§Ãµes**. Cada **relaÃ§Ã£o** possui um **campo-chave** que confere identificaÃ§Ã£o exclusiva a cada registro da tabela.

## Modelo MatemÃ¡tico de um Banco de Dados

Considere um Banco de Dados para representar, com consistÃªncia MatemÃ¡tica os funcionÃ¡rios e Departamentos de uma Empresa.

### Podemos representa-lo matemÃ¡ticamente utilizando a teoria dos conjuntos

```{r tikz-diagrama0, engine='tikz', echo=FALSE, fig.cap="Diagrama de Montadoras, VeÃ­culos e ProprietÃ¡rios"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}
[
  every node/.style={on grid},
  setA/.style={fill=blue ,circle,inner  sep=3pt},
  setB/.style={fill=green,circle,inner  sep=3pt},
  setC/.style={fill=red,rectangle,inner sep=3pt},
  every fit/.style={draw,fill=blue!25,ellipse,text width=25pt},
  >=latex
]

% Conjunto Montadoras
\node [setA,              label  = left:$Fulano$]  (a) {};
\node [setA,below = of a, label  = left:$Beltrano$]  (b) {};
\node [setA,below = of b, label  = left:$Ciclano$] (c) {};
\node [above      = of a, anchor = south] {$Funcionarios$};

% Conjunto Veiculos
\node[setB,inner sep=3pt,right  = 4 cm of a, label=right:$\text{RH}$]        (x) {};
\node[setB,inner sep=3pt,below  =    of x,   label=right:$\text{FINANÃ‡AS}$]  (y) {};
\node[setB,inner sep=3pt,below  =    of y,   label=right:$\text{DIRETORIA}$] (z) {};
\node[above      = of x, anchor = south] {$Departamentos$};



% the arrows
%\draw[->,shorten >= 3pt] (a) -- node[label=above:$f(Corsa)$]  {} (x);
%\draw[->,shorten >= 3pt] (b) -- node[label=above:$g(Fiesta)$] {} (y);
%\draw[->,shorten >= 3pt] (c) -- node[label=above:$h(Gol)$]    {} (z);
%\draw[->,shorten <= 3pt] (x) -- node[label=above:$i(Fulano)$] {} (m);
%\draw[->,shorten <= 3pt] (y) -- node[label=above:$j(Beltrano)$] {} (n);
%\draw[->,shorten <= 3pt] (z) -- node[label=above:$k(Ciclano)$] {} (p);

%\draw[->] (n) -- node[label=above:$j(j(Beltrano))$] {} (y);

% the boxes around the sets
\begin{pgfonlayer}{background}
\node[fit= (a)  (c) ] {};
\node[fit= (x) (z)  ] {};
%\node[fit= (m) (p)  ] {};
\end{pgfonlayer}
\end{tikzpicture}

```

#### Edgard F Cood explica em sua obra "A Relational Model of Data for Large Shared Data Banks" como definir uma Banco de Dados compartilhado *matemÃ¡ticamente*

> Um **banco de dados relacional** Ã© um banco de dados no qual todos os dados sÃ£o representados por meio de **relaÃ§Ãµes (matematicamente, conjuntos de tuplas)**, e todas as operaÃ§Ãµes sobre os dados sÃ£o baseadas em operadores formais do cÃ¡lculo relacional e da Ã¡lgebra relacional. - *A Relational Model of Data for Large Shared Data Banksâ€ (Communications of the ACM, vol. 13, n. 6, pp. 377â€“387, 1970).*

[![Professor Edgar Frank Codd - Universidade do Tenessi](media/01-codd.jpg){width="352"}](https://buttondown.com/jaffray/archive/in-codd-we-trust-or-not/)

### EntÃ£o para podemos relacionar estes dois conjuntos (FuncionÃ¡rios e Departamentos) utilizando a Teoria das FunÃ§Ãµes

$$
\text{Edgard Frank Codd era um matemÃ¡tico tradicional} \\
\text{Considere o conseito de funÃ§Ã£o: } \\
f(x) = Y \\
\text{era dessa forma que ele imaginava relacionamento e } \\
\text{ garantia matemÃ¡tica de CONSISTÃŠNCIA entre } \\
\text{ elementos de 2 conjuntos de dados diferentes }
$$

```{r tikz-diagrama10, engine='tikz', echo=FALSE, fig.cap="Diagrama de Montadoras, VeÃ­culos e ProprietÃ¡rios"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}[
  every node/.style={on grid},
  setA/.style={fill=blue!50,circle,inner sep=3pt},
  setB/.style={fill=green!50,circle,inner sep=3pt},
  >=latex
]

% Conjunto FuncionÃ¡rios
\node [setA,              label=left:$Fulano$]   (a) {};
\node [setA,below=of a,   label=left:$Beltrano$] (b) {};
\node [setA,below=of b,   label=left:$Ciclano$]  (c) {};

% Conjunto Departamentos
\node [setB,right=4cm of a, label=right:$\text{RH}$        ] (x) {};
\node [setB,below=of     x, label=right:$\text{FinanÃ§as}$  ] (y) {};
\node [setB,below=of     y, label=right:$\text{Diretoria}$ ] (z) {};

% As setas (funÃ§Ãµes)
\draw[->,shorten >=3pt] (a) -- node[above] {$trabalha(\text{RH})$}        (x);
\draw[->,shorten >=3pt] (b) -- node[above] {$trabalha(\text{FinanÃ§as})$}  (y);
\draw[->,shorten >=3pt] (c) -- node[above] {$trabalha(\text{Diretoria})$} (z);

% Os conjuntos
\begin{pgfonlayer}{background}
  \node[fit=(a) (c), ellipse, draw, fill=blue!10,  label=above:{FuncionÃ¡rios}] {};
  \node[fit=(x) (z), ellipse, draw, fill=green!10, label=above:{Departamentos}] {};
\end{pgfonlayer}

\end{tikzpicture}


```

Mas vai ficar faltando como representar os atributos nesse modelo (colunas das tabelas):

$$
\begin{array}{c| c | c}
\textbf{ Conjunto FuncionÃ¡rios}    & \textbf{ Relacionamento Trabalha} & \textbf{Conjunto Departamentos)} \\ 
\hline 
FULANO                             &  \quad TRABALHA                   & \quad RH \\
BELTRANO                           &  \quad TRABALHA                   & \quad FINANCEIRO \\
CICLANO                            &  \quad TRABALHA                   & \quad DEIRETORIA \\
\hline
\textbf{Total: 3 ELEMENTOS }       & \textbf{ CONECTADOS }             & \textbf{Total: 3 ELEMENTOS }
\end{array}
$$

Ainda, Ã© necessÃ¡rio acrescentar algumas regras de integridade a representaÃ§Ã£o;

## Modelo LÃ³gico de Banco de Dados

### Modelo Conceitual "Entidade Relacionamento" de Banco de Dados

O Modelo Entidade-Relacionamento (MER), proposto por Peter Chen em 1976, Ã© uma ferramenta fundamental na modelagem de dados. Ã‰ um modelo de dados de alto nÃ­vel que descreve a estrutura conceitual de um banco de dados. O Modelo Entidade-Relacionamento (MER) Ã© representado graficamente atravÃ©s de um DER (Diagrama Entidade-Relacionamento).

[![Professor Peter Chen - universidade norte-americana de Luisiania](media/03-Peter_Chen.jpg)](https://personalidades-tecnologia.blogspot.com/2011/06/peter-pin-shan-chen-peter-pin-shan-chen.html)

Ã‰ utilizado para projetar Bancos de Dados Relacionais a partir de entrevistas onde se descreve as informaÃ§Ãµes que se deseja armazenar de forma consistente. Exemplo:

"*Desenhe um diagrama entidade-relacionamento DER contendo as entidades funcionarios e departamentos. A entidade "funcionÃ¡rios" possui os atributos "nome" e "CPF". A entidade "Departamentos" possui os atributos "Nome" e "sigla". O atributo "CPF" Ã© chave primÃ¡ria da entidade "FuncionÃ¡rios". O atributo "sigla" Ã© chave primÃ¡ria da entidade "Departamentos". As entidades "FuncionÃ¡rios" e "Departamentos" se relacionam atravÃ©s de um relacionamento chamado "Pertence"*."

```{plantuml Exemplo-01, plantuml.path="images"}
@startchen

left to right direction

entity FUNCIONARIOS {
  nome 
  cpf <<key>> 
}

entity DEPARTAMENTOS {
  nome 
  sigla <<key>> 
}

relationship PERTENCE {

}


FUNCIONARIOS  -1- PERTENCE
PERTENCE      -N- DEPARTAMENTOS

@endchen
```

Segundo Laudon

> **Diagrama Entidade/Relacionamento (DER)** Ã© uma representaÃ§Ã£o esquemÃ¡tica utilizada para entender as relaÃ§Ãµes entre as tabelas de um banco de dados relacional. [[1] - LAUDON, Kenneth C.; LAUDON, Jane P. \*Sistemas de informaÃ§Ã£o gerenciais\*. 11. ed. SÃ£o Paulo: Pearson Education do Brasil, 2010. p. 180.]

### ComposiÃ§Ã£o e Significado do Diagrama Entidade Relacionamento (DER)

$$
\begin{array}{c| c | c}
\textbf{ NOME DO COMPONENTE}    & \textbf{RepresentaÃ§Ã£o GrÃ¡fica}   & \textbf{ Liguagem Natural (texto)} \\ 
\hline 
ENTIDADE                        &  \quad RETÃ‚NGULO                 & \quad SUBSTÃƒNTIVO \\
ATRIBUTO                        &  \quad ELÃPSE                    & \quad ADJETIVO \\
RELACIONAMENTO                  &  \quad LOSÃ‚NGULO                 & \quad VERBO \\
\hline
\textbf{Total: 3 ELEMENTOS }    & \textbf{ FORMA GRÃFICA }         & \textbf{ FORMA MOFOLÃ“GICA GRAMATICAL }
\end{array}
$$

```{r tikz-diagrama-DER-00, engine='tikz', echo=FALSE, fig.cap="Diagrama de Montadoras, VeÃ­culos e ProprietÃ¡rios"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}

  %--- RetÃ¢ngulo Ã  esquerda ---
  \begin{scope}[shift={(0,0)}]
    \draw[thick] (0,0) rectangle (3,2);
    \node at (1.5,1) {RetÃ¢ngulo};
  \end{scope}

  %--- Elipse ao centro (deslocada 5 cm Ã  direita) ---
  \begin{scope}[shift={(5,0)}]
    \draw[thick] (0,1) ellipse (1.5cm and 1cm);
    \node at (0,1) {Elipse};
  \end{scope}

  %--- Losango Ã  direita (deslocado 10 cm Ã  direita) ---
  \begin{scope}[shift={(9,0.9)}]
    \draw[thick] (0,1.5) -- (1.5,0) -- (0,-1.5) -- (-1.5,0) -- cycle;
    \node at (0,0) {Losango};
  \end{scope}


\end{tikzpicture}


```

## Modelo FÃ­sico de Banco de Dados

### GeraÃ§Ã£o do modelo FÃ­sico para aplica-lo ao SGBD (Sistema de Gerenciamento de Banco de Dados):

Uma vez que o modelo conceitual seja gerado, o analista pode mapea-lo para um "modelo fÃ­sico". Aqui, cada entidade irÃ¡ gerar uma tebela, cada atributo irÃ¡ originar uma coluna pertinente da tabela em questÃ£o e cada relacionamento irÃ¡ mapear **chaves primÃ¡rias** e **chaves forasteiras** nas tabelas interrelacionadas.

$$
\begin{array}{c| c | c}
\textbf{Componente LÃ³gico}    & \textbf{ Componente FÃ­sico}   & \textbf{Liguagem Natural (texto)} \\ 
\hline 
ENTIDADE                        &  \quad TABELA               & \quad SUBSTÃƒNTIVO \\
ATRIBUTO                        &  \quad COLUNA               & \quad ADJETIVO \\
RELACIONAMENTO                  &  \quad CHAVE-ESTRANGEIRA    & \quad VERBO \\
\hline
\textbf{Diagrama LÃ³gico DER }    & \textbf{ FORMA FÃSICA - SGBD }    & \textbf{ FORMA MOFOLÃ“GICA GRAMATICAL ORIGINAL }
\end{array}
$$

A ferramenta que irÃ¡ criar as estruturas FÃ­sicas (tabelas, colunas, chaves) dentro do Banco de Dados Ã© o Sistema de Gerenciamento de Banco de Dados atravÃ©s da linguagem **SQL**.

![](media/06-modelo_fisico.jpg)

### Interagindo com o Modelo FÃ­sico - A linguagem SQL (Structured Query Language)

A linguagem SQL foi criada nos laboratÃ³rios da IBM em 1974, como interface de manipulaÃ§Ã£o ao Bando de Dados Relacional System-R , atualmente denominado IBM DB2. Os criadores foram engenheiros de sistemas que sucederam o professor Edgard Frank Codd no projeto de Banco de Dados Relacional: **Donald Chamberlain** e **Raymond Boyce**.

|  |  |
|----|----|
| ![Donald Chamberlain - Criador da linguagem SQL nos laboratÃ³rios da IBM](media/04-Donald_Chamberlain.jpg) | ![Raymond Boyce - Criador da linguagem SQL nos laboratÃ³rios da IBM](media/04-Raymond_Boyce.jpg){width="239"} |

A lingauem SQL Ã© a ponte com o mundo exterior para um Sistema de Gerenciamento de Banco de Dados (SGBD). Os conjunto de comandos da linguagem SQL sÃ£o divididos em 3 grandes grupos:

$$
\begin{array}{c| c | c}
\textbf{GRUPO}    & \textbf{ Comandos}   & \textbf{Finalidade} \\ 
\hline 
Grupo \ DDL         &  \quad \ Data \ Definion \ Language        & \quad Criar \ estruturas \ de \ dados \\
Grupo \ DML         &  \quad \ Data \ Manipulation \ Language    & \quad Manipular \ dados \ armazenados \\
Grupo \ DCL         &  \quad \ Data \ Control \ Language         & \quad Criar \ Regras \ para \ os \ dados \\
Grupo \ TCL         &  \quad \ Transaction \ Control \ Language  & \quad Criar \ TransaÃ§Ãµes \ para \ os \ dados \\
\hline
\textbf{Subconjunto SQL }    & \textbf{ Significado }    & \textbf{ Conjunto Completo }
\end{array}
$$

Comandos exemplo:

$$
\begin{array}{c| c }
\textbf{GRUPO}    & \textbf{ Comandos}    \\ 
\hline 
Grupo \ DDL         &  \quad  CREATE, \quad ALTER,\quad DROP \ \        \\
Grupo \ DML         &  \quad SELECT, \quad INSERT, \quad UPDATE, \quad DELETE, \quad JOIN    \\
Grupo \ DCL         &  \quad GRANT, \quad REVOKE  \\
Grupo \ TCL         &  \quad COMMIT, \quad ROLLBACK, \quad SAVEPOINT   \\
\hline
\textbf{Subconjunto SQL }    & \textbf{ Significado }     
\end{array}
$$

O cÃ³digo abaixo escrito em Lingauem SQL padrÃ£o transfere para o modelo fÃ­sico o modelo lÃ³gico anterior:

```{plantuml Exemplo-01-continuaÃ§Ã£o, plantuml.path="images"}
@startchen

left to right direction

entity FUNCIONARIOS {
  nome 
  cpf <<key>> 
}

entity DEPARTAMENTOS {
  nome 
  sigla <<key>> 
}

relationship PERTENCE {

}


FUNCIONARIOS  -1- PERTENCE
PERTENCE      -N- DEPARTAMENTOS

@endchen
```

Transformando em SQL - EQUIVALENTE:

``` sql
-- Exemplo testado e gerado no SGBD Postgres versÃ£o 15

-- Tabela FuncionÃ¡rios
CREATE TABLE IF NOT EXISTS "public".funcionarios
(
    cpf bigint NOT NULL,
    nome varchar(200)
);

-- Tabela Departamentos

CREATE TABLE IF NOT EXISTS "public".departamentos
(
    sigla integer NOT NULL,
    nome varchar(200)
);

-- Definindo a coluna "cpf" da tabela "funcionÃ¡rios" como chave primÃ¡ria
alter table "public".funcionarios add constraint "chave_primaria_funcionarios" primary key (cpf);

-- Definindo a coluna "sigla"" da tabela "departamentos" como chave primÃ¡ria
alter table "public".departamentos add constraint "chave_primaria_departamentos" primary key (sigla);

-- Gerando a integridade referÃªncial 
-- Importando a chave primÃ¡ria da tabela "departamentos" como "chave estrangeira"
-- na tabela "funcionÃ¡rios"

-- primeiro adiciona-se a coluna estrageira "sigla" que Ã© coluna originalmente 
-- pertencente a tabela departamentos
alter table "public".funcionarios add column sigla integer;

-- finalmente conecte a coluna sigla a chave primÃ¡ria da tabela "departamento"
-- criando entÃ£o uma chave estrageira na tabela "funcionÃ¡rios".
alter table "public".funcionarios add constraint "Chave_estrangeira_Departamento_funcionarios" foreign key (sigla) references "public".departamentos(sigla);
```

## EXEMPLO: REVENDA DE VEÃCULOS MULTI-MARCAS

Uma revenda de veÃ­culos multimarcas deseja informatizar seu negÃ³cio e precisa de um banco de dados que registre informaÃ§Ãµes sobre veÃ­culos, fabricantes e clientes. Cada veÃ­culo deve ter cÃ³digo de identificaÃ§Ã£o, modelo, ano de fabricaÃ§Ã£o, cor, preÃ§o e chassi. Todo veÃ­culo pertence a um fabricante. O fabricante Ã© identificado por um cÃ³digo e deve ter armazenados seu nome e paÃ­s de origem. A revenda vende veÃ­culos para clientes, e cada venda deve registrar a data, o valor da negociaÃ§Ã£o e a forma de pagamento. Um cliente pode comprar mais de um veÃ­culo, mas cada veÃ­culo sÃ³ pode ser vendido uma vez. Cada cliente Ã© identificado por um cÃ³digo e deve ter armazenados seu nome, CPF/CNPJ, telefone e endereÃ§o.

### Passo 1 - Visualizando matemÃ¡ticamente os dados:

Vejamos como ficaria representar matemÃ¡ticamente o enunciado acima:

-   Teoria dos Conjuntos - Ajudaria a organizar e agrupar os dados em conjuntos;

-   Teoria das FunÃ§Ãµes - A idÃ©ia era fornecer um mecanismo de consistÃªncia aos dados de conjuntos diferentes relacionados. Por exemplo, haveria uma funÃ§Ã£o que mapeasse um um elemento do conjunto `veÃ­culo` a outro elemento do conjunto `montadora`.

#### RepresentaÃ§Ã£o MatemÃ¡tica em Conjuntos e seus Elementos :

Vamos visualizar grÃ¡ficamente os conjuntos de `Marcas`, `modelos` e `proprietÃ¡rios` :

```{r tikz-diagrama1, engine='tikz', echo=FALSE, fig.cap="Diagrama de Montadoras, VeÃ­culos e ProprietÃ¡rios"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}
[
  every node/.style={on grid},
  setA/.style={fill=blue ,circle,inner  sep=3pt},
  setB/.style={fill=green,circle,inner  sep=3pt},
  setC/.style={fill=red,rectangle,inner sep=3pt},
  every fit/.style={draw,fill=blue!25,ellipse,text width=25pt},
  >=latex
]

% Conjunto Montadoras
\node [setA,              label  = left:$Chevrolet$]  (a) {};
\node [setA,below = of a, label  = left:$Ford$]       (b) {};
\node [setA,below = of b, label  = left:$VolksWagen$] (c) {};
\node [above      = of a, anchor = south] {$Montadoras$};

% Conjunto Veiculos
\node[setB,inner sep=3pt,right  = 4 cm of a, label  = right:$Corsa$]  (x) {};
\node[setB,inner sep=3pt,below  =      of x, label  = right:$Fiesta$] (y) {};
\node[setB,inner sep=3pt,below  =      of y, label  = right:$Gol$]    (z) {};
\node[above      = of x, anchor =     south] {$Veiculos$};

% Conjunto Proprietarios
\node[setC,label=right:$Fulano$,right   = 4 cm of x] (m) {};
\node[setC,label=right:$Beltrano$,below =     of m] (n) {};
\node[setC,label=right:$Ciclano$,below  =     of n] (p) {};
\node[above=of m,anchor=south] {$Proprietarios$};



% the boxes around the sets
\begin{pgfonlayer}{background}
\node[fit= (a)  (c) ] {};
\node[fit= (x) (z)  ] {};
\node[fit= (m) (p)  ] {};
\end{pgfonlayer}
\end{tikzpicture}

```

#### Gerando os Relacionamentos "MatemÃ¡ticamente" - (Teoria das FunÃ§Ãµes, DomÃ­nios e Imagens):

Vamos visualizar grÃ¡ficamente os relacionamentos entre os lementos dos conjuntos `Marcas`, `modelos` e `proprietÃ¡rios` :

```{r tikz-diagrama2, engine='tikz', echo=FALSE, fig.cap="Diagrama de Montadoras, VeÃ­culos e ProprietÃ¡rios"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}
\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}[
  every node/.style={on grid},
  setA/.style={fill=blue ,circle,inner sep=3pt},
  setB/.style={fill=green,circle,inner sep=3pt},
  setC/.style={fill=red,rectangle,inner sep=3pt},
  every fit/.style={draw,fill=blue!25,ellipse,text width=25pt},
  >=latex
]

\node [setA,              label=left:$Chevrolet$]  (a) {};
\node [setA,below = of a, label=left:$Ford$]       (b) {};
\node [setA,below = of b, label=left:$VolksWagen$] (c) {};
\node [above=of a,anchor=south] {$Montadoras$};

\node[setB,inner sep=3pt,right=4cm of a, label  = above:$Corsa$]  (x) {};
\node[setB,inner sep=3pt,below=of x    , label  = above:$Fiesta$] (y) {};
\node[setB,inner sep=3pt,below=of y    , label  = above:$Gol$]    (z) {};
\node[above=of x,anchor=south] {$Veiculos$};

\node[setC,label=right:$Fulano$,right=4cm of x] (m) {};
\node[setC,label=right:$Beltrano$,below=of m] (n) {};
\node[setC,label=right:$Ciclano$,below=of n] (p) {};
\node[above=of m,anchor=south] {$Proprietarios$};

\draw[->,shorten >= 3pt] (a) -- node[label=above:$f(Corsa)$] {} (x);
\draw[->,shorten >= 3pt] (b) -- node[label=above:$g(Fiesta)$] {} (y);
\draw[->,shorten >= 3pt] (c) -- node[label=above:$h(Gol)$]    {} (z);
\draw[->,shorten <= 3pt] (x) -- node[label=above:$i(Fulano)$] {} (m);
\draw[->,shorten <= 3pt] (y) -- node[label=above:$j(Beltrano)$] {} (n);
\draw[->,shorten <= 3pt] (z) -- node[label=above:$k(Ciclano)$] {} (p);

\begin{pgfonlayer}{background}
\node[fit=(a)(c)] {};
\node[fit=(x)(z)] {};
\node[fit=(m)(p)] {};
\end{pgfonlayer}
\end{tikzpicture}
```

A limitaÃ§Ã£o desta representaÃ§Ã£o grÃ¡fica logo fica evidente: por mais que na forma matemÃ¡tica se consiga representar os elementos dos conjuntos e o relacionamento entre eles, a representaÃ§Ã£o nÃ£o consegue representar os diferentes atributos (caracterÃ­sticas) que os elementos dos conjuntos compartilham.

### Modelo LÃ³gico: Modelo Entidade Relacionamento

Vamos agora converter a representaÃ§Ã£o matemÃ¡tica para uma representaÃ§Ã£o lÃ³gica utilizando o modelo M.E.R. (modelo entidade-relacionamento ) proposto pelo professor Peter Chen

#### Modelo Entidade Relacionamento

O modelo Entidade Relacionamento consistem em traduzir elementos morfolÃ³gicos da gramÃ¡tica da lÃ­ngua portuguesa em um texto para um modelo de Banco de dados utilizando a com a seguinte regra de montagem:

|  |  |  |  |
|----|----|----|----|
| Classe morfolÃ³gica da palavra | CORRESPONDÃŠNCIA NO MODELO MATEMÃTICO | CORRESPONDÃŠNCIA NO MODELO LÃ“GICO | CORRESPONDÃŠNCIA NO MODELO FÃSICO-RELACIONAL |
| `Substantivos` | `CONJUNTOS` | `ENTIDADES` | `TABELAS` |
| **`Adjetivos`** | N/A | **`ATRIBUTO`** | **`COLUNAS`** |
| **`Verbos`** | IdÃ©ia de "funÃ§Ãµes y=f(x) " | **`RELACIONAMENTOS`** | **`CHAVE ESTRANGEIRA`** |

Tomando como exemplo a revenda de carros:

+-------------------------------+-----------------------------------------------------------------------------+
| Classe morfolÃ³gica da palavra |                                                                             |
+-------------------------------+-----------------------------------------------------------------------------+
| `Substantivos`                | VEÃCULOS, FABRICANTES, CLIENTES                                             |
+-------------------------------+-----------------------------------------------------------------------------+
| **`Adjetivos`**               | Referentes a veÃ­culos: `Modelo`, `Ano_Fabricacao`, `Cor`, `Preco`, `Chassi` |
|                               |                                                                             |
|                               | Referentes a fabricante: `Nome`, `Pais_Origem`                              |
|                               |                                                                             |
|                               | Referentes a cliente: `Nome`, `CPF_CNPJ`, `Telefone`, `Endereco`            |
+-------------------------------+-----------------------------------------------------------------------------+
| **`Verbos`**                  | Fabricante - `PRODUZ`- VeÃ­culo                                              |
|                               |                                                                             |
|                               | clinte - `COMPRA/VENDE` - VeÃ­culo                                           |
+-------------------------------+-----------------------------------------------------------------------------+

#### Modelo Entidade Relacionamento - representaÃ§Ã£o grÃ¡fica

|                               |                       |
|-------------------------------|-----------------------|
| Classe morfolÃ³gica da palavra | REPRESENTAÃ‡ÃƒO GRÃFICA |
| `Substantivos`                | RETÃ‚NGULOS            |
| **`Adjetivos`**               | **ELIPSES**           |
| **`Verbos`**                  | **LOSÃ‚NGULOS**        |

```{plantuml modelo01, plantuml.path="images"}
@startchen


entity VEICULOS {
  Modelo
  Ano_Fabricacao
  Cor
  Preco
  Chassi <<key>>
}

entity FABRICANTES {
  CNPJ <<key>>
  Nome
  Pais_Origem
}


entity CLIENTES {
  Nome
  CPF_CNPJ <<key>>
  Telefone
  Endereco
}

relationship PRODUZEM {
  
}

relationship COMPRA_VENDE {

}


FABRICANTES -1- PRODUZEM
PRODUZEM    -N- VEICULOS

CLIENTES     -N- COMPRA_VENDE
COMPRA_VENDE -1- VEICULOS

@endchen
```

``` sql


-- ================================================
-- 1) TRANSFORME AS ENTIDADES E ATRIBUTOS EM 
--    TABELAS E COLUNAS
-- ================================================
CREATE TABLE fabricantes
(
    codigo_fabricante  INTEGER      NOT NULL,
    nome               VARCHAR(100) NOT NULL,
    pais_origem        VARCHAR(60)  NOT NULL
);

CREATE TABLE clientes
(
    codigo_cliente   INTEGER      NOT NULL,
    nome             VARCHAR(120) NOT NULL,
    cpf_cnpj         VARCHAR(20)  NOT NULL UNIQUE,
    telefone         VARCHAR(30),
    endereco         TEXT
);

CREATE TABLE veiculos 
(
    codigo_veiculo      INTEGER       NOT NULL,
    modelo              VARCHAR(100)  NOT NULL,
    ano_fabricacao      INTEGER       NOT NULL,
    cor                 VARCHAR(40),
    preco               NUMERIC(12,2) NOT NULL,
    chassi              VARCHAR(30)   UNIQUE NOT NULL
);

CREATE TABLE vendas
(
    codigo_venda     INTEGER          NOT NULL,
    data_venda       DATE             NOT NULL,
    valor_negociado  NUMERIC(12,2)    NOT NULL,
    forma_pagamento  VARCHAR(50)      NOT NULL
);

-- ================================================
-- 2) TRANSFORME OS ATRIBUTOS CHAVE PRIMÃRIA
-- EM CHAVES-PRIMÃRIAS DAS TABELAS
-- ================================================
ALTER TABLE fabricantes ADD CONSTRAINT chave-primaria_fabricante PRIMARY KEY (codigo_fabricante);

ALTER TABLE clientes    ADD CONSTRAINT chave-primaria_cliente PRIMARY KEY (codigo_cliente);

ALTER TABLE veiculos    ADD CONSTRAINT chave-primaria_veiculo PRIMARY KEY (codigo_veiculo);

ALTER TABLE vendas      ADD CONSTRAINT chave-primaria_venda PRIMARY KEY (codigo_venda);

-- ================================================
-- 3) ADICIONAR NAS TABELAS AS COLUNAS EXTRAS
--    QUE VÃƒO RECEBER AS CHAVES ESTRANGEIRAS
-- ================================================

-- adicione uma coluna que irÃ¡ acomodar a chave primÃ¡ria da tabela fabricantes como chave estrangeira
ALTER TABLE veiculos add cloumn  codigo_fabricante   INTEGER NOT NULL;

-- adicione uma coluna que irÃ¡ acomodar a chave primÃ¡ria da tabela clientes como chave estrangeira
ALTER TABLE vendas   add cloumn  codigo_cliente      INTEGER NOT NULL;

-- adicione uma coluna que irÃ¡ acomodar a chave primÃ¡ria da tabela veÃ­culos como chave estrangeira
ALTER TABLE vendas   add cloumn  codigo_veiculo      INTEGER NOT NULL UNIQUE;

-- ================================================
-- 3) CRIE AS CHAVES ESTRANGEIRAS QUE FAZEM A LIGAÃ‡ÃƒO
-- DAS TABELAS "LADO N" DO RELACIONAMENTO NO 
-- DIAGRAMA ENTIDADE-RELACIONAMENTO COM AS
-- COLUNAS DO LADO 1
-- ================================================

-- utilizando chave estrangeira, faÃ§a esta tabela veÃ­culos referenciar a tabela fabricantes
ALTER TABLE veiculos
    ADD CONSTRAINT chave-estrageira_veiculo_fabricante
    FOREIGN KEY (codigo_fabricante)
    REFERENCES fabricantes (codigo_fabricante)
    ON UPDATE CASCADE
    ON DELETE RESTRICT;

-- utilizando chave estrangeira, faÃ§a esta tabela vendas referenciar a tabela clientes
ALTER TABLE vendas
    ADD CONSTRAINT chave-estrageira_venda_cliente
    FOREIGN KEY (codigo_cliente)
    REFERENCES clientes (codigo_cliente)
    ON UPDATE CASCADE
    ON DELETE RESTRICT;

-- utilizando chave estrangeira, faÃ§a esta tabela vendas referenciar a tabela veÃ­culos 
ALTER TABLE vendas
    ADD CONSTRAINT chave-estrageira_venda_veiculo
    FOREIGN KEY (codigo_veiculo)
    REFERENCES veiculos (codigo_veiculo)
    ON UPDATE CASCADE
    ON DELETE RESTRICT;
```

## VERBOS: Relacionamentos e Cardinalidade

A **cardinalidade** define **quantas ocorrÃªncias de uma entidade podem estar associadas** a ocorrÃªncias de outra entidade em um relacionamento.

Ela Ã© fundamental para entender as regras de negÃ³cio do banco de dados e deve estar sempre representada no **Diagrama Entidade-Relacionamento (DER)**.

------------------------------------------------------------------------

### ğŸ”¹ Tipos principais de cardinalidade

1.  **Um para Um (1:1)**\
2.  **Um para Muitos (1:N)**\
3.  **Muitos para Muitos (N:N)**

A seguir, vamos detalhar cada caso.

------------------------------------------------------------------------

### 1. Relacionamento **1:1 (Um para Um)**

Um exemplo clÃ¡ssico:\
- Cada MARIDO possui **uma Ãºnica ESPOSA**.\
- Cada ESPOSA pertence a **um Ãºnico MARIDO**.

#### RepresentaÃ§Ã£o no DER:

```{plantuml cardinalidade01, plantuml.path="images"}
@startchen
left to right direction

entity MARIDOS {
  nome 
  cpf <<key>> 
}

entity ESPOSAS {
  nome
  cpf <<key>> 
}

relationship POSSUI {

}

MARIDOS -1- POSSUI 
POSSUI  -1- ESPOSAS

@endchen
```

### Relacionamento **1:N (Um para Muitos)**

Exemplo:

Um **Cliente** pode fazer **muitos Pedidos**.

Mas cada **Pedido** sÃ³ pode pertencer a **um Cliente**.

#### RepresentaÃ§Ã£o no DER:

```{plantuml cardinalidade02, plantuml.path="images"}
@startchen
left to right direction

entity CLIENTES {
  nome 
  cpf <<key>> 
}

entity PASSAGENS {
  DATA
  HORA
  PARTIDA
  DESTINO
  NUMERO <<key>> 
}

relationship COMPRA {

}

CLIENTES -1- COMPRA 
COMPRA   -N- PASSAGENS

@endchen
```

### Relacionamento N:N (Muitos para Muitos)

Exemplo:

Um **Aluno** pode se matricular **em muitas Disciplinas**.

Cada **Disciplina** pode ter **muitos Alunos**.

( Esse tipo de relacionamento precisa de uma entidade associativa para ser implementado no banco (ex.: Matricula) )

#### RepresentaÃ§Ã£o no DER:

```{plantuml cardinalidade03, plantuml.path="images"}
@startchen
left to right direction

entity ALUNOS {
  nome 
  RA <<key>> 
}

entity DISCIPLINAS {
  cOD_DISCIPLINA <<KEY>>
  NOME
  CONTEUDO
  DURACAO
}

relationship CURSAM {

}

ALUNOS   -N- CURSAM
CURSAM   -N- DISCIPLINAS

@endchen
```

## Entidade Dominante e Entidade Subordinada

No **Modelo Entidade-Relacionamento (MER)**, algumas entidades sÃ³ existem **dependendo da existÃªncia de outra**.\
Nesses casos, usamos os conceitos de **Entidade Dominante** e **Entidade Subordinada**.

------------------------------------------------------------------------

### DefiniÃ§Ãµes:

-   **Entidade Dominante (ou Forte):**\
    Ã‰ uma entidade que **existe por si sÃ³**, sem depender de nenhuma outra.\
    Ex.: Cliente, Produto, FuncionÃ¡rio.

-   **Entidade Subordinada (ou Fraca):**\
    Ã‰ uma entidade que **depende de outra** para existir.\
    Ela **nÃ£o possui chave primÃ¡ria prÃ³pria** completa e precisa da chave da entidade dominante.\
    Ex.: ItemPedido, Dependente, Parcela.

A entidade subordinada Ã© representada por um **losango duplo** (relacionamento identificador) em algumas notaÃ§Ãµes, ou simplesmente destacada como **entidade fraca**.

```{plantuml EntidadeDominante01, plantuml.path="images"}
@startchen
left to right direction

entity PAIS {
  nome 
  RA <<key>> 
}

entity FILHOS <<weak>> {
  Nome nome
}

relationship POSSUEM {

}

PAIS      -1- POSSUEM
POSSUEM   -N- FILHOS

@endchen
```

Outro Exemplo:

```{plantuml EntidadeDominante02, plantuml.path="images"}
@startchen
left to right direction

entity PEDIDOS_VENDAS {
  CODIGO_PEDIDO <<KEY>>
  DATA
  VALOR_TOTAL
}

entity ITEMS_PEDIDO <<weak>> {
  ID_ITEM
  DESCRICAO
  QUANTIDADE
  PERCO_UNITARIO
}

relationship POSSUEM {

}

PEDIDOS_VENDAS  -1- POSSUEM
POSSUEM         -N- ITEMS_PEDIDO

@endchen
```

------------------------------------------------------------------------

## CARDINALIDADE DO MODELO LÃ“GICO E A CRIAÃ‡ÃƒO DE CHAVES ESTRANGEIRAS NO MODELO FÃSICO-RELACIONAL

Vai ser a cardinalidade que irÃ¡ ditar em quais tabelas criaremos chaves estrangeiras.

## NormalizaÃ§Ã£o em Bancos de Dados Relaionais

### Tabela Desnormalizada

![](images/5-bi/01-montadora.jpg){width="343"}

Considere a tabela VeÃ­culos abaixo:

|  Modelo   | Montadora  |
|:---------:|:----------:|
|  Strada   |    Fiat    |
|   Mobi    |    Fiat    |
|   Pulse   |    Fiat    |
|   Onix    | Chevrolet  |
|  Tracker  | Chevrolet  |
| Onix Plus | Chevrolet  |
|   Polo    | Volkswagen |
|   Nivus   | Volkswagen |
|  T-Cross  | Volkswagen |
|   HB20    |  Hyundai   |
|   Creta   |  Hyundai   |

Separamos o conjunto de elemntos *Montadoras* e *Modelos*.

| MontadoraID | Montadora  |
|:-----------:|:----------:|
|      1      |    Fiat    |
|      2      | Chevrolet  |
|      3      | Volkswagen |
|      4      |  Hyundai   |

| ModeloID |  Modelo   |
|:--------:|:---------:|
|   101    |  Strada   |
|   102    |   Mobi    |
|   103    |   Pulse   |
|   201    |   Onix    |
|   202    |  Tracker  |
|   203    | Onix Plus |
|   301    |   Polo    |
|   302    |   Nivus   |
|   303    |  T-Cross  |
|   401    |   HB20    |
|   402    |   Creta   |

> O processo de fragmentar agrupamentos complexos de dados e simplifica-los a fim de minimizar redundÃ¢ncias e economizar espaÃ§o no Banco de Dados Relacional Ã© chamado de **NORMALIZAÃ‡ÃƒO.** [[1] - LAUDON, Kenneth C.; LAUDON, Jane P. \*Sistemas de informaÃ§Ã£o gerenciais\*. 11. ed. SÃ£o Paulo: Pearson Education do Brasil, 2010. p. 180.]

Mas Como indicar que cada elemento da tabela "Modelo" estÃ¡ associado a um elemento da tabela "Montadora" ?

### Tabela Normalizada

Considere as tabelas abaixo:

| MontadoraID | Montadora  |
|:-----------:|:----------:|
|      1      |    Fiat    |
|      2      | Chevrolet  |
|      3      | Volkswagen |
|      4      |  Hyundai   |

| ModeloID |  Modelo   | MontadoraID |
|:--------:|:---------:|:-----------:|
|   101    |  Strada   |      1      |
|   102    |   Mobi    |      1      |
|   103    |   Pulse   |      1      |
|   201    |   Onix    |      2      |
|   202    |  Tracker  |      2      |
|   203    | Onix Plus |      2      |
|   301    |   Polo    |      3      |
|   302    |   Nivus   |      3      |
|   303    |  T-Cross  |      3      |
|   401    |   HB20    |      4      |
|   402    |   Creta   |      4      |

Repare que:

-   Ã‰ possÃ­vel identificar que nÃ£o existem montadoras repetidas na tabela "Montadoras";

-   Ã‰ possÃ­vel identificar que nÃ£o existem modelos repetidos na tabela "Montadoras";

A coluna (atributo) **ModeloID** Ã© a **chave primÃ¡ria** da tabela **Modelos.** A coluna (atributo) **MontadoraID** Ã© a **chave primÃ¡ria** da tabela **Montadoras.**

Na tabela **Modelos**, a coluna **MontadoraID**, acrescentada a tabela Modelos representa a ligaÃ§Ã£o de cada elemento da tabela Modelos e Montadoras. Essa coluna "importada" da tabela Montadoras para a tabela Modelos se chama **chave estrangeira**.

## ReferÃªncias

**CHEN**, Peter (1990).Â ***Gerenciando Banco de Dados*****. A Abordagem Entidade-Relacionamento para Projeto LÃ³gico**. SÃ£o Paulo: McGraw-Hill. 80Â pÃ¡ginas.Â [ISBN](https://pt.wikipedia.org/wiki/International_Standard_Book_Number "International Standard Book Number")Â [0-07-460575-5](https://pt.wikipedia.org/wiki/Especial:Fontes_de_livros/0-07-460575-5 "Especial:Fontes de livros/0-07-460575-5")

**DATE**, C. J. **An Introduction to Database Systems.** 8. ed. Boston: Addison-Wesley, 2003.

**SILBERSCHATZ**, Abraham; KORTH, Henry F.; SUDARSHAN, S. **Database System Concepts.** 6. ed. New York: McGraw-Hill, 2010.

**CODD**, E. F. **A Relational Model of Data for Large Shared Data Banks.** Communications of the ACM, New York, v. 13, n. 6, p. 377â€“387, 1970.

```{r aula-03, eval=FALSE, include=FALSE}
rmarkdown::render("03-2026-03-03_Modelagem_SGBD-aula-01.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; utils::browseURL("docs/temporario.html")
```

<!--chapter:end:03-aula03/03-2026-03-03_Modelagem_SGBD-aula-01.Rmd-->

---
output: 
  html_document: 
    highlight: tango
    theme: cerulean
    toc_depth: 4
    number_sections: true
  pdf_document: 
    toc: true
    toc_depth: 4
  word_document: 
    toc: true
    toc_depth: 4
---

## ExercÃ­cios RESOLVIDOS

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ExercÃ­cio 1 â€” Universidade                                                                                                                                                                                                                                                                 |
+============================================================================================================================================================================================================================================================================================+
| Considere uma Universidade que possui vÃ¡rios Cursos. Cada curso tem um nome, uma duraÃ§Ã£o em semestres e um coordenador. A universidade possui Professores, cada um com um nome, tÃ­tulo e CPF. Um professor pode ministrar vÃ¡rias disciplinas, e cada disciplina pertence a um Ãºnico curso. |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a)  Identifique as entidades                                                                                                                                                                                                                                                               |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| b)  Identifique os atributos de cada Entidade                                                                                                                                                                                                                                              |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c)  Identifique os relacionamentos entre as Entidades                                                                                                                                                                                                                                      |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| e)  FaÃ§a o diagrama DEM (Diagrama Entidade Relacionamento) contendo as entidades, atributos e relacionamentos que vocÃª mapeou.                                                                                                                                                             |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#### Passo #1 -

Identificar **SUBSTANTIVOS** no contexto; identificar os **ADJETIVOS** pertinentes a cada SUBSTANTIVO; identificar os **VERBOS** de relaÃ§Ã£o entre os substantivos.

+---------------------------------------------------+----------------------------------------------+----------------------------------------------------+
| `Substantivos` **do contexto**: leve-os ao plural | `Adjetivos`                                  | `Verbos`                                           |
+:==================================================+==============================================+====================================================+
| UNIVERSIDADE -\> **`UNIVERSIDADES`**              | `NOME` (implÃ­cito no enunciado)              | universidade `POSSUI` (vÃ¡rios) cursos              |
|                                                   |                                              |                                                    |
|                                                   | `CNPJ` (implÃ­cito no enunciado)              |                                                    |
+---------------------------------------------------+----------------------------------------------+----------------------------------------------------+
| CURSO -\> **`CURSOS`**                            | `NOME` (explÃ­cito no enunciado)              | cursos sÃ£o `POSSUÃDOS` por (vÃ¡rios) universidades  |
|                                                   |                                              |                                                    |
|                                                   | `DURAÃ‡ÃƒO` (explÃ­cito no enunciado)           |                                                    |
|                                                   |                                              |                                                    |
|                                                   | `COORDENADOR` (explÃ­cito no enunciado)       |                                                    |
|                                                   |                                              |                                                    |
|                                                   | `CODIGO_CURSO` (implÃ­cito no enunciado)      |                                                    |
+---------------------------------------------------+----------------------------------------------+----------------------------------------------------+
| PROFESSOR -\> **`PROFESSORES`**                   | `CPF` (explÃ­cito no enunciado)               | universidade `POSSUI` (vÃ¡rios) professores         |
|                                                   |                                              |                                                    |
|                                                   | `NOME` (explÃ­cito no enunciado)              | professor `MINISTRA` (vÃ¡rias) disciplinas          |
|                                                   |                                              |                                                    |
|                                                   | `TÃTULO` (explÃ­cito no enunciado)            |                                                    |
+---------------------------------------------------+----------------------------------------------+----------------------------------------------------+
| DISCIPLINA -\> **`DISCIPLINAS`**                  | `NOME` (implÃ­cito no enunciado)              | disciplina `Ã‰ MINISTRADA` por (vÃ¡rios) professores |
|                                                   |                                              |                                                    |
|                                                   | `CODIGO_DISCIPLINA` (implÃ­cito no enunciado) | disciplina `PERTENCE` a (um Ãºnico) curso           |
+---------------------------------------------------+----------------------------------------------+----------------------------------------------------+

: Identificando SUBSTANTIVOS, ADJETIVOS referentes e VERBOS de relaÃ§Ã£o

#### Passo #2

Criar o **`MODELO ENTIDADE RELACIONAMENTO (M.E.R.)`** - Converter SUBSTANTIVO em **`ENTIDADES`**; converter ADJETIVOS em **`ATRIBUTOS`** e converter VERBOS em **`RELACIONAMENTOS`**.

-   ENTIDADES identificadas: **`UNIVERSIDADES`**, **`CURSOS`**, **`PROFESSORES`** e **`DISCIPLINAS`**

-   ATRIBUTOS identificados: UNIVERSIDADES [ nome,cnpj ] ; CURSOS [ nome, duraÃ§Ã£o, coordenador, codigo_curso] ; PROFESSORES [ cpf, nome e tÃ­tulo] ; DISCIPLINAS [nome e codigo_disciplina]

-   RELACIONAMENTOS: [universidade-`POSSUI`-curso] ; [universidade-`POSSUI`-professores]; [professor-`MINISTRA`-disciplina] ; [disciplina-`PERTENCE`-curso]

#### Passo #3

Criar um DIAGRAMA ENTIDADE-RELACIONAMENTO (D.E.R.) com as informaÃ§Ãµes levantadas:

```{plantuml exercicio01-01, plantuml.path="images"}
@startchen

entity UNIVERSIDADES {
  nome
  CNPJ <<KEY>>
}
@endchen
```

```{plantuml exercicio01-02, plantuml.path="images"}
@startchen
entity CURSOS {
  nome
  duracao
  coordenador
  codigo_curso <<KEY>>
}
@endchen
```

```{plantuml exercicio01-03, plantuml.path="images"}
@startchen
entity PROFESSORES {
  cpf <<KEY>>
  nome
  titulo
}
@endchen
```

```{plantuml exercicio01-04, plantuml.path="images"}
@startchen
entity DISCIPLINAS {
  nome
  codigo_disciplina <<KEY>>
}

@endchen
```

#### Passo #4

Identificar os Relacionamentos:

-   [universidade-`POSSUI`-curso] ; [universidade-`POSSUI`-professores]; [professor-`MINISTRA`-disciplina] ; [disciplina-`PERTENCE`-curso]

```{plantuml exercicio01-05, plantuml.path="images"}
@startchen


entity UNIVERSIDADES {
  nome
  CNPJ <<KEY>>
}

entity CURSOS {
  nome
  duracao
  coordenador
  codigo_curso <<KEY>>
}


entity PROFESSORES {
  cpf <<key>>
  nome
  titulo
}

entity DISCIPLINAS {
  nome
  codigo_disciplina <<KEY>>
}

relationship OFERECE {
  
}


relationship POSSUI {
  
}



relationship MINISTRA {
  
}

UNIVERSIDADES -1- OFERECE
OFERECE       -N- CURSOS

UNIVERSIDADES -1- POSSUI
POSSUI        -N- PROFESSORES


PROFESSORES -1- MINISTRA
MINISTRA    -N- DISCIPLINAS



@endchen
```


#### Passo  #5 - Crie o cÃ³digo SQL referente ao diagrama que vocÃª desenhou:

```SQL
/* =========================================================
   Passo 1ï¸- CRIAR TABELAS (somente colunas, sem PK nem FK)
   ========================================================= */
CREATE TABLE UNIVERSIDADES 
(
    nome            VARCHAR(255),
    CNPJ            VARCHAR(14)
);

CREATE TABLE CURSOS 
(
    nome            VARCHAR(255),
    duracao         INT,
    coordenador     VARCHAR(255),
    codigo_curso    INTEGER
);

CREATE TABLE PROFESSORES 
(
    cpf             VARCHAR(11),
    nome            VARCHAR(255),
    titulo          VARCHAR(255)
);

CREATE TABLE DISCIPLINAS 
(
    nome                VARCHAR(255),
    codigo_disciplina   INTEGER
);

/* =========================================================
   Passo 2- ADICIONAR CHAVES PRIMÃRIAS
   ========================================================= */
ALTER TABLE UNIVERSIDADES ADD PRIMARY KEY (CNPJ);

ALTER TABLE CURSOS        ADD PRIMARY KEY (codigo_curso);

ALTER TABLE PROFESSORES   ADD PRIMARY KEY (cpf);

ALTER TABLE DISCIPLINAS   ADD PRIMARY KEY (codigo_disciplina);

/* =========================================================
   Passo 3- CRIAR COLUNAS PARA FUTURAS CHAVES ESTRANGEIRAS
   -- Sempre no lado N de cada relacionamento
   ========================================================= */
-- UNIVERSIDADES (1) â€”â€” (N) CURSOS  â†’ CURSOS precisa de CNPJ
ALTER TABLE CURSOS   ADD COLUMN CNPJ VARCHAR(14);

-- UNIVERSIDADES (1) â€”â€” (N) PROFESSORES â†’ PROFESSORES precisa de CNPJ
ALTER TABLE PROFESSORES  ADD COLUMN CNPJ VARCHAR(14);

-- PROFESSORES (1) â€”â€” (N) DISCIPLINAS â†’ DISCIPLINAS precisa de cpf
ALTER TABLE DISCIPLINAS ADD COLUMN cpf VARCHAR(11);

/* =========================================================
   Passo 4- CRIAR AS CHAVES ESTRANGEIRAS
   ========================================================= */
ALTER TABLE CURSOS      ADD CONSTRAINT fk_cursos_universidade      FOREIGN KEY (CNPJ) REFERENCES UNIVERSIDADES (CNPJ);

ALTER TABLE PROFESSORES ADD CONSTRAINT fk_professores_universidade FOREIGN KEY (CNPJ) REFERENCES UNIVERSIDADES (CNPJ);

ALTER TABLE DISCIPLINAS ADD CONSTRAINT fk_disciplinas_professor    FOREIGN KEY (cpf)  REFERENCES PROFESSORES (cpf);

```

------------------------------------------------------------------------

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ExercÃ­cio 2 â€” Um Projeto de e-commerce                                                                                                                                                                                             |
+====================================================================================================================================================================================================================================+
| Um Cliente faz Pedidos em um sistema de e-commerce. Cada cliente tem um nome, endereÃ§o e telefone. Os pedidos possuem uma data, um valor total e podem conter vÃ¡rios Produtos. Cada produto tem um nome, uma descriÃ§Ã£o e um preÃ§o. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a)  Identifique as **entidades**                                                                                                                                                                                                   |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| b)  Identifique os **atributos** de cada Entidade                                                                                                                                                                                  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c)  Identifique os **relacionamentos** entre as Entidades                                                                                                                                                                          |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| e)  FaÃ§a o **diagrama DEM (Diagrama Entidade Relacionamento)** contendo as entidades, atributos e relacionamentos que vocÃª mapeou.                                                                                                 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#### Passo #1 -

Identificar **SUBSTANTIVOS** no contexto; identificar os **ADJETIVOS** pertinentes a cada SUBSTANTIVO; identificar os **VERBOS** de relaÃ§Ã£o entre os substantivos.

+-------------------------------------------------------------------------+----------------------------------------+-------------------------------------------------------+
| `Substantivos` **do contexto**: leve-os ao plural                       | `Adjetivos`                            | `Verbos`                                              |
+:========================================================================+========================================+=======================================================+
| CLIENTE -\> **`CLIENTES`**                                              | `NOME` (explÃ­cito no enunciado)        | (vÃ¡rios) clientes `PEDEM` (vÃ¡rios) produtos           |
|                                                                         |                                        |                                                       |
|                                                                         | `ENDERECO` (explÃ­cito no enunciado)    |                                                       |
|                                                                         |                                        |                                                       |
|                                                                         | `TELEFONE` (explÃ­cito no enunciado)    |                                                       |
|                                                                         |                                        |                                                       |
|                                                                         | `CPF` (implÃ­cito no enunciado)         |                                                       |
+-------------------------------------------------------------------------+----------------------------------------+-------------------------------------------------------+
| PEDIDO -\> **`PEDIDOS ????`**                                           | `DATA` (explÃ­cito no enunciado)        | (vÃ¡rios) clientes `PEDEM` (vÃ¡rios) produtos           |
|                                                                         |                                        |                                                       |
| PEDIDO NÃƒO Ã‰ SUBSTABNTIVO, MAS SIM O PARTICÃPIO PASSADO DO VERBO PEDIR. | `VALOR_TOTAL` (explÃ­cito no enunciado) |                                                       |
|                                                                         |                                        |                                                       |
| (PEDIR Ã‰ VERBO !!!)                                                     |                                        |                                                       |
+-------------------------------------------------------------------------+----------------------------------------+-------------------------------------------------------+
| PRODUTO -\> **`PRODUTOS`**                                              | `NOME` (implÃ­cito no enunciado)        | (vÃ¡rios) produtos sÃ£o `PEDidos` por (vÃ¡rios) clientes |
|                                                                         |                                        |                                                       |
|                                                                         | `DESCRICAO` (explÃ­cito no enunciado)   |                                                       |
|                                                                         |                                        |                                                       |
|                                                                         | `PRECO` (explÃ­cito no enunciado)       |                                                       |
|                                                                         |                                        |                                                       |
|                                                                         | `COD_PRODUTO` (implÃ­cito no enunciado) |                                                       |
+-------------------------------------------------------------------------+----------------------------------------+-------------------------------------------------------+

: Identificando SUBSTANTIVOS, ADJETIVOS referentes e VERBOS de relaÃ§Ã£o

#### Passo #2

Criar o **`MODELO ENTIDADE RELACIONAMENTO (M.E.R.)`** - Converter SUBSTANTIVO em **`ENTIDADES`**; converter ADJETIVOS em **`ATRIBUTOS`** e converter VERBOS em **`RELACIONAMENTOS`**.

Normalmente apenas as ENTIDADES levam atributos. Quando aparece um relacionamento N-N entre duas entidades, tambÃ©m podem aparecer atributos atrelados aos relacionamentos (como Ã© o caso de PEDIDO aqui).

-   ENTIDADES identificadas: **`CLIENTES`**, **`PRODUTOS`**

-   ATRIBUTOS identificados: CLIENTES [ nome, endereco, telefone, cpf] ; PRODUTOS [ nome, descricao, preco, cod_produto] ; PEDIDO[data, valor_total]

-   RELACIONAMENTOS: [cliente-`PEDE`-produto] ; [produto-`PEDIDO`-cliente];

#### Passo #3

Criar um DIAGRAMA ENTIDADE-RELACIONAMENTO (D.E.R.) com as informaÃ§Ãµes levantadas:

```{plantuml exercicio02-01, plantuml.path="images"}
@startchen


entity CLIENTES {
  nome
  endereco
  telefone
  cpf <<key>>
}



entity PRODUTOS {
  nome
  descricao
  preco
  cod_produto <<key>>
}

relationship PEDIDOS {
  data << key >>
  valor_total
}



PRODUTOS -N- PEDIDOS
PEDIDOS  -N- CLIENTES



@endchen
```

#### Passo  #5 - Crie o cÃ³digo SQL referente ao diagrama que vocÃª desenhou:

```SQL

-- CRIAR AS TABELAS

CREATE TABLE Cliente 
(
    id_cliente INT,
    nome VARCHAR(255)
);

CREATE TABLE CPF 
(
    numero_cpf CHAR(11)
);

-- ADICIONAR AS CHAVES PRIMÃRIAS

ALTER TABLE Cliente ADD PRIMARY KEY (id_cliente);

ALTER TABLE CPF ADD PRIMARY KEY (numero_cpf);


-- O relacionamento Ã© 1:1. Podemos escolher um dos lados para armazenar a chave.
-- Aqui vamos seguir o diagrama, colocando a chave estrangeira de CPF em Cliente.

ALTER TABLE Cliente ADD COLUMN numero_cpf CHAR(11);

-- CRIAR AS CHAVES ESTRANGEIRAS

ALTER TABLE Cliente ADD CONSTRAINT fk_cliente_cpf FOREIGN KEY (numero_cpf) REFERENCES CPF (numero_cpf);

```

------------------------------------------------------------------------

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ExercÃ­cio 3 â€” Hospital                                                                                                                                                                                                                                                                  |
+=========================================================================================================================================================================================================================================================================================+
| Um Hospital registra Pacientes, cada um com nome, idade, endereÃ§o e telefone. Os pacientes podem realizar vÃ¡rias Consultas com MÃ©dicos. Cada mÃ©dico possui um CRM, um nome e uma especialidade. Durante a consulta, o mÃ©dico pode prescrever Receitas, que possuem medicaÃ§Ã£o e dosagem. |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a)  Identifique as **entidades**                                                                                                                                                                                                                                                        |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| b)  Identifique os **atributos** de cada Entidade                                                                                                                                                                                                                                       |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| c)  Identifique os **relacionamentos** entre as Entidades                                                                                                                                                                                                                               |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| e)  FaÃ§a o **diagrama DEM (Diagrama Entidade Relacionamento) contendo as entidades, atributos e relacionamentos** que vocÃª mapeou.                                                                                                                                                      |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#### Passo #1 -

Identificar **SUBSTANTIVOS** no contexto; identificar os **ADJETIVOS** pertinentes a cada SUBSTANTIVO; identificar os **VERBOS** de relaÃ§Ã£o entre os substantivos.

+---------------------------------------------------+------------------------------------------+-------------------------------------------------------------------+
| `Substantivos` **do contexto**: leve-os ao plural | `Adjetivos`                              | `Verbos`                                                          |
+:==================================================+==========================================+===================================================================+
| HOSPITAL -\> **`HOSPITAIS`**                      | `NOME` (implÃ­cito no enunciado)          | (explÃ­cito) hospital `REGISTRA` (vÃ¡rios) pacientes                |
|                                                   |                                          |                                                                   |
|                                                   | `CNPJ` (implÃ­cito no enunciado)          | (implÃ­cito) hospital `POSSUI` medicos                             |
+---------------------------------------------------+------------------------------------------+-------------------------------------------------------------------+
| PACIENTE -\> **`PACIENTES`**                      | `NOME` (explÃ­cito no enunciado)          | pacientes sÃ£o `REGISTRADOS` em (um) hospital                      |
|                                                   |                                          |                                                                   |
|                                                   | `IDADE` (explÃ­cito no enunciado)         | (vÃ¡rios) pacientes `CONSULTAM` (vÃ¡rios) mÃ©dicos                   |
|                                                   |                                          |                                                                   |
|                                                   | `ENDERECO` (explÃ­cito no enunciado)      | (vÃ¡rios) pacientes `SÃƒO RECEITADOS` por (vÃ¡rios) mÃ©dicos          |
|                                                   |                                          |                                                                   |
|                                                   | `TELEFONE` (explÃ­cito no enunciado)      |                                                                   |
|                                                   |                                          |                                                                   |
|                                                   | `CPF` (implÃ­cito no enunciado)           |                                                                   |
+---------------------------------------------------+------------------------------------------+-------------------------------------------------------------------+
| MÃ‰DICO -\> **`MEDICOS`**                          | `CRM` (explÃ­cito no enunciado)           | (vÃ¡rios) mÃ©dico(s) `CONSULTA` (vÃ¡rios) pacientes                  |
|                                                   |                                          |                                                                   |
|                                                   | `NOME` (explÃ­cito no enunciado)          | (vÃ¡rios) mÃ©dico(s) `RECEITAM` (vÃ¡rios) pacientes                  |
|                                                   |                                          |                                                                   |
|                                                   | `ESPECIALIDADE` (explÃ­cito no enunciado) |                                                                   |
+---------------------------------------------------+------------------------------------------+-------------------------------------------------------------------+
| RECEITA ?? -\> **`RECEITAR`** Ã© VERBO             | `MEDICACAO` (explÃ­cito no enunciado)     | mÃ©dico `RECEITA` ao paciente                                      |
|                                                   |                                          |                                                                   |
|                                                   | `DOSAGEM`(explÃ­cito no enunciado)        | (vÃ¡rios) paciente(s) `Ã‰(SÃƒO) RECEITADO(s)` por (vÃ¡rios) mÃ©dico(s) |
+---------------------------------------------------+------------------------------------------+-------------------------------------------------------------------+
| CONSULTA ?? -\> **`CONSULTAR`** Ã© VERBO           | `DATA` (implÃ­cito no enunciado)          | (vÃ¡rios) pacientes(s) `CONSULTA(M)` (vÃ¡rios) mÃ©dico(s)            |
|                                                   |                                          |                                                                   |
|                                                   | `HORA`(implÃ­cito no enunciado)           |                                                                   |
|                                                   |                                          |                                                                   |
|                                                   | `sala`(implÃ­cito no enunciado)           |                                                                   |
+---------------------------------------------------+------------------------------------------+-------------------------------------------------------------------+

: Identificando SUBSTANTIVOS, ADJETIVOS referentes e VERBOS de relaÃ§Ã£o

#### Passo #2

Criar o **`MODELO ENTIDADE RELACIONAMENTO (M.E.R.)`** - Converter SUBSTANTIVO em **`ENTIDADES`**; converter ADJETIVOS em **`ATRIBUTOS`** e converter VERBOS em **`RELACIONAMENTOS`**.

-   ENTIDADES identificadas: **`HOSPITAIS`**, **`PACIENTES`**, **`MEDICOS`**

-   ATRIBUTOS identificados: HOSPITAIS [ nome,cnpj ] ; PACIENTES [ nome, idade, endereco, telefone, cpf] ; MEDICOS [ crm, nome e especialidade] ;

-   RELACIONAMENTOS: [medico-`consulta`-paciente] ; [medico-`receita`-paciente]; [hospital-registra-paciente] ; [hospital-`POSSUI`-medicos]

#### Passo #3

Criar um DIAGRAMA ENTIDADE-RELACIONAMENTO (D.E.R.) com as informaÃ§Ãµes levantadas:

```{plantuml exercicio03-01, plantuml.path="images"}
@startchen


entity HOSPITAIS {
  nome
  cnpj <<key>>
}

entity PACIENTES {
  nome
  idade
  endereco
  telefone
  cpf <<key>>
}


entity MEDICOS {
  nome
  especialidade
  crm <<key>>
}

relationship REGISTRAM {
  
}

relationship CONSULTAM {
  data
  hora
  sala
}

relationship RECEITAM {
  medicacao
  dosagem
}

HOSPITAIS -1- REGISTRAM
REGISTRAM -N- PACIENTES

MEDICOS   -N- CONSULTAM
CONSULTAM -N- PACIENTES

MEDICOS   -N- RECEITAM
RECEITAM  -N- PACIENTES

@endchen
```

#### Passo #5 - FaÃ§a o cÃ³digo SQL do diagrama acima

```SQL

/* =========================================================
   Passo 1- TABELAS (apenas colunas, sem PK ou FK)
   ========================================================= */
CREATE TABLE HOSPITAIS 
(
    nome    VARCHAR(255),
    cnpj    CHAR(14)
);

CREATE TABLE PACIENTES 
(
    nome        VARCHAR(255),
    idade       INT,
    endereco    VARCHAR(255),
    telefone    VARCHAR(20),
    cpf         CHAR(11)
);

CREATE TABLE MEDICOS 
(
    nome            VARCHAR(255),
    especialidade   VARCHAR(255),
    crm             CHAR(15)
);

/* As prÃ³ximas tabelas representam os relacionamentos N:N
   com atributos prÃ³prios (tabelas de junÃ§Ã£o) */
CREATE TABLE REGISTRAM 
(
    -- sem colunas de FK por enquanto
);

CREATE TABLE CONSULTAM 
(
    data_consulta   DATE,
    hora            TIME,
    sala            VARCHAR(50)
);

CREATE TABLE RECEITAM 
(
    medicacao       VARCHAR(255),
    dosagem         VARCHAR(100)
);

/* =========================================================
   Passo 2- ADICIONAR CHAVES PRIMÃRIAS
   ========================================================= */
ALTER TABLE HOSPITAIS  ADD PRIMARY KEY (cnpj);

ALTER TABLE PACIENTES  ADD PRIMARY KEY (cpf);

ALTER TABLE MEDICOS    ADD PRIMARY KEY (crm);

/* Para tabelas de relacionamento com atributos, a PK serÃ¡ composta
   (as FKs a serem criadas formarÃ£o a chave primÃ¡ria). Faremos isso depois
   de adicionar as colunas de FK. */

/* =========================================================
   Passo 3- CRIAR COLUNAS PARA FUTURAS CHAVES ESTRANGEIRAS
   ========================================================= */
-- REGISTRAM: HOSPITAIS (1) â€”â€” (N) PACIENTES
ALTER TABLE REGISTRAM ADD COLUMN cnpj CHAR(14), ADD COLUMN cpf  CHAR(11);

-- CONSULTAM: MEDICOS (N) â€”â€” (N) PACIENTES
ALTER TABLE CONSULTAM ADD COLUMN crm  CHAR(15), ADD COLUMN cpf  CHAR(11);

-- RECEITAM: MEDICOS (N) â€”â€” (N) PACIENTES
ALTER TABLE RECEITAM  ADD COLUMN crm  CHAR(15), ADD COLUMN cpf  CHAR(11);

/* =========================================================
   Passo 4- CRIAR CHAVES ESTRANGEIRAS
   ========================================================= */
ALTER TABLE REGISTRAM
    ADD CONSTRAINT fk_registram_hospitais
        FOREIGN KEY (cnpj)
        REFERENCES HOSPITAIS (cnpj),
    ADD CONSTRAINT fk_registram_pacientes
        FOREIGN KEY (cpf)
        REFERENCES PACIENTES (cpf);

ALTER TABLE CONSULTAM
    ADD CONSTRAINT fk_consultam_medicos
        FOREIGN KEY (crm)
        REFERENCES MEDICOS (crm),
    ADD CONSTRAINT fk_consultam_pacientes
        FOREIGN KEY (cpf)
        REFERENCES PACIENTES (cpf);

ALTER TABLE RECEITAM
    ADD CONSTRAINT fk_receitam_medicos
        FOREIGN KEY (crm)
        REFERENCES MEDICOS (crm),
    ADD CONSTRAINT fk_receitam_pacientes
        FOREIGN KEY (cpf)
        REFERENCES PACIENTES (cpf);

/* Definir chaves primÃ¡rias compostas para tabelas de relacionamento */
ALTER TABLE REGISTRAM ADD PRIMARY KEY (cnpj, cpf);

ALTER TABLE CONSULTAM ADD PRIMARY KEY (crm, cpf, data_consulta, hora);

ALTER TABLE RECEITAM  ADD PRIMARY KEY (crm, cpf, medicacao);

```

------------------------------------------------------------------------

### ExercÃ­cios

### ğŸ“ Lista de ExercÃ­cios â€“ Modelo Entidade-Relacionamento (MER)

#### ExercÃ­cio 1 â€“ Cliente e CPF (1:1)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
Cada **Cliente** possui exatamente **um CPF**, e cada CPF sÃ³ pode estar associado a um Ãºnico Cliente.\
- Identifique entidades, atributos e relacionamento.\
- Represente o MER com cardinalidade 1:1.

```{plantuml exercicio-01, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

relationship "_________________________" as relacionamento1 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2

@endchen
```

------------------------------------------------------------------------

#### ExercÃ­cio 2 â€“ Cliente e Pedidos (1:N)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
Um **Cliente** pode fazer **vÃ¡rios Pedidos**, mas cada Pedido pertence a apenas um Cliente.\
- Liste as entidades e atributos.\
- Defina o relacionamento e a cardinalidade.\
- Monte o DER.

```{plantuml exercicio-02, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

relationship "_________________________" as relacionamento1 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2

@endchen
```

------------------------------------------------------------------------

#### ExercÃ­cio 3 â€“ Alunos e Disciplinas (N:N)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
Um **Aluno** pode se matricular em vÃ¡rias **Disciplinas**, e cada Disciplina pode ter vÃ¡rios Alunos.\
- Identifique entidades e atributos. - Qual entidade associativa deve ser criada? - Desenhe o DER com a entidade associativa.

```{plantuml exercicio-03, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

relationship "_________________________" as relacionamento1 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2

@endchen
```

------------------------------------------------------------------------

#### ExercÃ­cio 4 â€“ FuncionÃ¡rio e Dependentes (Entidade Fraca)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
Cada **FuncionÃ¡rio** pode ter **vÃ¡rios Dependentes**. Um Dependente nÃ£o existe sem um FuncionÃ¡rio.\
- Identifique a entidade forte e a entidade fraca.\
- Defina atributos e chaves.\
- Monte o DER indicando a dependÃªncia existencial.

```{plantuml exercicio-04, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

relationship "_________________________" as relacionamento1 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2


@endchen
```

```SQL
-- Coloque aqui o cÃ³digo SQL criar as tabelas:



```

------------------------------------------------------------------------

#### ExercÃ­cio 5 â€“ Pedido e Itens de Pedido (Entidade Associativa + Fraca)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
Um **Pedido** contÃ©m vÃ¡rios **Itens**, mas cada Item estÃ¡ sempre vinculado a apenas um Pedido.\
- Qual entidade Ã© dominante e qual Ã© subordinada?\
- Identifique atributos das duas entidades.\
- Represente o DER com cardinalidade 1:N.

```{plantuml exercicio-05, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

relationship "_________________________" as relacionamento1 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2


@endchen
```

```SQL
-- Coloque aqui o cÃ³digo SQL criar as tabelas:



```

------------------------------------------------------------------------

#### ExercÃ­cio 6 â€“ MÃ©dicos e Consultas (1:N)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
Um **MÃ©dico** pode realizar vÃ¡rias **Consultas**, mas cada Consulta estÃ¡ associada a apenas um MÃ©dico.\
- Identifique entidades e atributos.\
- Desenhe o DER.\
- Indique as cardinalidades.

```{plantuml exercicio-06, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

relationship "_________________________" as relacionamento1 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2


@endchen
```

```SQL
-- Coloque aqui o cÃ³digo SQL criar as tabelas:



```


------------------------------------------------------------------------

#### ExercÃ­cio 7 â€“ Professor e Departamento (1:1)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
Cada **Professor** dirige apenas **um Departamento**, e cada Departamento tem apenas um Professor responsÃ¡vel.\
- Identifique entidades, atributos e relacionamento.\
- Defina cardinalidade 1:1 no DER.

```{plantuml exercicio-07, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

relationship "_________________________" as relacionamento1 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2


@endchen
```

```SQL
-- Coloque aqui o cÃ³digo SQL criar as tabelas:



```

------------------------------------------------------------------------

#### ExercÃ­cio 8 â€“ Livros e Autores (N:N)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
Um **Livro** pode ter vÃ¡rios **Autores**, e cada Autor pode escrever vÃ¡rios Livros.\
- Identifique as entidades e atributos.\
- Qual entidade associativa deve ser criada?\
- Monte o DER em notaÃ§Ã£o conceitual.

```{plantuml exercicio-08, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

relationship "_________________________" as relacionamento1 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2


@endchen
```

```SQL
-- Coloque aqui o cÃ³digo SQL criar as tabelas:



```

------------------------------------------------------------------------

#### ExercÃ­cio 9 â€“ Biblioteca (Entidades Fortes e Fracas)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
Um **Livro** pode ter vÃ¡rios **Exemplares**. Um Exemplar sÃ³ existe se estiver associado a um Livro.\
- Identifique entidades fortes e fracas.\
- Defina atributos (Livro: tÃ­tulo, ano; Exemplar: cÃ³digo_exemplar, status).\
- Monte o DER com a dependÃªncia existencial.


```{plantuml exercicio-09, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

relationship "_________________________" as relacionamento1 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2


@endchen
```

```SQL
-- Coloque aqui o cÃ³digo SQL criar as tabelas:



```

------------------------------------------------------------------------

#### ExercÃ­cio 10 â€“ Empresa, FuncionÃ¡rio e Projeto (Misto 1:N e N:N)
Considere um projeto de Banco de Dados.FaÃ§a a modelagem utilizando o Modelo Entidade-Relacionamento de Peter Chen (M.E.R.). \
-   Uma **Empresa** possui vÃ¡rios **FuncionÃ¡rios**.\
-   Cada **FuncionÃ¡rio** pode participar de vÃ¡rios **Projetos**, e cada Projeto pode ter vÃ¡rios FuncionÃ¡rios.\
-   Identifique todas as entidades, atributos e relacionamentos.\
-   Determine cardinalidades corretas (Empresaâ€“FuncionÃ¡rio 1:N, FuncionÃ¡rioâ€“Projeto N:N).\
-   Crie o DER completo.

```{plantuml exercicio-10, plantuml.path="images"}
@startchen
left to right direction

entity "________________________________________________________" as entidade1 {
  "_________________________" as atributo1 << key >>
  "_________________________" as atributo2
}

entity "________________________________________________________" as entidade2 {
  "_________________________" as atributo3 << key >>
  "_________________________" as atributo4
}

entity "________________________________________________________" as entidade3 {
  "_________________________" as atributo5 << key >>
  "_________________________" as atributo6
}

relationship "_________________________" as relacionamento1 {

}

relationship "_________________________" as relacionamento2 {

}

entidade1       -0- relacionamento1
relacionamento1 -0- entidade2


entidade2       -0- relacionamento2
relacionamento2 -0- entidade3


@endchen
```

```SQL
-- Coloque aqui o cÃ³digo SQL criar as tabelas:



```

------------------------------------------------------------------------

#### Tarefas propostas para cada exercÃ­cio:

1.  Identificar entidades e atributos.\
2.  Definir relacionamentos.\
3.  Especificar cardinalidades.\
4.  Indicar entidades fortes e fracas (quando houver).\
5.  Representar graficamente o DER.

------------------------------------------------------------------------

### Respostas dos ExercÃ­cios:

#### ExercÃ­cio #1

```{plantuml exercicio-01-resposta, plantuml.path="images"}
@startchen
left to right direction

entity CLIENTES {
  id_cliente <<key>>
  nome
}

entity CPFS {
  numero_cpf
}

relationship POSSUI {

}

CLIENTES -1- POSSUI
POSSUI   -1- CPFS

@endchen
```

##### ExercÃ­cio 1 - SQL referÃªnte ao diagrama anterior

```SQL
/* =========================================================
   TRANSFORMA AS ENTIDADES EM TABELAS E ATRIBUTOS EM COLUNAS
   ========================================================= */
CREATE TABLE CLIENTES 
(
    id_cliente INTEGER,
    nome VARCHAR(255)
);

CREATE TABLE CPFS
(
    numero_cpf CHAR(11)
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */
ALTER TABLE CLIENTES ADD PRIMARY KEY (id_cliente);

ALTER TABLE CPFS ADD PRIMARY KEY (numero_cpf);

/* =========================================================
    Criar coluna para futura chave estrangeira
   ========================================================= */
-- Relacionamento 1:1 (um cliente possui um CPF)
-- Vamos colocar a FK na tabela CLIENTES

ALTER TABLE CLIENTES   ADD COLUMN numero_cpf CHAR(11);

/* =========================================================
    Criar chave estrangeira
   ========================================================= */

ALTER TABLE CLIENTES ADD CONSTRAINT fk_clientes_cpfs FOREIGN KEY (numero_cpf) EFERENCES CPFS (numero_cpf);

```


------------------------------------------------------------------------

#### ExercÃ­cio #2

```{plantuml exercicio-02-resposta, plantuml.path="images"}
@startchen
left to right direction

entity CLIENTES {
  cpf << key >>
  nome
}

entity PEDIDOS {
  cod_pedido << key >>
  data
  valor_total
}

relationship FAZEM {

}

CLIENTES -1- FAZEM
FAZEM    -N- PEDIDOS

@endchen
```

##### ExercÃ­cio 2 - SQL referÃªnte ao diagrama anterior

```SQL
/* =========================================================
   Criar tabelas (sem PK ou FK)
   ========================================================= */
CREATE TABLE CLIENTES 
(
    cpf CHAR(11),
    nome VARCHAR(255)
);

CREATE TABLE PEDIDOS 
(
    cod_pedido INT,
    data DATE,
    valor_total DECIMAL(10,2)
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */

ALTER TABLE CLIENTES  ADD PRIMARY KEY (cpf);

ALTER TABLE PEDIDOS   ADD PRIMARY KEY (cod_pedido);

/* =========================================================
   Criar coluna para futura chave estrangeira
   ========================================================= */
-- Relacionamento CLIENTES 1:N PEDIDOS 

ALTER TABLE PEDIDOS ADD COLUMN cpf_cliente CHAR(11);

/* =========================================================
   Criar chave estrangeira
   ========================================================= */

ALTER TABLE PEDIDOS ADD CONSTRAINT fk_pedidos_clientes  FOREIGN KEY (cpf_cliente) REFERENCES CLIENTES (cpf);


```

------------------------------------------------------------------------

#### ExercÃ­cio #3

```{plantuml exercicio-03-resposta, plantuml.path="images"}
@startchen
left to right direction

entity ALUNOS {
  id_aluno << key >>
  nome
}

entity DISCIPLINAS {
  id_disciplina << key >>
  nome
}

relationship MATRICULA {
  semestre
}

ALUNOS -N- MATRICULA
MATRICULA -N- DISCIPLINAS

@endchen
```

##### ExercÃ­cio 3 - SQL referÃªnte ao diagrama anterior

```SQL
/* =========================================================
   Criar tabelas (sem PK ou FK)
   ========================================================= */

CREATE TABLE ALUNOS 
(
    id_aluno INT,
    nome VARCHAR(255)
);

CREATE TABLE DISCIPLINAS 
(
    id_disciplina INT,
    nome VARCHAR(255)
);

/* Tabela para o relacionamento N:N */

CREATE TABLE MATRICULA 
(
    semestre VARCHAR(10)
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */

ALTER TABLE ALUNOS  ADD PRIMARY KEY (id_aluno);

ALTER TABLE DISCIPLINAS ADD PRIMARY KEY (id_disciplina);

/* A PK da tabela MATRICULA serÃ¡ composta pelas FKs */
-- Definiremos depois de criar as colunas de FK

/* =========================================================
   Criar colunas para futuras chaves estrangeiras (lado N)
   ========================================================= */

ALTER TABLE MATRICULA ADD COLUMN id_aluno INT, ADD COLUMN id_disciplina INT;

/* =========================================================
   Criar chaves estrangeiras
   ========================================================= */

ALTER TABLE MATRICULA ADD CONSTRAINT fk_matricula_aluno FOREIGN KEY (id_aluno) REFERENCES ALUNOS (id_aluno);

ALTER TABLE MATRICULA ADD CONSTRAINT fk_matricula_disciplina FOREIGN KEY (id_disciplina) REFERENCES DISCIPLINAS (id_disciplina);

/* =========================================================
   Definir chave primÃ¡ria composta da tabela MATRICULA
   ========================================================= */

ALTER TABLE MATRICULA ADD PRIMARY KEY (id_aluno, id_disciplina);

```

------------------------------------------------------------------------

#### ExercÃ­cio #4

```{plantuml exercicio-04-resposta, plantuml.path="images"}
@startchen

entity FUNCIONARIOS {
  id_funcionario <<key>>
  nome
  cargo
  salario
}

entity DEPENDENTES {
  id_dependente <<key>>
  nome
  parentesco
  data_nascimento
}

relationship POSSUI {
}

FUNCIONARIOS -1- POSSUI
POSSUI      -N- DEPENDENTES

@endchen
```

##### ExercÃ­cio 4 - SQL referÃªnte ao diagrama anterior

```SQL
/* =========================================================
   Criar tabelas (sem PK ou FK)
   ========================================================= */
CREATE TABLE FUNCIONARIOS 
(
    id_funcionario INT,
    nome VARCHAR(255),
    cargo VARCHAR(100),
    salario DECIMAL(10,2)
);

CREATE TABLE DEPENDENTES 
(
    id_dependente INT,
    nome VARCHAR(255),
    parentesco VARCHAR(50),
    data_nascimento DATE
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */

ALTER TABLE FUNCIONARIOS ADD PRIMARY KEY (id_funcionario);

ALTER TABLE DEPENDENTES ADD PRIMARY KEY (id_dependente);

/* =========================================================
   Criar coluna para futura chave estrangeira
   ========================================================= */

-- Relacionamento FUNCIONARIOS 1:N DEPENDENTES

ALTER TABLE DEPENDENTES ADD COLUMN id_funcionario INT;

/* =========================================================
   Criar chave estrangeira
   ========================================================= */

ALTER TABLE DEPENDENTES ADD CONSTRAINT fk_dependentes_funcionarios FOREIGN KEY (id_funcionario) REFERENCES FUNCIONARIOS  (id_funcionario);


```

------------------------------------------------------------------------

#### ExercÃ­cio #5

```{plantuml exercicio-05-resposta, plantuml.path="images"}
@startchen

entity PEDIDOS {
  id_pedido <<key>>
  data_pedido
  valor_total
  status
}

entity ITENS {
  id_item <<key>>
  descricao
  quantidade
  preco_unitario
}

relationship CONTEM {
}

PEDIDOS -1- CONTEM
CONTEM  -N- ITENS

@endchen
```

##### ExercÃ­cio 5 - SQL referÃªnte ao diagrama anterior

```SQL
/* =========================================================
   Criar tabelas (sem PK ou FK)
   ========================================================= */
CREATE TABLE PEDIDOS 
(
    id_pedido INT,
    data_pedido DATE,
    valor_total DECIMAL(10,2),
    status VARCHAR(50)
);

CREATE TABLE ITENS 
(
    id_item INT,
    descricao VARCHAR(255),
    quantidade INT,
    preco_unitario DECIMAL(10,2)
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */
ALTER TABLE PEDIDOS ADD PRIMARY KEY (id_pedido);

ALTER TABLE ITENS ADD PRIMARY KEY (id_item);

/* =========================================================
   Criar coluna para futura chave estrangeira
   ========================================================= */

-- Relacionamento PEDIDOS 1:N ITENS

ALTER TABLE ITENS ADD COLUMN id_pedido INT;

/* =========================================================
   Criar chave estrangeira
   ========================================================= */

ALTER TABLE ITENS ADD CONSTRAINT fk_itens_pedidos FOREIGN KEY (id_pedido) REFERENCES PEDIDOS (id_pedido);


```

------------------------------------------------------------------------

#### ExercÃ­cio #6

```{plantuml exercicio-06-resposta, plantuml.path="images"}
@startchen

entity MEDICOS {
  id_medico <<key>>
  nome
  especialidade
  crm
}

entity CONSULTAS {
  id_consulta <<key>>
  data_consulta
  hora
  observacoes
}

relationship REALIZA {
}

MEDICOS  -1- REALIZA
REALIZA  -N- CONSULTAS

@endchen
```

##### ExercÃ­cio 6 - SQL referÃªnte ao diagrama anterior

```SQL
/* =========================================================
   Criar tabelas (sem PK ou FK)
   ========================================================= */
CREATE TABLE MEDICOS 
(
    id_medico INT,
    nome VARCHAR(255),
    especialidade VARCHAR(100),
    crm VARCHAR(20)
);

CREATE TABLE CONSULTAS 
(
    id_consulta INT,
    data_consulta DATE,
    hora TIME,
    observacoes VARCHAR(255)
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */

ALTER TABLE MEDICOS ADD PRIMARY KEY (id_medico);

ALTER TABLE CONSULTAS ADD PRIMARY KEY (id_consulta);

/* =========================================================
   Criar coluna para futura chave estrangeira
   ========================================================= */
-- Relacionamento MEDICOS 1:N CONSULTAS

ALTER TABLE CONSULTAS ADD COLUMN id_medico INT;

/* =========================================================
   Criar chave estrangeira
   ========================================================= */

ALTER TABLE CONSULTAS ADD CONSTRAINT fk_consultas_medicos FOREIGN KEY (id_medico) REFERENCES MEDICOS (id_medico);

```

------------------------------------------------------------------------

#### ExercÃ­cio #7

```{plantuml exercicio-07-resposta, plantuml.path="images"}
@startchen

entity PROFESSORES {
  id_professor <<key>>
  nome
  titulacao
  email
}

entity DEPARTAMENTOS {
  id_departamento <<key>>
  nome
  localizacao
  telefone
}

relationship DIRIGE {
}

PROFESSORES  -1- DIRIGE
DIRIGE       -1- DEPARTAMENTOS

@endchen
```

##### ExercÃ­cio 7 - SQL referÃªnte ao diagrama anterior

```SQL
/* =========================================================
   Criar tabelas (sem PK ou FK)
   ========================================================= */
CREATE TABLE PROFESSORES 
(
    id_professor INT,
    nome VARCHAR(255),
    titulacao VARCHAR(100),
    email VARCHAR(255)
);

CREATE TABLE DEPARTAMENTOS 
(
    id_departamento INT,
    nome VARCHAR(255),
    localizacao VARCHAR(255),
    telefone VARCHAR(20)
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */
ALTER TABLE PROFESSORES ADD PRIMARY KEY (id_professor);

ALTER TABLE DEPARTAMENTOS ADD PRIMARY KEY (id_departamento);

/* =========================================================
   Criar coluna para futura chave estrangeira
   ========================================================= */
-- Relacionamento 1:1 entre PROFESSORES e DEPARTAMENTOS
-- Aqui vamos colocar a FK em DEPARTAMENTOS, vinculando ao professor responsÃ¡vel

ALTER TABLE DEPARTAMENTOS ADD COLUMN id_professor INT;

/* =========================================================
   Criar chave estrangeira
   ========================================================= */

ALTER TABLE DEPARTAMENTOS ADD CONSTRAINT fk_departamentos_professores FOREIGN KEY (id_professor) REFERENCES PROFESSORES (id_professor);

```

------------------------------------------------------------------------

#### ExercÃ­cio #8

```{plantuml exercicio-08-resposta, plantuml.path="images"}
@startchen

entity LIVROS {
  id_livro <<key>>
  titulo
  ano_publicacao
  editora
}

entity AUTORES {
  id_autor <<key>>
  nome
  nacionalidade
}

' Entidade associativa para o relacionamento N:N '

entity ESCREVEM {
  data_participacao
  ordem_autoria
}

relationship ESCREVE {
}

LIVROS  -N- ESCREVE
ESCREVE -N- AUTORES

@endchen
```

##### ExercÃ­cio 8 - SQL referÃªnte ao diagrama anterior

```SQL

/* =========================================================
   Criar tabelas (sem PK ou FK)
   ========================================================= */
CREATE TABLE LIVROS 
(
    id_livro INT,
    titulo VARCHAR(255),
    ano_publicacao INT,
    editora VARCHAR(255)
);

CREATE TABLE AUTORES 
(
    id_autor INT,
    nome VARCHAR(255),
    nacionalidade VARCHAR(100)
);

/* Tabela para relacionamento N:N com atributos */

CREATE TABLE ESCREVEM 
(
    data_participacao DATE,
    ordem_autoria INT
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */
ALTER TABLE LIVROS ADD PRIMARY KEY (id_livro);

ALTER TABLE AUTORES ADD PRIMARY KEY (id_autor);

/* =========================================================
   Criar colunas para futuras chaves estrangeiras
   ========================================================= */

ALTER TABLE ESCREVEM ADD COLUMN id_livro INT, ADD COLUMN id_autor INT;

/* =========================================================
   Criar chaves estrangeiras
   =====================================

ALTER TABLE ESCREVEM ADD CONSTRAINT fk_escrevem_livros   FOREIGN KEY (id_livro) REFERENCES LIVROS (id_livro);

ALTER TABLE ESCREVEM ADD CONSTRAINT fk_escrevem_autores  FOREIGN KEY (id_autor) REFERENCES AUTORES (id_autor);

/* =========================================================
   Definir chave primÃ¡ria composta da tabela ESCREVEM
   ========================================================= */

ALTER TABLE ESCREVEM  ADD PRIMARY KEY (id_livro, id_autor);

```

------------------------------------------------------------------------

#### ExercÃ­cio #9

```{plantuml exercicio-09-resposta, plantuml.path="images"}
@startchen

entity LIVROS {
  id_livro <<key>>
  titulo
  ano
}

' Entidade fraca: depende de LIVROS '

entity EXEMPLARES {
  codigo_exemplar <<partial key>>
  status
}

relationship POSSUI {
}

LIVROS    -1- POSSUI
POSSUI    -N- EXEMPLARES

@endchen
```

##### ExercÃ­cio 9 - SQL referÃªnte ao diagrama anterior

```SQL
/* =========================================================
   Criar tabelas (sem PK ou FK)
   ========================================================= */

CREATE TABLE LIVROS 
(
    id_livro INT,
    titulo VARCHAR(255),
    ano INT
);

CREATE TABLE EXEMPLARES 
(
    codigo_exemplar INT,
    status VARCHAR(50)
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */

ALTER TABLE LIVROS ADD PRIMARY KEY (id_livro);

/* A chave primÃ¡ria de EXEMPLARES serÃ¡ composta depois, usando FK + codigo_exemplar */

/* =========================================================
   Criar coluna para futura chave estrangeira
   ========================================================= */
-- Relacionamento LIVROS 1:N EXEMPLARES

ALTER TABLE EXEMPLARES ADD COLUMN id_livro INT;

/* =========================================================
   Criar chave estrangeira
   ========================================================= */

ALTER TABLE EXEMPLARES ADD CONSTRAINT fk_exemplares_livros FOREIGN KEY (id_livro) REFERENCES LIVROS (id_livro);

/* =========================================================
   Definir chave primÃ¡ria composta da tabela EXEMPLARES
   ========================================================= */

ALTER TABLE EXEMPLARES ADD PRIMARY KEY (id_livro, codigo_exemplar);


```

------------------------------------------------------------------------

#### ExercÃ­cio #10

```{plantuml exercicio-10-resposta, plantuml.path="images"}
@startchen

' ========================= '
' Entidades                 '
' ========================= '

entity EMPRESAS {
  id_empresa <<key>>
  nome
  cnpj
  endereco
}

entity FUNCIONARIOS {
  id_funcionario <<key>>
  nome
  cargo
  salario
}

entity PROJETOS {
  id_projeto <<key>>
  nome
  data_inicio
  data_fim
  descricao
}

' =========================                            '
' Entidade associativa para FuncionÃ¡rioâ€“Projeto (N:N)  '
' =========================                            '

entity PARTICIPAM {
  data_inicio
  data_fim
  papel
}

' ========================= '
' Relacionamentos           '
' ========================= '

relationship POSSUI {
}

relationship TRABALHA_EM {
}

' ========================= '
' Cardinalidades            '
' ========================= '

EMPRESAS    -1- POSSUI
POSSUI      -N- FUNCIONARIOS

FUNCIONARIOS -N- TRABALHA_EM
TRABALHA_EM  -N- PROJETOS

@endchen
```

##### ExercÃ­cio 10 - SQL referÃªnte ao diagrama anterior

```SQL
/* =========================================================
   Criar tabelas (sem PK ou FK)
   ========================================================= */
CREATE TABLE EMPRESAS (
    id_empresa INT,
    nome VARCHAR(255),
    cnpj CHAR(14),
    endereco VARCHAR(255)
);

CREATE TABLE FUNCIONARIOS (
    id_funcionario INT,
    nome VARCHAR(255),
    cargo VARCHAR(100),
    salario DECIMAL(10,2)
);

CREATE TABLE PROJETOS (
    id_projeto INT,
    nome VARCHAR(255),
    data_inicio DATE,
    data_fim DATE,
    descricao VARCHAR(255)
);

CREATE TABLE PARTICIPAM (
    data_inicio DATE,
    data_fim DATE,
    papel VARCHAR(100)
);

/* =========================================================
   Definir chaves primÃ¡rias
   ========================================================= */
ALTER TABLE EMPRESAS ADD PRIMARY KEY (id_empresa);

ALTER TABLE FUNCIONARIOS ADD PRIMARY KEY (id_funcionario);

ALTER TABLE PROJETOS ADD PRIMARY KEY (id_projeto);

/* A tabela PARTICIPAM terÃ¡ PK composta, definida depois */

/* =========================================================
   Criar colunas para futuras chaves estrangeiras
   ========================================================= */
-- Relacionamento EMPRESAS 1:N FUNCIONARIOS

ALTER TABLE FUNCIONARIOS  ADD COLUMN id_empresa INT;

-- Relacionamento FUNCIONARIOS N:N PROJETOS
ALTER TABLE PARTICIPAM ADD COLUMN id_funcionario INT, ADD COLUMN id_projeto INT;

/* =========================================================
   Criar chaves estrangeiras
   ========================================================= */
ALTER TABLE FUNCIONARIOS ADD CONSTRAINT fk_funcionarios_empresas FOREIGN KEY (id_empresa) REFERENCES EMPRESAS (id_empresa);

ALTER TABLE PARTICIPAM ADD CONSTRAINT fk_participam_funcionarios FOREIGN KEY (id_funcionario) REFERENCES FUNCIONARIOS (id_funcionario);

ALTER TABLE PARTICIPAM ADD CONSTRAINT fk_participam_projetos FOREIGN KEY (id_projeto) REFERENCES PROJETOS (id_projeto);

/* =========================================================
   Definir chave primÃ¡ria composta da tabela PARTICIPAM
   ========================================================= */

ALTER TABLE PARTICIPAM ADD PRIMARY KEY (id_funcionario, id_projeto);


```

------------------------------------------------------------------------





<!--chapter:end:03-aula03/03-2026-03-03_Modelagem_SGBD-exercicio-01.Rmd-->

---
output: 
  html_document: 
    highlight: tango
    theme: cerulean
    fig_caption: true
---

# Modelagem de Bancos de Dados parte 02

<!--chapter:end:04-aula04/04-2026-03-10_Modelagem_SGBD-aula-02.Rmd-->

---
output: 
  html_document: 
    highlight: tango
    theme: cerulean
    toc_depth: 4
    number_sections: true
  pdf_document: 
    toc: true
    toc_depth: 4
  word_document: 
    toc: true
    toc_depth: 4
---

## ExercÃ­cios RESOLVIDOS

<!--chapter:end:04-aula04/04-2026-03-10_Modelagem_SGBD-exercicio-02.Rmd-->

# AdministraÃ§Ã£o e Gerenciamento de Bancos de Dados

#### 25/08/2025 {.unnumbered}

#### Professor MiguÃ©l Suares {.unnumbered}

## AdministraÃ§Ã£o e Gerenciamento de Banco de Dados:

Por que administraÃ§Ã£o e gerenciamento sÃ£o fundamentais

-   Integridade e consistÃªncia

-   Garantir que as regras de negÃ³cio (restriÃ§Ãµes, chaves, relacionamentos) sejam sempre respeitadas.

-   Evitar dados duplicados ou incoerentes.

-   Disponibilidade e recuperaÃ§Ã£o

-   Planejar backup e restore; criar polÃ­ticas de alta disponibilidade e contingÃªncia para falhas ou desastres.

-   SeguranÃ§a e controle de acesso

-   Definir quem pode ver, inserir, alterar ou excluir dados.

-   Atender requisitos de LGPD/privacidade e normas corporativas.

-   Desempenho e escalabilidade

-   Monitorar consultas lentas, criar Ã­ndices adequados, ajustar parÃ¢metros do SGBD para suportar crescimento do volume de dados.

-   ManutenÃ§Ã£o e evoluÃ§Ã£o

-   Atualizar versÃµes, aplicar patches, revisar modelos de dados Ã  medida que a aplicaÃ§Ã£o muda.

## Papel do DBA (Database Administrator)

O DBA Ã© o profissional responsÃ¡vel por orquestrar tudo isso.Principais atribuiÃ§Ãµes:

-   Projeto fÃ­sico do banco (estrutura de tabelas, Ã­ndices, partiÃ§Ãµes).

-   GestÃ£o de usuÃ¡rios e permissÃµes â€“ criaÃ§Ã£o de contas, papÃ©is (roles), polÃ­ticas de seguranÃ§a.

-   Backup e recuperaÃ§Ã£o â€“ polÃ­ticas de backup, testes de restauraÃ§Ã£o.

-   Monitoramento de desempenho â€“ tuning de consultas, manutenÃ§Ã£o de Ã­ndices, anÃ¡lise de logs.

-   Planejamento de capacidade â€“ prever crescimento, escalabilidade e uso de recursos.

-   AtualizaÃ§Ãµes e patches â€“ manter o SGBD seguro e estÃ¡vel.

Sem administraÃ§Ã£o e gerenciamento adequados, um banco de dados vira um â€œdepÃ³sito de riscosâ€: falhas, lentidÃ£o, vazamento de informaÃ§Ãµes ou perda definitiva de dados. O DBA atua como guardiÃ£o da informaÃ§Ã£o, garantindo que ela esteja correta, segura, disponÃ­vel e performÃ¡tica, sustentando todas as operaÃ§Ãµes da organizaÃ§Ã£o.

## UsuÃ¡rios, Grupos e Esquemas de Bancos de Dados

### UsuÃ¡rios

O que sÃ£o ? Contas individuais que representam pessoas, aplicaÃ§Ãµes ou serviÃ§os que acessam o banco.Cada usuÃ¡rio possui um nome de login e, geralmente, uma senha ou outro mÃ©todo de autenticaÃ§Ã£o.

#### FunÃ§Ãµes principal

-   Conectar-se ao SGBD.

-   Executar operaÃ§Ãµes de leitura, escrita ou administraÃ§Ã£o conforme os privilÃ©gios concedidos.

#### PrivilÃ©gios:

Podem ser especÃ­ficos (ex.: SELECT em uma tabela) ou globais (ex.: CREATE DATABASE).

SÃ£o a base do controle de acesso.

### Esquemas

O que sÃ£o ? Um esquema Ã© um container lÃ³gico de objetos do banco de dados. Ele organiza tabelas, views, funÃ§Ãµes, procedures, Ã­ndices, triggers etc.

#### Por que usar

-   Facilita a organizaÃ§Ã£o (por projeto, por aplicaÃ§Ã£o, por departamento).

-   Permite gestÃ£o de permissÃµes mais granular: vocÃª pode conceder privilÃ©gios em nÃ­vel de esquema.

-   Evita conflitos de nomes, pois objetos com o mesmo nome podem existir em esquemas diferentes.

### Grupos ou Roles

O que sÃ£o ? PapÃ©is coletivos que agrupam permissÃµes e, muitas vezes, usuÃ¡rios.

No MySQL: CREATE ROLE ...

No PostgreSQL: roles podem ser usuÃ¡rios ou grupos.

#### Vantagens

-   Gerenciamento simplificado: conceda privilÃ©gios ao grupo e depois apenas adicione/remova usuÃ¡rios.

-   ConsistÃªncia: garante que todos de uma equipe tenham as mesmas permissÃµes.

-   Escalabilidade: ao entrar um novo membro, basta associÃ¡-lo ao role, sem revisar dezenas de tabelas.

### Sistema de Gerenciamento de Banco de Dados (S.G.B.D.)

O Sistema de Gerenciamento de Banco de Dados cuida nÃ£o sÃ³ de como as informaÃ§Ãµes sÃ£o armazenadas, mas tambÃ©m quem pode acessa-las, sob quais condiÃ§Ãµes.

![](media/01-SGBD.jpg)

### CriaÃ§Ã£o de usuÃ¡rios no MySQL

Podemos criar um novo usuÃ¡rio no SGBD MySQL atravÃ©s do seguinte comando SQL-DCL:

``` sql
CREATE USER 'nome_login'@'host' IDENTIFIED BY 'senha' COMMENT 'descriÃ§Ã£o';
```

| Parte | FunÃ§Ã£o |
|:----------------------------------:|:----------------------------------:|
| 'nome_login' | Nome de login do novo usuÃ¡rio. |
| 'host' | Origem permitida de conexÃ£o. |
| IDENTIFIED BY 'senha' | Define a senha inicial. |
| COMMENT 'descriÃ§Ã£o' | (Opcional) Uma anotaÃ§Ã£o de texto para identificar o usuÃ¡rio. |

Exemplo 1:

Crie o usuÃ¡rio do aluno "Bruno Marques". O usuÃ¡rio deve ser o RA do aluno e a sua senha deve ser *unip*.

``` sql
CREATE USER 'f362bf0'@'%' IDENTIFIED BY 'unip' COMMENT 'Bruno Antonio Marques';
```

Exemplo 2:

Crie os usuÃ¡rios de todos os alunos da sala. O usuÃ¡rio deve ser o RA do aluno e a sua senha deve ser *unip*.

``` sql

-- turma TI2P40

-- usuÃ¡rios no MySQL

DROP USER IF EXISTS 'f362bf0'@'%'; -- apaga o 'Bruno Antonio Marques';
DROP USER IF EXISTS 'r536fa6'@'%'; -- apaga o 'Caio Cesar Balbino Da Silva';
DROP USER IF EXISTS 'h756960'@'%'; -- apaga o 'Heder Rodrigues Da Silva';
DROP USER IF EXISTS 'r8133g7'@'%'; -- apaga o 'Ãtalo Kevin Rodrigues Da Silva';
DROP USER IF EXISTS 'r837aa0'@'%'; -- apaga o 'Lucas Souza Rodrigues';
DROP USER IF EXISTS 'h714419'@'%'; -- apaga o 'Marcos Paulo Cordeiro Goes';
DROP USER IF EXISTS 'r854124'@'%'; -- apaga o 'Ramon Borges De Holanda';


CREATE USER 'f362bf0'@'%' IDENTIFIED BY 'unip' COMMENT  'Bruno Antonio Marques';
CREATE USER 'r536fa6'@'%' IDENTIFIED BY 'unip' COMMENT  'Caio Cesar Balbino Da Silva';
CREATE USER 'h756960'@'%' IDENTIFIED BY 'unip' COMMENT  'Heder Rodrigues Da Silva';
CREATE USER 'r8133g7'@'%' IDENTIFIED BY 'unip' COMMENT  'Ãtalo Kevin Rodrigues Da Silva';
CREATE USER 'r837aa0'@'%' IDENTIFIED BY 'unip' COMMENT  'Lucas Souza Rodrigues';
CREATE USER 'h714419'@'%' IDENTIFIED BY 'unip' COMMENT  'Marcos Paulo Cordeiro Goes';
CREATE USER 'r854124'@'%' IDENTIFIED BY 'unip' COMMENT  'Ramon Borges De Holanda';

-- turma TI1P40

DROP USER IF EXISTS 'n0296a6'@'%'; -- apaga o 'Bryan Lucena Barbosa Da Silva';
DROP USER IF EXISTS 'h788986'@'%'; -- apaga o 'Igor Soares Lima Da Cunha';
DROP USER IF EXISTS 'h77gii5'@'%'; -- apaga o 'Jessica Cristina De S Silva';
DROP USER IF EXISTS 'f3648i0'@'%'; -- apaga o 'Maysa Kelly Dos Santos Freitas';


CREATE USER 'n0296a6'@'%' IDENTIFIED BY 'unip' COMMENT  'Bryan Lucena Barbosa Da Silva';
CREATE USER 'h788986'@'%' IDENTIFIED BY 'unip' COMMENT  'Igor Soares Lima Da Cunha';
CREATE USER 'h77gii5'@'%' IDENTIFIED BY 'unip' COMMENT  'Jessica Cristina De S Silva';
CREATE USER 'f3648i0'@'%' IDENTIFIED BY 'unip' COMMENT  'Maysa Kelly Dos Santos Freitas';
```

### CriaÃ§Ã£o de Esquemas de Banco de Dados no MySQL

No MySQL, schema e database sÃ£o sinÃ´nimos. Ã‰ o â€œcontÃªinerâ€ onde ficam tabelas, views, procedures, usuÃ¡rios com permissÃµes etc.

``` sql
CREATE DATABASE [IF NOT EXISTS] nome_do_schema  [OPTIONS];
```

| CREATE DATABASE: cria um novo banco.                          |
|---------------------------------------------------------------|
| IF NOT EXISTS: evita erro caso o schema jÃ¡ exista.            |
| nome_do_schema: nome do banco.                                |
| [OPTIONS]: parÃ¢metros opcionais como CHARACTER SET ou COLLATE |

Exemplo 1:

Crie um esquema de Banco de Dados onde chamado 11-rondonia para guardar a tabela "Cidades";

``` sql
CREATE DATABASE IF NOT EXISTS `11-rondonia`;
```

Exemplo 2:

Crie um esquema de Banco de Dados de todas as Unidades da FederaÃ§Ã£o para guardar tabelas "Cidades" dentro de cada uma:

``` sql
-- Script para criar um esquema (database) para cada UF brasileira
-- Nome do esquema: <cÃ³digo IBGE>-<nome_uf>
-- Ordenado pelo cÃ³digo IBGE
-- CompatÃ­vel com MySQL 8

CREATE DATABASE IF NOT EXISTS `11-rondonia`;
CREATE DATABASE IF NOT EXISTS `12-acre`;
CREATE DATABASE IF NOT EXISTS `13-amazonas`;
CREATE DATABASE IF NOT EXISTS `14-roraima`;
CREATE DATABASE IF NOT EXISTS `15-para`;
CREATE DATABASE IF NOT EXISTS `16-amapa`;
CREATE DATABASE IF NOT EXISTS `17-tocantins`;
CREATE DATABASE IF NOT EXISTS `21-maranhao`;
CREATE DATABASE IF NOT EXISTS `22-piaui`;
CREATE DATABASE IF NOT EXISTS `23-ceara`;
CREATE DATABASE IF NOT EXISTS `24-rio_grande_do_norte`;
CREATE DATABASE IF NOT EXISTS `25-paraiba`;
CREATE DATABASE IF NOT EXISTS `26-pernambuco`;
CREATE DATABASE IF NOT EXISTS `27-alagoas`;
CREATE DATABASE IF NOT EXISTS `28-sergipe`;
CREATE DATABASE IF NOT EXISTS `29-bahia`;
CREATE DATABASE IF NOT EXISTS `31-minas_gerais`;
CREATE DATABASE IF NOT EXISTS `32-espiritosanto`;
CREATE DATABASE IF NOT EXISTS `33-rio_de_janeiro`;
CREATE DATABASE IF NOT EXISTS `35-sao_paulo`;
CREATE DATABASE IF NOT EXISTS `41-parana`;
CREATE DATABASE IF NOT EXISTS `42-santa_catarina`;
CREATE DATABASE IF NOT EXISTS `43-rio_grande_do_sul`;
CREATE DATABASE IF NOT EXISTS `50-mato_grosso_do_sul`;
CREATE DATABASE IF NOT EXISTS `51-mato_grosso`;
CREATE DATABASE IF NOT EXISTS `52-goias`;
CREATE DATABASE IF NOT EXISTS `53-distrito_federal`;
```

### Criando de Grupos de PermissÃµes no MySQL:

No MySQL, roles (funÃ§Ãµes ou papÃ©is) sÃ£o grupos de permissÃµes que vocÃª define uma vez e pode atribuir a vÃ¡rios usuÃ¡rios. Eles funcionam como â€œgrupos de acessoâ€, facilitando o gerenciamento de privilÃ©gios. Em vez de conceder privilÃ©gios individualmente a cada usuÃ¡rio, vocÃª define tudo no role. Se precisar incluir um novo privilÃ©gio (ex.: UPDATE) para todos que jÃ¡ tÃªm o role, basta atualizar o role uma vez.

Como criar uma regra no MySQL utilizando SQL-DCL

``` sql
CREATE ROLE 'nome_grupo';
```

onde, obviamente, *nome_grupo* Ã© o nome do grupo a ser criado.

Exemplo 1:

Crie um grupo chamado *norte* para associar todas as unidades da federaÃ§Ã£o da regiÃ£o norte do Brasil:

``` sql
CREATE ROLE 'norte';
```

Exemplo 2:

Crie um grupos para associar todas as unidades da federaÃ§Ã£o de todas as regiÃµes do Brasil:

``` sql
-- ===========================================
-- CriaÃ§Ã£o de roles para as 5 regiÃµes do Brasil
-- ===========================================

CREATE ROLE 'norte';
CREATE ROLE 'nordeste';
CREATE ROLE 'centro_oeste';
CREATE ROLE 'sudeste';
CREATE ROLE 'sul';

-- ===========================================
/*
Concedendo privilÃ©gios de leitura (SELECT) a cada grupo criado
*/
-- ===========================================

GRANT SELECT ON *.* TO 'norte';
GRANT SELECT ON *.* TO 'nordeste';
GRANT SELECT ON *.* TO 'centro_oeste';
GRANT SELECT ON *.* TO 'sudeste';
GRANT SELECT ON *.* TO 'sul';

-- ===========================================
-- Para atribuir um role a um usuÃ¡rio:
-- ===========================================
-- GRANT 'norte' TO 'usuario_exemplo'@'%';
-- SET DEFAULT ROLE 'norte' TO 'usuario_exemplo'@'%';
```

## Fazendo tudo funcionar: Colocando usuÃ¡rios em grupos e concedendo a estes acesso a Esquemas de Banco de Dados:

### Associando os esquemas que representam cada estado a cada grupo (que representa cada regiÃ§Ã£o):

``` sql
-- ================================================
-- AssociaÃ§Ã£o dos esquemas (databases) aos roles
-- Roles criadas previamente:
--   norte, nordeste, centro_oeste, sudeste, sul
-- ================================================

-- >>>>> REGIÃƒO NORTE >>>>>>>>>>>>>>

GRANT ALL PRIVILEGES ON `11-rondonia`.*       TO 'norte';
GRANT ALL PRIVILEGES ON `12-acre`.*           TO 'norte';
GRANT ALL PRIVILEGES ON `13-amazonas`.*       TO 'norte';
GRANT ALL PRIVILEGES ON `14-roraima`.*        TO 'norte';
GRANT ALL PRIVILEGES ON `15-para`.*           TO 'norte';
GRANT ALL PRIVILEGES ON `16-amapa`.*          TO 'norte';
GRANT ALL PRIVILEGES ON `17-tocantins`.*      TO 'norte';

-- >>>>> REGIÃƒO NORDESTE >>>>>>>>>>>>>>

GRANT ALL PRIVILEGES ON `21-maranhao`.*            TO 'nordeste';
GRANT ALL PRIVILEGES ON `22-piaui`.*               TO 'nordeste';
GRANT ALL PRIVILEGES ON `23-ceara`.*               TO 'nordeste';
GRANT ALL PRIVILEGES ON `24-rio_grande_do_norte`.* TO 'nordeste';
GRANT ALL PRIVILEGES ON `25-paraiba`.*             TO 'nordeste';
GRANT ALL PRIVILEGES ON `26-pernambuco`.*          TO 'nordeste';
GRANT ALL PRIVILEGES ON `27-alagoas`.*             TO 'nordeste';
GRANT ALL PRIVILEGES ON `28-sergipe`.*             TO 'nordeste';
GRANT ALL PRIVILEGES ON `29-bahia`.*               TO 'nordeste';

-- >>>>> REGIÃƒO CENTRO_OESTE >>>>>>>>>>>>>>

GRANT ALL PRIVILEGES ON `50-mato_grosso_do_sul`.* TO 'centro_oeste';
GRANT ALL PRIVILEGES ON `51-mato_grosso`.*       TO 'centro_oeste';
GRANT ALL PRIVILEGES ON `52-goias`.*             TO 'centro_oeste';
GRANT ALL PRIVILEGES ON `53-distrito_federal`.*  TO 'centro_oeste';

-- >>>>> REGIÃƒO SUDESTE >>>>>>>>>>>>>>

GRANT ALL PRIVILEGES ON `31-minas_gerais`.*   TO 'sudeste';
GRANT ALL PRIVILEGES ON `32-espiritosanto`.*  TO 'sudeste';
GRANT ALL PRIVILEGES ON `33-rio_de_janeiro`.* TO 'sudeste';
GRANT ALL PRIVILEGES ON `35-sao_paulo`.*      TO 'sudeste';

-- >>>>> REGIÃƒO SUL >>>>>>>>>>>>>>

GRANT ALL PRIVILEGES ON `41-parana`.*            TO 'sul';
GRANT ALL PRIVILEGES ON `42-santa_catarina`.*    TO 'sul';
GRANT ALL PRIVILEGES ON `43-rio_grande_do_sul`.* TO 'sul';
```

### Associando associando alunos a cada grupo (regiÃ£o):

| Role (grupo) |     UsuÃ¡rios (login)      |
|:------------:|:-------------------------:|
|    norte     |     f362bf0, r536fa6      |
|   nordeste   |     h756960, r8133g7      |
| centro_oeste |     r837aa0, h714419      |
|   sudeste    |     r854124, n0296a6      |
|     sul      | h788986, h77gii5, f3648i0 |

#### RegiÃ£o Norte

```{plantuml aula_04-Exemplo-01-grupos-01, plantuml.path="images"}
@startuml


folder 11rondonia [
----
Esquema <b>11-rondonia
========
Grupo <b>Norte
========
* <b>f362bf0</b> â€“ Bruno Antonio Marques
* <b>r536fa6</b> â€“ Caio Cesar Balbino Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

folder 12acre [
----
Esquema <b>12-acre
========
Grupo <b>Norte
========
* <b>f362bf0</b> â€“ Bruno Antonio Marques
* <b>r536fa6</b> â€“ Caio Cesar Balbino Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]


@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-02, plantuml.path="images"}
@startuml


folder 13amazonas [
----
Esquema <b>13-amazonas
========
Grupo <b>Norte
========
* <b>f362bf0</b> â€“ Bruno Antonio Marques
* <b>r536fa6</b> â€“ Caio Cesar Balbino Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]




folder 14roraima [
----
Esquema <b>14-roraima
========
Grupo <b>Norte
========
* <b>f362bf0</b> â€“ Bruno Antonio Marques
* <b>r536fa6</b> â€“ Caio Cesar Balbino Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-03, plantuml.path="images"}
@startuml


folder 15para [
----
Esquema <b>15-para
========
Grupo <b>Norte
========
* <b>f362bf0</b> â€“ Bruno Antonio Marques
* <b>r536fa6</b> â€“ Caio Cesar Balbino Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

folder 16amapa [
----
Esquema <b>16-amapa
========
Grupo <b>Norte
========
* <b>f362bf0</b> â€“ Bruno Antonio Marques
* <b>r536fa6</b> â€“ Caio Cesar Balbino Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-04, plantuml.path="images"}
@startuml


folder 17tocantins [
----
Esquema <b>17-tocantins
========
Grupo <b>Norte
========
* <b>f362bf0</b> â€“ Bruno Antonio Marques
* <b>r536fa6</b> â€“ Caio Cesar Balbino Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]


@enduml
```

#### RegiÃ£o Nordeste

```{plantuml aula_04-Exemplo-01-grupos-05, plantuml.path="images"}
@startuml


folder 21maranhao [
----
Esquema <b>21-maranhao
========
Grupo <b>Nordeste
========
* <b>h756960</b> â€“ Heder Rodrigues Da Silva
* <b>r8133g7</b> â€“ Ãtalo Kevin Rodrigues Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

folder 22piaui [
----
Esquema <b>22-piaui
========
Grupo <b>Nordeste
========
* <b>h756960</b> â€“ Heder Rodrigues Da Silva
* <b>r8133g7</b> â€“ Ãtalo Kevin Rodrigues Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-06, plantuml.path="images"}
@startuml


folder 23ceara [
----
Esquema <b>23-ceara
========
Grupo <b>Nordeste
========
* <b>h756960</b> â€“ Heder Rodrigues Da Silva
* <b>r8133g7</b> â€“ Ãtalo Kevin Rodrigues Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]



folder 24riograndedonorte [
----
Esquema <b>24-rio_grande_do_norte
========
Grupo <b>Nordeste
========
* <b>h756960</b> â€“ Heder Rodrigues Da Silva
* <b>r8133g7</b> â€“ Ãtalo Kevin Rodrigues Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-07, plantuml.path="images"}
@startuml


folder 25paraiba [
----
Esquema <b>25-paraiba
========
Grupo <b>Nordeste
========
* <b>h756960</b> â€“ Heder Rodrigues Da Silva
* <b>r8133g7</b> â€“ Ãtalo Kevin Rodrigues Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

folder 26pernambuco [
----
Esquema <b>26-pernambuco
========
Grupo <b>Nordeste
========
* <b>h756960</b> â€“ Heder Rodrigues Da Silva
* <b>r8133g7</b> â€“ Ãtalo Kevin Rodrigues Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-08, plantuml.path="images"}
@startuml

folder 27alagoas [
----
Esquema <b>27-alagoas
========
Grupo <b>Nordeste
========
* <b>h756960</b> â€“ Heder Rodrigues Da Silva
* <b>r8133g7</b> â€“ Ãtalo Kevin Rodrigues Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

folder 28sergipe [
----
Esquema <b>28-sergipe
========
Grupo <b>Nordeste
========
* <b>h756960</b> â€“ Heder Rodrigues Da Silva
* <b>r8133g7</b> â€“ Ãtalo Kevin Rodrigues Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-09, plantuml.path="images"}
@startuml

folder 29bahia [
----
Esquema <b>29-bahia
========
Grupo <b>Nordeste
========
* <b>h756960</b> â€“ Heder Rodrigues Da Silva
* <b>r8133g7</b> â€“ Ãtalo Kevin Rodrigues Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]


@enduml
```

#### RegiÃ£o Centro-Oeste

```{plantuml aula_04-Exemplo-01-grupos-10, plantuml.path="images"}
@startuml

folder 50matogrossodosul [
----
Esquema <b>50-mato_grosso_do_sul
========
Grupo <b>Centro-Oeste
========
* <b>r837aa0</b> â€“ Lucas Souza Rodrigues
* <b>h714419</b> â€“ Marcos Paulo Cordeiro Goes
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

folder 51matogrosso [
----
Esquema <b>51-mato_grosso
========
Grupo <b>Centro-Oeste
========
* <b>r837aa0</b> â€“ Lucas Souza Rodrigues
* <b>h714419</b> â€“ Marcos Paulo Cordeiro Goes
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-11, plantuml.path="images"}
@startuml

folder 52goias [
----
Esquema <b>52-goias
========
Grupo <b>Centro-Oeste
========
* <b>r837aa0</b> â€“ Lucas Souza Rodrigues
* <b>h714419</b> â€“ Marcos Paulo Cordeiro Goes
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]



folder 53distritofederal [
----
Esquema <b>53-distrito_federal
========
Grupo <b>Centro-Oeste
========
* <b>r837aa0</b> â€“ Lucas Souza Rodrigues
* <b>h714419</b> â€“ Marcos Paulo Cordeiro Goes
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

@enduml
```

#### RegiÃ£o Sudeste

```{plantuml aula_04-Exemplo-01-grupos-12, plantuml.path="images"}
@startuml

folder 31minasgerais [
----
Esquema <b>31-minas_gerais
========
Grupo <b>Sudeste
========
* <b>r854124</b> â€“ Ramon Borges De Holanda
* <b>n0296a6</b> â€“ Bryan Lucena Barbosa Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

folder 32espiritosanto [
----
Esquema <b>32-espiritosanto
========
Grupo <b>Sudeste
========
* <b>r854124</b> â€“ Ramon Borges De Holanda
* <b>n0296a6</b> â€“ Bryan Lucena Barbosa Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]


@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-13, plantuml.path="images"}
@startuml

folder 33riodejaneiro [
----
Esquema <b>33-rio_de_janeiro
========
Grupo <b>Sudeste
========
* <b>r854124</b> â€“ Ramon Borges De Holanda
* <b>n0296a6</b> â€“ Bryan Lucena Barbosa Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

folder 35saopaulo [
----
Esquema <b>35-sao_paulo
========
Grupo <b>Sudeste
========
* <b>r854124</b> â€“ Ramon Borges De Holanda
* <b>n0296a6</b> â€“ Bryan Lucena Barbosa Da Silva
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]


@enduml
```

#### RegiÃ£o Sul

```{plantuml aula_04-Exemplo-01-grupos-15, plantuml.path="images"}
@startuml

folder 41parana [
----
Esquema <b>41-parana
========
Grupo <b>Sul
========
* <b>h788986</b> â€“ Igor Soares Lima Da Cunha
* <b>h77gii5</b> â€“ Jessica Cristina De S Silva
* <b>f3648i0</b> â€“ Maysa Kelly Dos Santos Freitas
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

folder 42santacatarina [
----
Esquema <b>42-santa_catarina
========
Grupo <b>Sul
========
* <b>h788986</b> â€“ Igor Soares Lima Da Cunha
* <b>h77gii5</b> â€“ Jessica Cristina De S Silva
* <b>f3648i0</b> â€“ Maysa Kelly Dos Santos Freitas
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]

@enduml
```

```{plantuml aula_04-Exemplo-01-grupos-16, plantuml.path="images"}
@startuml

folder 43riograndedosul [
----
Esquema <b>43-rio_grande_do_sul
========
Grupo <b>Sul
========
* <b>h788986</b> â€“ Igor Soares Lima Da Cunha
* <b>h77gii5</b> â€“ Jessica Cristina De S Silva
* <b>f3648i0</b> â€“ Maysa Kelly Dos Santos Freitas
----
PrivilÃ©gios SQL-DML
----
* Ler (SELECT)
* Inserir (INSERT)
* Alterar (UPDATE)
* Remover (DELETE)
----
PrivilÃ©gios SQL-DDL
----
* Criar tabela (CREATE)
* Alterar tabela (ALTER)
* Apagar tabela (DROP)
]


@enduml
```

### Associando usuÃ¡rios aos grupos

``` sql
-- =========================================
-- AssociaÃ§Ã£o de usuÃ¡rios aos roles (grupos)
-- =========================================

-- Grupo Norte
GRANT 'norte' TO 'f362bf0'@'%';
GRANT 'norte' TO 'r536fa6'@'%';

-- Grupo Nordeste
GRANT 'nordeste' TO 'h756960'@'%';
GRANT 'nordeste' TO 'r8133g7'@'%';

-- Grupo Centro-Oeste
GRANT 'centro_oeste' TO 'r837aa0'@'%';
GRANT 'centro_oeste' TO 'h714419'@'%';

-- Grupo Sudeste
GRANT 'sudeste' TO 'r854124'@'%';
GRANT 'sudeste' TO 'n0296a6'@'%';

-- Grupo Sul
GRANT 'sul' TO 'h788986'@'%';
GRANT 'sul' TO 'h77gii5'@'%';
GRANT 'sul' TO 'f3648i0'@'%';

-- (Opcional) Definir cada role como padrÃ£o para o usuÃ¡rio
SET DEFAULT ROLE ALL TO
    'f362bf0'@'%',
    'r536fa6'@'%',
    'h756960'@'%',
    'r8133g7'@'%',
    'r837aa0'@'%',
    'h714419'@'%',
    'r854124'@'%',
    'n0296a6'@'%',
    'h788986'@'%',
    'h77gii5'@'%',
    'f3648i0'@'%';
```

### Concedendo privilÃ©gios aos grupos:

``` sql
-- ============================================
-- NORTE lÃª os demais grupos (Nordeste, Centro-Oeste, Sudeste, Sul)
-- ============================================
GRANT SELECT ON `21-maranhao`.*            TO 'norte';
GRANT SELECT ON `22-piaui`.*               TO 'norte';
GRANT SELECT ON `23-ceara`.*               TO 'norte';
GRANT SELECT ON `24-rio_grande_do_norte`.* TO 'norte';
GRANT SELECT ON `25-paraiba`.*             TO 'norte';
GRANT SELECT ON `26-pernambuco`.*          TO 'norte';
GRANT SELECT ON `27-alagoas`.*             TO 'norte';
GRANT SELECT ON `28-sergipe`.*             TO 'norte';
GRANT SELECT ON `29-bahia`.*               TO 'norte';
GRANT SELECT ON `50-mato_grosso_do_sul`.*  TO 'norte';
GRANT SELECT ON `51-mato_grosso`.*        TO 'norte';
GRANT SELECT ON `52-goias`.*              TO 'norte';
GRANT SELECT ON `53-distrito_federal`.*   TO 'norte';
GRANT SELECT ON `31-minas_gerais`.*       TO 'norte';
GRANT SELECT ON `32-espiritosanto`.*      TO 'norte';
GRANT SELECT ON `33-rio_de_janeiro`.*     TO 'norte';
GRANT SELECT ON `35-sao_paulo`.*          TO 'norte';
GRANT SELECT ON `41-parana`.*             TO 'norte';
GRANT SELECT ON `42-santa_catarina`.*     TO 'norte';
GRANT SELECT ON `43-rio_grande_do_sul`.*  TO 'norte';

-- ============================================
-- NORDESTE lÃª os demais grupos (Norte, Centro-Oeste, Sudeste, Sul)
-- ============================================
GRANT SELECT ON `11-rondonia`.*           TO 'nordeste';
GRANT SELECT ON `12-acre`.*               TO 'nordeste';
GRANT SELECT ON `13-amazonas`.*           TO 'nordeste';
GRANT SELECT ON `14-roraima`.*            TO 'nordeste';
GRANT SELECT ON `15-para`.*               TO 'nordeste';
GRANT SELECT ON `16-amapa`.*              TO 'nordeste';
GRANT SELECT ON `17-tocantins`.*          TO 'nordeste';
GRANT SELECT ON `50-mato_grosso_do_sul`.* TO 'nordeste';
GRANT SELECT ON `51-mato_grosso`.*       TO 'nordeste';
GRANT SELECT ON `52-goias`.*             TO 'nordeste';
GRANT SELECT ON `53-distrito_federal`.*  TO 'nordeste';
GRANT SELECT ON `31-minas_gerais`.*      TO 'nordeste';
GRANT SELECT ON `32-espiritosanto`.*     TO 'nordeste';
GRANT SELECT ON `33-rio_de_janeiro`.*    TO 'nordeste';
GRANT SELECT ON `35-sao_paulo`.*         TO 'nordeste';
GRANT SELECT ON `41-parana`.*            TO 'nordeste';
GRANT SELECT ON `42-santa_catarina`.*    TO 'nordeste';
GRANT SELECT ON `43-rio_grande_do_sul`.* TO 'nordeste';

-- ============================================
-- CENTRO-OESTE lÃª os demais grupos (Norte, Nordeste, Sudeste, Sul)
-- ============================================
GRANT SELECT ON `11-rondonia`.*           TO 'centro_oeste';
GRANT SELECT ON `12-acre`.*               TO 'centro_oeste';
GRANT SELECT ON `13-amazonas`.*           TO 'centro_oeste';
GRANT SELECT ON `14-roraima`.*            TO 'centro_oeste';
GRANT SELECT ON `15-para`.*               TO 'centro_oeste';
GRANT SELECT ON `16-amapa`.*              TO 'centro_oeste';
GRANT SELECT ON `17-tocantins`.*          TO 'centro_oeste';
GRANT SELECT ON `21-maranhao`.*           TO 'centro_oeste';
GRANT SELECT ON `22-piaui`.*              TO 'centro_oeste';
GRANT SELECT ON `23-ceara`.*              TO 'centro_oeste';
GRANT SELECT ON `24-rio_grande_do_norte`.* TO 'centro_oeste';
GRANT SELECT ON `25-paraiba`.*            TO 'centro_oeste';
GRANT SELECT ON `26-pernambuco`.*         TO 'centro_oeste';
GRANT SELECT ON `27-alagoas`.*            TO 'centro_oeste';
GRANT SELECT ON `28-sergipe`.*            TO 'centro_oeste';
GRANT SELECT ON `29-bahia`.*              TO 'centro_oeste';
GRANT SELECT ON `31-minas_gerais`.*       TO 'centro_oeste';
GRANT SELECT ON `32-espiritosanto`.*      TO 'centro_oeste';
GRANT SELECT ON `33-rio_de_janeiro`.*     TO 'centro_oeste';
GRANT SELECT ON `35-sao_paulo`.*          TO 'centro_oeste';
GRANT SELECT ON `41-parana`.*             TO 'centro_oeste';
GRANT SELECT ON `42-santa_catarina`.*     TO 'centro_oeste';
GRANT SELECT ON `43-rio_grande_do_sul`.*  TO 'centro_oeste';

-- ============================================
-- SUDESTE lÃª os demais grupos (Norte, Nordeste, Centro-Oeste, Sul)
-- ============================================
GRANT SELECT ON `11-rondonia`.*           TO 'sudeste';
GRANT SELECT ON `12-acre`.*               TO 'sudeste';
GRANT SELECT ON `13-amazonas`.*           TO 'sudeste';
GRANT SELECT ON `14-roraima`.*            TO 'sudeste';
GRANT SELECT ON `15-para`.*               TO 'sudeste';
GRANT SELECT ON `16-amapa`.*              TO 'sudeste';
GRANT SELECT ON `17-tocantins`.*          TO 'sudeste';
GRANT SELECT ON `21-maranhao`.*           TO 'sudeste';
GRANT SELECT ON `22-piaui`.*              TO 'sudeste';
GRANT SELECT ON `23-ceara`.*              TO 'sudeste';
GRANT SELECT ON `24-rio_grande_do_norte`.* TO 'sudeste';
GRANT SELECT ON `25-paraiba`.*            TO 'sudeste';
GRANT SELECT ON `26-pernambuco`.*         TO 'sudeste';
GRANT SELECT ON `27-alagoas`.*            TO 'sudeste';
GRANT SELECT ON `28-sergipe`.*            TO 'sudeste';
GRANT SELECT ON `29-bahia`.*              TO 'sudeste';
GRANT SELECT ON `50-mato_grosso_do_sul`.* TO 'sudeste';
GRANT SELECT ON `51-mato_grosso`.*       TO 'sudeste';
GRANT SELECT ON `52-goias`.*             TO 'sudeste';
GRANT SELECT ON `53-distrito_federal`.*  TO 'sudeste';
GRANT SELECT ON `41-parana`.*            TO 'sudeste';
GRANT SELECT ON `42-santa_catarina`.*    TO 'sudeste';
GRANT SELECT ON `43-rio_grande_do_sul`.* TO 'sudeste';

-- ============================================
-- SUL lÃª os demais grupos (Norte, Nordeste, Centro-Oeste, Sudeste)
-- ============================================
GRANT SELECT ON `11-rondonia`.*           TO 'sul';
GRANT SELECT ON `12-acre`.*               TO 'sul';
GRANT SELECT ON `13-amazonas`.*           TO 'sul';
GRANT SELECT ON `14-roraima`.*            TO 'sul';
GRANT SELECT ON `15-para`.*               TO 'sul';
GRANT SELECT ON `16-amapa`.*              TO 'sul';
GRANT SELECT ON `17-tocantins`.*          TO 'sul';
GRANT SELECT ON `21-maranhao`.*           TO 'sul';
GRANT SELECT ON `22-piaui`.*              TO 'sul';
GRANT SELECT ON `23-ceara`.*              TO 'sul';
GRANT SELECT ON `24-rio_grande_do_norte`.* TO 'sul';
GRANT SELECT ON `25-paraiba`.*            TO 'sul';
GRANT SELECT ON `26-pernambuco`.*         TO 'sul';
GRANT SELECT ON `27-alagoas`.*            TO 'sul';
GRANT SELECT ON `28-sergipe`.*            TO 'sul';
GRANT SELECT ON `29-bahia`.*              TO 'sul';
GRANT SELECT ON `50-mato_grosso_do_sul`.* TO 'sul';
GRANT SELECT ON `51-mato_grosso`.*       TO 'sul';
GRANT SELECT ON `52-goias`.*             TO 'sul';
GRANT SELECT ON `53-distrito_federal`.*  TO 'sul';
GRANT SELECT ON `31-minas_gerais`.*      TO 'sul';
GRANT SELECT ON `32-espiritosanto`.*     TO 'sul';
GRANT SELECT ON `33-rio_de_janeiro`.*    TO 'sul';
GRANT SELECT ON `35-sao_paulo`.*         TO 'sul';
```

### Exemplo no MySQL

Exemplo 01

Considere o cenÃ¡rio: um administrador de banco de dados irÃ¡ criar uma tabela chamada **clientes** com cpf, nome e data_nascimento. Essa tabela deverÃ¡ ficar no esquema **compras** e serÃ¡ acessada com **todos os privilÃ©gios** pelo usuÃ¡rio **aluno**. Considere que nosso SGBD Ã© o MySQL 9. faÃ§a passo-a-passo os cÃ³digos SQL para que o ambiente descrito seja gerado.

#### Passo 1 - Criar o esquema de Banco de Dados "compras"

``` sql
CREATE DATABASE IF NOT EXISTS compras
  DEFAULT CHARACTER SET utf8mb4
  DEFAULT COLLATE utf8mb4_0900_ai_ci;
```

#### Passo 2 - Criar o usuÃ¡rio "aluno"

``` sql
-- Apenas local:
CREATE USER IF NOT EXISTS 'aluno'@'localhost' IDENTIFIED BY 'TroqueEstaSenha!2025';

-- (Opcional) Acesso pela rede/WAN:
CREATE USER IF NOT EXISTS 'aluno'@'%' IDENTIFIED BY 'TroqueEstaSenha!2025';
```

#### Passo 2 - Conceder ao usuÃ¡rio "aluno" privilÃ©gios sobre todas os objetos (tabelas, views, gatilhos, Ã­ndices) do esquema "compras"

``` sql
-- Para acesso local:
GRANT ALL PRIVILEGES ON compras.* TO 'aluno'@'localhost';

-- (Opcional) Para acesso via rede:
GRANT ALL PRIVILEGES ON compras.* TO 'aluno'@'%';

-- Tornar os privilÃ©gios efetivos (costume; no MySQL moderno aplica na hora):
FLUSH PRIVILEGES;
```

#### Passo 3 - Criar a tabela "clientes" dentro do esquema "compras"

``` sql
USE compras;

CREATE TABLE IF NOT EXISTS clientes (
  cpf            CHAR(11)     NOT NULL,
  nome           VARCHAR(120) NOT NULL,
  data_nascimento DATE        NOT NULL,
  CONSTRAINT pk_clientes PRIMARY KEY (cpf)
) ENGINE=InnoDB;
```

### Exemplo no PostGreSQL

Exemplo 03

Considere o cenÃ¡rio: um administrador de banco de dados irÃ¡ criar uma tabela chamada **clientes** com cpf, nome e data_nascimento. Essa tabela deverÃ¡ ficar no esquema **compras** e serÃ¡ acessada com **todos os privilÃ©gios** pelo usuÃ¡rio **aluno**. Considere que nosso SGBD Ã© o Postgresql 15. faÃ§a passo-a-passo os cÃ³digos SQL para que o ambiente descrito seja gerado.

#### Passo 0 - Crie um Banco de Dados "sistema_compras"

``` sql
CREATE DATABASE sistema_compras
    WITH OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'pt_BR.UTF-8'
    LC_CTYPE = 'pt_BR.UTF-8'
    TEMPLATE = template0;
```

#### Passo 1 - Criar o esquema de Banco de Dados "compras"

``` sql
CREATE SCHEMA IF NOT EXISTS compras AUTHORIZATION postgres;
```

#### Passo 2 - Criar o usuÃ¡rio "aluno"

``` sql
CREATE ROLE aluno WITH
    LOGIN
    PASSWORD 'TroqueEstaSenha!2025'
    NOSUPERUSER
    NOCREATEDB
    NOCREATEROLE
    INHERIT;
```

#### Passo 3 - Conceder ao usuÃ¡rio "aluno" privilÃ©gios sobre todas os objetos (tabelas, views, gatilhos, Ã­ndices) do esquema "compras"

``` sql
GRANT USAGE ON SCHEMA compras TO aluno;
GRANT CREATE ON SCHEMA compras TO aluno;
```

#### Passo 4 - Criar a tabela "clientes" dentro do esquema "compras"

``` sql
CREATE TABLE compras.clientes (
    cpf            CHAR(11)     PRIMARY KEY,
    nome           VARCHAR(120) NOT NULL,
    data_nascimento DATE        NOT NULL
);
```

#### Passo 5 - Conceder privilÃ©gios da tabela "clientes" do esquema "compras" para o usuÃ¡rio "aluno"

``` sql
GRANT ALL PRIVILEGES ON TABLE compras.clientes TO aluno;
```

## Feito

```{r Executa_pagina_aula_05, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}

rmarkdown::render("05-2026-03-17_Administracao_Gerenciamento-aula-01.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; 

utils::browseURL("docs/temporario.html")

```

<!--chapter:end:05-aula05/05-2026-03-17_Administracao_Gerenciamento-aula-01.Rmd-->

# AdministraÃ§Ã£o e Gerenciamento de Bancos de Dados
#### 25/08/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:05-aula05/05-2026-03-17_Administracao_Gerenciamento-exercicio-01.Rmd-->

# Banco de Dados: Uma AplicaÃ§Ã£o CRUD

#### 24/03/2026 {.unnumbered}

#### Professor MiguÃ©l Suares {.unnumbered}


## Feito

```{r Executa_pagina_aula_05_, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
rmarkdown::render("06-2026-03-24_Administracao_Gerenciamento-aula-02.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; utils::browseURL("docs/temporario.html")
```

<!--chapter:end:06-aula06/06-2026-03-24_Administracao_Gerenciamento-aula-02.Rmd-->

## ExercÃ­cios

#### 01/09/2025 {.unnumbered}

#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:06-aula06/06-2026-03-24_Administracao_Gerenciamento-exercicio-02.Rmd-->

# Banco de Dados: MySQL (MariaDB)
#### 08/09/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:07-aula07/07-2026-2026-04-07_MySQL-aula.Rmd-->

# Banco de Dados: MySQL (MariaDB)
#### 08/09/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:07-aula07/07-2026-2026-04-07_MySQL-exercicio.Rmd-->

# Banco de Dados: Postgres
#### 22/09/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:08-aula08/08-2026-2026-04-14_Postgres-aula.Rmd-->

# Banco de Dados: Postgres
#### 22/09/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:08-aula08/08-2026-2026-04-14_Postgres-exercicio.Rmd-->

# Banco de Dados: Uma AplicaÃ§Ã£o CRUD

#### 21/04/2026 {.unnumbered}

#### Professor MiguÃ©l Suares {.unnumbered}

## O que Ã© uma AplicaÃ§Ã£o CRUD?

Hoje vamos desenvolver um cadastro web simples e entender o que Ã© o acronimo C.R.U.D.

## Conceito de CRUD

**CRUD** Ã© um acrÃ´nimo para quatro operaÃ§Ãµes fundamentais que um sistema realiza sobre dados em um banco de dados:

![](images/2025-09-01/01-CRUD.jpg)

Essas quatro operaÃ§Ãµes compÃµem a base da maioria das **aplicaÃ§Ãµes web** que manipulam dados persistidos em um **SGBD** (Sistema Gerenciador de Banco de Dados).

------------------------------------------------------------------------

## O padrÃ£o de Design de Sistemas MVC (Model View Controller)

Uma aplicaÃ§Ã£o Cliente-Servidor (modelo 2 camadas) geralmente segue o **padrÃ£o MVC** â€” **Model, View, Controller**:

![](images/2025-09-01/03-MVC.jpg)

## Construindo uma aplicaÃ§Ã£o CRUD para interfacear com a tabela "Pessoa"

Considere o Diagrama Entidade-Relacionamento abaixo:

```{plantuml aula-05-Exemplo-01-continuaÃ§Ã£o, plantuml.path="images"}
@startchen
title Diagrama ER â€” Entidade Pessoa (Peter Chen)
left to right direction

entity PESSOAS {
  cpf <<key>>
  nome
  endereco
  data_nascimento
  foto
}

@endchen

```

Vamos Converte-lo para o Modelo FÃ­sico-Relacional em linguagem SQL:

### RepresentaÃ§Ã£o grÃ¡fica no modelo FÃ­sico-Relacional

Vamos agora representa-lo em linguagem SQL:

![](images/2025-09-01/02-TabelaPessoas.jpg)

## CriaÃ§Ã£o de uma aplicaÃ§Ã£o CRUD

Vamos criar um **microsas** (micro Software As A Service) , ou seja, um site para inserir informaÃ§Ãµes dentro da tabela acima.

![](images/2025-09-01/04-Aplicacao.jpg)

| InformaÃ§Ãµes de Projeto | Tecnologias utilizadas no projeto CRUD |
|----|----|
| Servidor de banco de dados SGBD | MySQL 8 |
| UsuÃ¡rio de Banco de Dados | **pessoas_user** |
| De onde pode ser acessado | Apenas MÃ¡quina Local (localhost) |
| Esquema de Banco de Dados | **pessoasdb** |
| Servidor de AplicaÃ§Ã£o | Python 3 |
| Cliente da AplicaÃ§Ã£o | HTML + Javascript |
| Tecnologia de API | RestuFul |
| **Biblioteca de Javascript** para criar API **RestFul** | MÃ©todo **Fetch** (Biblioteca PadrÃ£o do JavaScript para API RestFul) |
| Formato de Dados entre Servidor de AplicaÃ§Ã£o e Cliente de AplicaÃ§Ã£o | **JSON** |

: Criando um Esquema de Banco de Dados - CRUD tabela Pessoas

#### CriaÃ§Ã£o de um usuÃ¡rio para Interagir com o Esquema de Banco de Dados

![](images/2025-09-01/05-Usuario.jpg)

``` sql

-- CRIAR USUÃRIO LOCAL E CONCEDER PERMISSÃ•ES
-- Troque 'MinhaSenhaForte' por uma senha segura


CREATE USER IF NOT EXISTS 'pessoas_user'@'localhost' IDENTIFIED BY 'MinhaSenhaForte';

GRANT ALL PRIVILEGES ON pessoasdb.* TO 'pessoas_user'@'localhost';

FLUSH PRIVILEGES;
```

#### CriaÃ§Ã£o do Esquema de Banco de Dados no SGBD MySQL

Agora vamos criar um esquema de Banco de Dados para abrigar nossa futura tabela:

![](images/2025-09-01/06-Esquema.jpg)

``` sql
-- 1) CRIAR BANCO (ajuste o nome se quiser)

CREATE DATABASE IF NOT EXISTS pessoasdb
  CHARACTER SET utf8mb4
  COLLATE utf8mb4_0900_ai_ci;

USE pessoasdb;
```

#### CriaÃ§Ã£o da Tabela "pessoas"

![](images/2025-09-01/07-Tabela_Pessoas.jpg)

``` sql

-- 3) TABELA 'pessoas' COMPATÃVEL COM O MODELO SQLAlchemy
--    - cpf: chave primÃ¡ria (String(14))
--    - nome, endereco, foto: TEXT
--    - data_nascimento: DATE

CREATE TABLE IF NOT EXISTS pessoas 
(
  cpf             VARCHAR(14)  NOT NULL,
  nome            TEXT         NOT NULL,
  endereco        TEXT         NOT NULL,
  data_nascimento DATE         NOT NULL,
  foto            TEXT         NULL,
  PRIMARY KEY (cpf)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


-- 4) (OPCIONAL) ÃNDICES PARA BUSCA
-- Seu endpoint usa LIKE/ILIKE em nome e cpf; cpf jÃ¡ Ã© PK.
-- Para acelerar buscas por nome com LIKE, crie um Ã­ndice por prefixo.
-- OBS: Ã­ndices em TEXT precisam de comprimento; 128 costuma ser um bom compromisso.

CREATE INDEX idx_pessoas_nome_prefix ON pessoas (nome(128));
```

#### Uma aplicaÃ§Ã£o Cliente Servidor no formato MVC (Model View Controller)

```{plantuml Aplicacao-MVC-CRUD-Pessoas-01, plantuml.path="images"}
@startuml
title AplicaÃ§Ã£o CRUD (Cliente + Servidor) â€” Componentes UML com padrÃ£o MVC

skinparam backgroundColor #FFFFFF
skinparam componentStyle rectangle
skinparam rectangle {
  RoundCorner 12
  BorderColor #333
}
skinparam database {
  BorderColor #333
  BackgroundColor #F9F9F9
}
left to right direction

' ==========================
' CLIENTE (MVC no Navegador)
' ==========================
package "Cliente Web (Browser)" <<Client>> {
  [View\nHTML + CSS] <<View>> as C_VIEW
  [Controller\nJS (handlers + UI)] <<Controller>> as C_CTRL
  [Model\nPessoaDTO] <<Model>> as C_MODEL
  [API Service\nfetch()] <<Service>> as C_API

  C_VIEW -down-> C_CTRL : eventos do usuÃ¡rio (click, submit)
  C_CTRL --> C_MODEL : cria/atualiza objetos
  C_CTRL --> C_API : invoca REST (fetch)
  C_API --> C_MODEL : (de)serializa JSON
}

' Interface REST exposta pelo servidor
interface "REST API\n(JSON/HTTP)" as I_REST

C_API -[#1F78B4]-> I_REST : HTTP/1.1\nGET/POST/PUT/DELETE\nContent-Type: application/json

' ==========================
' SERVIDOR (MVC no Backend)
' ==========================
package "Servidor de AplicaÃ§Ã£o (Python 3 / Flask)" <<Server>> {
  [View\n(na prÃ¡tica, sem templates)] <<View>> as S_VIEW
  [Controller\nFlask Routes /pessoas] <<Controller>> as S_CTRL
  [Service\nValidaÃ§Ã£o + Regra de NegÃ³cio] <<Service>> as S_SVC
  [Repository\nSQLAlchemy Session] <<Repository>> as S_REPO
  [Model\nPessoa (ORM)] <<Model>> as S_MODEL

  S_CTRL --> S_SVC : delega operaÃ§Ãµes CRUD
  S_SVC --> S_REPO : transaÃ§Ãµes, queries
  S_REPO --> S_MODEL : mapeamento ORM
}

I_REST -[#1F78B4]-> S_CTRL : JSON request/response\nCORS habilitado

' ==========================
' BANCO DE DADOS
' ==========================
database "MySQL 8" as DB {
  component "Schema: pessoasdb\nTabela: pessoas(cpf PK, nome, endereco, data_nascimento, foto)" as TBL
}

S_REPO -[#33A02C]-> DB : SQL (TCP 3306)\nuser=pessoas_user\nschema=pessoasdb
DB -down-> TBL

' ==========================
' NOTAS E CONSTRAINTS
' ==========================
note bottom of C_API
  Camada de integraÃ§Ã£o REST (fetch):
  â€¢ GET  /pessoas[?q=]
  â€¢ GET  /pessoas/{cpf}
  â€¢ POST /pessoas
  â€¢ PUT  /pessoas/{cpf}
  â€¢ DELETE /pessoas/{cpf}
end note

note right of S_SVC
  Regras de negÃ³cio / validaÃ§Ã£o:
  â€¢ Campos obrigatÃ³rios
  â€¢ Datas ISO (YYYY-MM-DD)
  â€¢ Conflitos (CPF duplicado)
  â€¢ Erros padronizados (422/404/409)
end note

note right of DB
  Acesso restrito a localhost.
  UsuÃ¡rio: pessoas_user
  Collation: utf8mb4_0900_ai_ci
end note

legend right
  <<View>>      Camada de apresentaÃ§Ã£o
  <<Controller>>Orquestra fluxo e aÃ§Ãµes
  <<Model>>     Dados/DTO/ORM
  <<Service>>   Regras de negÃ³cio/integraÃ§Ã£o
  <<Repository>>PersistÃªncia (ORM/SQL)
end legend

@enduml

```

#### CriaÃ§Ã£o do Servidor de AplicaÃ§Ã£o em Linguagem Python

Vejamos a representaÃ§Ã£o grÃ¡fica de nosso servidor utilizando o diagrama de classes da linguagem UML

```{plantuml Servidor-CRUD-Pessoas-01, plantuml.path="images"}

@startuml
title Diagrama de Classes â€” Servidor Flask + SQLAlchemy (MySQL)

skinparam backgroundColor #FFFFFF
skinparam class {
  BackgroundColor #FDFDFD
  BorderColor #333
  RoundCorner 10
}
skinparam package {
  BackgroundColor #FFFFFF
  BorderColor #555
}
left to right direction

package "API (Flask)" {
  class App <<FlaskApp>> {
    +run(debug: bool, port: int)
  }

  class PessoasController <<Controller>> {
    +listar() : Response
    +inserir() : Response
    +alterar(cpf: str) : Response
    +remover(cpf: str) : Response
    +buscar(cpf: str) : Response
  }

  class Helpers <<Helper>> {
    +to_dict(p: Pessoa) : dict
    +parse_date_iso(value: str | date) : date
  }
}

package "PersistÃªncia (SQLAlchemy)" {
  class Engine <<SQLAlchemy>> {
    +url : str
    +pool_pre_ping : bool
  }

  class SessionLocal <<SQLAlchemy>> {
    +__call__() : Session
  }

  class Session <<SQLAlchemy>>

  abstract class Base <<SQLAlchemy>>

  class Pessoa <<ORMModel>> {
    +__tablename__ = "pessoas"
    --
    +cpf : String(14)      <<PK>>
    +nome : Text
    +endereco : Text
    +data_nascimento : Date
    +foto : Text
  }
}

' ------------------ RelaÃ§Ãµes ------------------
Pessoa --|> Base
PessoasController ..> SessionLocal : usa
PessoasController ..> Pessoa : CRUD
Helpers ..> Pessoa
Helpers ..> date
App ..> PessoasController : registra rotas /pessoas
Engine o-- SessionLocal
App ..> Engine

note right of Engine
  MySQL 8 (localhost)
  URL:
  mysql+pymysql://
  pessoas_user:******@localhost:3306/pessoasdb
end note

@enduml

```

Para utilizar o MySQL como servidor, devemos instalar os drivers de MySQL para a biblioteca SQLAlchemy do Python atravÃ©s da ferramenta de linha de comando PIP do python

``` cmd
pip install flask flask-cors sqlalchemy "pymysql>=1.1"
# (ou use mysqlclient: pip install mysqlclient e troque o driver para mysql+mysqlclient)
```

Agora vamos escrever o script python que criarÃ¡ o servidor de aplicaÃ§Ã£o para interfacear nosso Cliente no Navegador e nossa tabela pessoas dentro do SGBD MySQL:

``` python
from flask import Flask, request, jsonify
from flask_cors import CORS
from sqlalchemy import create_engine, Column, String, Date, Text
from sqlalchemy.orm import sessionmaker, declarative_base
from datetime import date

# ------------------------------
# Flask + CORS
# ------------------------------
app = Flask(__name__)
CORS(app)  # em produÃ§Ã£o, restrinja as origens

# ------------------------------
# Banco de Dados MySQL (localhost)
# ------------------------------
# ParÃ¢metros do projeto:
#   SGBD: MySQL 8
#   Host: localhost
#   UsuÃ¡rio: pessoas_user
#   DB/Schema: pessoasdb
#   Tabela: pessoas
DATABASE_URL = "mysql+pymysql://pessoas_user:MinhaSenhaForte@localhost:3306/pessoasdb"

engine = create_engine(
    DATABASE_URL,
    pool_pre_ping=True,        # evita "MySQL server has gone away"
    future=True
)
SessionLocal = sessionmaker(bind=engine, autoflush=False, autocommit=False, future=True)
Base = declarative_base()

# ------------------------------
# Modelo Pessoa
# ------------------------------
class Pessoa(Base):
    __tablename__ = "pessoas"
    cpf = Column(String(14), primary_key=True)
    nome = Column(Text, nullable=False)
    endereco = Column(Text, nullable=False)
    data_nascimento = Column(Date, nullable=False)
    foto = Column(Text)  # Base64 ou URL

# Cria a tabela se nÃ£o existir (deve existir conforme seu script SQL)
Base.metadata.create_all(engine)

# ------------------------------
# Helpers
# ------------------------------
def to_dict(p: Pessoa):
    return {
        "cpf": p.cpf,
        "nome": p.nome,
        "endereco": p.endereco,
        "data_nascimento": p.data_nascimento.isoformat(),
        "foto": p.foto
    }

def parse_date_iso(value):
    if isinstance(value, date):
        return value
    return date.fromisoformat(value)  # espera "YYYY-MM-DD"

# ------------------------------
# CRUD
# ------------------------------

# Listar todas as pessoas ou pesquisar por termo (?q=)
@app.route('/pessoas', methods=['GET'])
def listar():
    termo = (request.args.get('q') or '').strip()
    with SessionLocal() as session:
        query = session.query(Pessoa)
        if termo:
            like = f"%{termo}%"
            # MySQL Ã© case-insensitive com collation *_ci; ilike Ã© traduzido para LIKE
            query = query.filter((Pessoa.nome.ilike(like)) | (Pessoa.cpf.ilike(like)))
        pessoas = query.order_by(Pessoa.nome.asc()).all()
        return jsonify([to_dict(p) for p in pessoas])

# Inserir nova pessoa
@app.route('/pessoas', methods=['POST'])
def inserir():
    dados = request.get_json(force=True)
    required = ['cpf', 'nome', 'endereco', 'data_nascimento']
    faltantes = [k for k in required if not dados.get(k)]
    if faltantes:
        return jsonify({"error": "Campos obrigatÃ³rios faltando", "fields": faltantes}), 422

    try:
        dn = parse_date_iso(dados['data_nascimento'])
    except Exception:
        return jsonify({"error": "data_nascimento invÃ¡lida. Use YYYY-MM-DD"}), 422

    with SessionLocal() as session:
        if session.query(Pessoa).filter_by(cpf=dados['cpf']).first():
            return jsonify({"error": "CPF jÃ¡ cadastrado"}), 409
        pessoa = Pessoa(
            cpf=dados['cpf'],
            nome=dados['nome'],
            endereco=dados['endereco'],
            data_nascimento=dn,
            foto=dados.get('foto')
        )
        session.add(pessoa)
        session.commit()
        session.refresh(pessoa)
        return jsonify(to_dict(pessoa)), 201

# Alterar pessoa (PUT)
@app.route('/pessoas/<cpf>', methods=['PUT'])
def alterar(cpf):
    dados = request.get_json(force=True)
    with SessionLocal() as session:
        pessoa = session.query(Pessoa).filter_by(cpf=cpf).first()
        if not pessoa:
            return jsonify({"error": "CPF nÃ£o encontrado"}), 404

        if 'nome' in dados and dados['nome'] is not None:
            pessoa.nome = dados['nome']
        if 'endereco' in dados and dados['endereco'] is not None:
            pessoa.endereco = dados['endereco']
        if 'data_nascimento' in dados and dados['data_nascimento'] is not None:
            try:
                pessoa.data_nascimento = parse_date_iso(dados['data_nascimento'])
            except Exception:
                return jsonify({"error": "data_nascimento invÃ¡lida. Use YYYY-MM-DD"}), 422
        if 'foto' in dados:
            pessoa.foto = dados['foto']

        session.commit()
        session.refresh(pessoa)
        return jsonify(to_dict(pessoa)), 200

# Remover pessoa
@app.route('/pessoas/<cpf>', methods=['DELETE'])
def remover(cpf):
    with SessionLocal() as session:
        pessoa = session.query(Pessoa).filter_by(cpf=cpf).first()
        if not pessoa:
            return jsonify({"error": "CPF nÃ£o encontrado"}), 404
        session.delete(pessoa)
        session.commit()
        return '', 204

# Buscar pessoa por CPF
@app.route('/pessoas/<cpf>', methods=['GET'])
def buscar(cpf):
    with SessionLocal() as session:
        pessoa = session.query(Pessoa).filter_by(cpf=cpf).first()
        if not pessoa:
            return jsonify({"error": "CPF nÃ£o encontrado"}), 404
        return jsonify(to_dict(pessoa))

# ------------------------------
# Inicia o servidor
# ------------------------------
if __name__ == '__main__':
    app.run(debug=True, port=5000)
```

#### CriaÃ§Ã£o do Cliente de AplicaÃ§Ã£o em HTML (Parte GrÃ¡fica) e Javascript (ProgramaÃ§Ã£o ExecutÃ¡vel)

Vamos verificar como Ã© o Diagrama de Classes do Cliente que vai conversar com o servidor que vimos anteriormente:

![](images/2025-09-01/09-cliente.jpg)

Agora vamos verificar o cÃ³digo-fonte.

Salve esse cÃ³digo em um arquivo chamado **cliente.html**, para poder abrir-lo no navegador, juntamente com o servidor rodando:

``` html
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Cadastro de Pessoas - Flask/MySQL</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; max-width: 980px; margin: 24px auto; }
  label { display: block; margin-top: 10px; }
  button { margin-top: 10px; margin-right: 6px; padding: 8px 12px; }
  table { border-collapse: collapse; width:100%; margin-top:20px; }
  th, td { border:1px solid #ddd; padding:8px; text-align:left; }
  img.thumb { width:60px; height:60px; object-fit:cover; border-radius:4px; }
  .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
</style>
</head>
<body>
<h1>Cadastro de Pessoas (Flask/MySQL)</h1>

<form id="formPessoa">
  <label>CPF (chave primÃ¡ria): <input id="cpf" required></label>
  <label>Nome: <input id="nome" required></label>
  <label>EndereÃ§o: <input id="endereco" required></label>
  <label>Data Nasc.: <input type="date" id="data_nascimento" required></label>
  <label>Foto: <input type="file" id="foto" accept="image/*"></label>

  <div class="row">
    <button type="button" id="btnInserir" onclick="inserir()">Inserir</button>
    <button type="button" id="btnAlterar" onclick="alterar()">Alterar</button>
    <button type="button" id="btnRemover" onclick="remover()">Remover</button>
  </div>
</form>

<h2>Pesquisar</h2>
<div class="row">
  <input id="pesquisa" placeholder="Digite nome ou CPF" style="flex:1">
  <button type="button" id="btnPesquisar" onclick="pesquisar()">Pesquisar</button>
  <button type="button" onclick="listar()">Listar tudo</button>
</div>

<table>
  <thead>
    <tr>
      <th>CPF</th><th>Foto</th><th>Nome</th>
      <th>EndereÃ§o</th><th>Nascimento</th>
    </tr>
  </thead>
  <tbody id="tabela"></tbody>
</table>

<script>
const API = 'http://localhost:5000/pessoas';

/* ---------- Helpers ---------- */
function setBusy(busy) {
  for (const id of ['btnInserir','btnAlterar','btnRemover','btnPesquisar']) {
    const el = document.getElementById(id);
    if (el) el.disabled = busy;
  }
}

function validaCampos() {
  const campos = ['cpf','nome','endereco','data_nascimento'];
  for (const id of campos) {
    const valor = document.getElementById(id).value.trim();
    if (!valor) {
      alert(`O campo "${id}" nÃ£o pode ficar em branco.`);
      return false;
    }
  }
  return true;
}

function getFotoBase64() {
  const file = document.getElementById('foto').files[0];
  if(!file) return Promise.resolve('');
  return new Promise((resolve,reject)=>{
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result);
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}

function coletaDados(base64Foto){
  return {
    cpf: document.getElementById('cpf').value.trim(),
    nome: document.getElementById('nome').value.trim(),
    endereco: document.getElementById('endereco').value.trim(),
    data_nascimento: document.getElementById('data_nascimento').value, // YYYY-MM-DD
    foto: base64Foto || ''
  };
}

async function readJsonSafe(res) {
  const ct = res.headers.get('content-type') || '';
  if (ct.includes('application/json')) {
    try { return await res.json(); } catch { return null; }
  }
  return null;
}

/* ---------- CRUD ---------- */
async function inserir() {
  if(!validaCampos()) return;
  setBusy(true);
  try {
    const base64 = await getFotoBase64();
    const pessoa = coletaDados(base64);

    const res = await fetch(API, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(pessoa)
    });
    const data = await readJsonSafe(res);
    if(res.ok) {
      alert('Inserido com sucesso!');
      listar();
      document.getElementById('formPessoa').reset();
    } else {
      alert('Erro: ' + (data?.error || res.statusText));
    }
  } catch (e) {
    alert('Falha ao inserir: ' + e.message);
  } finally {
    setBusy(false);
  }
}

async function alterar() {
  if(!validaCampos()) return;
  const cpf = document.getElementById('cpf').value.trim();
  setBusy(true);
  try {
    const base64 = await getFotoBase64();
    const novosDados = coletaDados();
    if (base64) novosDados.foto = base64;

    const res = await fetch(`${API}/${encodeURIComponent(cpf)}`, {
      method: 'PUT',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(novosDados)
    });
    const data = await readJsonSafe(res);
    if(res.ok) {
      alert('Alterado com sucesso!');
      listar();
    } else {
      alert('Erro: ' + (data?.error || res.statusText));
    }
  } catch (e) {
    alert('Falha ao alterar: ' + e.message);
  } finally {
    setBusy(false);
  }
}

async function remover() {
  const cpf = document.getElementById('cpf').value.trim();
  if(!cpf) return alert('Informe o CPF para remover.');
  if(!confirm('Confirma a exclusÃ£o?')) return;

  setBusy(true);
  try {
    const res = await fetch(`${API}/${encodeURIComponent(cpf)}`, {method:'DELETE'});
    // 204 => sem corpo; nÃ£o tente parsear JSON aqui
    if(res.status === 204) {
      alert('Removido com sucesso!');
      listar();
      return;
    }
    const data = await readJsonSafe(res);
    if(res.ok) {
      alert('Removido com sucesso!');
      listar();
    } else {
      alert('Erro: ' + (data?.error || res.statusText));
    }
  } catch (e) {
    alert('Falha ao remover: ' + e.message);
  } finally {
    setBusy(false);
  }
}

async function pesquisar() {
  const termo = document.getElementById('pesquisa').value.trim();
  setBusy(true);
  try {
    const url = termo ? `${API}?q=${encodeURIComponent(termo)}` : API;
    const res = await fetch(url);
    const data = await readJsonSafe(res);
    if(!res.ok) return alert('Falha na pesquisa: ' + (data?.error || res.statusText));
    preencheTabela(Array.isArray(data) ? data : (data?.items ?? []));
  } catch (e) {
    alert('Falha na pesquisa: ' + e.message);
  } finally {
    setBusy(false);
  }
}

async function listar() {
  setBusy(true);
  try {
    const res = await fetch(API);
    const data = await readJsonSafe(res);
    if(!res.ok) return alert('Falha ao listar: ' + (data?.error || res.statusText));
    preencheTabela(Array.isArray(data) ? data : (data?.items ?? []));
  } catch (e) {
    alert('Falha ao listar: ' + e.message);
  } finally {
    setBusy(false);
  }
}

/* ---------- UI ---------- */
function preencheTabela(lista){
  const tbody = document.getElementById('tabela');
  tbody.innerHTML = '';
  (lista || []).forEach(p=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${p.cpf}</td>
      <td>${p.foto ? `<img class="thumb" src="${p.foto}" alt="foto">` : ''}</td>
      <td>${p.nome}</td>
      <td>${p.endereco}</td>
      <td>${p.data_nascimento}</td>`;
    tr.onclick = () => {
      document.getElementById('cpf').value = p.cpf;
      document.getElementById('nome').value = p.nome;
      document.getElementById('endereco').value = p.endereco;
      document.getElementById('data_nascimento').value = p.data_nascimento;
    };
    tbody.appendChild(tr);
  });
}

listar();
</script>
</body>
</html>
```

### Resultado final:

#### Servidor de aplicaÃ§Ã£o Python "Restful" rodando

![](images/2025-09-01/10-servidor_rodando.jpg)

#### Cliente HTML + Javascript ( pÃ¡gina ESTÃTICA ) aberta no navegador

##### Passo 1 - Preencher dados no formulÃ¡rio do cliente

Vamos inserir dados de exemplo no "cliente WEB" abaixo

![](images/2025-09-01/11-Cliente_Vazio.jpg)

##### Passo 2 - Pressionar o BotÃ£o INSERIR

![](images/2025-09-01/11-Cliente_Vazio-02.jpg)

OBS: Na tela do servidor, Ã© possÃ­vel verificar as operaÃ§Ãµes HTTP Equivalentes ao SQL que foram executadas entre o Servidor e o Cliente

![](images/2025-09-01/10-servidor_rodando-01.jpg)

##### Passo 3 - Verificar se o "DBGRID" do cliente "espelhando" a linha da tabela "pessoas" no esquema "pessoasdb" do SQBG MySQL

![](images/2025-09-01/11-Cliente_03-Preenchido.jpg)

##### Passo 4 - Verificar na tabela pessoas a linha que o cliente preencheu atravÃ©s da API da aplicaÃ§Ã£o cliente/servidor

![](images/2025-09-01/12-Dados_no_SGBD.jpg)

## Feito

```{r Executa_pagina_aula_09_, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
rmarkdown::render("09-2026-2026-04-21_CRUD-1-aula.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; utils::browseURL("docs/temporario.html")
```

<!--chapter:end:09-aula09/09-2026-2026-04-21_CRUD-1-aula.Rmd-->

## ExercÃ­cios

#### 01/09/2025 {.unnumbered}

#### Professor MiguÃ©l Suares {.unnumbered}

### Banco de Dados utilizado nos exemplos de aplicaÃ§Ãµes abaixo

Crie o banco de dados abaixo em um servidor mysql 8 ou superior na sua mÃ¡quina antes de testar os exemplos abaixo:

``` SQL
-- 1) CRIAR BANCO (ajuste o nome se quiser)
CREATE DATABASE IF NOT EXISTS pessoasdb
  CHARACTER SET utf8mb4
  COLLATE utf8mb4_0900_ai_ci;

USE pessoasdb;

-- 2) (OPCIONAL) CRIAR USUÃRIO LOCAL E CONCEDER PERMISSÃ•ES
--    Troque 'MinhaSenhaForte' por uma senha segura
CREATE USER IF NOT EXISTS 'pessoas_user'@'localhost' IDENTIFIED BY 'MinhaSenhaForte';
GRANT ALL PRIVILEGES ON pessoasdb.* TO 'pessoas_user'@'localhost';
FLUSH PRIVILEGES;

-- 3) TABELA 'pessoas' COMPATÃVEL COM O MODELO SQLAlchemy
--    - cpf: chave primÃ¡ria (String(14))
--    - nome, endereco, foto: TEXT
--    - data_nascimento: DATE
CREATE TABLE IF NOT EXISTS pessoas (
  cpf             VARCHAR(14)  NOT NULL,
  nome            TEXT         NOT NULL,
  endereco        TEXT         NOT NULL,
  data_nascimento DATE         NOT NULL,
  foto            TEXT         NULL,
  PRIMARY KEY (cpf)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- 4) (OPCIONAL) ÃNDICES PARA BUSCA
-- Seu endpoint usa LIKE/ILIKE em nome e cpf; cpf jÃ¡ Ã© PK.
-- Para acelerar buscas por nome com LIKE, crie um Ã­ndice por prefixo.
-- OBS: Ã­ndices em TEXT precisam de comprimento; 128 costuma ser um bom compromisso.
CREATE INDEX idx_pessoas_nome_prefix ON pessoas (nome(128));
```

## Exemplo 01

servidor SUPABASE .... a fazer

## Exemplo 02 - SERVIDOR DE APLICAÃ‡ÃƒO PYTHON

![](images/clipboard-3666283714.png)

Neste exemplo, temos uma aplicaÃ§Ã£o cliente feita html e javascript

A interface do Cliente Ã© feita em HTML5

A conexÃ£o com o servidor Ã© feita pelo javascript incorporado no HTML:

CRUD no cliente Ã© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0

O servidor Restful Ã© feito em linguagem PYTHON

OBS: NÃƒO TEMOS CONTROLE DE SESSÃƒO DE CLIENTE IMPLEMENTADO.

``` cmd
python -m pip install --user --upgrade flask flask-cors sqlalchemy psycopg2-binary
```

### Servidor python

``` python
from flask import Flask, request, jsonify
from flask_cors import CORS
from sqlalchemy import create_engine, Column, String, Date, Text
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker

# ------------------------------
# ConfiguraÃ§Ã£o do Flask e CORS
# ------------------------------
app = Flask(__name__)
CORS(app)

# ------------------------------
# ConfiguraÃ§Ã£o do banco PostgreSQL
# ------------------------------
DATABASE_URL = "postgresql://postgres:MinhaSuperSenha@db.pbbtfwmydxmxdibmtbqq.supabase.co:5432/postgres"

engine = create_engine(DATABASE_URL)
SessionLocal = sessionmaker(bind=engine)
Base = declarative_base()

# ------------------------------
# Modelo Pessoa
# ------------------------------
class Pessoa(Base):
    __tablename__ = "pessoas"
    cpf = Column(String(14), primary_key=True)
    nome = Column(Text, nullable=False)
    endereco = Column(Text, nullable=False)
    data_nascimento = Column(Date, nullable=False)
    foto = Column(Text)  # Base64 ou URL

# Cria a tabela se nÃ£o existir
Base.metadata.create_all(engine)

# ------------------------------
# CRUD
# ------------------------------

# Listar todas as pessoas ou pesquisar por termo
@app.route('/pessoas', methods=['GET'])
def listar():
    termo = request.args.get('q', '').lower()
    session = SessionLocal()
    if termo:
        pessoas = session.query(Pessoa).filter(
            (Pessoa.nome.ilike(f"%{termo}%")) | (Pessoa.cpf.ilike(f"%{termo}%"))
        ).all()
    else:
        pessoas = session.query(Pessoa).all()
    session.close()
    return jsonify([{
        "cpf": p.cpf,
        "nome": p.nome,
        "endereco": p.endereco,
        "data_nascimento": p.data_nascimento.isoformat(),
        "foto": p.foto
    } for p in pessoas])

# Inserir nova pessoa
@app.route('/pessoas', methods=['POST'])
def inserir():
    dados = request.get_json()
    session = SessionLocal()
    if session.query(Pessoa).filter_by(cpf=dados['cpf']).first():
        session.close()
        return jsonify({"error": "CPF jÃ¡ cadastrado"}), 400
    pessoa = Pessoa(
        cpf=dados['cpf'],
        nome=dados['nome'],
        endereco=dados['endereco'],
        data_nascimento=dados['data_nascimento'],
        foto=dados.get('foto')
    )
    session.add(pessoa)
    session.commit()
    session.close()
    return jsonify({"message": "Inserido com sucesso"}), 201

# Alterar pessoa
@app.route('/pessoas/<cpf>', methods=['PUT'])
def alterar(cpf):
    dados = request.get_json()
    session = SessionLocal()
    pessoa = session.query(Pessoa).filter_by(cpf=cpf).first()
    if not pessoa:
        session.close()
        return jsonify({"error": "CPF nÃ£o encontrado"}), 404
    pessoa.nome = dados.get('nome', pessoa.nome)
    pessoa.endereco = dados.get('endereco', pessoa.endereco)
    pessoa.data_nascimento = dados.get('data_nascimento', pessoa.data_nascimento)
    pessoa.foto = dados.get('foto', pessoa.foto)
    session.commit()
    session.close()
    return jsonify({"message": "Alterado com sucesso"})

# Remover pessoa
@app.route('/pessoas/<cpf>', methods=['DELETE'])
def remover(cpf):
    session = SessionLocal()
    pessoa = session.query(Pessoa).filter_by(cpf=cpf).first()
    if not pessoa:
        session.close()
        return jsonify({"error": "CPF nÃ£o encontrado"}), 404
    session.delete(pessoa)
    session.commit()
    session.close()
    return jsonify({"message": "Removido com sucesso"})

# Buscar pessoa por CPF
@app.route('/pessoas/<cpf>', methods=['GET'])
def buscar(cpf):
    session = SessionLocal()
    pessoa = session.query(Pessoa).filter_by(cpf=cpf).first()
    session.close()
    if not pessoa:
        return jsonify({"error": "CPF nÃ£o encontrado"}), 404
    return jsonify({
        "cpf": pessoa.cpf,
        "nome": pessoa.nome,
        "endereco": pessoa.endereco,
        "data_nascimento": pessoa.data_nascimento.isoformat(),
        "foto": pessoa.foto
    })

# ------------------------------
# Inicia o servidor
# ------------------------------
if __name__ == '__main__':
    app.run(debug=True, port=5000)
```

servidor estarÃ¡ rodando na porta 5000 e EXPÃ•E A API de operaÃ§Ãµes na URI <http://localhost:5000/pessoas> sem senha

``` css
http://localhost:5000/pessoas
```

### Cliente HTML (conexÃ£o Restful)

crie o arquivo index.html e abra-o no navegador

``` html
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Cadastro de Pessoas - Flask/MySQL</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; max-width: 980px; margin: 24px auto; }
  label { display: block; margin-top: 10px; }
  button { margin-top: 10px; margin-right: 6px; padding: 8px 12px; }
  table { border-collapse: collapse; width:100%; margin-top:20px; }
  th, td { border:1px solid #ddd; padding:8px; text-align:left; }
  img.thumb { width:60px; height:60px; object-fit:cover; border-radius:4px; }
  .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
</style>
</head>
<body>
<h1>Cadastro de Pessoas (Flask/MySQL)</h1>

<form id="formPessoa">
  <label>CPF (chave primÃ¡ria): <input id="cpf" required></label>
  <label>Nome: <input id="nome" required></label>
  <label>EndereÃ§o: <input id="endereco" required></label>
  <label>Data Nasc.: <input type="date" id="data_nascimento" required></label>
  <label>Foto: <input type="file" id="foto" accept="image/*"></label>

  <div class="row">
    <button type="button" id="btnInserir" onclick="inserir()">Inserir</button>
    <button type="button" id="btnAlterar" onclick="alterar()">Alterar</button>
    <button type="button" id="btnRemover" onclick="remover()">Remover</button>
  </div>
</form>

<h2>Pesquisar</h2>
<div class="row">
  <input id="pesquisa" placeholder="Digite nome ou CPF" style="flex:1">
  <button type="button" id="btnPesquisar" onclick="pesquisar()">Pesquisar</button>
  <button type="button" onclick="listar()">Listar tudo</button>
</div>

<table>
  <thead>
    <tr>
      <th>CPF</th><th>Foto</th><th>Nome</th>
      <th>EndereÃ§o</th><th>Nascimento</th>
    </tr>
  </thead>
  <tbody id="tabela"></tbody>
</table>

<script>
const API = 'http://localhost:5000/pessoas';

/* ---------- Helpers ---------- */
function setBusy(busy) {
  for (const id of ['btnInserir','btnAlterar','btnRemover','btnPesquisar']) {
    const el = document.getElementById(id);
    if (el) el.disabled = busy;
  }
}

function validaCampos() {
  const campos = ['cpf','nome','endereco','data_nascimento'];
  for (const id of campos) {
    const valor = document.getElementById(id).value.trim();
    if (!valor) {
      alert(`O campo "${id}" nÃ£o pode ficar em branco.`);
      return false;
    }
  }
  return true;
}

function getFotoBase64() {
  const file = document.getElementById('foto').files[0];
  if(!file) return Promise.resolve('');
  return new Promise((resolve,reject)=>{
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result);
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}

function coletaDados(base64Foto){
  return {
    cpf: document.getElementById('cpf').value.trim(),
    nome: document.getElementById('nome').value.trim(),
    endereco: document.getElementById('endereco').value.trim(),
    data_nascimento: document.getElementById('data_nascimento').value, // YYYY-MM-DD
    foto: base64Foto || ''
  };
}

async function readJsonSafe(res) {
  const ct = res.headers.get('content-type') || '';
  if (ct.includes('application/json')) {
    try { return await res.json(); } catch { return null; }
  }
  return null;
}

/* ---------- CRUD ---------- */
async function inserir() {
  if(!validaCampos()) return;
  setBusy(true);
  try {
    const base64 = await getFotoBase64();
    const pessoa = coletaDados(base64);

    const res = await fetch(API, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(pessoa)
    });
    const data = await readJsonSafe(res);
    if(res.ok) {
      alert('Inserido com sucesso!');
      listar();
      document.getElementById('formPessoa').reset();
    } else {
      alert('Erro: ' + (data?.error || res.statusText));
    }
  } catch (e) {
    alert('Falha ao inserir: ' + e.message);
  } finally {
    setBusy(false);
  }
}

async function alterar() {
  if(!validaCampos()) return;
  const cpf = document.getElementById('cpf').value.trim();
  setBusy(true);
  try {
    const base64 = await getFotoBase64();
    const novosDados = coletaDados();
    if (base64) novosDados.foto = base64;

    const res = await fetch(`${API}/${encodeURIComponent(cpf)}`, {
      method: 'PUT',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(novosDados)
    });
    const data = await readJsonSafe(res);
    if(res.ok) {
      alert('Alterado com sucesso!');
      listar();
    } else {
      alert('Erro: ' + (data?.error || res.statusText));
    }
  } catch (e) {
    alert('Falha ao alterar: ' + e.message);
  } finally {
    setBusy(false);
  }
}

async function remover() {
  const cpf = document.getElementById('cpf').value.trim();
  if(!cpf) return alert('Informe o CPF para remover.');
  if(!confirm('Confirma a exclusÃ£o?')) return;

  setBusy(true);
  try {
    const res = await fetch(`${API}/${encodeURIComponent(cpf)}`, {method:'DELETE'});
    // 204 => sem corpo; nÃ£o tente parsear JSON aqui
    if(res.status === 204) {
      alert('Removido com sucesso!');
      listar();
      return;
    }
    const data = await readJsonSafe(res);
    if(res.ok) {
      alert('Removido com sucesso!');
      listar();
    } else {
      alert('Erro: ' + (data?.error || res.statusText));
    }
  } catch (e) {
    alert('Falha ao remover: ' + e.message);
  } finally {
    setBusy(false);
  }
}

async function pesquisar() {
  const termo = document.getElementById('pesquisa').value.trim();
  setBusy(true);
  try {
    const url = termo ? `${API}?q=${encodeURIComponent(termo)}` : API;
    const res = await fetch(url);
    const data = await readJsonSafe(res);
    if(!res.ok) return alert('Falha na pesquisa: ' + (data?.error || res.statusText));
    preencheTabela(Array.isArray(data) ? data : (data?.items ?? []));
  } catch (e) {
    alert('Falha na pesquisa: ' + e.message);
  } finally {
    setBusy(false);
  }
}

async function listar() {
  setBusy(true);
  try {
    const res = await fetch(API);
    const data = await readJsonSafe(res);
    if(!res.ok) return alert('Falha ao listar: ' + (data?.error || res.statusText));
    preencheTabela(Array.isArray(data) ? data : (data?.items ?? []));
  } catch (e) {
    alert('Falha ao listar: ' + e.message);
  } finally {
    setBusy(false);
  }
}

/* ---------- UI ---------- */
function preencheTabela(lista){
  const tbody = document.getElementById('tabela');
  tbody.innerHTML = '';
  (lista || []).forEach(p=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${p.cpf}</td>
      <td>${p.foto ? `<img class="thumb" src="${p.foto}" alt="foto">` : ''}</td>
      <td>${p.nome}</td>
      <td>${p.endereco}</td>
      <td>${p.data_nascimento}</td>`;
    tr.onclick = () => {
      document.getElementById('cpf').value = p.cpf;
      document.getElementById('nome').value = p.nome;
      document.getElementById('endereco').value = p.endereco;
      document.getElementById('data_nascimento').value = p.data_nascimento;
    };
    tbody.appendChild(tr);
  });
}

listar();
</script>
</body>
</html>
```

------------------------------------------------------------------------

## Exemplo 03 - SERVIDOR DE APLICAÃ‡ÃƒO PERL

![](images/clipboard-2372699820.png)

Neste exemplo, temos uma aplicaÃ§Ã£o cliente feita html e javascript

A interface do Cliente Ã© feita em HTML5

A conexÃ£o com o servidor Ã© feita pelo javascript incorporado no HTML:

CRUD no cliente Ã© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0

O servidor Restful Ã© feito em linguagem PERL

OBS: NÃƒO TEMOS CONTROLE DE SESSÃƒO DE CLIENTE IMPLEMENTADO.

``` cmd
cpan Dancer2 DBI DBD::Pg JSON
```

### Servidor Perl

``` perl
#!/usr/bin/perl
use strict;
use warnings;
use Dancer2;
use DBI;
use JSON;

# -----------------------------
# ConfiguraÃ§Ãµes do banco
# -----------------------------
my $dsn = "dbi:Pg:dbname=postgres;host=db.pbbtfwmydxmxdibmtbqq.supabase.co;port=5432";
my $db_user = "postgres";
my $db_pass = "MinhaSuperSenha";

my $dbh = DBI->connect($dsn, $db_user, $db_pass, { RaiseError => 1, AutoCommit => 1 });

# -----------------------------
# Helpers
# -----------------------------
sub json_response {
    content_type 'application/json';
    return encode_json($_[0]);
}

# -----------------------------
# Endpoints REST
# -----------------------------

# Listar todas ou pesquisar
get '/pessoas' => sub {
    my $q = query_parameters->get('q') || '';
    my $sql = "SELECT * FROM pessoas";
    my @params;
    if ($q ne '') {
        $sql .= " WHERE cpf ILIKE ? OR nome ILIKE ?";
        @params = ("%$q%", "%$q%");
    }
    my $sth = $dbh->prepare($sql);
    $sth->execute(@params);
    my @rows;
    while (my $row = $sth->fetchrow_hashref) {
        push @rows, $row;
    }
    return json_response(\@rows);
};

# Buscar por CPF
get '/pessoas/:cpf' => sub {
    my $cpf = route_parameters->get('cpf');
    my $sth = $dbh->prepare("SELECT * FROM pessoas WHERE cpf = ?");
    $sth->execute($cpf);
    my $row = $sth->fetchrow_hashref;
    return $row ? json_response($row) : status(404)->json_response({ error => "CPF nÃ£o encontrado" });
};

# Inserir
post '/pessoas' => sub {
    my $data = from_json(request->body);
    my $cpf = $data->{cpf};
    # Verifica se existe
    my $check = $dbh->prepare("SELECT cpf FROM pessoas WHERE cpf = ?");
    $check->execute($cpf);
    if ($check->fetchrow_array) {
        status(400);
        return json_response({ error => "CPF jÃ¡ cadastrado" });
    }
    my $sth = $dbh->prepare("INSERT INTO pessoas (cpf, nome, endereco, data_nascimento, foto) VALUES (?, ?, ?, ?, ?)");
    $sth->execute($cpf, $data->{nome}, $data->{endereco}, $data->{data_nascimento}, $data->{foto});
    status(201);
    return json_response({ message => "Inserido com sucesso" });
};

# Alterar
put '/pessoas/:cpf' => sub {
    my $cpf = route_parameters->get('cpf');
    my $data = from_json(request->body);
    # Verifica se existe
    my $check = $dbh->prepare("SELECT cpf FROM pessoas WHERE cpf = ?");
    $check->execute($cpf);
    unless ($check->fetchrow_array) {
        status(404);
        return json_response({ error => "CPF nÃ£o encontrado" });
    }
    my $sth = $dbh->prepare("UPDATE pessoas SET nome=?, endereco=?, data_nascimento=?, foto=? WHERE cpf=?");
    $sth->execute($data->{nome}, $data->{endereco}, $data->{data_nascimento}, $data->{foto}, $cpf);
    return json_response({ message => "Alterado com sucesso" });
};

# Remover
del '/pessoas/:cpf' => sub {
    my $cpf = route_parameters->get('cpf');
    my $sth = $dbh->prepare("DELETE FROM pessoas WHERE cpf=?");
    my $rows = $sth->execute($cpf);
    if ($rows) {
        return json_response({ message => "Removido com sucesso" });
    } else {
        status(404);
        return json_response({ error => "CPF nÃ£o encontrado" });
    }
};

# -----------------------------
# Inicializa o servidor
# -----------------------------
set port => 5000;
set serializer => 'JSON';

start;
```

servidor estarÃ¡ rodando na porta 5000 e EXPÃ•E A API de operaÃ§Ãµes na URI <http://localhost:5000/pessoas> sem senha

``` css
http://localhost:5000/pessoas
```

### Cliente HTML (conexÃ£o Restful)

crie o arquivo index.html e abra-o no navegador

``` html
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Cadastro de Pessoas - Perl/PostgreSQL</title>
<style>
  body { font-family: sans-serif; max-width: 800px; margin: 20px auto; }
  label { display: block; margin-top: 10px; }
  button { margin-top: 10px; margin-right: 5px; }
  table { border-collapse: collapse; width:100%; margin-top:20px; }
  th, td { border:1px solid #ccc; padding:6px; text-align:left; }
  img.thumb { width:60px; height:60px; object-fit:cover; border-radius:4px; }
</style>
</head>
<body>
<h1>Cadastro de Pessoas (Perl/PostgreSQL)</h1>

<form id="formPessoa">
  <label>CPF (chave primÃ¡ria): <input id="cpf" required></label>
  <label>Nome: <input id="nome" required></label>
  <label>EndereÃ§o: <input id="endereco" required></label>
  <label>Data Nasc.: <input type="date" id="data_nascimento" required></label>
  <label>Foto: <input type="file" id="foto" accept="image/*"></label>

  <button type="button" onclick="inserir()">Inserir</button>
  <button type="button" onclick="alterar()">Alterar</button>
  <button type="button" onclick="remover()">Remover</button>
</form>

<h2>Pesquisar</h2>
<input id="pesquisa" placeholder="Digite nome ou CPF">
<button type="button" onclick="pesquisar()">Pesquisar</button>

<table>
  <thead>
    <tr>
      <th>CPF</th><th>Foto</th><th>Nome</th>
      <th>EndereÃ§o</th><th>Nascimento</th>
    </tr>
  </thead>
  <tbody id="tabela"></tbody>
</table>

<script>
const API = 'http://localhost:5000/pessoas';

/* ---------- FunÃ§Ãµes utilitÃ¡rias ---------- */
function validaCampos() {
  const campos = ['cpf','nome','endereco','data_nascimento'];
  for (const id of campos) {
    const valor = document.getElementById(id).value.trim();
    if (!valor) {
      alert(`O campo "${id}" nÃ£o pode ficar em branco.`);
      return false;
    }
  }
  return true;
}

function getFotoBase64() {
  const file = document.getElementById('foto').files[0];
  if(!file) return Promise.resolve('');
  return new Promise((resolve,reject)=>{
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result);
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}

function coletaDados(base64Foto){
  return {
    cpf: document.getElementById('cpf').value.trim(),
    nome: document.getElementById('nome').value.trim(),
    endereco: document.getElementById('endereco').value.trim(),
    data_nascimento: document.getElementById('data_nascimento').value,
    foto: base64Foto || ''
  };
}

/* ---------- CRUD ---------- */
async function inserir() {
  if(!validaCampos()) return;
  const base64 = await getFotoBase64();
  const pessoa = coletaDados(base64);

  const res = await fetch(API, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(pessoa)
  });
  const data = await res.json();
  if(res.ok) alert('Inserido com sucesso!');
  else alert('Erro: ' + (data.error || ''));
  listar();
}

async function alterar() {
  if(!validaCampos()) return;
  const cpf = document.getElementById('cpf').value.trim();
  const base64 = await getFotoBase64();
  const novosDados = coletaDados();
  if(base64) novosDados.foto = base64;

  const res = await fetch(`${API}/${encodeURIComponent(cpf)}`, {
    method: 'PUT',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(novosDados)
  });
  const data = await res.json();
  if(res.ok) alert('Alterado com sucesso!');
  else alert('Erro: ' + (data.error || ''));
  listar();
}

async function remover() {
  const cpf = document.getElementById('cpf').value.trim();
  if(!cpf) return alert('Informe o CPF para remover.');
  if(confirm('Confirma a exclusÃ£o?')){
    const res = await fetch(`${API}/${encodeURIComponent(cpf)}`, {method:'DELETE'});
    const data = await res.json();
    if(res.ok) alert('Removido com sucesso!');
    else alert('Erro: ' + (data.error || ''));
    listar();
  }
}

async function pesquisar() {
  const termo = document.getElementById('pesquisa').value.trim();
  if(!termo){ listar(); return; }
  const res = await fetch(`${API}?q=${encodeURIComponent(termo)}`);
  const data = await res.json();
  preencheTabela(data);
}

async function listar() {
  const res = await fetch(API);
  const data = await res.json();
  preencheTabela(data);
}

/* ---------- UI ---------- */
function preencheTabela(lista){
  const tbody = document.getElementById('tabela');
  tbody.innerHTML = '';
  lista.forEach(p=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${p.cpf}</td>
      <td>${p.foto ? `<img class="thumb" src="${p.foto}" alt="foto">` : ''}</td>
      <td>${p.nome}</td>
      <td>${p.endereco}</td>
      <td>${p.data_nascimento}</td>`;
    tr.onclick = () => {
      document.getElementById('cpf').value = p.cpf;
      document.getElementById('nome').value = p.nome;
      document.getElementById('endereco').value = p.endereco;
      document.getElementById('data_nascimento').value = p.data_nascimento;
    };
    tbody.appendChild(tr);
  });
}

listar();
</script>
</body>
</html>
```

## Exemplo 04 - SERVIDOR DE APLICAÃ‡ÃƒO JAVA

![](images/clipboard-3162947411.png)

[ Vou refazer estes exemplo ]

## Exemplo 05 - SERVIDOR DE APLICAÃ‡ÃƒO C++

![](images/clipboard-2416235942.png)

Neste exemplo, temos uma aplicaÃ§Ã£o cliente feita html e javascript

A interface do Cliente Ã© feita em HTML5

A conexÃ£o com o servidor Ã© feita pelo javascript incorporado no HTML:

CRUD no cliente Ã© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0

O servidor Restful Ã© feito em linguagem C++

A linguagem C++ precisa ser compilada.

PORTANTO O CÃ“DIGO DO SERVIDOR PRECISARÃ SER COMPILADO.

EM C++ VAMOS USAR BIBLIOTECAS EXTERNAS libpqxx e crow

OBS: NÃƒO TEMOS CONTROLE DE SESSÃƒO DE CLIENTE IMPLEMENTADO.

estrutura de diretÃ³rios:

``` css
pessoas-rest-cpp/
â”œâ”€ CMakeLists.txt
â”œâ”€ src/
â”‚   â””â”€ main.cpp
â””â”€ include/
    â””â”€ crow_all.h        â† header Ãºnico da biblioteca Crow
```

### Criando o arquivo C++ do servidor

``` cpp
#include "crow_all.h"
#include <pqxx/pqxx>
#include <iostream>

const std::string CONN_STR =
    "postgresql://postgres:MinhaSuperSenha@db.pbbtfwmydxmxdibmtbqq.supabase.co:5432/postgres";

int main() {
    crow::SimpleApp app;

    // GET /pessoas
    CROW_ROUTE(app, "/pessoas").methods("GET"_method)
    ([](const crow::request& req){
        pqxx::connection c(CONN_STR);
        pqxx::work w(c);
        std::string q = req.url_params.get("q") ? req.url_params.get("q") : "";
        pqxx::result r;
        if(!q.empty()) {
            r = w.exec_params(
                "SELECT cpf,nome,endereco,data_nascimento,foto "
                "FROM pessoas WHERE lower(nome) LIKE lower('%'||$1||'%') OR cpf LIKE '%'||$1||'%'",
                q);
        } else {
            r = w.exec("SELECT cpf,nome,endereco,data_nascimento,foto FROM pessoas");
        }
        crow::json::wvalue out;
        size_t i=0;
        for(auto row : r) {
            out[i]["cpf"] = row["cpf"].c_str();
            out[i]["nome"] = row["nome"].c_str();
            out[i]["endereco"] = row["endereco"].c_str();
            out[i]["dataNascimento"] = row["data_nascimento"].c_str();
            out[i]["foto"] = row["foto"].is_null() ? "" : row["foto"].c_str();
            ++i;
        }
        return crow::response(out);
    });

    // POST /pessoas
    CROW_ROUTE(app, "/pessoas").methods("POST"_method)
    ([](const crow::request& req){
        auto body = crow::json::load(req.body);
        if(!body || !body.has("cpf"))
            return crow::response(400, "CPF Ã© obrigatÃ³rio");

        try {
            pqxx::connection c(CONN_STR);
            pqxx::work w(c);
            w.exec_params(
                "INSERT INTO pessoas (cpf,nome,endereco,data_nascimento,foto) "
                "VALUES ($1,$2,$3,$4,$5)",
                body["cpf"].s(),
                body["nome"].s_or(""),
                body["endereco"].s_or(""),
                body["dataNascimento"].s_or(""),
                body["foto"].s_or("")
            );
            w.commit();
            return crow::response(201, "Inserido");
        } catch(const std::exception &e) {
            return crow::response(400, e.what());
        }
    });

    // PUT /pessoas/<cpf>
    CROW_ROUTE(app, "/pessoas/<string>").methods("PUT"_method)
    ([](const crow::request& req, std::string cpf){
        auto body = crow::json::load(req.body);
        if(!body)
            return crow::response(400, "JSON invÃ¡lido");
        try {
            pqxx::connection c(CONN_STR);
            pqxx::work w(c);
            w.exec_params(
                "UPDATE pessoas SET nome=$1,endereco=$2,data_nascimento=$3,foto=$4 WHERE cpf=$5",
                body["nome"].s_or(""),
                body["endereco"].s_or(""),
                body["dataNascimento"].s_or(""),
                body["foto"].s_or(""),
                cpf
            );
            if(w.affected_rows() == 0) return crow::response(404, "CPF nÃ£o encontrado");
            w.commit();
            return crow::response(200, "Alterado");
        } catch(const std::exception &e) {
            return crow::response(400, e.what());
        }
    });

    // DELETE /pessoas/<cpf>
    CROW_ROUTE(app, "/pessoas/<string>").methods("DELETE"_method)
    ([](const crow::request&, std::string cpf){
        try {
            pqxx::connection c(CONN_STR);
            pqxx::work w(c);
            w.exec_params("DELETE FROM pessoas WHERE cpf=$1", cpf);
            if(w.affected_rows() == 0) return crow::response(404, "CPF nÃ£o encontrado");
            w.commit();
            return crow::response(200, "Removido");
        } catch(const std::exception &e) {
            return crow::response(400, e.what());
        }
    });

    std::cout << "Servidor rodando em http://0.0.0.0:8080\n";
    app.port(8080).multithreaded().run();
}
```

### Ferramenta de compilaÃ§Ã£o CMAKE

Preparando o arquivo de instruÃ§Ãµes da ferramenta de projeto CMAKE

``` txt
cmake_minimum_required(VERSION 3.20)
project(PessoasRestCpp LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Caminho para os headers (Crow e outros)
include_directories(${CMAKE_SOURCE_DIR}/include)

# LocalizaÃ§Ã£o de libpqxx (ajuste se estiver em pasta diferente)
find_package(PostgreSQL REQUIRED)
find_path(PQXX_INCLUDE_DIR pqxx/pqxx)
find_library(PQXX_LIBRARY pqxx)

if(NOT PQXX_INCLUDE_DIR OR NOT PQXX_LIBRARY)
    message(FATAL_ERROR "libpqxx nÃ£o encontrada. Instale com vcpkg ou aponte manualmente.")
endif()

add_executable(pessoas-rest
    src/main.cpp
)

target_include_directories(pessoas-rest PRIVATE ${PQXX_INCLUDE_DIR})
target_link_libraries(pessoas-rest
    ${PQXX_LIBRARY}
    PostgreSQL::PostgreSQL
)
```

Adicionando biblioteca extra no compilador C++ do windows

``` cmd
vcpkg install libpqxx
```

Gere o projeto do servidor para "Visual Studio 17 2022" E ARQUITETURA x64

``` cmd
cmake -B build -G "Visual Studio 17 2022" -A x64  -DCMAKE_TOOLCHAIN_FILE=C:/path/to/vcpkg/scripts/buildsystems/vcpkg.cmake
```

Compile e linque todo o projeto

``` cmd
cmake --build build --config Release
```

execute o servidor

``` cmd
build/Release/pessoas-rest.exe
```

servidor estarÃ¡ rodando na porta 8080 e EXPÃ•E A API de operaÃ§Ãµes na URI <http://localhost:8080/pessoas> sem senha

``` css
http://localhost:8080/pessoas
```

### Cliente HTML (conexÃ£o Restful)

crie o arquivo index.html e abra-o no navegador

``` html
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Cadastro de Pessoas</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  h1 { color: #333; }
  form { margin-bottom: 20px; }
  label { display: block; margin-top: 10px; }
  input[type=text], input[type=date], input[type=file] {
    width: 300px; padding: 5px;
  }
  table { border-collapse: collapse; width: 100%; margin-top: 20px; }
  th, td { border: 1px solid #aaa; padding: 6px; text-align: left; }
  img { max-width: 80px; max-height: 80px; }
  .btn { padding: 4px 8px; cursor: pointer; margin: 0 2px; }
</style>
</head>
<body>

<h1>Cadastro de Pessoas</h1>

<form id="pessoaForm">
  <label>CPF*:
    <input type="text" id="cpf" required>
  </label>
  <label>Nome:
    <input type="text" id="nome">
  </label>
  <label>EndereÃ§o:
    <input type="text" id="endereco">
  </label>
  <label>Data de Nascimento:
    <input type="date" id="dataNascimento">
  </label>
  <label>Foto:
    <input type="file" id="foto">
  </label>
  <button type="submit" class="btn">Salvar</button>
</form>

<div>
  <input type="text" id="search" placeholder="Buscar por CPF ou Nome">
  <button id="btnBuscar" class="btn">Buscar</button>
  <button id="btnListar" class="btn">Listar Todos</button>
</div>

<table id="tabelaPessoas">
  <thead>
    <tr>
      <th>CPF</th><th>Nome</th><th>EndereÃ§o</th><th>Nascimento</th><th>Foto</th><th>AÃ§Ãµes</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const API_URL = "http://localhost:8080/pessoas";

async function carregarPessoas(query="") {
  const url = query ? `${API_URL}?q=${encodeURIComponent(query)}` : API_URL;
  const resp = await fetch(url);
  const data = await resp.json();
  const tbody = document.querySelector("#tabelaPessoas tbody");
  tbody.innerHTML = "";
  data.forEach(p => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${p.cpf}</td>
      <td>${p.nome || ""}</td>
      <td>${p.endereco || ""}</td>
      <td>${p.dataNascimento || ""}</td>
      <td>${p.foto ? `<img src="${p.foto}" alt="foto">` : ""}</td>
      <td>
        <button class="btn" onclick="editar('${p.cpf}')">Editar</button>
        <button class="btn" onclick="excluir('${p.cpf}')">Excluir</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

async function toBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result);
    reader.onerror = reject;
    reader.readAsDataURL(file);
  });
}

document.getElementById("pessoaForm").addEventListener("submit", async e => {
  e.preventDefault();
  const cpf = document.getElementById("cpf").value.trim();
  if (!cpf) { alert("CPF Ã© obrigatÃ³rio."); return; }

  const nome = document.getElementById("nome").value.trim();
  const endereco = document.getElementById("endereco").value.trim();
  const dataNascimento = document.getElementById("dataNascimento").value;
  const fotoFile = document.getElementById("foto").files[0];
  let fotoBase64 = "";
  if (fotoFile) {
    fotoBase64 = await toBase64(fotoFile);
  }

  // Se jÃ¡ existe, usa PUT, senÃ£o POST
  const method = document.getElementById("cpf").dataset.editing ? "PUT" : "POST";
  const url = method === "PUT" ? `${API_URL}/${cpf}` : API_URL;

  const resp = await fetch(url, {
    method,
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ cpf, nome, endereco, dataNascimento, foto: fotoBase64 })
  });

  if (resp.ok) {
    alert("Salvo com sucesso!");
    document.getElementById("pessoaForm").reset();
    document.getElementById("cpf").dataset.editing = "";
    carregarPessoas();
  } else {
    alert("Erro: " + await resp.text());
  }
});

function editar(cpf) {
  const row = [...document.querySelectorAll("#tabelaPessoas tbody tr")]
    .find(tr => tr.children[0].textContent === cpf);
  if (!row) return;
  document.getElementById("cpf").value = cpf;
  document.getElementById("nome").value = row.children[1].textContent;
  document.getElementById("endereco").value = row.children[2].textContent;
  document.getElementById("dataNascimento").value = row.children[3].textContent;
  document.getElementById("cpf").dataset.editing = "true";
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

async function excluir(cpf) {
  if (!confirm(`Excluir CPF ${cpf}?`)) return;
  const resp = await fetch(`${API_URL}/${cpf}`, { method: "DELETE" });
  if (resp.ok) {
    carregarPessoas();
  } else {
    alert("Erro: " + await resp.text());
  }
}

document.getElementById("btnBuscar").addEventListener("click", () => {
  const q = document.getElementById("search").value.trim();
  carregarPessoas(q);
});

document.getElementById("btnListar").addEventListener("click", () => {
  document.getElementById("search").value = "";
  carregarPessoas();
});

// Carregar lista inicial
carregarPessoas();
</script>
</body>
</html>
```

<!--chapter:end:09-aula09/09-2026-2026-04-21_CRUD-1-exercicio.Rmd-->

# Banco de Dados EstatÃ­stico - Cliente Rstudio
#### 06/10/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:10-aula10/10-2026-2026-04-28_CRUD-2-aula.Rmd-->

# Banco de Dados EstatÃ­stico - Cliente Rstudio
#### 06/10/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:10-aula10/10-2026-2026-04-28_CRUD-2-exercicio.Rmd-->

# Banco de Dados - AnÃ¡lise de Dados Parte 01
#### 13/10/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:11-aula11/11-2026-2026-05-05_Analise_01-aula.Rmd-->

# Banco de Dados - AnÃ¡lise de Dados Parte 01
#### 13/10/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:11-aula11/11-2026-2026-05-05_Analise_01-exercicio.Rmd-->

# Banco de Dados - AnÃ¡lise de Dados Parte 02
#### 20/10/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

```{r exemplo-teste-01, eval=FALSE, engine='tikz', include=FALSE}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}
[
  every node/.style={on grid},
  setA/.style={fill=blue ,circle,inner  sep=3pt},
  setB/.style={fill=green,circle,inner  sep=3pt},
  setC/.style={fill=red,rectangle,inner sep=3pt},
  every fit/.style={draw,fill=blue!25,ellipse,text width=25pt},
  >=latex
]

% Conjunto Montadoras
\node [setA,              label  = left:$Fulano$]    (a) {};
\node [setA,below = of a, label  = left:$Beltrano$]  (b) {};
\node [setA,below = of b, label  = left:$Ciclano$]   (c) {};

\node [above      = of a, anchor = south] {$Funcionarios$};

% Conjunto Veiculos
\node[setB,inner sep=3pt,right  = 4 cm of a, label=right:$\text{RH}$]        (x) {};
\node[setB,inner sep=3pt,below  =      of x, label=right:$\text{FINANÃ‡AS}$]  (y) {};
\node[setB,inner sep=3pt,below  =      of y, label=right:$\text{DIRETORIA}$] (z) {};

\node[above                     =      of x, anchor = south] {$Departamentos$};



% the arrows
%\draw[->,shorten >= 3pt] (a) -- node[label=above:$f(Corsa)$]  {} (x);
%\draw[->,shorten >= 3pt] (b) -- node[label=above:$g(Fiesta)$] {} (y);
%\draw[->,shorten >= 3pt] (c) -- node[label=above:$h(Gol)$]    {} (z);
%\draw[->,shorten <= 3pt] (x) -- node[label=above:$i(Fulano)$] {} (m);
%\draw[->,shorten <= 3pt] (y) -- node[label=above:$j(Beltrano)$] {} (n);
%\draw[->,shorten <= 3pt] (z) -- node[label=above:$k(Ciclano)$] {} (p);

%\draw[->] (n) -- node[label=above:$j(j(Beltrano))$] {} (y);

% the boxes around the sets
\begin{pgfonlayer}{background}
\node[fit= (a)  (c) ] {};
\node[fit= (x) (z)  ] {};
%\node[fit= (m) (p)  ] {};
\end{pgfonlayer}
\end{tikzpicture}

```



================================================================================

```{r exemplo-teste-02, eval=FALSE, engine='tikz', include=FALSE}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}[
  every node/.style={on grid},
  setA/.style={fill=blue!50,circle,inner sep=3pt},
  setB/.style={fill=green!50,circle,inner sep=3pt},
  >=latex
]

% Conjunto FuncionÃ¡rios
\node [setA,              label=left:$Fulano$]   (a) {};
\node [setA,below=of a,   label=left:$Beltrano$] (b) {};
\node [setA,below=of b,   label=left:$Ciclano$]  (c) {};

% Conjunto Departamentos
\node [setB,right=4cm of a, label=right:$\text{RH}$        ] (x) {};
\node [setB,below=of     x, label=right:$\text{FinanÃ§as}$  ] (y) {};
\node [setB,below=of     y, label=right:$\text{Diretoria}$ ] (z) {};

% As setas (funÃ§Ãµes)
\draw[->,shorten >=3pt] (a) -- node[above] {$trabalha(\text{RH})$}        (x);
\draw[->,shorten >=3pt] (b) -- node[above] {$trabalha(\text{FinanÃ§as})$}  (y);
\draw[->,shorten >=3pt] (c) -- node[above] {$trabalha(\text{Diretoria})$} (z);

% Os conjuntos
\begin{pgfonlayer}{background}
  \node[fit=(a) (c), ellipse, draw, fill=blue!10,  label=above:{FuncionÃ¡rios}] {};
  \node[fit=(x) (z), ellipse, draw, fill=green!10, label=above:{Departamentos}] {};
\end{pgfonlayer}

\end{tikzpicture}


```

================================================================================

```{r ex1, engine='tikz', eval=FALSE, echo=FALSE, fig.cap="Diagrama de Montadoras, VeÃ­culos e ProprietÃ¡rios"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}



\begin{tikzpicture}
[
  every node/.style={on grid},
  setA/.style={fill=blue,               circle,  inner sep=3pt },
  setB/.style={fill=green!70!black,     circle,  inner sep=3pt },
  setC/.style={fill=red!70!black,       circle,  inner sep=3pt },
  every fit/.style={draw, fill=gray!10, ellipse, inner sep=12pt},
  >=latex
]


% --- Conjunto A (PaÃ­ses) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setA, label=left:Brasil]    (a1) {};
  \node [setA, below=of a1, label=left:Argentina] (a2) {};
  \node [setA, below=of a2, label=left:Chile]     (a3) {};
  \node [above=1.5cm of a1, font=\bfseries]            {PaÃ­ses};
\end{scope}

% --- Conjunto B (Capitais) ---
\begin{scope}[node distance=1cm and 6cm]
  \node [setB, right=of a1, label=right:BrasÃ­lia]       (b1) {};
  \node [setB, below=of b1, label=right:{Buenos Aires}] (b2) {};
  \node [setB, below=of b2, label=right:{Santiago}]     (b3) {};
  \node [above=1.5cm of b1, font=\bfseries] {Capitais};
\end{scope}

% --- As Setas (Mapeamento) ---
\draw[->, shorten >= 3pt, shorten <= 3pt, thick, gray!80] (a1) -- (b1);
\draw[->, shorten >= 3pt, shorten <= 3pt, thick, gray!80] (a2) -- (b2);
\draw[->, shorten >= 3pt, shorten <= 3pt, thick, gray!80] (a3) -- (b3);


% --- Conjunto C (layout: c1 ao lado de c2; c3 abaixo do par) ---
% --- Conjunto C: C = A x B (todos os pares ordenados) ---

% Ã‚ncoras e deslocamentos para ficar "quase encostado"
\def\dx{1.5pt}      % distÃ¢ncia do c1 atÃ© a vÃ­rgula e da vÃ­rgula atÃ© c2
\def\dy{5mm}        % espaÃ§amento vertical entre linhas (pares)

% TÃ­tulo
%\node [below=3cm of b1, font=\bfseries] (titleC) {C = A \times B};

% Linha 1: (Brasil, BrasÃ­lia)
\node [setC, below=4cm of a3, xshift=3cm, label=left:Brasil, fill=blue] (cA11) {};
\node [font=\bfseries] (cComma11) at ([xshift=\dx] cA11.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:BrasÃ­lia, fill=blue] (cB11) at (cComma11.east) {};

% Linha 2: (Brasil, Buenos Aires)
\node [setC, below=\dy of cA11, label=left:Brasil] (cA12) {};
\node [font=\bfseries] (cComma12) at ([xshift=\dx] cA12.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:{Buenos Aires}] (cB12) at (cComma12.east) {};

% Linha 3: (Brasil, Santiago)
\node [setC, below=\dy of cA12, label=left:Brasil] (cA13) {};
\node [font=\bfseries] (cComma13) at ([xshift=\dx] cA13.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Santiago] (cB13) at (cComma13.east) {};

% Linha 4: (Argentina, BrasÃ­lia)
\node [setC, below=\dy of cA13, label=left:Argentina] (cA21) {};
\node [font=\bfseries] (cComma21) at ([xshift=\dx] cA21.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:BrasÃ­lia] (cB21) at (cComma21.east) {};

% Linha 5: (Argentina, Buenos Aires)
\node [setC, below=\dy of cA21, label=left:Argentina, fill=blue] (cA22) {};
\node [font=\bfseries] (cComma22) at ([xshift=\dx] cA22.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:{Buenos Aires}, fill=blue] (cB22) at (cComma22.east) {};

% Linha 6: (Argentina, Santiago)
\node [setC, below=\dy of cA22, label=left:Argentina] (cA23) {};
\node [font=\bfseries] (cComma23) at ([xshift=\dx] cA23.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Santiago] (cB23) at (cComma23.east) {};

% Linha 7: (Chile, BrasÃ­lia)
\node [setC, below=\dy of cA23, label=left:Chile] (cA31) {};
\node [font=\bfseries] (cComma31) at ([xshift=\dx] cA31.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:BrasÃ­lia] (cB31) at (cComma31.east) {};

% Linha 8: (Chile, Buenos Aires)
\node [setC, below=\dy of cA31, label=left:Chile] (cA32) {};
\node [font=\bfseries] (cComma32) at ([xshift=\dx] cA32.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:{Buenos Aires}] (cB32) at (cComma32.east) {};

% Linha 9: (Chile, Santiago)
\node [setC, below=\dy of cA32, label=left:Chile, fill=blue] (cA33) {};
\node [font=\bfseries] (cComma33) at ([xshift=\dx] cA33.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Santiago, fill=blue] (cB33) at (cComma33.east) {};

\node [above=1.5cm of cA11, xshift=-\dx, font=\bfseries] (titleC) {PaÃ­ses X Capitais};


% --- Camada de Fundo (Elipses) ---
\begin{pgfonlayer}{background}
  \node[fit=(a1) (a2) (a3)] {};
  \node[fit=(b1) (b2) (b3)] {};
  \node[fit= (titleC) (cComma11) (cComma12) (cComma13) (cComma21) (cComma22)  (cComma23)  (cComma31)  (cComma32) (cComma33) ] {};
\end{pgfonlayer}

\end{tikzpicture}


```


```{r ex2, engine='tikz', eval=FALSE, echo=FALSE, fig.cap="Diagrama Produtos x categorias"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}
[
  every node/.style={on grid},
  setA/.style={fill=blue!60, circle, inner sep=3pt},
  setB/.style={circle, inner sep=3pt},
  >=latex
]

% --- Conjunto A (Produtos) ---
\begin{scope}[node distance=0.9cm and 7.5cm]
  \node [setA, label=left:Teclado]     (a1)  {};
  \node [setA, below=of a1, label=left:Mouse]       (a2)  {};
  \node [setA, below=of a2, label=left:Monitor]     (a3)  {};
  \node [setA, below=of a3, label=left:Camisa]      (a4)  {};
  \node [setA, below=of a4, label=left:CalÃ§a]       (a5)  {};
  \node [setA, below=of a5, label=left:TÃªnis]       (a6)  {};
  \node [setA, below=of a6, label=left:Livro SQL]   (a7)  {};
  \node [setA, below=of a7, label=left:Livro Java]  (a8)  {};
  \node [setA, below=of a8, label=left:Livro Redes] (a9)  {};
  \node [setA, below=of a9, label=left:Cadeira]     (a10) {};
  \node [setA, below=of a10,label=left:Mesa]        (a11) {};
  \node [setA, below=of a11,label=left:SofÃ¡]        (a12) {};

  \node [above=1.3cm of a1, font=\bfseries, align=center]
  {Conjunto A\\Produtos de venda};
\end{scope}

% --- Conjunto B (Categorias com cores diferentes) ---
\begin{scope}[node distance=1.4cm and 7.5cm]
  \node [setB, fill=blue!70, right=of a1, label=right:EletrÃ´nicos] (b1) {};
  \node [setB, fill=green!70!black, below=of b1, label=right:VestuÃ¡rio]   (b2) {};
  \node [setB, fill=purple!70, below=of b2, label=right:Livraria]    (b3) {};
  \node [setB, fill=red!70, below=of b3, label=right:MÃ³veis]      (b4) {};

  \node [above=1.3cm of b1, font=\bfseries, align=center]
  {Conjunto B\\Categorias};
\end{scope}

% --- RelaÃ§Ã£o real R âŠ† AÃ—B ---

% EletrÃ´nicos (azul)
\draw[<->,shorten >=3pt, thick, blue] (a1) -- (b1);
\draw[<->,shorten >=3pt, thick, blue] (a2) -- (b1);
\draw[<->,shorten >=3pt, thick, blue] (a3) -- (b1);

% VestuÃ¡rio (verde)
\draw[<->,shorten >=3pt, thick, green!70!black] (a4) -- (b2);
\draw[<->,shorten >=3pt, thick, green!70!black] (a5) -- (b2);
\draw[<->,shorten >=3pt, thick, green!70!black] (a6) -- (b2);

% Livraria (roxo)
\draw[<->,shorten >=3pt, thick, purple] (a7) -- (b3);
\draw[<->,shorten >=3pt, thick, purple] (a8) -- (b3);
\draw[<->,shorten >=3pt, thick, purple] (a9) -- (b3);

% MÃ³veis (vermelho)
\draw[<->,shorten >=3pt, thick, red] (a10) -- (b4);
\draw[<->,shorten >=3pt, thick, red] (a11) -- (b4);
\draw[<->,shorten >=3pt, thick, red] (a12) -- (b4);

% --- Fundo ---
\begin{pgfonlayer}{background}
  \node[fit=(a1) (a12), draw, fill=gray!10, ellipse, inner sep=8pt] {};
  \node[fit=(b1) (b4),  draw, fill=gray!10, ellipse, inner sep=8pt] {};
\end{pgfonlayer}

\end{tikzpicture}
```

```{r ex3, engine='tikz', echo=FALSE, fig.cap="Diagrama Produtos x categorias"}
\usetikzlibrary{arrows,positioning,shapes,fit,calc}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{tikzpicture}
[
  % scale=0.5,
  % transform shape,
  every node/.style={on grid},
  setA/.style={fill=blue,               circle,  inner sep=2pt },
  setB/.style={fill=green!70!black,     circle,  inner sep=2pt },
  setC/.style={fill=red!70!black,       circle,  inner sep=2pt },
  every fit/.style={draw, fill=gray!10, ellipse, inner sep=8pt},
  >=latex
]



% --- Conjunto C (layout: lista de pares ordenados de R) ---
% Aqui mostramos explicitamente os pares (produto, categoria) pertencentes a R.
\def\dx{1.5pt}
\def\dy{5.2mm}

\node [ xshift=3.6cm, font=\bfseries] (titleC) {$R \subseteq A \times B$};

% Linha 1: (Teclado, EletrÃ´nicos)
\node [setC, below=1cm of titleC, xshift=-1.0cm, label=left:Teclado, fill=blue!80] (cA1) {};
\node [font=\bfseries] (cComma1) at ([xshift=\dx] cA1.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Eletr\^onicos, fill=blue!80] (cB1) at (cComma1.east) {};

% Linha 2: (Mouse, EletrÃ´nicos)
\node [setC, below=\dy of cA1, label=left:Mouse, fill=blue!80] (cA2) {};
\node [font=\bfseries] (cComma2) at ([xshift=\dx] cA2.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Eletr\^onicos, fill=blue!80] (cB2) at (cComma2.east) {};

% Linha 3: (Monitor, EletrÃ´nicos)
\node [setC, below=\dy of cA2, label=left:Monitor, fill=blue!80] (cA3) {};
\node [font=\bfseries] (cComma3) at ([xshift=\dx] cA3.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Eletr\^onicos, fill=blue!80] (cB3) at (cComma3.east) {};

% Linha 4: (Camisa, VestuÃ¡rio)
\node [setC, below=\dy of cA3, label=left:Camisa, fill=green!70!black] (cA4) {};
\node [font=\bfseries] (cComma4) at ([xshift=\dx] cA4.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Vestu\'ario, fill=green!70!black] (cB4) at (cComma4.east) {};

% Linha 5: (CalÃ§a, VestuÃ¡rio)
\node [setC, below=\dy of cA4, label=left:Cal\c ca, fill=green!70!black] (cA5) {};
\node [font=\bfseries] (cComma5) at ([xshift=\dx] cA5.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Vestu\'ario, fill=green!70!black] (cB5) at (cComma5.east) {};

% Linha 6: (TÃªnis, VestuÃ¡rio)
\node [setC, below=\dy of cA5, label=left:T\^enis, fill=green!70!black] (cA6) {};
\node [font=\bfseries] (cComma6) at ([xshift=\dx] cA6.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Vestu\'ario, fill=green!70!black] (cB6) at (cComma6.east) {};

% Linha 7: (Livro SQL, Livraria)
\node [setC, below=\dy of cA6, label=left:Livro SQL, fill=purple!80] (cA7) {};
\node [font=\bfseries] (cComma7) at ([xshift=\dx] cA7.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Livraria, fill=purple!80] (cB7) at (cComma7.east) {};

% Linha 8: (Livro Java, Livraria)
\node [setC, below=\dy of cA7, label=left:Livro Java, fill=purple!80] (cA8) {};
\node [font=\bfseries] (cComma8) at ([xshift=\dx] cA8.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Livraria, fill=purple!80] (cB8) at (cComma8.east) {};

% Linha 9: (Livro Redes, Livraria)
\node [setC, below=\dy of cA8, label=left:Livro Redes, fill=purple!80] (cA9) {};
\node [font=\bfseries] (cComma9) at ([xshift=\dx] cA9.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:Livraria, fill=purple!80] (cB9) at (cComma9.east) {};

% Linha 10: (Cadeira, MÃ³veis)
\node [setC, below=\dy of cA9, label=left:Cadeira, fill=red!80] (cA10) {};
\node [font=\bfseries] (cComma10) at ([xshift=\dx] cA10.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:M\'oveis, fill=red!80] (cB10) at (cComma10.east) {};

% Linha 11: (Mesa, MÃ³veis)
\node [setC, below=\dy of cA10, label=left:Mesa, fill=red!80] (cA11) {};
\node [font=\bfseries] (cComma11) at ([xshift=\dx] cA11.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:M\'oveis, fill=red!80] (cB11) at (cComma11.east) {};

% Linha 12: (SofÃ¡, MÃ³veis)
\node [setC, below=\dy of cA11, label=left:Sof\'a, fill=red!80] (cA12) {};
\node [font=\bfseries] (cComma12) at ([xshift=\dx] cA12.east) {,};
\node [setC, anchor=west, xshift=-\dx, label=right:M\'oveis, fill=red!80] (cB12) at (cComma12.east) {};

% --- Camada de Fundo (Elipses) ---
\begin{pgfonlayer}{background}
  \node[fit=(titleC) (cComma1) (cComma2) (cComma3) (cComma4) (cComma5) (cComma6)
                 (cComma7) (cComma8) (cComma9) (cComma10) (cComma11) (cComma12)] {};
\end{pgfonlayer}

\end{tikzpicture}
```



```{r teste-03, eval=FALSE, include=FALSE}
rmarkdown::render("12-2026-2026-05-12_Analise_02-aula.Rmd", output_dir="docs", output_file ="temporario.html" , output_format = "html_document") ; utils::browseURL("docs/temporario.html")
```

<!--chapter:end:12-aula12/12-2026-2026-05-12_Analise_02-aula.Rmd-->

# Banco de Dados - AnÃ¡lise de Dados Parte 02
#### 20/10/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:12-aula12/12-2026-2026-05-12_Analise_02-exercicio.Rmd-->

# Banco de Dados - AnÃ¡lise de Dados Parte 03
#### 27/10/2025 {.unnumbered}
#### Professor MiguÃ©l Suares {.unnumbered}

<!--chapter:end:13-aula13/13-2026-2026-05-26_Analise_03-aula.Rmd-->

# Banco de Dados - AnÃ¡lise de Dados Parte 03

#### 27/10/2025 {.unnumbered}

#### Professor MiguÃ©l Suares {.unnumbered}


<!--chapter:end:13-aula13/13-2026-2026-05-26_Analise_03-exercicio.Rmd-->

