<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Slide 8 Banco de Dados: Uma Aplica√ß√£o CRUD | GTI - Banco de dados - 2025 - Anota√ß√µes de aula</title>
  <meta name="description" content="Este livreto re√∫ne anota√ß√µes, reflex√µes e conte√∫dos desenvolvidos ao longo das aulas da disciplina Banco de Dados, ministrada pelo Professor Migu√©l Suares. Elaborado com base em experi√™ncias pr√°ticas, refer√™ncias acad√™micas e diretrizes atualizadas sobre o tema, o material busca fornecer uma vis√£o cr√≠tica e aplicada sobre an√°lise de dados nas organiza√ß√µes contempor√¢neas." />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="Slide 8 Banco de Dados: Uma Aplica√ß√£o CRUD | GTI - Banco de dados - 2025 - Anota√ß√µes de aula" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="your book url like https://bookdown.org/yihui/bookdown/images/cover.jpg" />
  <meta property="og:description" content="Este livreto re√∫ne anota√ß√µes, reflex√µes e conte√∫dos desenvolvidos ao longo das aulas da disciplina Banco de Dados, ministrada pelo Professor Migu√©l Suares. Elaborado com base em experi√™ncias pr√°ticas, refer√™ncias acad√™micas e diretrizes atualizadas sobre o tema, o material busca fornecer uma vis√£o cr√≠tica e aplicada sobre an√°lise de dados nas organiza√ß√µes contempor√¢neas." />
  <meta name="github-repo" content="miguel7penteado/2025-2sem-GTI-BancoDeDados" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Slide 8 Banco de Dados: Uma Aplica√ß√£o CRUD | GTI - Banco de dados - 2025 - Anota√ß√µes de aula" />
  
  <meta name="twitter:description" content="Este livreto re√∫ne anota√ß√µes, reflex√µes e conte√∫dos desenvolvidos ao longo das aulas da disciplina Banco de Dados, ministrada pelo Professor Migu√©l Suares. Elaborado com base em experi√™ncias pr√°ticas, refer√™ncias acad√™micas e diretrizes atualizadas sobre o tema, o material busca fornecer uma vis√£o cr√≠tica e aplicada sobre an√°lise de dados nas organiza√ß√µes contempor√¢neas." />
  <meta name="twitter:image" content="your book url like https://bookdown.org/yihui/bookdown/images/cover.jpg" />

<meta name="author" content="Professor Migu√©l Suares" />


<meta name="date" content="2025-10-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="o-que-√©-uma-aplica√ß√£o-crud.html"/>
<link rel="next" href="banco-de-dados-mysql-mariadb.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">2025-GTI- Disciplina de Banco de Dados - Anota√ß√µes de Aula</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Sobre estas anota√ß√µes</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#acesso-ao-gitbook-celular"><i class="fa fa-check"></i><b>0.1</b> ACESSO AO GITBOOK CELULAR</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#leitores-de-formato-de-arquivo-epub-para-smartphone"><i class="fa fa-check"></i><b>0.2</b> Leitores de formato de arquivo EPUB para SmartPhone</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#android"><i class="fa fa-check"></i><b>0.2.1</b> ANDROID</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#livros-texto-da-disciplina"><i class="fa fa-check"></i><b>0.3</b> Livros Texto da Disciplina</a>
<ul>
<li class="chapter" data-level="0.3.1" data-path="index.html"><a href="index.html#introdu√ß√£o-a-sistemas-de-bancos-de-dados-do-autor-christopher-john-date"><i class="fa fa-check"></i><b>0.3.1</b> ‚ÄúIntrodu√ß√£o a sistemas de bancos de dados‚Äù do autor ‚Äú<strong>Christopher John Date</strong>‚Äù</a></li>
<li class="chapter" data-level="0.3.2" data-path="index.html"><a href="index.html#projeto-de-bancos-de-dados-do-autor-carlos-alberto-heuser"><i class="fa fa-check"></i><b>0.3.2</b> ‚Äú<strong>Projeto de bancos de dados</strong>‚Äù do autor ‚ÄúCarlos Alberto HEUSER‚Äù</a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#calend√°rio-das-aulas"><i class="fa fa-check"></i><b>0.4</b> Calend√°rio das aulas</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#alunos-2025---2o-semestre"><i class="fa fa-check"></i><b>0.5</b> Alunos 2025 - 2o Semestre</a>
<ul>
<li class="chapter" data-level="0.5.1" data-path="index.html"><a href="index.html#campus-ch√°cara-santo-ant√¥nio"><i class="fa fa-check"></i><b>0.5.1</b> Campus Ch√°cara Santo Ant√¥nio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="aula-inaugural.html"><a href="aula-inaugural.html"><i class="fa fa-check"></i><b>1</b> Aula Inaugural</a>
<ul>
<li class="chapter" data-level="1.1" data-path="aula-inaugural.html"><a href="aula-inaugural.html#disciplina-banco-de-dados"><i class="fa fa-check"></i><b>1.1</b> Disciplina: <strong>Banco de Dados</strong></a></li>
<li class="chapter" data-level="1.2" data-path="aula-inaugural.html"><a href="aula-inaugural.html#sobre-o-professor"><i class="fa fa-check"></i><b>1.2</b> üë®‚Äçüè´ Sobre o Professor</a></li>
<li class="chapter" data-level="1.3" data-path="aula-inaugural.html"><a href="aula-inaugural.html#objetivos-da-disciplina"><i class="fa fa-check"></i><b>1.3</b> üéØ Objetivos da Disciplina</a></li>
<li class="chapter" data-level="1.4" data-path="aula-inaugural.html"><a href="aula-inaugural.html#calend√°rio-da-disciplina"><i class="fa fa-check"></i><b>1.4</b> üìÖ Calend√°rio da Disciplina</a></li>
<li class="chapter" data-level="1.5" data-path="aula-inaugural.html"><a href="aula-inaugural.html#ementa-resumida"><i class="fa fa-check"></i><b>1.5</b> üìö Ementa Resumida</a></li>
<li class="chapter" data-level="1.6" data-path="aula-inaugural.html"><a href="aula-inaugural.html#avalia√ß√£o"><i class="fa fa-check"></i><b>1.6</b> üìù Avalia√ß√£o</a></li>
<li class="chapter" data-level="1.7" data-path="aula-inaugural.html"><a href="aula-inaugural.html#ferramentas-da-disciplina"><i class="fa fa-check"></i><b>1.7</b> üõ†Ô∏è Ferramentas da Disciplina</a></li>
<li class="chapter" data-level="1.8" data-path="aula-inaugural.html"><a href="aula-inaugural.html#expectativas-e-regras"><i class="fa fa-check"></i><b>1.8</b> üìå Expectativas e Regras</a></li>
<li class="chapter" data-level="1.9" data-path="aula-inaugural.html"><a href="aula-inaugural.html#dicas-para-mandar-bem"><i class="fa fa-check"></i><b>1.9</b> üí° Dicas para Mandar Bem</a></li>
<li class="chapter" data-level="1.10" data-path="aula-inaugural.html"><a href="aula-inaugural.html#encerramento"><i class="fa fa-check"></i><b>1.10</b> üôå Encerramento</a></li>
<li class="chapter" data-level="1.11" data-path="aula-inaugural.html"><a href="aula-inaugural.html#estamos-prontos"><i class="fa fa-check"></i><b>1.11</b> Estamos prontos?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html"><i class="fa fa-check"></i><b>2</b> Fundamentos de Sistemas de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="2.1" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#o-in√≠cio-edgar-frank-ted-codd-19081923-18042003"><i class="fa fa-check"></i><b>2.1</b> O in√≠cio : Edgar Frank ‚ÄúTed‚Äù Codd (19/08/1923 ‚Äì 18/04/2003)</a></li>
<li class="chapter" data-level="2.2" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-1970-ibm-entra-no-modelo-relacional-systemr-e-sequelsql"><i class="fa fa-check"></i><b>2.2</b> Anos 1970: IBM entra no Modelo relacional: SystemR e SEQUEL/SQL</a></li>
<li class="chapter" data-level="2.3" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-1970-prof-codd-inspira-prof-stonebraker-banco-ingres"><i class="fa fa-check"></i><b>2.3</b> Anos 1970: Prof Codd inspira Prof StoneBraker: BANCO INGRES</a></li>
<li class="chapter" data-level="2.4" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-1980-ingres-semi-livre-vs-ibm-system-r-pago-vs-oracle"><i class="fa fa-check"></i><b>2.4</b> Anos 1980: INGRES (SEMI-LIVRE) vs IBM System R ( pago ) vs ORACLE</a></li>
<li class="chapter" data-level="2.5" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-1990-mysql-e-postgres-que-vira-postgresql"><i class="fa fa-check"></i><b>2.5</b> Anos 1990: MySQL e POSTGRES que vira POSTGRESQL</a></li>
<li class="chapter" data-level="2.6" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-2000-sybase-eo-no-sql"><i class="fa fa-check"></i><b>2.6</b> Anos 2000: Sybase eo No-SQL</a></li>
<li class="chapter" data-level="2.7" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#exerc√≠cios"><i class="fa fa-check"></i><b>2.7</b> Exerc√≠cios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html"><i class="fa fa-check"></i><b>3</b> Modelagem de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#introdu√ß√£o-visitando-a-teoria-de-bancos-de-dados"><i class="fa fa-check"></i><b>3.1</b> Introdu√ß√£o: Visitando a teoria de Bancos de Dados</a></li>
<li class="chapter" data-level="3.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-matem√°tico-de-um-banco-de-dados"><i class="fa fa-check"></i><b>3.2</b> Modelo Matem√°tico de um Banco de Dados</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#podemos-representa-lo-matem√°ticamente-utilizando-a-teoria-dos-conjuntos"><i class="fa fa-check"></i><b>3.2.1</b> Podemos representa-lo matem√°ticamente utilizando a teoria dos conjuntos</a></li>
<li class="chapter" data-level="3.2.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#ent√£o-para-podemos-relacionar-estes-dois-conjuntos-funcion√°rios-e-departamentos-utilizando-a-teoria-das-fun√ß√µes"><i class="fa fa-check"></i><b>3.2.2</b> Ent√£o para podemos relacionar estes dois conjuntos (Funcion√°rios e Departamentos) utilizando a Teoria das Fun√ß√µes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-l√≥gico-de-banco-de-dados"><i class="fa fa-check"></i><b>3.3</b> Modelo L√≥gico de Banco de Dados</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-conceitual-entidade-relacionamento-de-banco-de-dados"><i class="fa fa-check"></i><b>3.3.1</b> Modelo Conceitual ‚ÄúEntidade Relacionamento‚Äù de Banco de Dados</a></li>
<li class="chapter" data-level="3.3.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#composi√ß√£o-e-significado-do-diagrama-entidade-relacionamento-der"><i class="fa fa-check"></i><b>3.3.2</b> Composi√ß√£o e Significado do Diagrama Entidade Relacionamento (DER)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-f√≠sico-de-banco-de-dados"><i class="fa fa-check"></i><b>3.4</b> Modelo F√≠sico de Banco de Dados</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#gera√ß√£o-do-modelo-f√≠sico-para-aplica-lo-ao-sgbd-sistema-de-gerenciamento-de-banco-de-dados"><i class="fa fa-check"></i><b>3.4.1</b> Gera√ß√£o do modelo F√≠sico para aplica-lo ao SGBD (Sistema de Gerenciamento de Banco de Dados):</a></li>
<li class="chapter" data-level="3.4.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#interagindo-com-o-modelo-f√≠sico---a-linguagem-sql-structured-query-language"><i class="fa fa-check"></i><b>3.4.2</b> Interagindo com o Modelo F√≠sico - A linguagem SQL (Structured Query Language)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#exemplo-revenda-de-ve√≠culos-multi-marcas"><i class="fa fa-check"></i><b>3.5</b> EXEMPLO: REVENDA DE VE√çCULOS MULTI-MARCAS</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#passo-1---visualizando-matem√°ticamente-os-dados"><i class="fa fa-check"></i><b>3.5.1</b> Passo 1 - Visualizando matem√°ticamente os dados:</a></li>
<li class="chapter" data-level="3.5.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-l√≥gico-modelo-entidade-relacionamento"><i class="fa fa-check"></i><b>3.5.2</b> Modelo L√≥gico: Modelo Entidade Relacionamento</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#verbos-relacionamentos-e-cardinalidade"><i class="fa fa-check"></i><b>3.6</b> VERBOS: Relacionamentos e Cardinalidade</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#tipos-principais-de-cardinalidade"><i class="fa fa-check"></i><b>3.6.1</b> üîπ Tipos principais de cardinalidade</a></li>
<li class="chapter" data-level="3.6.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#relacionamento-11-um-para-um"><i class="fa fa-check"></i><b>3.6.2</b> 1. Relacionamento <strong>1:1 (Um para Um)</strong></a></li>
<li class="chapter" data-level="3.6.3" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#relacionamento-1n-um-para-muitos"><i class="fa fa-check"></i><b>3.6.3</b> Relacionamento <strong>1:N (Um para Muitos)</strong></a></li>
<li class="chapter" data-level="3.6.4" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#relacionamento-nn-muitos-para-muitos"><i class="fa fa-check"></i><b>3.6.4</b> Relacionamento N:N (Muitos para Muitos)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#entidade-dominante-e-entidade-subordinada"><i class="fa fa-check"></i><b>3.7</b> Entidade Dominante e Entidade Subordinada</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#defini√ß√µes"><i class="fa fa-check"></i><b>3.7.1</b> Defini√ß√µes:</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#cardinalidade-do-modelo-l√≥gico-e-a-cria√ß√£o-de-chaves-estrangeiras-no-modelo-f√≠sico-relacional"><i class="fa fa-check"></i><b>3.8</b> CARDINALIDADE DO MODELO L√ìGICO E A CRIA√á√ÉO DE CHAVES ESTRANGEIRAS NO MODELO F√çSICO-RELACIONAL</a></li>
<li class="chapter" data-level="3.9" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#normaliza√ß√£o-em-bancos-de-dados-relaionais"><i class="fa fa-check"></i><b>3.9</b> Normaliza√ß√£o em Bancos de Dados Relaionais</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#tabela-desnormalizada"><i class="fa fa-check"></i><b>3.9.1</b> Tabela Desnormalizada</a></li>
<li class="chapter" data-level="3.9.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#tabela-normalizada"><i class="fa fa-check"></i><b>3.9.2</b> Tabela Normalizada</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#refer√™ncias"><i class="fa fa-check"></i><b>3.10</b> Refer√™ncias</a></li>
<li class="chapter" data-level="3.11" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#exerc√≠cios-resolvidos"><i class="fa fa-check"></i><b>3.11</b> Exerc√≠cios RESOLVIDOS</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#exerc√≠cios-1"><i class="fa fa-check"></i><b>3.11.1</b> Exerc√≠cios</a></li>
<li class="chapter" data-level="3.11.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#lista-de-exerc√≠cios-modelo-entidade-relacionamento-mer"><i class="fa fa-check"></i><b>3.11.2</b> üìù Lista de Exerc√≠cios ‚Äì Modelo Entidade-Relacionamento (MER)</a></li>
<li class="chapter" data-level="3.11.3" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#respostas-dos-exerc√≠cios"><i class="fa fa-check"></i><b>3.11.3</b> Respostas dos Exerc√≠cios:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><i class="fa fa-check"></i><b>4</b> Administra√ß√£o e Gerenciamento de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="4.1" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#administra√ß√£o-e-gerenciamento-de-banco-de-dados"><i class="fa fa-check"></i><b>4.1</b> Administra√ß√£o e Gerenciamento de Banco de Dados:</a></li>
<li class="chapter" data-level="4.2" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#papel-do-dba-database-administrator"><i class="fa fa-check"></i><b>4.2</b> Papel do DBA (Database Administrator)</a></li>
<li class="chapter" data-level="4.3" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#usu√°rios-grupos-e-esquemas-de-bancos-de-dados"><i class="fa fa-check"></i><b>4.3</b> Usu√°rios, Grupos e Esquemas de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#usu√°rios"><i class="fa fa-check"></i><b>4.3.1</b> Usu√°rios</a></li>
<li class="chapter" data-level="4.3.2" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#esquemas"><i class="fa fa-check"></i><b>4.3.2</b> Esquemas</a></li>
<li class="chapter" data-level="4.3.3" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#grupos-ou-roles"><i class="fa fa-check"></i><b>4.3.3</b> Grupos ou Roles</a></li>
<li class="chapter" data-level="4.3.4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#sistema-de-gerenciamento-de-banco-de-dados-s.g.b.d."><i class="fa fa-check"></i><b>4.3.4</b> Sistema de Gerenciamento de Banco de Dados (S.G.B.D.)</a></li>
<li class="chapter" data-level="4.3.5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#cria√ß√£o-de-usu√°rios-no-mysql"><i class="fa fa-check"></i><b>4.3.5</b> Cria√ß√£o de usu√°rios no MySQL</a></li>
<li class="chapter" data-level="4.3.6" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#cria√ß√£o-de-esquemas-de-banco-de-dados-no-mysql"><i class="fa fa-check"></i><b>4.3.6</b> Cria√ß√£o de Esquemas de Banco de Dados no MySQL</a></li>
<li class="chapter" data-level="4.3.7" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#criando-de-grupos-de-permiss√µes-no-mysql"><i class="fa fa-check"></i><b>4.3.7</b> Criando de Grupos de Permiss√µes no MySQL:</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#fazendo-tudo-funcionar-colocando-usu√°rios-em-grupos-e-concedendo-a-estes-acesso-a-esquemas-de-banco-de-dados"><i class="fa fa-check"></i><b>4.4</b> Fazendo tudo funcionar: Colocando usu√°rios em grupos e concedendo a estes acesso a Esquemas de Banco de Dados:</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#associando-os-esquemas-que-representam-cada-estado-a-cada-grupo-que-representa-cada-regi√ß√£o"><i class="fa fa-check"></i><b>4.4.1</b> Associando os esquemas que representam cada estado a cada grupo (que representa cada regi√ß√£o):</a></li>
<li class="chapter" data-level="4.4.2" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#associando-associando-alunos-a-cada-grupo-regi√£o"><i class="fa fa-check"></i><b>4.4.2</b> Associando associando alunos a cada grupo (regi√£o):</a></li>
<li class="chapter" data-level="4.4.3" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#associando-usu√°rios-aos-grupos"><i class="fa fa-check"></i><b>4.4.3</b> Associando usu√°rios aos grupos</a></li>
<li class="chapter" data-level="4.4.4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#concedendo-privil√©gios-aos-grupos"><i class="fa fa-check"></i><b>4.4.4</b> Concedendo privil√©gios aos grupos:</a></li>
<li class="chapter" data-level="4.4.5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#exemplo-no-mysql"><i class="fa fa-check"></i><b>4.4.5</b> Exemplo no MySQL</a></li>
<li class="chapter" data-level="4.4.6" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#exemplo-no-postgresql"><i class="fa fa-check"></i><b>4.4.6</b> Exemplo no PostGreSQL</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados-1.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados-1.html"><i class="fa fa-check"></i><b>5</b> Administra√ß√£o e Gerenciamento de Bancos de Dados</a></li>
<li class="chapter" data-level="6" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html"><i class="fa fa-check"></i><b>6</b> Banco de Dados: Uma Aplica√ß√£o CRUD</a></li>
<li class="chapter" data-level="7" data-path="o-que-√©-uma-aplica√ß√£o-crud.html"><a href="o-que-√©-uma-aplica√ß√£o-crud.html"><i class="fa fa-check"></i><b>7</b> O que √© uma Aplica√ß√£o CRUD?</a>
<ul>
<li class="chapter" data-level="7.1" data-path="o-que-√©-uma-aplica√ß√£o-crud.html"><a href="o-que-√©-uma-aplica√ß√£o-crud.html#conceito-de-crud"><i class="fa fa-check"></i><b>7.1</b> Conceito de CRUD</a></li>
<li class="chapter" data-level="7.2" data-path="o-que-√©-uma-aplica√ß√£o-crud.html"><a href="o-que-√©-uma-aplica√ß√£o-crud.html#o-padr√£o-de-design-de-sistemas-mvc-model-view-controller"><i class="fa fa-check"></i><b>7.2</b> O padr√£o de Design de Sistemas MVC (Model View Controller)</a></li>
<li class="chapter" data-level="7.3" data-path="o-que-√©-uma-aplica√ß√£o-crud.html"><a href="o-que-√©-uma-aplica√ß√£o-crud.html#construindo-uma-aplica√ß√£o-crud-para-interfacear-com-a-tabela-pessoa"><i class="fa fa-check"></i><b>7.3</b> Construindo uma aplica√ß√£o CRUD para interfacear com a tabela ‚ÄúPessoa‚Äù</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="o-que-√©-uma-aplica√ß√£o-crud.html"><a href="o-que-√©-uma-aplica√ß√£o-crud.html#representa√ß√£o-gr√°fica-no-modelo-f√≠sico-relacional"><i class="fa fa-check"></i><b>7.3.1</b> Representa√ß√£o gr√°fica no modelo F√≠sico-Relacional</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="o-que-√©-uma-aplica√ß√£o-crud.html"><a href="o-que-√©-uma-aplica√ß√£o-crud.html#cria√ß√£o-de-uma-aplica√ß√£o-crud"><i class="fa fa-check"></i><b>7.4</b> Cria√ß√£o de uma aplica√ß√£o CRUD</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><i class="fa fa-check"></i><b>8</b> Banco de Dados: Uma Aplica√ß√£o CRUD</a>
<ul>
<li class="chapter" data-level="8.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-02"><i class="fa fa-check"></i><b>8.1</b> Exemplo 02</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#servidor-python"><i class="fa fa-check"></i><b>8.1.1</b> Servidor python</a></li>
<li class="chapter" data-level="8.1.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex√£o-restful"><i class="fa fa-check"></i><b>8.1.2</b> Cliente HTML (conex√£o Restful)</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-03"><i class="fa fa-check"></i><b>8.2</b> Exemplo 03</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#servidor-perl"><i class="fa fa-check"></i><b>8.2.1</b> Servidor Perl</a></li>
<li class="chapter" data-level="8.2.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex√£o-restful-1"><i class="fa fa-check"></i><b>8.2.2</b> Cliente HTML (conex√£o Restful)</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-05"><i class="fa fa-check"></i><b>8.3</b> Exemplo 05</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#criando-o-arquivo-c-do-servidor"><i class="fa fa-check"></i><b>8.3.1</b> Criando o arquivo C++ do servidor</a></li>
<li class="chapter" data-level="8.3.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#ferramenta-de-compila√ß√£o-cmake"><i class="fa fa-check"></i><b>8.3.2</b> Ferramenta de compila√ß√£o CMAKE</a></li>
<li class="chapter" data-level="8.3.3" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex√£o-restful-2"><i class="fa fa-check"></i><b>8.3.3</b> Cliente HTML (conex√£o Restful)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="banco-de-dados-mysql-mariadb.html"><a href="banco-de-dados-mysql-mariadb.html"><i class="fa fa-check"></i><b>9</b> Banco de Dados: MySQL (MariaDB)</a></li>
<li class="chapter" data-level="10" data-path="banco-de-dados-mysql-mariadb-1.html"><a href="banco-de-dados-mysql-mariadb-1.html"><i class="fa fa-check"></i><b>10</b> Banco de Dados: MySQL (MariaDB)</a></li>
<li class="chapter" data-level="11" data-path="banco-de-dados-postgres.html"><a href="banco-de-dados-postgres.html"><i class="fa fa-check"></i><b>11</b> Banco de Dados: Postgres</a></li>
<li class="chapter" data-level="12" data-path="banco-de-dados-postgres-1.html"><a href="banco-de-dados-postgres-1.html"><i class="fa fa-check"></i><b>12</b> Banco de Dados: Postgres</a></li>
<li class="chapter" data-level="13" data-path="banco-de-dados-espaciais---cliente-qgis.html"><a href="banco-de-dados-espaciais---cliente-qgis.html"><i class="fa fa-check"></i><b>13</b> Banco de Dados Espaciais - Cliente QGIS</a></li>
<li class="chapter" data-level="14" data-path="banco-de-dados-espaciais---cliente-qgis-1.html"><a href="banco-de-dados-espaciais---cliente-qgis-1.html"><i class="fa fa-check"></i><b>14</b> Banco de Dados Espaciais - Cliente QGIS</a></li>
<li class="chapter" data-level="15" data-path="banco-de-dados-estat√≠stico---cliente-rstudio.html"><a href="banco-de-dados-estat√≠stico---cliente-rstudio.html"><i class="fa fa-check"></i><b>15</b> Banco de Dados Estat√≠stico - Cliente Rstudio</a></li>
<li class="chapter" data-level="16" data-path="banco-de-dados-estat√≠stico---cliente-rstudio-1.html"><a href="banco-de-dados-estat√≠stico---cliente-rstudio-1.html"><i class="fa fa-check"></i><b>16</b> Banco de Dados Estat√≠stico - Cliente Rstudio</a></li>
<li class="chapter" data-level="17" data-path="banco-de-dados---an√°lise-de-dados-parte-01.html"><a href="banco-de-dados---an√°lise-de-dados-parte-01.html"><i class="fa fa-check"></i><b>17</b> Banco de Dados - An√°lise de Dados Parte 01</a></li>
<li class="chapter" data-level="18" data-path="banco-de-dados---an√°lise-de-dados-parte-01-1.html"><a href="banco-de-dados---an√°lise-de-dados-parte-01-1.html"><i class="fa fa-check"></i><b>18</b> Banco de Dados - An√°lise de Dados Parte 01</a></li>
<li class="chapter" data-level="19" data-path="banco-de-dados---an√°lise-de-dados-parte-02.html"><a href="banco-de-dados---an√°lise-de-dados-parte-02.html"><i class="fa fa-check"></i><b>19</b> Banco de Dados - An√°lise de Dados Parte 02</a></li>
<li class="chapter" data-level="20" data-path="banco-de-dados---an√°lise-de-dados-parte-02-1.html"><a href="banco-de-dados---an√°lise-de-dados-parte-02-1.html"><i class="fa fa-check"></i><b>20</b> Banco de Dados - An√°lise de Dados Parte 02</a></li>
<li class="chapter" data-level="21" data-path="banco-de-dados---an√°lise-de-dados-parte-03.html"><a href="banco-de-dados---an√°lise-de-dados-parte-03.html"><i class="fa fa-check"></i><b>21</b> Banco de Dados - An√°lise de Dados Parte 03</a></li>
<li class="chapter" data-level="22" data-path="banco-de-dados---an√°lise-de-dados-parte-03-1.html"><a href="banco-de-dados---an√°lise-de-dados-parte-03-1.html"><i class="fa fa-check"></i><b>22</b> Banco de Dados - An√°lise de Dados Parte 03</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado com Biblioteca R bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GTI - Banco de dados - 2025 - Anota√ß√µes de aula</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="banco-de-dados-uma-aplica√ß√£o-crud-1" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Slide 8</span> Banco de Dados: Uma Aplica√ß√£o CRUD<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#banco-de-dados-uma-aplica√ß√£o-crud-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="section-6" class="section level4 unnumbered hasAnchor">
<h4>01/09/2025<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#section-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="professor-migu√©l-suares-6" class="section level4 unnumbered hasAnchor">
<h4>Professor Migu√©l Suares<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#professor-migu√©l-suares-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">## Exemplo 01</td>
</tr>
<tr class="even">
<td align="left">Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</td>
</tr>
<tr class="odd">
<td align="left">A interface do Cliente √© feita em HTML5</td>
</tr>
<tr class="even">
<td align="left">A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</td>
</tr>
<tr class="odd">
<td align="left">CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</td>
</tr>
<tr class="even">
<td align="left">O servidor Restful √© interno ao pr√≥prio SUPABASE (n√£o precisa programar)</td>
</tr>
<tr class="odd">
<td align="left">OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</td>
</tr>
<tr class="even">
<td align="left">crie o arquivo index.html e abra-o no navegador</td>
</tr>
<tr class="odd">
<td align="left">servidor estar√° rodando na porta 80 e EXP√ïE A API de opera√ß√µes na URI <a href="https://pbbtfwmydxmxdibmtbqq.supabase.co:80/" class="uri">https://pbbtfwmydxmxdibmtbqq.supabase.co:80/</a> com a senha eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiYnRmd215ZHhteGRpYm10YnFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2NTIwNjksImV4cCI6MjA3NDIyODA2OX0.-41ZWZmoYbnA9YUw1kutcWrk7IIMZ6mjTmzsBvtHPEo</td>
</tr>
<tr class="even">
<td align="left"><code>css https://pbbtfwmydxmxdibmtbqq.supabase.co:80/</code></td>
</tr>
<tr class="odd">
<td align="left">``` html</td>
</tr>
<tr class="even">
<td align="left">&lt;!DOCTYPE html&gt;</td>
</tr>
<tr class="odd">
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><button type="button" onclick="inserir()">Inserir</button> <button type="button" onclick="alterar()">Alterar</button> <button type="button" onclick="remover()">Remover</button></td>
</tr>
<tr class="odd">
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">31b8e172-b470-440e-83d8-e6b185028602:dAB5AHAAZQA6AE8AQQBCAGwAQQBHAFkAQQBOAFEAQgBoAEEARABjAEEATgB3AEEAeQBBAEMAMABBAFoAQQBCAGsAQQBEAFkAQQBNAHcAQQB0AEEARABRAEEATgBnAEEAeQBBAEQASQBBAEwAUQBBADQAQQBEAFEAQQBZAGcAQgBtAEEAQwAwAEEAWQBRAEIAbQBBAEQARQBBAE8AUQBBADUAQQBEAFUAQQBZAFEAQQB4AEEARwBJAEEATQBnAEIAaQBBAEQAawBBAAoAcABvAHMAaQB0AGkAbwBuADoATQBnAEEAegBBAEQAZwBBAE4AdwBBAD0ACgBwAHIAZQBmAGkAeAA6AAoAcwBvAHUAcgBjAGUAOgBQAEEAQgAwAEEARwBFAEEAWQBnAEIAcwBBAEcAVQBBAFAAZwBBAEsAQQBDAEEAQQBJAEEAQQA4AEEASABRAEEAYQBBAEIAbABBAEcARQBBAFoAQQBBACsAQQBBAG8AQQBJAEEAQQBnAEEAQwBBAEEASQBBAEEAOABBAEgAUQBBAGMAZwBBACsAQQBBAG8AQQBJAEEAQQBnAEEAQwBBAEEASQBBAEEAZwBBAEMAQQBBAFAAQQBCADAAQQBHAGcAQQBQAGcAQgBEAEEARgBBAEEAUgBnAEEAOABBAEMAOABBAGQAQQBCAG8AQQBEADQAQQBQAEEAQgAwAEEARwBnAEEAUABnAEIARwBBAEcAOABBAGQAQQBCAHYAQQBEAHcAQQBMAHcAQgAwAEEARwBnAEEAUABnAEEAOABBAEgAUQBBAGEAQQBBACsAQQBFADQAQQBiAHcAQgB0AEEARwBVAEEAUABBAEEAdgBBAEgAUQBBAGEAQQBBACsAQQBBAG8AQQBJAEEAQQBnAEEAQwBBAEEASQBBAEEAZwBBAEMAQQBBAFAAQQBCADAAQQBHAGcAQQBQAGcAQgBGAEEARwA0AEEAWgBBAEIAbABBAEgASQBBAFoAUQBEAG4AQQBHADgAQQBQAEEAQQB2AEEASABRAEEAYQBBAEEAKwBBAEQAdwBBAGQAQQBCAG8AQQBEADQAQQBUAGcAQgBoAEEASABNAEEAWQB3AEIAcABBAEcAMABBAFoAUQBCAHUAQQBIAFEAQQBiAHcAQQA4AEEAQwA4AEEAZABBAEIAbwBBAEQANABBAEMAZwBBAGcAQQBDAEEAQQBJAEEAQQBnAEEARAB3AEEATAB3AEIAMABBAEgASQBBAFAAZwBBAEsAQQBDAEEAQQBJAEEAQQA4AEEAQwA4AEEAZABBAEIAbwBBAEcAVQBBAFkAUQBCAGsAQQBEADQAQQBDAGcAQQBnAEEAQwBBAEEAUABBAEIAMABBAEcASQBBAGIAdwBCAGsAQQBIAGsAQQBJAEEAQgBwAEEARwBRAEEAUABRAEEAaQBBAEgAUQBBAFkAUQBCAGkAQQBHAFUAQQBiAEEAQgBoAEEAQwBJAEEAUABnAEEAOABBAEMAOABBAGQAQQBCAGkAQQBHADgAQQBaAEEAQgA1AEEARAA0AEEAQwBnAEEAOABBAEMAOABBAGQAQQBCAGgAQQBHAEkAQQBiAEEAQgBsAEEARAA0AEEACgBzAHUAZgBmAGkAeAA6AA==:31b8e172-b470-440e-83d8-e6b185028602</td>
</tr>
<tr class="odd">
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">/* ‚Äî‚Äî‚Äî- Fun√ß√µes utilit√°rias ‚Äî‚Äî‚Äî- */ function validaCampos() { const campos = [‚Äòcpf‚Äô,‚Äònome‚Äô,‚Äòendereco‚Äô,‚Äòdata_nascimento‚Äô]; for (const id of campos) { const valor = document.getElementById(id).value.trim(); if (!valor) { alert(<code>O campo "${id}" n√£o pode ficar em branco.</code>); return false; } } return true; } function getFotoBase64() { const file = document.getElementById(‚Äòfoto‚Äô).files[0]; if(!file) return Promise.resolve(‚Äô‚Äò); return new Promise((resolve,reject)=&gt;{ const reader = new FileReader(); reader.onload = () =&gt; resolve(reader.result); reader.onerror = reject; reader.readAsDataURL(file); }); } function coletaDados(base64Foto){ return { cpf: document.getElementById(‚Äôcpf‚Äô).value.trim(), nome: document.getElementById(‚Äònome‚Äô).value.trim(), endereco: document.getElementById(‚Äòendereco‚Äô).value.trim(), data_nascimento: document.getElementById(‚Äòdata_nascimento‚Äô).value, foto: base64Foto || ‚Äô‚Äô }; }</td>
</tr>
<tr class="odd">
<td align="left">/* ‚Äî‚Äî‚Äî- CRUD Supabase ‚Äî‚Äî‚Äî- */ async function inserir() { if (!validaCampos()) return; const base64 = await getFotoBase64(); const pessoa = coletaDados(base64);</td>
</tr>
<tr class="even">
<td align="left">// Verifica se j√° existe const { <a href="data:existe" class="uri">data:existe</a> } = await supabase .from(‚Äòpessoas‚Äô) .select(‚Äòcpf‚Äô) .eq(‚Äòcpf‚Äô, pessoa.cpf); if(existe &amp;&amp; existe.length) { alert(‚ÄòJ√° existe um registro com este CPF.‚Äô); return; }</td>
</tr>
<tr class="odd">
<td align="left">const { error } = await supabase .from(‚Äòpessoas‚Äô) .insert([pessoa]); if(error) alert(‚ÄòErro ao inserir:‚Äô + error.message); else { alert(‚ÄòInserido!‚Äô); listar(); } }</td>
</tr>
<tr class="even">
<td align="left">async function alterar() { if (!validaCampos()) return; const cpf = document.getElementById(‚Äòcpf‚Äô).value.trim(); const base64 = await getFotoBase64(); const novosDados = coletaDados(); if(base64) novosDados.foto = base64;</td>
</tr>
<tr class="odd">
<td align="left">const { error } = await supabase .from(‚Äòpessoas‚Äô) .update(novosDados) .eq(‚Äòcpf‚Äô, cpf); if(error) alert(‚ÄòErro ao alterar:‚Äô + error.message); else { alert(‚ÄòAlterado!‚Äô); listar(); } }</td>
</tr>
<tr class="even">
<td align="left">async function remover() { const cpf = document.getElementById(‚Äòcpf‚Äô).value.trim(); if(!cpf) return alert(‚ÄòInforme o CPF para remover.‚Äô); if(confirm(‚ÄòConfirma a exclus√£o?‚Äô)){ const { error } = await supabase .from(‚Äòpessoas‚Äô) .delete() .eq(‚Äòcpf‚Äô, cpf); if(error) alert(‚ÄòErro ao remover:‚Äô + error.message); else { alert(‚ÄòRemovido!‚Äô); listar(); } } }</td>
</tr>
<tr class="odd">
<td align="left">async function pesquisar() { const termo = document.getElementById(‚Äòpesquisa‚Äô).value.trim(); if(!termo){ listar(); return; } const { data, error } = await supabase .from(‚Äòpessoas‚Äô) .select(‚Äò*‚Äô) .or(<code>cpf.ilike.%${termo}%,nome.ilike.%${termo}%</code>); if(error) alert(‚ÄòErro:‚Äô + error.message); else preencheTabela(data); }</td>
</tr>
<tr class="even">
<td align="left">async function listar(){ const { data, error } = await supabase .from(‚Äòpessoas‚Äô) .select(‚Äò*‚Äô); if(error) alert(‚ÄòErro:‚Äô + error.message); else preencheTabela(data); }</td>
</tr>
<tr class="odd">
<td align="left">/* ‚Äî‚Äî‚Äî- UI ‚Äî‚Äî‚Äî- */ function preencheTabela(lista){ const tbody = document.getElementById(‚Äòtabela‚Äô); tbody.innerHTML = ‚Äô‚Äò; lista.forEach(p=&gt;{ const tr = document.createElement(‚Äôtr‚Äô); tr.innerHTML = <code>&lt;td&gt;${p.cpf}&lt;/td&gt; &lt;td&gt;${p.foto ?</code><img src="${p.foto}" alt="foto" class="thumb"/><code>: ''}&lt;/td&gt; &lt;td&gt;${p.nome}&lt;/td&gt; &lt;td&gt;${p.endereco}&lt;/td&gt; &lt;td&gt;${p.data_nascimento}&lt;/td&gt;</code>; tr.onclick = () =&gt; { document.getElementById(‚Äòcpf‚Äô).value = p.cpf; document.getElementById(‚Äònome‚Äô).value = p.nome; document.getElementById(‚Äòendereco‚Äô).value = p.endereco; document.getElementById(‚Äòdata_nascimento‚Äô).value = p.data_nascimento; }; tbody.appendChild(tr); }); }</td>
</tr>
<tr class="even">
<td align="left">listar(); // carrega ao abrir </script></td>
</tr>
</tbody>
</table>
</div>
<div id="exemplo-02" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Exemplo 02<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-02" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</p>
<p>A interface do Cliente √© feita em HTML5</p>
<p>A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</p>
<p>CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</p>
<p>O servidor Restful √© feito em linguagem PYTHON</p>
<p>OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb41-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb41-1" tabindex="-1"></a>python <span class="at">-m</span> pip install -<span class="at">-user</span> -<span class="at">-upgrade</span> flask flask<span class="at">-cors</span> sqlalchemy psycopg2<span class="at">-binary</span></span></code></pre></div>
<div id="servidor-python" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Servidor python<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#servidor-python" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-1" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb42-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-2" tabindex="-1"></a><span class="im">from</span> flask_cors <span class="im">import</span> CORS</span>
<span id="cb42-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-3" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine, Column, String, Date, Text</span>
<span id="cb42-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-4" tabindex="-1"></a><span class="im">from</span> sqlalchemy.ext.declarative <span class="im">import</span> declarative_base</span>
<span id="cb42-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-5" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker</span>
<span id="cb42-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-6" tabindex="-1"></a></span>
<span id="cb42-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-7" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-8" tabindex="-1"></a><span class="co"># Configura√ß√£o do Flask e CORS</span></span>
<span id="cb42-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-9" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-10" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb42-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-11" tabindex="-1"></a>CORS(app)</span>
<span id="cb42-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-12" tabindex="-1"></a></span>
<span id="cb42-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-13" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-14" tabindex="-1"></a><span class="co"># Configura√ß√£o do banco PostgreSQL</span></span>
<span id="cb42-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-15" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-16" tabindex="-1"></a>DATABASE_URL <span class="op">=</span> <span class="st">&quot;postgresql://postgres:MinhaSuperSenha@db.pbbtfwmydxmxdibmtbqq.supabase.co:5432/postgres&quot;</span></span>
<span id="cb42-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-17" tabindex="-1"></a></span>
<span id="cb42-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-18" tabindex="-1"></a>engine <span class="op">=</span> create_engine(DATABASE_URL)</span>
<span id="cb42-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-19" tabindex="-1"></a>SessionLocal <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine)</span>
<span id="cb42-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-20" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb42-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-21" tabindex="-1"></a></span>
<span id="cb42-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-22" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-23" tabindex="-1"></a><span class="co"># Modelo Pessoa</span></span>
<span id="cb42-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-24" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-25" tabindex="-1"></a><span class="kw">class</span> Pessoa(Base):</span>
<span id="cb42-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-26" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">&quot;pessoas&quot;</span></span>
<span id="cb42-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-27" tabindex="-1"></a>    cpf <span class="op">=</span> Column(String(<span class="dv">14</span>), primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb42-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-28" tabindex="-1"></a>    nome <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb42-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-29" tabindex="-1"></a>    endereco <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb42-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-30" tabindex="-1"></a>    data_nascimento <span class="op">=</span> Column(Date, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb42-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-31" tabindex="-1"></a>    foto <span class="op">=</span> Column(Text)  <span class="co"># Base64 ou URL</span></span>
<span id="cb42-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-32" tabindex="-1"></a></span>
<span id="cb42-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-33" tabindex="-1"></a><span class="co"># Cria a tabela se n√£o existir</span></span>
<span id="cb42-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-34" tabindex="-1"></a>Base.metadata.create_all(engine)</span>
<span id="cb42-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-35" tabindex="-1"></a></span>
<span id="cb42-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-36" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-37" tabindex="-1"></a><span class="co"># CRUD</span></span>
<span id="cb42-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-38" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-39" tabindex="-1"></a></span>
<span id="cb42-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-40" tabindex="-1"></a><span class="co"># Listar todas as pessoas ou pesquisar por termo</span></span>
<span id="cb42-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-41" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb42-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-42" tabindex="-1"></a><span class="kw">def</span> listar():</span>
<span id="cb42-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-43" tabindex="-1"></a>    termo <span class="op">=</span> request.args.get(<span class="st">&#39;q&#39;</span>, <span class="st">&#39;&#39;</span>).lower()</span>
<span id="cb42-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-44" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb42-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-45" tabindex="-1"></a>    <span class="cf">if</span> termo:</span>
<span id="cb42-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-46" tabindex="-1"></a>        pessoas <span class="op">=</span> session.query(Pessoa).<span class="bu">filter</span>(</span>
<span id="cb42-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-47" tabindex="-1"></a>            (Pessoa.nome.ilike(<span class="ss">f&quot;%</span><span class="sc">{</span>termo<span class="sc">}</span><span class="ss">%&quot;</span>)) <span class="op">|</span> (Pessoa.cpf.ilike(<span class="ss">f&quot;%</span><span class="sc">{</span>termo<span class="sc">}</span><span class="ss">%&quot;</span>))</span>
<span id="cb42-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-48" tabindex="-1"></a>        ).<span class="bu">all</span>()</span>
<span id="cb42-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-49" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb42-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-50" tabindex="-1"></a>        pessoas <span class="op">=</span> session.query(Pessoa).<span class="bu">all</span>()</span>
<span id="cb42-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-51" tabindex="-1"></a>    session.close()</span>
<span id="cb42-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-52" tabindex="-1"></a>    <span class="cf">return</span> jsonify([{</span>
<span id="cb42-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-53" tabindex="-1"></a>        <span class="st">&quot;cpf&quot;</span>: p.cpf,</span>
<span id="cb42-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-54" tabindex="-1"></a>        <span class="st">&quot;nome&quot;</span>: p.nome,</span>
<span id="cb42-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-55" tabindex="-1"></a>        <span class="st">&quot;endereco&quot;</span>: p.endereco,</span>
<span id="cb42-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-56" tabindex="-1"></a>        <span class="st">&quot;data_nascimento&quot;</span>: p.data_nascimento.isoformat(),</span>
<span id="cb42-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-57" tabindex="-1"></a>        <span class="st">&quot;foto&quot;</span>: p.foto</span>
<span id="cb42-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-58" tabindex="-1"></a>    } <span class="cf">for</span> p <span class="kw">in</span> pessoas])</span>
<span id="cb42-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-59" tabindex="-1"></a></span>
<span id="cb42-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-60" tabindex="-1"></a><span class="co"># Inserir nova pessoa</span></span>
<span id="cb42-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-61" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;POST&#39;</span>])</span>
<span id="cb42-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-62" tabindex="-1"></a><span class="kw">def</span> inserir():</span>
<span id="cb42-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-63" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json()</span>
<span id="cb42-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-64" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb42-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-65" tabindex="-1"></a>    <span class="cf">if</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>]).first():</span>
<span id="cb42-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-66" tabindex="-1"></a>        session.close()</span>
<span id="cb42-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-67" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF j√° cadastrado&quot;</span>}), <span class="dv">400</span></span>
<span id="cb42-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-68" tabindex="-1"></a>    pessoa <span class="op">=</span> Pessoa(</span>
<span id="cb42-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-69" tabindex="-1"></a>        cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>],</span>
<span id="cb42-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-70" tabindex="-1"></a>        nome<span class="op">=</span>dados[<span class="st">&#39;nome&#39;</span>],</span>
<span id="cb42-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-71" tabindex="-1"></a>        endereco<span class="op">=</span>dados[<span class="st">&#39;endereco&#39;</span>],</span>
<span id="cb42-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-72" tabindex="-1"></a>        data_nascimento<span class="op">=</span>dados[<span class="st">&#39;data_nascimento&#39;</span>],</span>
<span id="cb42-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-73" tabindex="-1"></a>        foto<span class="op">=</span>dados.get(<span class="st">&#39;foto&#39;</span>)</span>
<span id="cb42-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-74" tabindex="-1"></a>    )</span>
<span id="cb42-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-75" tabindex="-1"></a>    session.add(pessoa)</span>
<span id="cb42-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-76" tabindex="-1"></a>    session.commit()</span>
<span id="cb42-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-77" tabindex="-1"></a>    session.close()</span>
<span id="cb42-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-78" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&quot;message&quot;</span>: <span class="st">&quot;Inserido com sucesso&quot;</span>}), <span class="dv">201</span></span>
<span id="cb42-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-79" tabindex="-1"></a></span>
<span id="cb42-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-80" tabindex="-1"></a><span class="co"># Alterar pessoa</span></span>
<span id="cb42-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-81" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;PUT&#39;</span>])</span>
<span id="cb42-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-82" tabindex="-1"></a><span class="kw">def</span> alterar(cpf):</span>
<span id="cb42-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-83" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json()</span>
<span id="cb42-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-84" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb42-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-85" tabindex="-1"></a>    pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb42-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-86" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb42-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-87" tabindex="-1"></a>        session.close()</span>
<span id="cb42-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-88" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb42-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-89" tabindex="-1"></a>    pessoa.nome <span class="op">=</span> dados.get(<span class="st">&#39;nome&#39;</span>, pessoa.nome)</span>
<span id="cb42-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-90" tabindex="-1"></a>    pessoa.endereco <span class="op">=</span> dados.get(<span class="st">&#39;endereco&#39;</span>, pessoa.endereco)</span>
<span id="cb42-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-91" tabindex="-1"></a>    pessoa.data_nascimento <span class="op">=</span> dados.get(<span class="st">&#39;data_nascimento&#39;</span>, pessoa.data_nascimento)</span>
<span id="cb42-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-92" tabindex="-1"></a>    pessoa.foto <span class="op">=</span> dados.get(<span class="st">&#39;foto&#39;</span>, pessoa.foto)</span>
<span id="cb42-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-93" tabindex="-1"></a>    session.commit()</span>
<span id="cb42-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-94" tabindex="-1"></a>    session.close()</span>
<span id="cb42-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-95" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&quot;message&quot;</span>: <span class="st">&quot;Alterado com sucesso&quot;</span>})</span>
<span id="cb42-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-96" tabindex="-1"></a></span>
<span id="cb42-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-97" tabindex="-1"></a><span class="co"># Remover pessoa</span></span>
<span id="cb42-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-98" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;DELETE&#39;</span>])</span>
<span id="cb42-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-99" tabindex="-1"></a><span class="kw">def</span> remover(cpf):</span>
<span id="cb42-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-100" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb42-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-101" tabindex="-1"></a>    pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb42-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-102" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb42-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-103" tabindex="-1"></a>        session.close()</span>
<span id="cb42-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-104" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb42-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-105" tabindex="-1"></a>    session.delete(pessoa)</span>
<span id="cb42-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-106" tabindex="-1"></a>    session.commit()</span>
<span id="cb42-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-107" tabindex="-1"></a>    session.close()</span>
<span id="cb42-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-108" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&quot;message&quot;</span>: <span class="st">&quot;Removido com sucesso&quot;</span>})</span>
<span id="cb42-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-109" tabindex="-1"></a></span>
<span id="cb42-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-110" tabindex="-1"></a><span class="co"># Buscar pessoa por CPF</span></span>
<span id="cb42-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-111" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb42-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-112" tabindex="-1"></a><span class="kw">def</span> buscar(cpf):</span>
<span id="cb42-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-113" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb42-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-114" tabindex="-1"></a>    pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb42-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-115" tabindex="-1"></a>    session.close()</span>
<span id="cb42-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-116" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb42-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-117" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb42-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-118" tabindex="-1"></a>    <span class="cf">return</span> jsonify({</span>
<span id="cb42-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-119" tabindex="-1"></a>        <span class="st">&quot;cpf&quot;</span>: pessoa.cpf,</span>
<span id="cb42-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-120" tabindex="-1"></a>        <span class="st">&quot;nome&quot;</span>: pessoa.nome,</span>
<span id="cb42-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-121" tabindex="-1"></a>        <span class="st">&quot;endereco&quot;</span>: pessoa.endereco,</span>
<span id="cb42-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-122" tabindex="-1"></a>        <span class="st">&quot;data_nascimento&quot;</span>: pessoa.data_nascimento.isoformat(),</span>
<span id="cb42-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-123" tabindex="-1"></a>        <span class="st">&quot;foto&quot;</span>: pessoa.foto</span>
<span id="cb42-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-124" tabindex="-1"></a>    })</span>
<span id="cb42-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-125" tabindex="-1"></a></span>
<span id="cb42-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-126" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-127" tabindex="-1"></a><span class="co"># Inicia o servidor</span></span>
<span id="cb42-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-128" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb42-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-129" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb42-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb42-130" tabindex="-1"></a>    app.run(debug<span class="op">=</span><span class="va">True</span>, port<span class="op">=</span><span class="dv">5000</span>)</span></code></pre></div>
<p>servidor estar√° rodando na porta 5000 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:5000/pessoas" class="uri">http://localhost:5000/pessoas</a> sem senha</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb43-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb43-1" tabindex="-1"></a>http<span class="in">:</span><span class="er">//localhost:5000/pessoas</span></span></code></pre></div>
</div>
<div id="cliente-html-conex√£o-restful" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Cliente HTML (conex√£o Restful)<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex√£o-restful" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>crie o arquivo index.html e abra-o no navegador</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb44-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb44-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb44-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb44-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb44-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas - Flask/MySQL<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb44-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb44-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">system-ui</span><span class="op">,</span> <span class="dv">-apple-system</span><span class="op">,</span> <span class="dv">Segoe UI</span><span class="op">,</span> <span class="dv">Roboto</span><span class="op">,</span> <span class="dv">Arial</span><span class="op">;</span> <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">980</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">24</span><span class="dt">px</span> <span class="bu">auto</span><span class="op">;</span> }</span>
<span id="cb44-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-8" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb44-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-9" tabindex="-1"></a>  button { <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin-right</span><span class="ch">:</span> <span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span> <span class="dv">12</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb44-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-10" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span><span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span><span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb44-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-11" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span><span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb44-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-12" tabindex="-1"></a>  img<span class="fu">.thumb</span> { <span class="kw">width</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">height</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">object-fit</span><span class="ch">:</span><span class="dv">cover</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span><span class="dv">4</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb44-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-13" tabindex="-1"></a>  <span class="fu">.row</span> { <span class="kw">display</span><span class="ch">:</span><span class="dv">flex</span><span class="op">;</span> <span class="kw">gap</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">align-items</span><span class="ch">:</span><span class="dv">center</span><span class="op">;</span> <span class="kw">flex-wrap</span><span class="ch">:</span><span class="dv">wrap</span><span class="op">;</span> }</span>
<span id="cb44-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-14" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb44-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-15" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb44-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-16" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb44-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-17" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas (Flask/MySQL)<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb44-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-18" tabindex="-1"></a></span>
<span id="cb44-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-19" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;formPessoa&quot;</span><span class="dt">&gt;</span></span>
<span id="cb44-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-20" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF (chave prim√°ria): <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb44-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-21" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb44-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-22" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb44-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-23" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data Nasc.: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;data_nascimento&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb44-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-24" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="ot"> accept</span><span class="op">=</span><span class="st">&quot;image/*&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb44-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-25" tabindex="-1"></a></span>
<span id="cb44-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-26" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb44-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-27" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnInserir&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;inserir()&quot;</span><span class="dt">&gt;</span>Inserir<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb44-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-28" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnAlterar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;alterar()&quot;</span><span class="dt">&gt;</span>Alterar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb44-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-29" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnRemover&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;remover()&quot;</span><span class="dt">&gt;</span>Remover<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb44-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-30" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb44-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-31" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb44-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-32" tabindex="-1"></a></span>
<span id="cb44-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-33" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb44-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-34" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb44-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-35" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pesquisa&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Digite nome ou CPF&quot;</span><span class="ot"> style</span><span class="op">=</span><span class="st">&quot;flex:1&quot;</span><span class="dt">&gt;</span></span>
<span id="cb44-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-36" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnPesquisar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;pesquisar()&quot;</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb44-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-37" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;listar()&quot;</span><span class="dt">&gt;</span>Listar tudo<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb44-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-38" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb44-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-39" tabindex="-1"></a></span>
<span id="cb44-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-40" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb44-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-41" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb44-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-42" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb44-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-43" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb44-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-44" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb44-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-45" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb44-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-46" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb44-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-47" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabela&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb44-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-48" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb44-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-49" tabindex="-1"></a></span>
<span id="cb44-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-50" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb44-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-51" tabindex="-1"></a><span class="kw">const</span> API <span class="op">=</span> <span class="st">&#39;http://localhost:5000/pessoas&#39;</span><span class="op">;</span></span>
<span id="cb44-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-52" tabindex="-1"></a></span>
<span id="cb44-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-53" tabindex="-1"></a><span class="co">/* ---------- Helpers ---------- */</span></span>
<span id="cb44-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-54" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setBusy</span>(busy) {</span>
<span id="cb44-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-55" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> [<span class="st">&#39;btnInserir&#39;</span><span class="op">,</span><span class="st">&#39;btnAlterar&#39;</span><span class="op">,</span><span class="st">&#39;btnRemover&#39;</span><span class="op">,</span><span class="st">&#39;btnPesquisar&#39;</span>]) {</span>
<span id="cb44-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-56" tabindex="-1"></a>    <span class="kw">const</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">;</span></span>
<span id="cb44-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-57" tabindex="-1"></a>    <span class="cf">if</span> (el) el<span class="op">.</span><span class="at">disabled</span> <span class="op">=</span> busy<span class="op">;</span></span>
<span id="cb44-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-58" tabindex="-1"></a>  }</span>
<span id="cb44-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-59" tabindex="-1"></a>}</span>
<span id="cb44-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-60" tabindex="-1"></a></span>
<span id="cb44-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-61" tabindex="-1"></a><span class="kw">function</span> <span class="fu">validaCampos</span>() {</span>
<span id="cb44-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-62" tabindex="-1"></a>  <span class="kw">const</span> campos <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span><span class="op">,</span><span class="st">&#39;nome&#39;</span><span class="op">,</span><span class="st">&#39;endereco&#39;</span><span class="op">,</span><span class="st">&#39;data_nascimento&#39;</span>]<span class="op">;</span></span>
<span id="cb44-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-63" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> campos) {</span>
<span id="cb44-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-64" tabindex="-1"></a>    <span class="kw">const</span> valor <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb44-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-65" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>valor) {</span>
<span id="cb44-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-66" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="vs">`O campo &quot;</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">&quot; n√£o pode ficar em branco.`</span>)<span class="op">;</span></span>
<span id="cb44-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-67" tabindex="-1"></a>      <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb44-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-68" tabindex="-1"></a>    }</span>
<span id="cb44-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-69" tabindex="-1"></a>  }</span>
<span id="cb44-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-70" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb44-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-71" tabindex="-1"></a>}</span>
<span id="cb44-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-72" tabindex="-1"></a></span>
<span id="cb44-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-73" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getFotoBase64</span>() {</span>
<span id="cb44-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-74" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;foto&#39;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb44-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-75" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>file) <span class="cf">return</span> <span class="bu">Promise</span><span class="op">.</span><span class="fu">resolve</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></span>
<span id="cb44-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-76" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span>reject)<span class="kw">=&gt;</span>{</span>
<span id="cb44-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-77" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb44-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-78" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb44-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-79" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb44-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-80" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb44-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-81" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb44-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-82" tabindex="-1"></a>}</span>
<span id="cb44-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-83" tabindex="-1"></a></span>
<span id="cb44-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-84" tabindex="-1"></a><span class="kw">function</span> <span class="fu">coletaDados</span>(base64Foto){</span>
<span id="cb44-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-85" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb44-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-86" tabindex="-1"></a>    <span class="dt">cpf</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb44-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-87" tabindex="-1"></a>    <span class="dt">nome</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb44-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-88" tabindex="-1"></a>    <span class="dt">endereco</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb44-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-89" tabindex="-1"></a>    <span class="dt">data_nascimento</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">,</span> <span class="co">// YYYY-MM-DD</span></span>
<span id="cb44-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-90" tabindex="-1"></a>    <span class="dt">foto</span><span class="op">:</span> base64Foto <span class="op">||</span> <span class="st">&#39;&#39;</span></span>
<span id="cb44-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-91" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb44-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-92" tabindex="-1"></a>}</span>
<span id="cb44-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-93" tabindex="-1"></a></span>
<span id="cb44-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-94" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">readJsonSafe</span>(res) {</span>
<span id="cb44-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-95" tabindex="-1"></a>  <span class="kw">const</span> ct <span class="op">=</span> res<span class="op">.</span><span class="at">headers</span><span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;content-type&#39;</span>) <span class="op">||</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb44-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-96" tabindex="-1"></a>  <span class="cf">if</span> (ct<span class="op">.</span><span class="fu">includes</span>(<span class="st">&#39;application/json&#39;</span>)) {</span>
<span id="cb44-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-97" tabindex="-1"></a>    <span class="cf">try</span> { <span class="cf">return</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span> } <span class="cf">catch</span> { <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span> }</span>
<span id="cb44-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-98" tabindex="-1"></a>  }</span>
<span id="cb44-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-99" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb44-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-100" tabindex="-1"></a>}</span>
<span id="cb44-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-101" tabindex="-1"></a></span>
<span id="cb44-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-102" tabindex="-1"></a><span class="co">/* ---------- CRUD ---------- */</span></span>
<span id="cb44-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-103" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">inserir</span>() {</span>
<span id="cb44-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-104" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb44-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-105" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb44-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-106" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb44-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-107" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb44-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-108" tabindex="-1"></a>    <span class="kw">const</span> pessoa <span class="op">=</span> <span class="fu">coletaDados</span>(base64)<span class="op">;</span></span>
<span id="cb44-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-109" tabindex="-1"></a></span>
<span id="cb44-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-110" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API<span class="op">,</span> {</span>
<span id="cb44-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-111" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></span>
<span id="cb44-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-112" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb44-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-113" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(pessoa)</span>
<span id="cb44-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-114" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb44-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-115" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb44-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-116" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb44-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-117" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Inserido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb44-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-118" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb44-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-119" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;formPessoa&#39;</span>)<span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb44-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-120" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb44-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-121" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb44-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-122" tabindex="-1"></a>    }</span>
<span id="cb44-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-123" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb44-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-124" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao inserir: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb44-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-125" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb44-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-126" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb44-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-127" tabindex="-1"></a>  }</span>
<span id="cb44-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-128" tabindex="-1"></a>}</span>
<span id="cb44-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-129" tabindex="-1"></a></span>
<span id="cb44-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-130" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">alterar</span>() {</span>
<span id="cb44-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-131" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb44-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-132" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb44-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-133" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb44-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-134" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb44-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-135" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb44-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-136" tabindex="-1"></a>    <span class="kw">const</span> novosDados <span class="op">=</span> <span class="fu">coletaDados</span>()<span class="op">;</span></span>
<span id="cb44-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-137" tabindex="-1"></a>    <span class="cf">if</span> (base64) novosDados<span class="op">.</span><span class="at">foto</span> <span class="op">=</span> base64<span class="op">;</span></span>
<span id="cb44-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-138" tabindex="-1"></a></span>
<span id="cb44-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-139" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {</span>
<span id="cb44-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-140" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></span>
<span id="cb44-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-141" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb44-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-142" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(novosDados)</span>
<span id="cb44-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-143" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb44-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-144" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb44-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-145" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb44-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-146" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Alterado com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb44-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-147" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb44-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-148" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb44-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-149" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb44-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-150" tabindex="-1"></a>    }</span>
<span id="cb44-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-151" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb44-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-152" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao alterar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb44-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-153" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb44-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-154" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb44-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-155" tabindex="-1"></a>  }</span>
<span id="cb44-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-156" tabindex="-1"></a>}</span>
<span id="cb44-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-157" tabindex="-1"></a></span>
<span id="cb44-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-158" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">remover</span>() {</span>
<span id="cb44-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-159" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb44-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-160" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>cpf) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Informe o CPF para remover.&#39;</span>)<span class="op">;</span></span>
<span id="cb44-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-161" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">confirm</span>(<span class="st">&#39;Confirma a exclus√£o?&#39;</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb44-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-162" tabindex="-1"></a></span>
<span id="cb44-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-163" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb44-164"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-164" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb44-165"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-165" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {<span class="dt">method</span><span class="op">:</span><span class="st">&#39;DELETE&#39;</span>})<span class="op">;</span></span>
<span id="cb44-166"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-166" tabindex="-1"></a>    <span class="co">// 204 =&gt; sem corpo; n√£o tente parsear JSON aqui</span></span>
<span id="cb44-167"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-167" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">status</span> <span class="op">===</span> <span class="dv">204</span>) {</span>
<span id="cb44-168"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-168" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb44-169"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-169" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb44-170"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-170" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
<span id="cb44-171"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-171" tabindex="-1"></a>    }</span>
<span id="cb44-172"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-172" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb44-173"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-173" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb44-174"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-174" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb44-175"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-175" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb44-176"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-176" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb44-177"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-177" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb44-178"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-178" tabindex="-1"></a>    }</span>
<span id="cb44-179"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-179" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb44-180"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-180" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao remover: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb44-181"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-181" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb44-182"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-182" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb44-183"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-183" tabindex="-1"></a>  }</span>
<span id="cb44-184"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-184" tabindex="-1"></a>}</span>
<span id="cb44-185"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-185" tabindex="-1"></a></span>
<span id="cb44-186"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-186" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">pesquisar</span>() {</span>
<span id="cb44-187"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-187" tabindex="-1"></a>  <span class="kw">const</span> termo <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;pesquisa&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb44-188"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-188" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb44-189"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-189" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb44-190"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-190" tabindex="-1"></a>    <span class="kw">const</span> url <span class="op">=</span> termo <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(termo)<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API<span class="op">;</span></span>
<span id="cb44-191"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-191" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb44-192"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-192" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb44-193"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-193" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb44-194"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-194" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb44-195"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-195" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb44-196"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-196" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb44-197"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-197" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb44-198"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-198" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb44-199"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-199" tabindex="-1"></a>  }</span>
<span id="cb44-200"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-200" tabindex="-1"></a>}</span>
<span id="cb44-201"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-201" tabindex="-1"></a></span>
<span id="cb44-202"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-202" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">listar</span>() {</span>
<span id="cb44-203"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-203" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb44-204"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-204" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb44-205"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-205" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API)<span class="op">;</span></span>
<span id="cb44-206"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-206" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb44-207"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-207" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb44-208"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-208" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb44-209"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-209" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb44-210"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-210" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb44-211"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-211" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb44-212"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-212" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb44-213"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-213" tabindex="-1"></a>  }</span>
<span id="cb44-214"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-214" tabindex="-1"></a>}</span>
<span id="cb44-215"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-215" tabindex="-1"></a></span>
<span id="cb44-216"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-216" tabindex="-1"></a><span class="co">/* ---------- UI ---------- */</span></span>
<span id="cb44-217"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-217" tabindex="-1"></a><span class="kw">function</span> <span class="fu">preencheTabela</span>(lista){</span>
<span id="cb44-218"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-218" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;tabela&#39;</span>)<span class="op">;</span></span>
<span id="cb44-219"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-219" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb44-220"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-220" tabindex="-1"></a>  (lista <span class="op">||</span> [])<span class="op">.</span><span class="fu">forEach</span>(p<span class="kw">=&gt;</span>{</span>
<span id="cb44-221"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-221" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;tr&#39;</span>)<span class="op">;</span></span>
<span id="cb44-222"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-222" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb44-223"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-223" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb44-224"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-224" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img class=&quot;thumb&quot; src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb44-225"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-225" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb44-226"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-226" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb44-227"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-227" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">data_nascimento</span><span class="sc">}</span><span class="vs">&lt;/td&gt;`</span><span class="op">;</span></span>
<span id="cb44-228"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-228" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb44-229"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-229" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">cpf</span><span class="op">;</span></span>
<span id="cb44-230"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-230" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">nome</span><span class="op">;</span></span>
<span id="cb44-231"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-231" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">endereco</span><span class="op">;</span></span>
<span id="cb44-232"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-232" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">data_nascimento</span><span class="op">;</span></span>
<span id="cb44-233"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-233" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb44-234"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-234" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb44-235"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-235" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb44-236"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-236" tabindex="-1"></a>}</span>
<span id="cb44-237"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-237" tabindex="-1"></a></span>
<span id="cb44-238"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-238" tabindex="-1"></a><span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb44-239"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-239" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb44-240"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-240" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb44-241"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb44-241" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="exemplo-03" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Exemplo 03<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-03" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</p>
<p>A interface do Cliente √© feita em HTML5</p>
<p>A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</p>
<p>CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</p>
<p>O servidor Restful √© feito em linguagem PERL</p>
<p>OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb45-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb45-1" tabindex="-1"></a>cpan Dancer2 DBI DBD::Pg JSON</span></code></pre></div>
<div id="servidor-perl" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Servidor Perl<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#servidor-perl" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode perl"><code class="sourceCode perl"><span id="cb46-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-1" tabindex="-1"></a><span class="kw">#!/usr/bin/perl</span></span>
<span id="cb46-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-2" tabindex="-1"></a><span class="fu">use</span> <span class="kw">strict</span>;</span>
<span id="cb46-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-3" tabindex="-1"></a><span class="fu">use</span> <span class="kw">warnings</span>;</span>
<span id="cb46-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-4" tabindex="-1"></a><span class="fu">use</span> Dancer2;</span>
<span id="cb46-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-5" tabindex="-1"></a><span class="fu">use</span> DBI;</span>
<span id="cb46-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-6" tabindex="-1"></a><span class="fu">use</span> JSON;</span>
<span id="cb46-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-7" tabindex="-1"></a></span>
<span id="cb46-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-8" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb46-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-9" tabindex="-1"></a><span class="co"># Configura√ß√µes do banco</span></span>
<span id="cb46-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-10" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb46-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-11" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$dsn</span> = <span class="ot">&quot;</span><span class="st">dbi:Pg:dbname=postgres;host=db.pbbtfwmydxmxdibmtbqq.supabase.co;port=5432</span><span class="ot">&quot;</span>;</span>
<span id="cb46-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-12" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$db_user</span> = <span class="ot">&quot;</span><span class="st">postgres</span><span class="ot">&quot;</span>;</span>
<span id="cb46-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-13" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$db_pass</span> = <span class="ot">&quot;</span><span class="st">MinhaSuperSenha</span><span class="ot">&quot;</span>;</span>
<span id="cb46-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-14" tabindex="-1"></a></span>
<span id="cb46-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-15" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$dbh</span> = DBI-&gt;<span class="fu">connect</span>(<span class="dt">$dsn</span>, <span class="dt">$db_user</span>, <span class="dt">$db_pass</span>, { RaiseError =&gt; <span class="dv">1</span>, AutoCommit =&gt; <span class="dv">1</span> });</span>
<span id="cb46-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-16" tabindex="-1"></a></span>
<span id="cb46-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-17" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb46-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-18" tabindex="-1"></a><span class="co"># Helpers</span></span>
<span id="cb46-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-19" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb46-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-20" tabindex="-1"></a><span class="kw">sub </span><span class="fu">json_response</span> {</span>
<span id="cb46-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-21" tabindex="-1"></a>    content_type <span class="ot">&#39;</span><span class="ss">application/json</span><span class="ot">&#39;</span>;</span>
<span id="cb46-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-22" tabindex="-1"></a>    <span class="kw">return</span> encode_json(<span class="wa">$_</span>[<span class="dv">0</span>]);</span>
<span id="cb46-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-23" tabindex="-1"></a>}</span>
<span id="cb46-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-24" tabindex="-1"></a></span>
<span id="cb46-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-25" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb46-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-26" tabindex="-1"></a><span class="co"># Endpoints REST</span></span>
<span id="cb46-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-27" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb46-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-28" tabindex="-1"></a></span>
<span id="cb46-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-29" tabindex="-1"></a><span class="co"># Listar todas ou pesquisar</span></span>
<span id="cb46-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-30" tabindex="-1"></a>get <span class="ot">&#39;</span><span class="ss">/pessoas</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb46-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-31" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$q</span> = query_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">q</span><span class="ot">&#39;</span>) || <span class="ot">&#39;&#39;</span>;</span>
<span id="cb46-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-32" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sql</span> = <span class="ot">&quot;</span><span class="st">SELECT * FROM pessoas</span><span class="ot">&quot;</span>;</span>
<span id="cb46-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-33" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">@params</span>;</span>
<span id="cb46-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-34" tabindex="-1"></a>    <span class="kw">if</span> (<span class="dt">$q</span> <span class="ot">ne</span> <span class="ot">&#39;&#39;</span>) {</span>
<span id="cb46-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-35" tabindex="-1"></a>        <span class="dt">$sql</span> .= <span class="ot">&quot;</span><span class="st"> WHERE cpf ILIKE ? OR nome ILIKE ?</span><span class="ot">&quot;</span>;</span>
<span id="cb46-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-36" tabindex="-1"></a>        <span class="dt">@params</span> = (<span class="ot">&quot;</span><span class="st">%</span><span class="dt">$q</span><span class="st">%</span><span class="ot">&quot;</span>, <span class="ot">&quot;</span><span class="st">%</span><span class="dt">$q</span><span class="st">%</span><span class="ot">&quot;</span>);</span>
<span id="cb46-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-37" tabindex="-1"></a>    }</span>
<span id="cb46-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-38" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="dt">$sql</span>);</span>
<span id="cb46-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-39" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">@params</span>);</span>
<span id="cb46-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-40" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">@rows</span>;</span>
<span id="cb46-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-41" tabindex="-1"></a>    <span class="kw">while</span> (<span class="kw">my</span> <span class="dt">$row</span> = <span class="dt">$sth</span>-&gt;<span class="dt">fetchrow_hashref</span>) {</span>
<span id="cb46-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-42" tabindex="-1"></a>        <span class="fu">push</span> <span class="dt">@rows</span>, <span class="dt">$row</span>;</span>
<span id="cb46-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-43" tabindex="-1"></a>    }</span>
<span id="cb46-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-44" tabindex="-1"></a>    <span class="kw">return</span> json_response(\<span class="dt">@rows</span>);</span>
<span id="cb46-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-45" tabindex="-1"></a>};</span>
<span id="cb46-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-46" tabindex="-1"></a></span>
<span id="cb46-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-47" tabindex="-1"></a><span class="co"># Buscar por CPF</span></span>
<span id="cb46-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-48" tabindex="-1"></a>get <span class="ot">&#39;</span><span class="ss">/pessoas/:cpf</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb46-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-49" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = route_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">cpf</span><span class="ot">&#39;</span>);</span>
<span id="cb46-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-50" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">SELECT * FROM pessoas WHERE cpf = ?</span><span class="ot">&quot;</span>);</span>
<span id="cb46-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-51" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb46-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-52" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$row</span> = <span class="dt">$sth</span>-&gt;<span class="dt">fetchrow_hashref</span>;</span>
<span id="cb46-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-53" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">$row</span> ? json_response(<span class="dt">$row</span>) : status(<span class="dv">404</span>)-&gt;json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF n√£o encontrado</span><span class="ot">&quot;</span> });</span>
<span id="cb46-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-54" tabindex="-1"></a>};</span>
<span id="cb46-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-55" tabindex="-1"></a></span>
<span id="cb46-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-56" tabindex="-1"></a><span class="co"># Inserir</span></span>
<span id="cb46-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-57" tabindex="-1"></a>post <span class="ot">&#39;</span><span class="ss">/pessoas</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb46-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-58" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$data</span> = from_json(request-&gt;body);</span>
<span id="cb46-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-59" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = <span class="dt">$data</span>-&gt;{cpf};</span>
<span id="cb46-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-60" tabindex="-1"></a>    <span class="co"># Verifica se existe</span></span>
<span id="cb46-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-61" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$check</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">SELECT cpf FROM pessoas WHERE cpf = ?</span><span class="ot">&quot;</span>);</span>
<span id="cb46-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-62" tabindex="-1"></a>    <span class="dt">$check</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb46-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-63" tabindex="-1"></a>    <span class="kw">if</span> (<span class="dt">$check</span>-&gt;<span class="dt">fetchrow_array</span>) {</span>
<span id="cb46-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-64" tabindex="-1"></a>        status(<span class="dv">400</span>);</span>
<span id="cb46-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-65" tabindex="-1"></a>        <span class="kw">return</span> json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF j√° cadastrado</span><span class="ot">&quot;</span> });</span>
<span id="cb46-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-66" tabindex="-1"></a>    }</span>
<span id="cb46-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-67" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">INSERT INTO pessoas (cpf, nome, endereco, data_nascimento, foto) VALUES (?, ?, ?, ?, ?)</span><span class="ot">&quot;</span>);</span>
<span id="cb46-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-68" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>, <span class="dt">$data</span>-&gt;{nome}, <span class="dt">$data</span>-&gt;{endereco}, <span class="dt">$data</span>-&gt;{data_nascimento}, <span class="dt">$data</span>-&gt;{foto});</span>
<span id="cb46-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-69" tabindex="-1"></a>    status(<span class="dv">201</span>);</span>
<span id="cb46-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-70" tabindex="-1"></a>    <span class="kw">return</span> json_response({ message =&gt; <span class="ot">&quot;</span><span class="st">Inserido com sucesso</span><span class="ot">&quot;</span> });</span>
<span id="cb46-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-71" tabindex="-1"></a>};</span>
<span id="cb46-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-72" tabindex="-1"></a></span>
<span id="cb46-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-73" tabindex="-1"></a><span class="co"># Alterar</span></span>
<span id="cb46-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-74" tabindex="-1"></a>put <span class="ot">&#39;</span><span class="ss">/pessoas/:cpf</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb46-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-75" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = route_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">cpf</span><span class="ot">&#39;</span>);</span>
<span id="cb46-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-76" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$data</span> = from_json(request-&gt;body);</span>
<span id="cb46-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-77" tabindex="-1"></a>    <span class="co"># Verifica se existe</span></span>
<span id="cb46-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-78" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$check</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">SELECT cpf FROM pessoas WHERE cpf = ?</span><span class="ot">&quot;</span>);</span>
<span id="cb46-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-79" tabindex="-1"></a>    <span class="dt">$check</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb46-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-80" tabindex="-1"></a>    <span class="kw">unless</span> (<span class="dt">$check</span>-&gt;<span class="dt">fetchrow_array</span>) {</span>
<span id="cb46-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-81" tabindex="-1"></a>        status(<span class="dv">404</span>);</span>
<span id="cb46-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-82" tabindex="-1"></a>        <span class="kw">return</span> json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF n√£o encontrado</span><span class="ot">&quot;</span> });</span>
<span id="cb46-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-83" tabindex="-1"></a>    }</span>
<span id="cb46-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-84" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">UPDATE pessoas SET nome=?, endereco=?, data_nascimento=?, foto=? WHERE cpf=?</span><span class="ot">&quot;</span>);</span>
<span id="cb46-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-85" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$data</span>-&gt;{nome}, <span class="dt">$data</span>-&gt;{endereco}, <span class="dt">$data</span>-&gt;{data_nascimento}, <span class="dt">$data</span>-&gt;{foto}, <span class="dt">$cpf</span>);</span>
<span id="cb46-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-86" tabindex="-1"></a>    <span class="kw">return</span> json_response({ message =&gt; <span class="ot">&quot;</span><span class="st">Alterado com sucesso</span><span class="ot">&quot;</span> });</span>
<span id="cb46-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-87" tabindex="-1"></a>};</span>
<span id="cb46-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-88" tabindex="-1"></a></span>
<span id="cb46-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-89" tabindex="-1"></a><span class="co"># Remover</span></span>
<span id="cb46-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-90" tabindex="-1"></a>del <span class="ot">&#39;</span><span class="ss">/pessoas/:cpf</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb46-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-91" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = route_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">cpf</span><span class="ot">&#39;</span>);</span>
<span id="cb46-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-92" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">DELETE FROM pessoas WHERE cpf=?</span><span class="ot">&quot;</span>);</span>
<span id="cb46-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-93" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$rows</span> = <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb46-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-94" tabindex="-1"></a>    <span class="kw">if</span> (<span class="dt">$rows</span>) {</span>
<span id="cb46-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-95" tabindex="-1"></a>        <span class="kw">return</span> json_response({ message =&gt; <span class="ot">&quot;</span><span class="st">Removido com sucesso</span><span class="ot">&quot;</span> });</span>
<span id="cb46-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-96" tabindex="-1"></a>    } <span class="kw">else</span> {</span>
<span id="cb46-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-97" tabindex="-1"></a>        status(<span class="dv">404</span>);</span>
<span id="cb46-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-98" tabindex="-1"></a>        <span class="kw">return</span> json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF n√£o encontrado</span><span class="ot">&quot;</span> });</span>
<span id="cb46-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-99" tabindex="-1"></a>    }</span>
<span id="cb46-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-100" tabindex="-1"></a>};</span>
<span id="cb46-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-101" tabindex="-1"></a></span>
<span id="cb46-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-102" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb46-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-103" tabindex="-1"></a><span class="co"># Inicializa o servidor</span></span>
<span id="cb46-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-104" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb46-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-105" tabindex="-1"></a>set port =&gt; <span class="dv">5000</span>;</span>
<span id="cb46-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-106" tabindex="-1"></a>set serializer =&gt; <span class="ot">&#39;</span><span class="ss">JSON</span><span class="ot">&#39;</span>;</span>
<span id="cb46-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-107" tabindex="-1"></a></span>
<span id="cb46-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb46-108" tabindex="-1"></a>start;</span></code></pre></div>
<p>servidor estar√° rodando na porta 5000 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:5000/pessoas" class="uri">http://localhost:5000/pessoas</a> sem senha</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb47-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb47-1" tabindex="-1"></a>http<span class="in">:</span><span class="er">//localhost:5000/pessoas</span></span></code></pre></div>
</div>
<div id="cliente-html-conex√£o-restful-1" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Cliente HTML (conex√£o Restful)<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex√£o-restful-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>crie o arquivo index.html e abra-o no navegador</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb48-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb48-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb48-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb48-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb48-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas - Perl/PostgreSQL<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb48-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb48-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">sans-serif</span><span class="op">;</span> <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">800</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span> <span class="bu">auto</span><span class="op">;</span> }</span>
<span id="cb48-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-8" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb48-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-9" tabindex="-1"></a>  button { <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin-right</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb48-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-10" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span><span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span><span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb48-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-11" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ccc</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span><span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span><span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb48-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-12" tabindex="-1"></a>  img<span class="fu">.thumb</span> { <span class="kw">width</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">height</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">object-fit</span><span class="ch">:</span><span class="dv">cover</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span><span class="dv">4</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb48-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-13" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb48-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-14" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb48-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-15" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb48-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-16" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas (Perl/PostgreSQL)<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb48-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-17" tabindex="-1"></a></span>
<span id="cb48-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-18" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;formPessoa&quot;</span><span class="dt">&gt;</span></span>
<span id="cb48-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-19" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF (chave prim√°ria): <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb48-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-20" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb48-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-21" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb48-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-22" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data Nasc.: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;data_nascimento&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb48-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-23" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="ot"> accept</span><span class="op">=</span><span class="st">&quot;image/*&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb48-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-24" tabindex="-1"></a></span>
<span id="cb48-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-25" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;inserir()&quot;</span><span class="dt">&gt;</span>Inserir<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb48-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-26" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;alterar()&quot;</span><span class="dt">&gt;</span>Alterar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb48-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-27" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;remover()&quot;</span><span class="dt">&gt;</span>Remover<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb48-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-28" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb48-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-29" tabindex="-1"></a></span>
<span id="cb48-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-30" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb48-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-31" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pesquisa&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Digite nome ou CPF&quot;</span><span class="dt">&gt;</span></span>
<span id="cb48-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-32" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;pesquisar()&quot;</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb48-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-33" tabindex="-1"></a></span>
<span id="cb48-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-34" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb48-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-35" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb48-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-36" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb48-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-37" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb48-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-38" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb48-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-39" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb48-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-40" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb48-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-41" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabela&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb48-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-42" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb48-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-43" tabindex="-1"></a></span>
<span id="cb48-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-44" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb48-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-45" tabindex="-1"></a><span class="kw">const</span> API <span class="op">=</span> <span class="st">&#39;http://localhost:5000/pessoas&#39;</span><span class="op">;</span></span>
<span id="cb48-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-46" tabindex="-1"></a></span>
<span id="cb48-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-47" tabindex="-1"></a><span class="co">/* ---------- Fun√ß√µes utilit√°rias ---------- */</span></span>
<span id="cb48-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-48" tabindex="-1"></a><span class="kw">function</span> <span class="fu">validaCampos</span>() {</span>
<span id="cb48-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-49" tabindex="-1"></a>  <span class="kw">const</span> campos <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span><span class="op">,</span><span class="st">&#39;nome&#39;</span><span class="op">,</span><span class="st">&#39;endereco&#39;</span><span class="op">,</span><span class="st">&#39;data_nascimento&#39;</span>]<span class="op">;</span></span>
<span id="cb48-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-50" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> campos) {</span>
<span id="cb48-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-51" tabindex="-1"></a>    <span class="kw">const</span> valor <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb48-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-52" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>valor) {</span>
<span id="cb48-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-53" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="vs">`O campo &quot;</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">&quot; n√£o pode ficar em branco.`</span>)<span class="op">;</span></span>
<span id="cb48-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-54" tabindex="-1"></a>      <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb48-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-55" tabindex="-1"></a>    }</span>
<span id="cb48-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-56" tabindex="-1"></a>  }</span>
<span id="cb48-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-57" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb48-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-58" tabindex="-1"></a>}</span>
<span id="cb48-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-59" tabindex="-1"></a></span>
<span id="cb48-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-60" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getFotoBase64</span>() {</span>
<span id="cb48-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-61" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;foto&#39;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb48-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-62" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>file) <span class="cf">return</span> <span class="bu">Promise</span><span class="op">.</span><span class="fu">resolve</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></span>
<span id="cb48-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-63" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span>reject)<span class="kw">=&gt;</span>{</span>
<span id="cb48-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-64" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb48-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-65" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb48-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-66" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb48-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-67" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb48-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-68" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb48-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-69" tabindex="-1"></a>}</span>
<span id="cb48-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-70" tabindex="-1"></a></span>
<span id="cb48-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-71" tabindex="-1"></a><span class="kw">function</span> <span class="fu">coletaDados</span>(base64Foto){</span>
<span id="cb48-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-72" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb48-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-73" tabindex="-1"></a>    <span class="dt">cpf</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb48-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-74" tabindex="-1"></a>    <span class="dt">nome</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb48-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-75" tabindex="-1"></a>    <span class="dt">endereco</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb48-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-76" tabindex="-1"></a>    <span class="dt">data_nascimento</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">,</span></span>
<span id="cb48-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-77" tabindex="-1"></a>    <span class="dt">foto</span><span class="op">:</span> base64Foto <span class="op">||</span> <span class="st">&#39;&#39;</span></span>
<span id="cb48-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-78" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb48-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-79" tabindex="-1"></a>}</span>
<span id="cb48-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-80" tabindex="-1"></a></span>
<span id="cb48-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-81" tabindex="-1"></a><span class="co">/* ---------- CRUD ---------- */</span></span>
<span id="cb48-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-82" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">inserir</span>() {</span>
<span id="cb48-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-83" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb48-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-84" tabindex="-1"></a>  <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb48-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-85" tabindex="-1"></a>  <span class="kw">const</span> pessoa <span class="op">=</span> <span class="fu">coletaDados</span>(base64)<span class="op">;</span></span>
<span id="cb48-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-86" tabindex="-1"></a></span>
<span id="cb48-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-87" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API<span class="op">,</span> {</span>
<span id="cb48-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-88" tabindex="-1"></a>    <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></span>
<span id="cb48-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-89" tabindex="-1"></a>    <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb48-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-90" tabindex="-1"></a>    <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(pessoa)</span>
<span id="cb48-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-91" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb48-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-92" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb48-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-93" tabindex="-1"></a>  <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) <span class="fu">alert</span>(<span class="st">&#39;Inserido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb48-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-94" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">.</span><span class="at">error</span> <span class="op">||</span> <span class="st">&#39;&#39;</span>))<span class="op">;</span></span>
<span id="cb48-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-95" tabindex="-1"></a>  <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb48-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-96" tabindex="-1"></a>}</span>
<span id="cb48-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-97" tabindex="-1"></a></span>
<span id="cb48-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-98" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">alterar</span>() {</span>
<span id="cb48-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-99" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb48-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-100" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb48-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-101" tabindex="-1"></a>  <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb48-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-102" tabindex="-1"></a>  <span class="kw">const</span> novosDados <span class="op">=</span> <span class="fu">coletaDados</span>()<span class="op">;</span></span>
<span id="cb48-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-103" tabindex="-1"></a>  <span class="cf">if</span>(base64) novosDados<span class="op">.</span><span class="at">foto</span> <span class="op">=</span> base64<span class="op">;</span></span>
<span id="cb48-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-104" tabindex="-1"></a></span>
<span id="cb48-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-105" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {</span>
<span id="cb48-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-106" tabindex="-1"></a>    <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></span>
<span id="cb48-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-107" tabindex="-1"></a>    <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb48-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-108" tabindex="-1"></a>    <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(novosDados)</span>
<span id="cb48-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-109" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb48-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-110" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb48-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-111" tabindex="-1"></a>  <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) <span class="fu">alert</span>(<span class="st">&#39;Alterado com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb48-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-112" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">.</span><span class="at">error</span> <span class="op">||</span> <span class="st">&#39;&#39;</span>))<span class="op">;</span></span>
<span id="cb48-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-113" tabindex="-1"></a>  <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb48-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-114" tabindex="-1"></a>}</span>
<span id="cb48-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-115" tabindex="-1"></a></span>
<span id="cb48-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-116" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">remover</span>() {</span>
<span id="cb48-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-117" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb48-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-118" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>cpf) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Informe o CPF para remover.&#39;</span>)<span class="op">;</span></span>
<span id="cb48-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-119" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">confirm</span>(<span class="st">&#39;Confirma a exclus√£o?&#39;</span>)){</span>
<span id="cb48-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-120" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {<span class="dt">method</span><span class="op">:</span><span class="st">&#39;DELETE&#39;</span>})<span class="op">;</span></span>
<span id="cb48-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-121" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb48-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-122" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb48-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-123" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">.</span><span class="at">error</span> <span class="op">||</span> <span class="st">&#39;&#39;</span>))<span class="op">;</span></span>
<span id="cb48-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-124" tabindex="-1"></a>    <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb48-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-125" tabindex="-1"></a>  }</span>
<span id="cb48-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-126" tabindex="-1"></a>}</span>
<span id="cb48-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-127" tabindex="-1"></a></span>
<span id="cb48-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-128" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">pesquisar</span>() {</span>
<span id="cb48-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-129" tabindex="-1"></a>  <span class="kw">const</span> termo <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;pesquisa&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb48-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-130" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>termo){ <span class="fu">listar</span>()<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb48-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-131" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(termo)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb48-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-132" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb48-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-133" tabindex="-1"></a>  <span class="fu">preencheTabela</span>(data)<span class="op">;</span></span>
<span id="cb48-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-134" tabindex="-1"></a>}</span>
<span id="cb48-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-135" tabindex="-1"></a></span>
<span id="cb48-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-136" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">listar</span>() {</span>
<span id="cb48-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-137" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API)<span class="op">;</span></span>
<span id="cb48-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-138" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb48-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-139" tabindex="-1"></a>  <span class="fu">preencheTabela</span>(data)<span class="op">;</span></span>
<span id="cb48-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-140" tabindex="-1"></a>}</span>
<span id="cb48-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-141" tabindex="-1"></a></span>
<span id="cb48-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-142" tabindex="-1"></a><span class="co">/* ---------- UI ---------- */</span></span>
<span id="cb48-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-143" tabindex="-1"></a><span class="kw">function</span> <span class="fu">preencheTabela</span>(lista){</span>
<span id="cb48-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-144" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;tabela&#39;</span>)<span class="op">;</span></span>
<span id="cb48-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-145" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb48-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-146" tabindex="-1"></a>  lista<span class="op">.</span><span class="fu">forEach</span>(p<span class="kw">=&gt;</span>{</span>
<span id="cb48-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-147" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;tr&#39;</span>)<span class="op">;</span></span>
<span id="cb48-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-148" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb48-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-149" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb48-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-150" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img class=&quot;thumb&quot; src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb48-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-151" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb48-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-152" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb48-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-153" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">data_nascimento</span><span class="sc">}</span><span class="vs">&lt;/td&gt;`</span><span class="op">;</span></span>
<span id="cb48-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-154" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb48-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-155" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">cpf</span><span class="op">;</span></span>
<span id="cb48-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-156" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">nome</span><span class="op">;</span></span>
<span id="cb48-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-157" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">endereco</span><span class="op">;</span></span>
<span id="cb48-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-158" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">data_nascimento</span><span class="op">;</span></span>
<span id="cb48-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-159" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb48-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-160" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb48-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-161" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb48-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-162" tabindex="-1"></a>}</span>
<span id="cb48-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-163" tabindex="-1"></a></span>
<span id="cb48-164"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-164" tabindex="-1"></a><span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb48-165"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-165" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb48-166"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-166" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb48-167"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb48-167" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">## Exemplo 04</td>
</tr>
<tr class="even">
<td align="left">Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</td>
</tr>
<tr class="odd">
<td align="left">A interface do Cliente √© feita em HTML5</td>
</tr>
<tr class="even">
<td align="left">A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</td>
</tr>
<tr class="odd">
<td align="left">CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</td>
</tr>
<tr class="even">
<td align="left">O servidor Restful √© feito em linguagem JAVA</td>
</tr>
<tr class="odd">
<td align="left">A linguagem JAVA precisa ser compilada e empacotada.</td>
</tr>
<tr class="even">
<td align="left">PORTANTO O C√ìDIGO DO SERVIDOR PRECISAR√Å SER COMPILADO E EMPACOTADO.</td>
</tr>
<tr class="odd">
<td align="left">OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</td>
</tr>
<tr class="even">
<td align="left">### preparar a arvore de diret√≥rios do pacote servidor</td>
</tr>
<tr class="odd">
<td align="left"><code>css pessoas-rest-java/ ‚îú‚îÄ src/main/java/com/example/pessoas/ ‚îÇ   ‚îú‚îÄ PessoasApplication.java ‚îÇ   ‚îú‚îÄ controller/ ‚îÇ   ‚îÇ    ‚îî‚îÄ PessoaController.java ‚îÇ   ‚îú‚îÄ model/ ‚îÇ   ‚îÇ    ‚îî‚îÄ Pessoa.java ‚îÇ   ‚îî‚îÄ repository/ ‚îÇ        ‚îî‚îÄ PessoaRepository.java ‚îî‚îÄ src/main/resources/ ‚îî‚îÄ application.properties</code> #### passo 1 - criar estrutura de arquivos no diret√≥rio:</td>
</tr>
<tr class="even">
<td align="left"><code>cmd echo criando diret√≥rio raiz mkdir pessoas-rest-java cd pessoas-rest-java</code></td>
</tr>
<tr class="odd">
<td align="left">Agora vamos criar os subdiret√≥rios que v√£o representar a estrutura do pacote:</td>
</tr>
<tr class="even">
<td align="left">cria√ß√£o do pacote <em>java.com.example.pessoas</em></td>
</tr>
<tr class="odd">
<td align="left">Criar a seguinte <em>√°rvore de diret√≥rios</em>:</td>
</tr>
<tr class="even">
<td align="left"><code>cmd mkdir src\main\java\com\example\pessoas\</code> Criar o subdiret√≥rios com instru√ß√£o de montagem do pacote: ‚Äúresources‚Äù</td>
</tr>
<tr class="odd">
<td align="left"><code>cmd echo criando pacote java.com.example.pessoas no windows mkdir src\main\resources\</code></td>
</tr>
<tr class="even">
<td align="left">Criar os subdiret√≥rios padr√£o do novo pacote: ‚Äúcontroller‚Äù, ‚Äúmodel‚Äù, ‚Äúrepository‚Äù</td>
</tr>
<tr class="odd">
<td align="left">```cmd echo criando diretorio CONTROLER do mkdir src</td>
</tr>
<tr class="even">
<td align="left">echo criando diretorio MODEL do mkdir src</td>
</tr>
<tr class="odd">
<td align="left">echo criando diretorio REPOSITORY do mkdir src</td>
</tr>
<tr class="even">
<td align="left">```</td>
</tr>
<tr class="odd">
<td align="left">### Criando as classes java que v√£o conversar com o banco:</td>
</tr>
<tr class="even">
<td align="left">#### passo 2 - criar as classes JAVA nos arquivos .java</td>
</tr>
<tr class="odd">
<td align="left">#### Diret√≥rio MODEL do pacote - Classe que mapeia a tabela (ou ‚Äúentidade‚Äù)</td>
</tr>
<tr class="even">
<td align="left">##### CLASSE QUE MAPEIA TABELA NA MEM√ìRIA (equivalente a um CREATE TABLE no sql)</td>
</tr>
<tr class="odd">
<td align="left">crie o arquivo <em>Pessoa.java</em> dentro do diret√≥rio <code>src\main\java\com\example\pessoas\model</code></td>
</tr>
<tr class="even">
<td align="left">arquivo <em>Pessoa.java</em></td>
</tr>
<tr class="odd">
<td align="left">```java package com.example.pessoas.model;</td>
</tr>
<tr class="even">
<td align="left">import jakarta.persistence.Entity; import jakarta.persistence.Id; import jakarta.persistence.Column;</td>
</tr>
<tr class="odd">
<td align="left"><span class="citation">(<a href="#ref-Entity"><strong>Entity?</strong></a>)</span> public class Pessoa { <span class="citation">(<a href="#ref-Id"><strong>Id?</strong></a>)</span> private String cpf;</td>
</tr>
<tr class="even">
<td align="left">private String nome; private String endereco;</td>
</tr>
<tr class="odd">
<td align="left"><span class="citation">(<a href="#ref-Column"><strong>Column?</strong></a>)</span>(name = ‚Äúdata_nascimento‚Äù) private String dataNascimento; // armazenando como string ISO (yyyy-MM-dd)</td>
</tr>
<tr class="even">
<td align="left"><span class="citation">(<a href="#ref-Column"><strong>Column?</strong></a>)</span>(columnDefinition = ‚ÄúTEXT‚Äù) private String foto; // Base64</td>
</tr>
<tr class="odd">
<td align="left">// getters e setters public String getCpf() { return cpf; } public void setCpf(String cpf) { this.cpf = cpf; }</td>
</tr>
<tr class="even">
<td align="left">public String getNome() { return nome; } public void setNome(String nome) { this.nome = nome; }</td>
</tr>
<tr class="odd">
<td align="left">public String getEndereco() { return endereco; } public void setEndereco(String endereco) { this.endereco = endereco; }</td>
</tr>
<tr class="even">
<td align="left">public String getDataNascimento() { return dataNascimento; } public void setDataNascimento(String dataNascimento) { this.dataNascimento = dataNascimento; }</td>
</tr>
<tr class="odd">
<td align="left">public String getFoto() { return foto; } public void setFoto(String foto) { this.foto = foto; } }</td>
</tr>
<tr class="even">
<td align="left">```</td>
</tr>
<tr class="odd">
<td align="left">#### Diret√≥rio REPOSITORY do pacote - Classe que guarda o SQL para buscar dados existentes na tabela</td>
</tr>
<tr class="even">
<td align="left">##### CLASSE QUE EXTRAI DADOS DA TABELA NA MEM√ìRIA (equivalente a um SELECT * FROM no sql)</td>
</tr>
<tr class="odd">
<td align="left">crie o arquivo <em>PessoaRepository.java</em> dentro do diret√≥rio <code>src\main\java\com\example\pessoas\repository</code></td>
</tr>
<tr class="even">
<td align="left">arquivo <em>PessoaRepository.java</em></td>
</tr>
<tr class="odd">
<td align="left">```java package com.example.pessoas.repository;</td>
</tr>
<tr class="even">
<td align="left">import java.util.List;</td>
</tr>
<tr class="odd">
<td align="left">import org.springframework.data.jpa.repository.JpaRepository; import org.springframework.data.jpa.repository.Query;</td>
</tr>
<tr class="even">
<td align="left">import com.example.pessoas.model.Pessoa;</td>
</tr>
<tr class="odd">
<td align="left">public interface PessoaRepository extends JpaRepository&lt;Pessoa, String&gt; { <span class="citation">(<a href="#ref-Query"><strong>Query?</strong></a>)</span>(‚ÄúSELECT p FROM Pessoa p WHERE LOWER(p.nome) LIKE LOWER(CONCAT(‚Äò%‚Äô, :termo, ‚Äò%‚Äô))‚Äù + ‚ÄúOR LOWER(p.cpf) LIKE LOWER(CONCAT(‚Äò%‚Äô, :termo, ‚Äò%‚Äô))‚Äù) List<Pessoa> searchByNomeOrCpf(String termo); }</td>
</tr>
<tr class="even">
<td align="left">```</td>
</tr>
<tr class="odd">
<td align="left">#### Diret√≥rio CONTROLLER do pacote - Classe que MAPEIA opera√ß√µes INSERIR, ALTERAR, REMOVER e PESQUISAR</td>
</tr>
<tr class="even">
<td align="left">##### CLASSE INSERE, ALTERA E APAGA DADOS NA TABELA NA MEM√ìRIA (equivalente a um INSERT, UPDATE E DELETE no sql)</td>
</tr>
<tr class="odd">
<td align="left">crie o arquivo <em>PessoaController.java</em> dentro do diret√≥rio <code>src\main\java\com\example\pessoas\controller</code></td>
</tr>
<tr class="even">
<td align="left">arquivo <em>PessoaController.java</em></td>
</tr>
<tr class="odd">
<td align="left">```JAVA package com.example.pessoas.controller;</td>
</tr>
<tr class="even">
<td align="left">import java.util.List;</td>
</tr>
<tr class="odd">
<td align="left">import org.springframework.web.bind.annotation.*; import org.springframework.http.ResponseEntity;</td>
</tr>
<tr class="even">
<td align="left">import com.example.pessoas.model.Pessoa; import com.example.pessoas.repository.PessoaRepository;</td>
</tr>
<tr class="odd">
<td align="left"><span class="citation">(<a href="#ref-RestController"><strong>RestController?</strong></a>)</span> <span class="citation">(<a href="#ref-RequestMapping"><strong>RequestMapping?</strong></a>)</span>(‚Äú/pessoas‚Äù) <span class="citation">(<a href="#ref-CrossOrigin"><strong>CrossOrigin?</strong></a>)</span>(origins = ‚Äú*‚Äù) // habilita CORS para o front-end HTML public class PessoaController {</td>
</tr>
<tr class="even">
<td align="left">private final PessoaRepository repo;</td>
</tr>
<tr class="odd">
<td align="left">public PessoaController(PessoaRepository repo) { this.repo = repo; }</td>
</tr>
<tr class="even">
<td align="left">// GET /pessoas?q=termo <span class="citation">(<a href="#ref-GetMapping"><strong>GetMapping?</strong></a>)</span> public List<Pessoa> listar(<span class="citation">(<a href="#ref-RequestParam"><strong>RequestParam?</strong></a>)</span>(required = false) String q) { if (q == null || q.isEmpty()) { return repo.findAll(); } return repo.searchByNomeOrCpf(q); }</td>
</tr>
<tr class="odd">
<td align="left">// POST /pessoas <span class="citation">(<a href="#ref-PostMapping"><strong>PostMapping?</strong></a>)</span> public Pessoa criar(<span class="citation">(<a href="#ref-RequestBody"><strong>RequestBody?</strong></a>)</span> Pessoa p) { return repo.save(p); }</td>
</tr>
<tr class="even">
<td align="left">// PUT /pessoas/{cpf} <span class="citation">(<a href="#ref-PutMapping"><strong>PutMapping?</strong></a>)</span>(‚Äú/{cpf}‚Äù) public ResponseEntity<Pessoa> atualizar(<span class="citation">(<a href="#ref-PathVariable"><strong>PathVariable?</strong></a>)</span> String cpf, <span class="citation">(<a href="#ref-RequestBody"><strong>RequestBody?</strong></a>)</span> Pessoa p) { return repo.findById(cpf) .map(existente -&gt; { existente.setNome(p.getNome()); existente.setEndereco(p.getEndereco()); existente.setDataNascimento(p.getDataNascimento()); if (p.getFoto() != null &amp;&amp; !p.getFoto().isEmpty()) { existente.setFoto(p.getFoto()); } return ResponseEntity.ok(repo.save(existente)); }) .orElse(ResponseEntity.notFound().build()); }</td>
</tr>
<tr class="odd">
<td align="left">// DELETE /pessoas/{cpf} <span class="citation">(<a href="#ref-DeleteMapping"><strong>DeleteMapping?</strong></a>)</span>(‚Äú/{cpf}‚Äù) public ResponseEntity<Void> remover(<span class="citation">(<a href="#ref-PathVariable"><strong>PathVariable?</strong></a>)</span> String cpf) { if (!repo.existsById(cpf)) { return ResponseEntity.notFound().build(); } repo.deleteById(cpf); return ResponseEntity.noContent().build(); } }</td>
</tr>
<tr class="even">
<td align="left">```</td>
</tr>
<tr class="odd">
<td align="left">### Criando ARQUIVOS AUXILIARES para o JAVA compilar e criar o pacote:</td>
</tr>
<tr class="even">
<td align="left">#### passo 3 - criar arquivos de parametros, compila√ß√£o e cria√ß√£o de acote</td>
</tr>
<tr class="odd">
<td align="left">##### Arquivo texto de par√¢metros</td>
</tr>
<tr class="even">
<td align="left">crie o arquivo <em>application.properties</em> dentro do diret√≥rio <code>src\main\resources\</code></td>
</tr>
<tr class="odd">
<td align="left">arquivo <em>application.properties</em></td>
</tr>
<tr class="even">
<td align="left">```css spring.datasource.url=jdbc:postgresql://db.pbbtfwmydxmxdibmtbqq.supabase.co:5432/postgres spring.datasource.username=postgres spring.datasource.password=MinhaSuperSenha</td>
</tr>
<tr class="odd">
<td align="left">spring.jpa.hibernate.ddl-auto=update # cria/atualiza tabelas spring.jpa.show-sql=true spring.jpa.properties.hibernate.format_sql=true</td>
</tr>
<tr class="even">
<td align="left">```</td>
</tr>
<tr class="odd">
<td align="left">##### Arquivo de compila√ß√£o e cria√ß√£o de pacote (arquivo JAR)</td>
</tr>
<tr class="even">
<td align="left">Arquivo XML para ferramenta MAVEN fazer complia√ß√£o e empacotamento</td>
</tr>
<tr class="odd">
<td align="left">arquivo <em>pom.xml</em></td>
</tr>
<tr class="even">
<td align="left">```xml <project xmlns="http://maven.apache.org/POM/4.0.0"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
http://maven.apache.org/xsd/maven-4.0.0.xsd"> <modelVersion>4.0.0</modelVersion></td>
</tr>
<tr class="odd">
<td align="left"><groupId>com.example</groupId> <artifactId>pessoas-rest-java</artifactId> <version>0.0.1-SNAPSHOT</version> <name>pessoas-rest-java</name> <description>Servidor REST de Pessoas em Java</description></td>
</tr>
<tr class="even">
<td align="left"><parent> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-parent</artifactId> <version>3.3.4</version> </parent></td>
</tr>
<tr class="odd">
<td align="left"><dependencies> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-web</artifactId> </dependency> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-data-jpa</artifactId> </dependency> <dependency> <groupId>org.postgresql</groupId> <artifactId>postgresql</artifactId> <scope>runtime</scope> </dependency> </dependencies></td>
</tr>
<tr class="even">
<td align="left"><build> <plugins> <plugin> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-maven-plugin</artifactId> </plugin> </plugins> </build> </project></td>
</tr>
<tr class="odd">
<td align="left">```</td>
</tr>
<tr class="even">
<td align="left">finalmente, voc√™ deve compilar e criar o pacote JAVA servidor</td>
</tr>
<tr class="odd">
<td align="left"><code>mvn mvn spring-boot:run</code></td>
</tr>
<tr class="even">
<td align="left">servidor estar√° rodando na porta 8080 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:8080/pessoas" class="uri">http://localhost:8080/pessoas</a> sem senha</td>
</tr>
<tr class="odd">
<td align="left"><code>css http://localhost:8080/pessoas</code></td>
</tr>
<tr class="even">
<td align="left">### Cliente HTML (conex√£o Restful)</td>
</tr>
<tr class="odd">
<td align="left">crie o arquivo index.html e abra-o no navegador</td>
</tr>
<tr class="even">
<td align="left">```html &lt;!DOCTYPE html&gt;</td>
</tr>
<tr class="odd">
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><button onclick="inserir()">Inserir</button> <button onclick="alterar()">Alterar</button> <button onclick="remover()">Remover</button></td>
</tr>
<tr class="even">
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">// Pr√©-visualiza√ß√£o da imagem em Base64 document.getElementById(‚Äòfoto‚Äô).addEventListener(‚Äòchange‚Äô, function(e){ const file = e.target.files[0]; if (!file) return; const reader = new FileReader(); reader.onload = ev =&gt; { document.getElementById(‚Äòpreview‚Äô).src = ev.target.result; }; reader.readAsDataURL(file); });</td>
</tr>
<tr class="odd">
<td align="left">async function inserir() { const cpf = document.getElementById(‚Äòcpf‚Äô).value.trim(); if (!cpf) { alert(‚ÄòCPF √© obrigat√≥rio.‚Äô); return; } const dados = coletarDados(); const resp = await fetch(API, { method: ‚ÄòPOST‚Äô, headers: {‚ÄòContent-Type‚Äô: ‚Äòapplication/json‚Äô}, body: JSON.stringify(dados) }); if (resp.ok) { alert(‚ÄòPessoa inserida!‚Äô); pesquisar(); } else alert(‚ÄòErro ao inserir:‚Äô + resp.statusText); }</td>
</tr>
<tr class="even">
<td align="left">async function alterar() { const cpf = document.getElementById(‚Äòcpf‚Äô).value.trim(); if (!cpf) { alert(‚ÄòCPF √© obrigat√≥rio.‚Äô); return; } const dados = coletarDados(); const resp = await fetch(<code>${API}/${encodeURIComponent(cpf)}</code>, { method: ‚ÄòPUT‚Äô, headers: {‚ÄòContent-Type‚Äô: ‚Äòapplication/json‚Äô}, body: JSON.stringify(dados) }); if (resp.ok) { alert(‚ÄòAlterado!‚Äô); pesquisar(); } else alert(‚ÄòErro ao alterar:‚Äô + resp.statusText); }</td>
</tr>
<tr class="odd">
<td align="left">async function remover() { const cpf = document.getElementById(‚Äòcpf‚Äô).value.trim(); if (!cpf) { alert(‚ÄòCPF √© obrigat√≥rio.‚Äô); return; } if (!confirm(‚ÄòTem certeza que deseja remover?‚Äô)) return; const resp = await fetch(<code>${API}/${encodeURIComponent(cpf)}</code>, { method: ‚ÄòDELETE‚Äô }); if (resp.ok) { alert(‚ÄòRemovido!‚Äô); pesquisar(); } else alert(‚ÄòErro ao remover:‚Äô + resp.statusText); }</td>
</tr>
<tr class="even">
<td align="left">async function pesquisar() { const termo = document.getElementById(‚Äòpesquisa‚Äô).value.trim(); const url = termo ? <code>${API}?q=${encodeURIComponent(termo)}</code> : API; const resp = await fetch(url); const lista = await resp.json(); mostrarResultados(lista); }</td>
</tr>
<tr class="odd">
<td align="left">function coletarDados() { return { cpf: document.getElementById(‚Äòcpf‚Äô).value.trim(), nome: document.getElementById(‚Äònome‚Äô).value.trim(), endereco: document.getElementById(‚Äòendereco‚Äô).value.trim(), dataNascimento: document.getElementById(‚Äòdata_nascimento‚Äô).value, foto: document.getElementById(‚Äòpreview‚Äô).src || ‚Äô‚Äô }; }</td>
</tr>
<tr class="even">
<td align="left">function mostrarResultados(pessoas) { const tbody = document.querySelector(‚Äò#resultados tbody‚Äô); tbody.innerHTML = ‚Äô‚Äò; pessoas.forEach(p =&gt; { const tr = document.createElement(‚Äôtr‚Äô); tr.innerHTML = <code>&lt;td&gt;${p.cpf}&lt;/td&gt; &lt;td&gt;${p.nome || ''}&lt;/td&gt; &lt;td&gt;${p.endereco || ''}&lt;/td&gt; &lt;td&gt;${p.dataNascimento || ''}&lt;/td&gt; &lt;td&gt;${p.foto ?</code><img src="${p.foto}" width="60"/><code>: ''}&lt;/td&gt;</code>; tbody.appendChild(tr); }); } </script></td>
</tr>
<tr class="odd">
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">```</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exemplo-05" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Exemplo 05<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-05" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</p>
<p>A interface do Cliente √© feita em HTML5</p>
<p>A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</p>
<p>CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</p>
<p>O servidor Restful √© feito em linguagem C++</p>
<p>A linguagem C++ precisa ser compilada.</p>
<p>PORTANTO O C√ìDIGO DO SERVIDOR PRECISAR√Å SER COMPILADO.</p>
<p>EM C++ VAMOS USAR BIBLIOTECAS EXTERNAS libpqxx e crow</p>
<p>OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</p>
<p>estrutura de diret√≥rios:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb49-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb49-1" tabindex="-1"></a>pessoas-rest-cpp/</span>
<span id="cb49-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb49-2" tabindex="-1"></a>‚îú‚îÄ CMakeLists<span class="fu">.txt</span></span>
<span id="cb49-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb49-3" tabindex="-1"></a>‚îú‚îÄ src/</span>
<span id="cb49-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb49-4" tabindex="-1"></a>‚îÇ   ‚îî‚îÄ main<span class="fu">.cpp</span></span>
<span id="cb49-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb49-5" tabindex="-1"></a>‚îî‚îÄ include/</span>
<span id="cb49-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb49-6" tabindex="-1"></a>    ‚îî‚îÄ crow_all<span class="fu">.h</span>        ‚Üê header √∫nico da biblioteca Crow</span></code></pre></div>
<div id="criando-o-arquivo-c-do-servidor" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Criando o arquivo C++ do servidor<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#criando-o-arquivo-c-do-servidor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb50-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;crow_all.h&quot;</span></span>
<span id="cb50-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-2" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;pqxx/pqxx&gt;</span></span>
<span id="cb50-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-3" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb50-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-4" tabindex="-1"></a></span>
<span id="cb50-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-5" tabindex="-1"></a><span class="at">const</span> <span class="bu">std::</span>string CONN_STR <span class="op">=</span></span>
<span id="cb50-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-6" tabindex="-1"></a>    <span class="st">&quot;postgresql://postgres:MinhaSuperSenha@db.pbbtfwmydxmxdibmtbqq.supabase.co:5432/postgres&quot;</span><span class="op">;</span></span>
<span id="cb50-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-7" tabindex="-1"></a></span>
<span id="cb50-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-8" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb50-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-9" tabindex="-1"></a>    crow<span class="op">::</span>SimpleApp app<span class="op">;</span></span>
<span id="cb50-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-10" tabindex="-1"></a></span>
<span id="cb50-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-11" tabindex="-1"></a>    <span class="co">// GET /pessoas</span></span>
<span id="cb50-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-12" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;GET&quot;</span><span class="op">_method)</span></span>
<span id="cb50-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-13" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;</span> req<span class="op">){</span></span>
<span id="cb50-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-14" tabindex="-1"></a>        pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb50-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-15" tabindex="-1"></a>        pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb50-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-16" tabindex="-1"></a>        <span class="bu">std::</span>string q <span class="op">=</span> req<span class="op">.</span>url_params<span class="op">.</span>get<span class="op">(</span><span class="st">&quot;q&quot;</span><span class="op">)</span> <span class="op">?</span> req<span class="op">.</span>url_params<span class="op">.</span>get<span class="op">(</span><span class="st">&quot;q&quot;</span><span class="op">)</span> <span class="op">:</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb50-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-17" tabindex="-1"></a>        pqxx<span class="op">::</span>result r<span class="op">;</span></span>
<span id="cb50-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-18" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb50-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-19" tabindex="-1"></a>            r <span class="op">=</span> w<span class="op">.</span>exec_params<span class="op">(</span></span>
<span id="cb50-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-20" tabindex="-1"></a>                <span class="st">&quot;SELECT cpf,nome,endereco,data_nascimento,foto &quot;</span></span>
<span id="cb50-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-21" tabindex="-1"></a>                <span class="st">&quot;FROM pessoas WHERE lower(nome) LIKE lower(&#39;%&#39;||$1||&#39;%&#39;) OR cpf LIKE &#39;%&#39;||$1||&#39;%&#39;&quot;</span><span class="op">,</span></span>
<span id="cb50-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-22" tabindex="-1"></a>                q<span class="op">);</span></span>
<span id="cb50-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-23" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb50-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-24" tabindex="-1"></a>            r <span class="op">=</span> w<span class="op">.</span>exec<span class="op">(</span><span class="st">&quot;SELECT cpf,nome,endereco,data_nascimento,foto FROM pessoas&quot;</span><span class="op">);</span></span>
<span id="cb50-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-25" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb50-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-26" tabindex="-1"></a>        crow<span class="op">::</span>json<span class="op">::</span>wvalue out<span class="op">;</span></span>
<span id="cb50-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-27" tabindex="-1"></a>        <span class="dt">size_t</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb50-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-28" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> row <span class="op">:</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-29" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;cpf&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;cpf&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb50-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-30" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;nome&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;nome&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb50-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-31" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;endereco&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;endereco&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb50-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-32" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;dataNascimento&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;data_nascimento&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb50-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-33" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;foto&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span>is_null<span class="op">()</span> <span class="op">?</span> <span class="st">&quot;&quot;</span> <span class="op">:</span> row<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb50-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-34" tabindex="-1"></a>            <span class="op">++</span>i<span class="op">;</span></span>
<span id="cb50-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-35" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb50-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-36" tabindex="-1"></a>        <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span>out<span class="op">);</span></span>
<span id="cb50-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-37" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb50-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-38" tabindex="-1"></a></span>
<span id="cb50-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-39" tabindex="-1"></a>    <span class="co">// POST /pessoas</span></span>
<span id="cb50-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-40" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;POST&quot;</span><span class="op">_method)</span></span>
<span id="cb50-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-41" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;</span> req<span class="op">){</span></span>
<span id="cb50-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-42" tabindex="-1"></a>        <span class="kw">auto</span> body <span class="op">=</span> crow<span class="op">::</span>json<span class="op">::</span>load<span class="op">(</span>req<span class="op">.</span>body<span class="op">);</span></span>
<span id="cb50-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-43" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>body <span class="op">||</span> <span class="op">!</span>body<span class="op">.</span>has<span class="op">(</span><span class="st">&quot;cpf&quot;</span><span class="op">))</span></span>
<span id="cb50-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-44" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> <span class="st">&quot;CPF √© obrigat√≥rio&quot;</span><span class="op">);</span></span>
<span id="cb50-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-45" tabindex="-1"></a></span>
<span id="cb50-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-46" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb50-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-47" tabindex="-1"></a>            pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb50-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-48" tabindex="-1"></a>            pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb50-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-49" tabindex="-1"></a>            w<span class="op">.</span>exec_params<span class="op">(</span></span>
<span id="cb50-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-50" tabindex="-1"></a>                <span class="st">&quot;INSERT INTO pessoas (cpf,nome,endereco,data_nascimento,foto) &quot;</span></span>
<span id="cb50-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-51" tabindex="-1"></a>                <span class="st">&quot;VALUES ($1,$2,$3,$4,$5)&quot;</span><span class="op">,</span></span>
<span id="cb50-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-52" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;cpf&quot;</span><span class="op">].</span>s<span class="op">(),</span></span>
<span id="cb50-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-53" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;nome&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb50-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-54" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;endereco&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb50-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-55" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;dataNascimento&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb50-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-56" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">)</span></span>
<span id="cb50-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-57" tabindex="-1"></a>            <span class="op">);</span></span>
<span id="cb50-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-58" tabindex="-1"></a>            w<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb50-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-59" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">201</span><span class="op">,</span> <span class="st">&quot;Inserido&quot;</span><span class="op">);</span></span>
<span id="cb50-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-60" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span><span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>exception <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-61" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb50-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-62" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb50-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-63" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb50-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-64" tabindex="-1"></a></span>
<span id="cb50-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-65" tabindex="-1"></a>    <span class="co">// PUT /pessoas/&lt;cpf&gt;</span></span>
<span id="cb50-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-66" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas/&lt;string&gt;&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;PUT&quot;</span><span class="op">_method)</span></span>
<span id="cb50-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-67" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;</span> req<span class="op">,</span> <span class="bu">std::</span>string cpf<span class="op">){</span></span>
<span id="cb50-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-68" tabindex="-1"></a>        <span class="kw">auto</span> body <span class="op">=</span> crow<span class="op">::</span>json<span class="op">::</span>load<span class="op">(</span>req<span class="op">.</span>body<span class="op">);</span></span>
<span id="cb50-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-69" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>body<span class="op">)</span></span>
<span id="cb50-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-70" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> <span class="st">&quot;JSON inv√°lido&quot;</span><span class="op">);</span></span>
<span id="cb50-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-71" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb50-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-72" tabindex="-1"></a>            pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb50-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-73" tabindex="-1"></a>            pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb50-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-74" tabindex="-1"></a>            w<span class="op">.</span>exec_params<span class="op">(</span></span>
<span id="cb50-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-75" tabindex="-1"></a>                <span class="st">&quot;UPDATE pessoas SET nome=$1,endereco=$2,data_nascimento=$3,foto=$4 WHERE cpf=$5&quot;</span><span class="op">,</span></span>
<span id="cb50-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-76" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;nome&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb50-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-77" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;endereco&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb50-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-78" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;dataNascimento&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb50-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-79" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb50-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-80" tabindex="-1"></a>                cpf</span>
<span id="cb50-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-81" tabindex="-1"></a>            <span class="op">);</span></span>
<span id="cb50-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-82" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>w<span class="op">.</span>affected_rows<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">404</span><span class="op">,</span> <span class="st">&quot;CPF n√£o encontrado&quot;</span><span class="op">);</span></span>
<span id="cb50-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-83" tabindex="-1"></a>            w<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb50-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-84" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">200</span><span class="op">,</span> <span class="st">&quot;Alterado&quot;</span><span class="op">);</span></span>
<span id="cb50-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-85" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span><span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>exception <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-86" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb50-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-87" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb50-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-88" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb50-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-89" tabindex="-1"></a></span>
<span id="cb50-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-90" tabindex="-1"></a>    <span class="co">// DELETE /pessoas/&lt;cpf&gt;</span></span>
<span id="cb50-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-91" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas/&lt;string&gt;&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;DELETE&quot;</span><span class="op">_method)</span></span>
<span id="cb50-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-92" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;,</span> <span class="bu">std::</span>string cpf<span class="op">){</span></span>
<span id="cb50-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-93" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb50-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-94" tabindex="-1"></a>            pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb50-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-95" tabindex="-1"></a>            pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb50-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-96" tabindex="-1"></a>            w<span class="op">.</span>exec_params<span class="op">(</span><span class="st">&quot;DELETE FROM pessoas WHERE cpf=$1&quot;</span><span class="op">,</span> cpf<span class="op">);</span></span>
<span id="cb50-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-97" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>w<span class="op">.</span>affected_rows<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">404</span><span class="op">,</span> <span class="st">&quot;CPF n√£o encontrado&quot;</span><span class="op">);</span></span>
<span id="cb50-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-98" tabindex="-1"></a>            w<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb50-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-99" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">200</span><span class="op">,</span> <span class="st">&quot;Removido&quot;</span><span class="op">);</span></span>
<span id="cb50-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-100" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span><span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>exception <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-101" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb50-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-102" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb50-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-103" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb50-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-104" tabindex="-1"></a></span>
<span id="cb50-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-105" tabindex="-1"></a>    <span class="bu">std::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Servidor rodando em http://0.0.0.0:8080</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb50-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-106" tabindex="-1"></a>    app<span class="op">.</span>port<span class="op">(</span><span class="dv">8080</span><span class="op">).</span>multithreaded<span class="op">().</span>run<span class="op">();</span></span>
<span id="cb50-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb50-107" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="ferramenta-de-compila√ß√£o-cmake" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Ferramenta de compila√ß√£o CMAKE<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#ferramenta-de-compila√ß√£o-cmake" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Preparando o arquivo de instru√ß√µes da ferramenta de projeto CMAKE</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb51-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-1" tabindex="-1"></a>cmake_minimum_required(VERSION 3.20)</span>
<span id="cb51-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-2" tabindex="-1"></a>project(PessoasRestCpp LANGUAGES CXX)</span>
<span id="cb51-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-3" tabindex="-1"></a></span>
<span id="cb51-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-4" tabindex="-1"></a>set(CMAKE_CXX_STANDARD 17)</span>
<span id="cb51-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-5" tabindex="-1"></a>set(CMAKE_CXX_STANDARD_REQUIRED ON)</span>
<span id="cb51-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-6" tabindex="-1"></a></span>
<span id="cb51-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-7" tabindex="-1"></a># Caminho para os headers (Crow e outros)</span>
<span id="cb51-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-8" tabindex="-1"></a>include_directories(${CMAKE_SOURCE_DIR}/include)</span>
<span id="cb51-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-9" tabindex="-1"></a></span>
<span id="cb51-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-10" tabindex="-1"></a># Localiza√ß√£o de libpqxx (ajuste se estiver em pasta diferente)</span>
<span id="cb51-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-11" tabindex="-1"></a>find_package(PostgreSQL REQUIRED)</span>
<span id="cb51-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-12" tabindex="-1"></a>find_path(PQXX_INCLUDE_DIR pqxx/pqxx)</span>
<span id="cb51-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-13" tabindex="-1"></a>find_library(PQXX_LIBRARY pqxx)</span>
<span id="cb51-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-14" tabindex="-1"></a></span>
<span id="cb51-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-15" tabindex="-1"></a>if(NOT PQXX_INCLUDE_DIR OR NOT PQXX_LIBRARY)</span>
<span id="cb51-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-16" tabindex="-1"></a>    message(FATAL_ERROR &quot;libpqxx n√£o encontrada. Instale com vcpkg ou aponte manualmente.&quot;)</span>
<span id="cb51-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-17" tabindex="-1"></a>endif()</span>
<span id="cb51-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-18" tabindex="-1"></a></span>
<span id="cb51-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-19" tabindex="-1"></a>add_executable(pessoas-rest</span>
<span id="cb51-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-20" tabindex="-1"></a>    src/main.cpp</span>
<span id="cb51-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-21" tabindex="-1"></a>)</span>
<span id="cb51-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-22" tabindex="-1"></a></span>
<span id="cb51-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-23" tabindex="-1"></a>target_include_directories(pessoas-rest PRIVATE ${PQXX_INCLUDE_DIR})</span>
<span id="cb51-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-24" tabindex="-1"></a>target_link_libraries(pessoas-rest</span>
<span id="cb51-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-25" tabindex="-1"></a>    ${PQXX_LIBRARY}</span>
<span id="cb51-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-26" tabindex="-1"></a>    PostgreSQL::PostgreSQL</span>
<span id="cb51-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb51-27" tabindex="-1"></a>)</span></code></pre></div>
<p>Adicionando biblioteca extra no compilador C++ do windows</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb52-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb52-1" tabindex="-1"></a>vcpkg install libpqxx</span></code></pre></div>
<p>Gere o projeto do servidor para ‚ÄúVisual Studio 17 2022‚Äù E ARQUITETURA x64</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb53-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb53-1" tabindex="-1"></a>cmake <span class="at">-B</span> build <span class="at">-G</span> <span class="st">&quot;Visual Studio 17 2022&quot;</span> <span class="at">-A</span> x64  <span class="at">-DCMAKE_TOOLCHAIN_FILE</span>=C:<span class="at">/path/to/vcpkg/scripts/buildsystems/vcpkg</span>.cmake</span></code></pre></div>
<p>Compile e linque todo o projeto</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb54-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb54-1" tabindex="-1"></a>cmake -<span class="at">-build</span> build -<span class="at">-config</span> Release</span></code></pre></div>
<p>execute o servidor</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb55-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb55-1" tabindex="-1"></a>build/Release/pessoas-rest.exe</span></code></pre></div>
<p>servidor estar√° rodando na porta 8080 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:8080/pessoas" class="uri">http://localhost:8080/pessoas</a> sem senha</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb56-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb56-1" tabindex="-1"></a>http<span class="in">:</span><span class="er">//localhost:8080/pessoas</span></span></code></pre></div>
</div>
<div id="cliente-html-conex√£o-restful-2" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Cliente HTML (conex√£o Restful)<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex√£o-restful-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>crie o arquivo index.html e abra-o no navegador</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb57-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb57-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb57-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb57-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb57-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb57-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb57-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">Arial</span><span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb57-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-8" tabindex="-1"></a>  h1 { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#333</span><span class="op">;</span> }</span>
<span id="cb57-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-9" tabindex="-1"></a>  form { <span class="kw">margin-bottom</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb57-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-10" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb57-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-11" tabindex="-1"></a>  input<span class="ex">[</span><span class="ss">type</span><span class="op">=</span><span class="st">text</span><span class="ex">]</span><span class="op">,</span> input<span class="ex">[</span><span class="ss">type</span><span class="op">=</span><span class="st">date</span><span class="ex">]</span><span class="op">,</span> input<span class="ex">[</span><span class="ss">type</span><span class="op">=</span><span class="st">file</span><span class="ex">]</span> {</span>
<span id="cb57-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-12" tabindex="-1"></a>    <span class="kw">width</span><span class="ch">:</span> <span class="dv">300</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb57-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-13" tabindex="-1"></a>  }</span>
<span id="cb57-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-14" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span> <span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb57-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-15" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#aaa</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span> <span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb57-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-16" tabindex="-1"></a>  img { <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">80</span><span class="dt">px</span><span class="op">;</span> <span class="kw">max-height</span><span class="ch">:</span> <span class="dv">80</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb57-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-17" tabindex="-1"></a>  <span class="fu">.btn</span> { <span class="kw">padding</span><span class="ch">:</span> <span class="dv">4</span><span class="dt">px</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">cursor</span><span class="ch">:</span> <span class="dv">pointer</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">0</span> <span class="dv">2</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb57-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-18" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb57-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-19" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb57-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-20" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb57-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-21" tabindex="-1"></a></span>
<span id="cb57-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-22" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb57-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-23" tabindex="-1"></a></span>
<span id="cb57-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-24" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pessoaForm&quot;</span><span class="dt">&gt;</span></span>
<span id="cb57-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-25" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF*:</span>
<span id="cb57-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-26" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;</span></span>
<span id="cb57-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-27" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb57-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-28" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome:</span>
<span id="cb57-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-29" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="dt">&gt;</span></span>
<span id="cb57-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-30" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb57-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-31" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo:</span>
<span id="cb57-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-32" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="dt">&gt;</span></span>
<span id="cb57-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-33" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb57-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-34" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data de Nascimento:</span>
<span id="cb57-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-35" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;dataNascimento&quot;</span><span class="dt">&gt;</span></span>
<span id="cb57-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-36" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb57-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-37" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto:</span>
<span id="cb57-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-38" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="dt">&gt;</span></span>
<span id="cb57-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-39" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb57-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-40" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;submit&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn&quot;</span><span class="dt">&gt;</span>Salvar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb57-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-41" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb57-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-42" tabindex="-1"></a></span>
<span id="cb57-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-43" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb57-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-44" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;search&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Buscar por CPF ou Nome&quot;</span><span class="dt">&gt;</span></span>
<span id="cb57-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-45" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnBuscar&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn&quot;</span><span class="dt">&gt;</span>Buscar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb57-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-46" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnListar&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn&quot;</span><span class="dt">&gt;</span>Listar Todos<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb57-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-47" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb57-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-48" tabindex="-1"></a></span>
<span id="cb57-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-49" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabelaPessoas&quot;</span><span class="dt">&gt;</span></span>
<span id="cb57-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-50" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb57-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-51" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb57-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-52" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>A√ß√µes<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb57-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-53" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb57-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-54" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb57-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-55" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb57-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-56" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb57-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-57" tabindex="-1"></a></span>
<span id="cb57-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-58" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb57-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-59" tabindex="-1"></a><span class="kw">const</span> API_URL <span class="op">=</span> <span class="st">&quot;http://localhost:8080/pessoas&quot;</span><span class="op">;</span></span>
<span id="cb57-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-60" tabindex="-1"></a></span>
<span id="cb57-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-61" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">carregarPessoas</span>(query<span class="op">=</span><span class="st">&quot;&quot;</span>) {</span>
<span id="cb57-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-62" tabindex="-1"></a>  <span class="kw">const</span> url <span class="op">=</span> query <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(query)<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API_URL<span class="op">;</span></span>
<span id="cb57-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-63" tabindex="-1"></a>  <span class="kw">const</span> resp <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb57-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-64" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> resp<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb57-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-65" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&quot;#tabelaPessoas tbody&quot;</span>)<span class="op">;</span></span>
<span id="cb57-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-66" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb57-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-67" tabindex="-1"></a>  data<span class="op">.</span><span class="fu">forEach</span>(p <span class="kw">=&gt;</span> {</span>
<span id="cb57-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-68" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&quot;tr&quot;</span>)<span class="op">;</span></span>
<span id="cb57-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-69" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb57-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-70" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb57-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-71" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span> <span class="op">||</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb57-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-72" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span> <span class="op">||</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb57-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-73" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">dataNascimento</span> <span class="op">||</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb57-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-74" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb57-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-75" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span></span>
<span id="cb57-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-76" tabindex="-1"></a><span class="vs">        &lt;button class=&quot;btn&quot; onclick=&quot;editar(&#39;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&#39;)&quot;&gt;Editar&lt;/button&gt;</span></span>
<span id="cb57-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-77" tabindex="-1"></a><span class="vs">        &lt;button class=&quot;btn&quot; onclick=&quot;excluir(&#39;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&#39;)&quot;&gt;Excluir&lt;/button&gt;</span></span>
<span id="cb57-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-78" tabindex="-1"></a><span class="vs">      &lt;/td&gt;</span></span>
<span id="cb57-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-79" tabindex="-1"></a><span class="vs">    `</span><span class="op">;</span></span>
<span id="cb57-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-80" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb57-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-81" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb57-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-82" tabindex="-1"></a>}</span>
<span id="cb57-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-83" tabindex="-1"></a></span>
<span id="cb57-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-84" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">toBase64</span>(file) {</span>
<span id="cb57-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-85" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> {</span>
<span id="cb57-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-86" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb57-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-87" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb57-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-88" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb57-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-89" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb57-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-90" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb57-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-91" tabindex="-1"></a>}</span>
<span id="cb57-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-92" tabindex="-1"></a></span>
<span id="cb57-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-93" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;pessoaForm&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;submit&quot;</span><span class="op">,</span> <span class="kw">async</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb57-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-94" tabindex="-1"></a>  e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb57-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-95" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb57-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-96" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>cpf) { <span class="fu">alert</span>(<span class="st">&quot;CPF √© obrigat√≥rio.&quot;</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb57-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-97" tabindex="-1"></a></span>
<span id="cb57-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-98" tabindex="-1"></a>  <span class="kw">const</span> nome <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;nome&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb57-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-99" tabindex="-1"></a>  <span class="kw">const</span> endereco <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;endereco&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb57-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-100" tabindex="-1"></a>  <span class="kw">const</span> dataNascimento <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;dataNascimento&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb57-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-101" tabindex="-1"></a>  <span class="kw">const</span> fotoFile <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;foto&quot;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb57-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-102" tabindex="-1"></a>  <span class="kw">let</span> fotoBase64 <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb57-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-103" tabindex="-1"></a>  <span class="cf">if</span> (fotoFile) {</span>
<span id="cb57-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-104" tabindex="-1"></a>    fotoBase64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">toBase64</span>(fotoFile)<span class="op">;</span></span>
<span id="cb57-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-105" tabindex="-1"></a>  }</span>
<span id="cb57-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-106" tabindex="-1"></a></span>
<span id="cb57-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-107" tabindex="-1"></a>  <span class="co">// Se j√° existe, usa PUT, sen√£o POST</span></span>
<span id="cb57-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-108" tabindex="-1"></a>  <span class="kw">const</span> method <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">dataset</span><span class="op">.</span><span class="at">editing</span> <span class="op">?</span> <span class="st">&quot;PUT&quot;</span> <span class="op">:</span> <span class="st">&quot;POST&quot;</span><span class="op">;</span></span>
<span id="cb57-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-109" tabindex="-1"></a>  <span class="kw">const</span> url <span class="op">=</span> method <span class="op">===</span> <span class="st">&quot;PUT&quot;</span> <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>cpf<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API_URL<span class="op">;</span></span>
<span id="cb57-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-110" tabindex="-1"></a></span>
<span id="cb57-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-111" tabindex="-1"></a>  <span class="kw">const</span> resp <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url<span class="op">,</span> {</span>
<span id="cb57-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-112" tabindex="-1"></a>    method<span class="op">,</span></span>
<span id="cb57-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-113" tabindex="-1"></a>    <span class="dt">headers</span><span class="op">:</span> { <span class="st">&quot;Content-Type&quot;</span><span class="op">:</span> <span class="st">&quot;application/json&quot;</span> }<span class="op">,</span></span>
<span id="cb57-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-114" tabindex="-1"></a>    <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>({ cpf<span class="op">,</span> nome<span class="op">,</span> endereco<span class="op">,</span> dataNascimento<span class="op">,</span> <span class="dt">foto</span><span class="op">:</span> fotoBase64 })</span>
<span id="cb57-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-115" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb57-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-116" tabindex="-1"></a></span>
<span id="cb57-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-117" tabindex="-1"></a>  <span class="cf">if</span> (resp<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb57-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-118" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;Salvo com sucesso!&quot;</span>)<span class="op">;</span></span>
<span id="cb57-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-119" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;pessoaForm&quot;</span>)<span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb57-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-120" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">dataset</span><span class="op">.</span><span class="at">editing</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb57-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-121" tabindex="-1"></a>    <span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb57-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-122" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb57-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-123" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;Erro: &quot;</span> <span class="op">+</span> <span class="cf">await</span> resp<span class="op">.</span><span class="fu">text</span>())<span class="op">;</span></span>
<span id="cb57-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-124" tabindex="-1"></a>  }</span>
<span id="cb57-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-125" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb57-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-126" tabindex="-1"></a></span>
<span id="cb57-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-127" tabindex="-1"></a><span class="kw">function</span> <span class="fu">editar</span>(cpf) {</span>
<span id="cb57-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-128" tabindex="-1"></a>  <span class="kw">const</span> row <span class="op">=</span> [<span class="op">...</span><span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&quot;#tabelaPessoas tbody tr&quot;</span>)]</span>
<span id="cb57-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-129" tabindex="-1"></a>    <span class="op">.</span><span class="fu">find</span>(tr <span class="kw">=&gt;</span> tr<span class="op">.</span><span class="at">children</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">textContent</span> <span class="op">===</span> cpf)<span class="op">;</span></span>
<span id="cb57-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-130" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>row) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb57-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-131" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> cpf<span class="op">;</span></span>
<span id="cb57-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-132" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;nome&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> row<span class="op">.</span><span class="at">children</span>[<span class="dv">1</span>]<span class="op">.</span><span class="at">textContent</span><span class="op">;</span></span>
<span id="cb57-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-133" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;endereco&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> row<span class="op">.</span><span class="at">children</span>[<span class="dv">2</span>]<span class="op">.</span><span class="at">textContent</span><span class="op">;</span></span>
<span id="cb57-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-134" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;dataNascimento&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> row<span class="op">.</span><span class="at">children</span>[<span class="dv">3</span>]<span class="op">.</span><span class="at">textContent</span><span class="op">;</span></span>
<span id="cb57-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-135" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">dataset</span><span class="op">.</span><span class="at">editing</span> <span class="op">=</span> <span class="st">&quot;true&quot;</span><span class="op">;</span></span>
<span id="cb57-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-136" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">scrollTo</span>({ <span class="dt">top</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">behavior</span><span class="op">:</span> <span class="st">&#39;smooth&#39;</span> })<span class="op">;</span></span>
<span id="cb57-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-137" tabindex="-1"></a>}</span>
<span id="cb57-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-138" tabindex="-1"></a></span>
<span id="cb57-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-139" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">excluir</span>(cpf) {</span>
<span id="cb57-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-140" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="fu">confirm</span>(<span class="vs">`Excluir CPF </span><span class="sc">${</span>cpf<span class="sc">}</span><span class="vs">?`</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb57-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-141" tabindex="-1"></a>  <span class="kw">const</span> resp <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>cpf<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> { <span class="dt">method</span><span class="op">:</span> <span class="st">&quot;DELETE&quot;</span> })<span class="op">;</span></span>
<span id="cb57-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-142" tabindex="-1"></a>  <span class="cf">if</span> (resp<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb57-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-143" tabindex="-1"></a>    <span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb57-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-144" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb57-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-145" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;Erro: &quot;</span> <span class="op">+</span> <span class="cf">await</span> resp<span class="op">.</span><span class="fu">text</span>())<span class="op">;</span></span>
<span id="cb57-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-146" tabindex="-1"></a>  }</span>
<span id="cb57-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-147" tabindex="-1"></a>}</span>
<span id="cb57-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-148" tabindex="-1"></a></span>
<span id="cb57-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-149" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;btnBuscar&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb57-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-150" tabindex="-1"></a>  <span class="kw">const</span> q <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;search&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb57-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-151" tabindex="-1"></a>  <span class="fu">carregarPessoas</span>(q)<span class="op">;</span></span>
<span id="cb57-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-152" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb57-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-153" tabindex="-1"></a></span>
<span id="cb57-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-154" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;btnListar&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb57-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-155" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;search&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb57-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-156" tabindex="-1"></a>  <span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb57-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-157" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb57-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-158" tabindex="-1"></a></span>
<span id="cb57-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-159" tabindex="-1"></a><span class="co">// Carregar lista inicial</span></span>
<span id="cb57-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-160" tabindex="-1"></a><span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb57-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-161" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb57-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-162" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb57-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb57-163" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="o-que-√©-uma-aplica√ß√£o-crud.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="banco-de-dados-mysql-mariadb.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/miguel7penteado/2025-2sem-GTI-BancoDeDados/edit/main/05-2025-09-01_Aplicacao_CRUD-exercicio.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["2025-GTI-Sem-BancoDeDados.pdf", "2025-GTI-Sem-BancoDeDados.epub", "2025-GTI-Sem-BancoDeDados.word", "2025-GTI-Sem-BancoDeDados.html"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
