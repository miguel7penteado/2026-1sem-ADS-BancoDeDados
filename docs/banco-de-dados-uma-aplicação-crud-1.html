<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Slide 13 Banco de Dados: Uma Aplica√ß√£o CRUD | ADS - Banco de dados e No-SQL - 2026 - Anota√ß√µes de aula</title>
  <meta name="description" content="Este livreto re√∫ne anota√ß√µes, reflex√µes e conte√∫dos desenvolvidos ao longo das aulas da disciplina Banco de Dados, ministrada pelo Professor Migu√©l Suares. Elaborado com base em experi√™ncias pr√°ticas, refer√™ncias acad√™micas e diretrizes atualizadas sobre o tema, o material busca fornecer uma vis√£o cr√≠tica e aplicada sobre an√°lise de dados nas organiza√ß√µes contempor√¢neas." />
  <meta name="generator" content="bookdown 0.46.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Slide 13 Banco de Dados: Uma Aplica√ß√£o CRUD | ADS - Banco de dados e No-SQL - 2026 - Anota√ß√µes de aula" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="your book url like https://bookdown.org/yihui/bookdown/images/cover.jpg" />
  <meta property="og:description" content="Este livreto re√∫ne anota√ß√µes, reflex√µes e conte√∫dos desenvolvidos ao longo das aulas da disciplina Banco de Dados, ministrada pelo Professor Migu√©l Suares. Elaborado com base em experi√™ncias pr√°ticas, refer√™ncias acad√™micas e diretrizes atualizadas sobre o tema, o material busca fornecer uma vis√£o cr√≠tica e aplicada sobre an√°lise de dados nas organiza√ß√µes contempor√¢neas." />
  <meta name="github-repo" content="miguel7penteado/2026-1sem-ADS-BancoDeDados" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Slide 13 Banco de Dados: Uma Aplica√ß√£o CRUD | ADS - Banco de dados e No-SQL - 2026 - Anota√ß√µes de aula" />
  
  <meta name="twitter:description" content="Este livreto re√∫ne anota√ß√µes, reflex√µes e conte√∫dos desenvolvidos ao longo das aulas da disciplina Banco de Dados, ministrada pelo Professor Migu√©l Suares. Elaborado com base em experi√™ncias pr√°ticas, refer√™ncias acad√™micas e diretrizes atualizadas sobre o tema, o material busca fornecer uma vis√£o cr√≠tica e aplicada sobre an√°lise de dados nas organiza√ß√µes contempor√¢neas." />
  <meta name="twitter:image" content="your book url like https://bookdown.org/yihui/bookdown/images/cover.jpg" />

<meta name="author" content="Professor Migu√©l Suares" />


<meta name="date" content="2026-02-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="banco-de-dados-postgres-1.html"/>
<link rel="next" href="banco-de-dados-estat√≠stico---cliente-rstudio.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">2026-ADS- Disciplina de Banco de Dados - Anota√ß√µes de Aula</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Sobre estas anota√ß√µes</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#acesso-ao-gitbook-celular"><i class="fa fa-check"></i><b>0.1</b> ACESSO AO GITBOOK CELULAR</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#leitores-de-formato-de-arquivo-epub-para-smartphone"><i class="fa fa-check"></i><b>0.2</b> Leitores de formato de arquivo EPUB para SmartPhone</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#android"><i class="fa fa-check"></i><b>0.2.1</b> ANDROID</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#livros-texto-da-disciplina"><i class="fa fa-check"></i><b>0.3</b> Livros Texto da Disciplina</a>
<ul>
<li class="chapter" data-level="0.3.1" data-path="index.html"><a href="index.html#introdu%C3%A7%C3%A3o-a-sistemas-de-bancos-de-dados-do-autor-christopher-john-date"><i class="fa fa-check"></i><b>0.3.1</b> ‚ÄúIntrodu√ß√£o a sistemas de bancos de dados‚Äù do autor ‚Äú<strong>Christopher John Date</strong>‚Äù</a></li>
<li class="chapter" data-level="0.3.2" data-path="index.html"><a href="index.html#projeto-de-bancos-de-dados-do-autor-carlos-alberto-heuser"><i class="fa fa-check"></i><b>0.3.2</b> ‚Äú<strong>Projeto de bancos de dados</strong>‚Äù do autor ‚ÄúCarlos Alberto HEUSER‚Äù</a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#calend%C3%A1rio-das-aulas"><i class="fa fa-check"></i><b>0.4</b> Calend√°rio das aulas</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path="index.html"><a href="index.html#fevereiro-de-2026"><i class="fa fa-check"></i><b>0.4.1</b> Fevereiro de 2026</a></li>
<li class="chapter" data-level="0.4.2" data-path="index.html"><a href="index.html#mar%C3%A7o-de-2026"><i class="fa fa-check"></i><b>0.4.2</b> Mar√ßo de 2026</a></li>
<li class="chapter" data-level="0.4.3" data-path="index.html"><a href="index.html#abril-de-2026"><i class="fa fa-check"></i><b>0.4.3</b> Abril de 2026</a></li>
<li class="chapter" data-level="0.4.4" data-path="index.html"><a href="index.html#maio-de-2026"><i class="fa fa-check"></i><b>0.4.4</b> Maio de 2026</a></li>
<li class="chapter" data-level="0.4.5" data-path="index.html"><a href="index.html#junho-de-2026"><i class="fa fa-check"></i><b>0.4.5</b> Junho de 2026</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#alunos-2026---1o-semestre"><i class="fa fa-check"></i><b>0.5</b> Alunos 2026 - 1o Semestre</a>
<ul>
<li class="chapter" data-level="0.5.1" data-path="index.html"><a href="index.html#campus-ch%C3%A1cara-santo-ant%C3%B4nio"><i class="fa fa-check"></i><b>0.5.1</b> Campus Ch√°cara Santo Ant√¥nio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="postgres-zip-version-windows-starting-guide.html"><a href="postgres-zip-version-windows-starting-guide.html"><i class="fa fa-check"></i><b>1</b> Postgres (Zip Version) Windows Starting Guide</a></li>
<li class="chapter" data-level="2" data-path="aula-inaugural.html"><a href="aula-inaugural.html"><i class="fa fa-check"></i><b>2</b> <strong>Aula Inaugural</strong></a>
<ul>
<li class="chapter" data-level="2.1" data-path="aula-inaugural.html"><a href="aula-inaugural.html#disciplina-banco-de-dados"><i class="fa fa-check"></i><b>2.1</b> Disciplina: <strong>Banco de Dados</strong></a></li>
<li class="chapter" data-level="2.2" data-path="aula-inaugural.html"><a href="aula-inaugural.html#sobre-o-professor"><i class="fa fa-check"></i><b>2.2</b> üë®‚Äçüè´ Sobre o Professor</a></li>
<li class="chapter" data-level="2.3" data-path="aula-inaugural.html"><a href="aula-inaugural.html#objetivos-da-disciplina"><i class="fa fa-check"></i><b>2.3</b> üéØ Objetivos da Disciplina</a></li>
<li class="chapter" data-level="2.4" data-path="aula-inaugural.html"><a href="aula-inaugural.html#calend%C3%A1rio-da-disciplina"><i class="fa fa-check"></i><b>2.4</b> üìÖ Calend√°rio da Disciplina</a></li>
<li class="chapter" data-level="2.5" data-path="aula-inaugural.html"><a href="aula-inaugural.html#ementa-resumida"><i class="fa fa-check"></i><b>2.5</b> üìö Ementa Resumida</a></li>
<li class="chapter" data-level="2.6" data-path="aula-inaugural.html"><a href="aula-inaugural.html#avalia%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>2.6</b> üìù Avalia√ß√£o</a></li>
<li class="chapter" data-level="2.7" data-path="aula-inaugural.html"><a href="aula-inaugural.html#ferramentas-da-disciplina"><i class="fa fa-check"></i><b>2.7</b> üõ†Ô∏è Ferramentas da Disciplina</a></li>
<li class="chapter" data-level="2.8" data-path="aula-inaugural.html"><a href="aula-inaugural.html#expectativas-e-regras"><i class="fa fa-check"></i><b>2.8</b> üìå Expectativas e Regras</a></li>
<li class="chapter" data-level="2.9" data-path="aula-inaugural.html"><a href="aula-inaugural.html#dicas-para-mandar-bem"><i class="fa fa-check"></i><b>2.9</b> üí° Dicas para Mandar Bem</a></li>
<li class="chapter" data-level="2.10" data-path="aula-inaugural.html"><a href="aula-inaugural.html#encerramento"><i class="fa fa-check"></i><b>2.10</b> üôå Encerramento</a></li>
<li class="chapter" data-level="2.11" data-path="aula-inaugural.html"><a href="aula-inaugural.html#estamos-prontos"><i class="fa fa-check"></i><b>2.11</b> Estamos prontos?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html"><i class="fa fa-check"></i><b>3</b> Fundamentos de Sistemas de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#parte-i-linha-do-tempo-dos-sgbds"><i class="fa fa-check"></i><b>3.1</b> Parte I ‚Äî Linha do Tempo dos SGBDs</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#o-in%C3%ADcio-do-modelo-relacional"><i class="fa fa-check"></i><b>3.1.1</b> O In√≠cio do Modelo Relacional</a></li>
<li class="chapter" data-level="3.1.2" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#edgar-f.-codd-19232003"><i class="fa fa-check"></i><b>3.1.2</b> Edgar F. Codd (1923‚Äì2003)</a></li>
<li class="chapter" data-level="3.1.3" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#system-r-e-sql"><i class="fa fa-check"></i><b>3.1.3</b> System R e SQL</a></li>
<li class="chapter" data-level="3.1.4" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#raymond-f.-boyce"><i class="fa fa-check"></i><b>3.1.4</b> Raymond F. Boyce</a></li>
<li class="chapter" data-level="3.1.5" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#donald-d.-chamberlin"><i class="fa fa-check"></i><b>3.1.5</b> Donald D. Chamberlin</a></li>
<li class="chapter" data-level="3.1.6" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#modelo-entidade-relacionamento"><i class="fa fa-check"></i><b>3.1.6</b> Modelo Entidade-Relacionamento</a></li>
<li class="chapter" data-level="3.1.7" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#peter-chen"><i class="fa fa-check"></i><b>3.1.7</b> Peter Chen</a></li>
<li class="chapter" data-level="3.1.8" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#escola-de-berkeley"><i class="fa fa-check"></i><b>3.1.8</b> Escola de Berkeley</a></li>
<li class="chapter" data-level="3.1.9" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#prof-michael-stonebraker"><i class="fa fa-check"></i><b>3.1.9</b> Prof Michael Stonebraker</a></li>
<li class="chapter" data-level="3.1.10" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#d%C3%A9cadas-de-consolida%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>3.1.10</b> D√©cadas de Consolida√ß√£o</a></li>
<li class="chapter" data-level="3.1.11" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-2000-big-data-e-nosql"><i class="fa fa-check"></i><b>3.1.11</b> Anos 2000 ‚Äî Big Data e NoSQL</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#parte-ii-fundamentos-matem%C3%A1ticos-do-modelo-relacional"><i class="fa fa-check"></i><b>3.2</b> Parte II ‚Äî Fundamentos Matem√°ticos do Modelo Relacional</a></li>
<li class="chapter" data-level="3.3" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#conceito-de-rela%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>3.3</b> 1. Conceito de Rela√ß√£o</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#a-solu%C3%A7%C3%A3o-vem-da-matem%C3%A1tica-fun%C3%A7%C3%B5es-como-relacionamentos"><i class="fa fa-check"></i><b>3.3.1</b> A Solu√ß√£o vem da Matem√°tica: FUN√á√ïES como RELACIONAMENTOS:</a></li>
<li class="chapter" data-level="3.3.2" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#rela%C3%A7%C3%A3o-em-banco-de-dados"><i class="fa fa-check"></i><b>3.3.2</b> Rela√ß√£o em Banco de Dados</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#opera%C3%A7%C3%B5es-relacionais"><i class="fa fa-check"></i><b>3.4</b> 2. Opera√ß√µes Relacionais</a></li>
<li class="chapter" data-level="3.5" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#propriedades-de-rela%C3%A7%C3%B5es"><i class="fa fa-check"></i><b>3.5</b> 3. Propriedades de Rela√ß√µes</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#reflexiva"><i class="fa fa-check"></i><b>3.5.1</b> 3.1 Reflexiva</a></li>
<li class="chapter" data-level="3.5.2" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#sim%C3%A9trica"><i class="fa fa-check"></i><b>3.5.2</b> 3.2 Sim√©trica</a></li>
<li class="chapter" data-level="3.5.3" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#transitiva"><i class="fa fa-check"></i><b>3.5.3</b> 3.3 Transitiva</a></li>
<li class="chapter" data-level="3.5.4" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#antissim%C3%A9trica"><i class="fa fa-check"></i><b>3.5.4</b> 3.4 Antissim√©trica</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#rela%C3%A7%C3%A3o-de-equival%C3%AAncia"><i class="fa fa-check"></i><b>3.6</b> 4. Rela√ß√£o de Equival√™ncia</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#classes-de-equival%C3%AAncia"><i class="fa fa-check"></i><b>3.6.1</b> Classes de Equival√™ncia</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#depend%C3%AAncias-funcionais"><i class="fa fa-check"></i><b>3.7</b> 5. Depend√™ncias Funcionais</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#resolu%C3%A7%C3%A3o-1"><i class="fa fa-check"></i><b>3.7.1</b> Resolu√ß√£o</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#conceito-de-fecho"><i class="fa fa-check"></i><b>3.8</b> 6. Conceito de Fecho</a></li>
<li class="chapter" data-level="3.9" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#normaliza%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>3.9</b> 6. Normaliza√ß√£o</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#%C2%AA-forma-normal-1fn"><i class="fa fa-check"></i><b>3.9.1</b> 1¬™ Forma Normal (1FN)</a></li>
<li class="chapter" data-level="3.9.2" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#%C2%AA-forma-normal-2fn"><i class="fa fa-check"></i><b>3.9.2</b> 2¬™ Forma Normal (2FN)</a></li>
<li class="chapter" data-level="3.9.3" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#%C2%AA-forma-normal-3fn"><i class="fa fa-check"></i><b>3.9.3</b> 3¬™ Forma Normal (3FN)</a></li>
<li class="chapter" data-level="3.9.4" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#bcnf"><i class="fa fa-check"></i><b>3.9.4</b> BCNF</a></li>
<li class="chapter" data-level="3.9.5" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#rela%C3%A7%C3%B5es-de-equival%C3%AAncia-e-normaliza%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>3.9.5</b> Rela√ß√µes de Equival√™ncia e Normaliza√ß√£o</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#conex%C3%A3o-final-a-base-matem%C3%A1tica-do-sgbd"><i class="fa fa-check"></i><b>3.10</b> Conex√£o Final ‚Äî A Base Matem√°tica do SGBD</a></li>
<li class="chapter" data-level="3.11" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#exerc%C3%ADcios"><i class="fa fa-check"></i><b>3.11</b> Exerc√≠cios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html"><i class="fa fa-check"></i><b>4</b> Modelagem de Bancos de Dados parte 01</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#introdu%C3%A7%C3%A3o-visitando-a-teoria-de-bancos-de-dados"><i class="fa fa-check"></i><b>4.1</b> Introdu√ß√£o: Visitando a teoria de Bancos de Dados</a></li>
<li class="chapter" data-level="4.2" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#modelo-matem%C3%A1tico-de-um-banco-de-dados"><i class="fa fa-check"></i><b>4.2</b> Modelo Matem√°tico de um Banco de Dados</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#podemos-representa-lo-matem%C3%A1ticamente-utilizando-a-teoria-dos-conjuntos"><i class="fa fa-check"></i><b>4.2.1</b> Podemos representa-lo matem√°ticamente utilizando a teoria dos conjuntos</a></li>
<li class="chapter" data-level="4.2.2" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#ent%C3%A3o-para-podemos-relacionar-estes-dois-conjuntos-funcion%C3%A1rios-e-departamentos-utilizando-a-teoria-das-fun%C3%A7%C3%B5es"><i class="fa fa-check"></i><b>4.2.2</b> Ent√£o para podemos relacionar estes dois conjuntos (Funcion√°rios e Departamentos) utilizando a Teoria das Fun√ß√µes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#modelo-l%C3%B3gico-de-banco-de-dados"><i class="fa fa-check"></i><b>4.3</b> Modelo L√≥gico de Banco de Dados</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#modelo-conceitual-entidade-relacionamento-de-banco-de-dados"><i class="fa fa-check"></i><b>4.3.1</b> Modelo Conceitual ‚ÄúEntidade Relacionamento‚Äù de Banco de Dados</a></li>
<li class="chapter" data-level="4.3.2" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#composi%C3%A7%C3%A3o-e-significado-do-diagrama-entidade-relacionamento-der"><i class="fa fa-check"></i><b>4.3.2</b> Composi√ß√£o e Significado do Diagrama Entidade Relacionamento (DER)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#modelo-f%C3%ADsico-de-banco-de-dados"><i class="fa fa-check"></i><b>4.4</b> Modelo F√≠sico de Banco de Dados</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#gera%C3%A7%C3%A3o-do-modelo-f%C3%ADsico-para-aplica-lo-ao-sgbd-sistema-de-gerenciamento-de-banco-de-dados"><i class="fa fa-check"></i><b>4.4.1</b> Gera√ß√£o do modelo F√≠sico para aplica-lo ao SGBD (Sistema de Gerenciamento de Banco de Dados):</a></li>
<li class="chapter" data-level="4.4.2" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#interagindo-com-o-modelo-f%C3%ADsico---a-linguagem-sql-structured-query-language"><i class="fa fa-check"></i><b>4.4.2</b> Interagindo com o Modelo F√≠sico - A linguagem SQL (Structured Query Language)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#exemplo-revenda-de-ve%C3%ADculos-multi-marcas"><i class="fa fa-check"></i><b>4.5</b> EXEMPLO: REVENDA DE VE√çCULOS MULTI-MARCAS</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#passo-1---visualizando-matem%C3%A1ticamente-os-dados"><i class="fa fa-check"></i><b>4.5.1</b> Passo 1 - Visualizando matem√°ticamente os dados:</a></li>
<li class="chapter" data-level="4.5.2" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#modelo-l%C3%B3gico-modelo-entidade-relacionamento"><i class="fa fa-check"></i><b>4.5.2</b> Modelo L√≥gico: Modelo Entidade Relacionamento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#verbos-relacionamentos-e-cardinalidade"><i class="fa fa-check"></i><b>4.6</b> VERBOS: Relacionamentos e Cardinalidade</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#tipos-principais-de-cardinalidade"><i class="fa fa-check"></i><b>4.6.1</b> üîπ Tipos principais de cardinalidade</a></li>
<li class="chapter" data-level="4.6.2" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#relacionamento-11-um-para-um"><i class="fa fa-check"></i><b>4.6.2</b> 1. Relacionamento <strong>1:1 (Um para Um)</strong></a></li>
<li class="chapter" data-level="4.6.3" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#relacionamento-1n-um-para-muitos"><i class="fa fa-check"></i><b>4.6.3</b> Relacionamento <strong>1:N (Um para Muitos)</strong></a></li>
<li class="chapter" data-level="4.6.4" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#relacionamento-nn-muitos-para-muitos"><i class="fa fa-check"></i><b>4.6.4</b> Relacionamento N:N (Muitos para Muitos)</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#entidade-dominante-e-entidade-subordinada"><i class="fa fa-check"></i><b>4.7</b> Entidade Dominante e Entidade Subordinada</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#defini%C3%A7%C3%B5es"><i class="fa fa-check"></i><b>4.7.1</b> Defini√ß√µes:</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#cardinalidade-do-modelo-l%C3%B3gico-e-a-cria%C3%A7%C3%A3o-de-chaves-estrangeiras-no-modelo-f%C3%ADsico-relacional"><i class="fa fa-check"></i><b>4.8</b> CARDINALIDADE DO MODELO L√ìGICO E A CRIA√á√ÉO DE CHAVES ESTRANGEIRAS NO MODELO F√çSICO-RELACIONAL</a></li>
<li class="chapter" data-level="4.9" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#normaliza%C3%A7%C3%A3o-em-bancos-de-dados-relaionais"><i class="fa fa-check"></i><b>4.9</b> Normaliza√ß√£o em Bancos de Dados Relaionais</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#tabela-desnormalizada"><i class="fa fa-check"></i><b>4.9.1</b> Tabela Desnormalizada</a></li>
<li class="chapter" data-level="4.9.2" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#tabela-normalizada"><i class="fa fa-check"></i><b>4.9.2</b> Tabela Normalizada</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#refer%C3%AAncias"><i class="fa fa-check"></i><b>4.10</b> Refer√™ncias</a></li>
<li class="chapter" data-level="4.11" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#exerc%C3%ADcios-resolvidos"><i class="fa fa-check"></i><b>4.11</b> Exerc√≠cios RESOLVIDOS</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#exerc%C3%ADcios-1"><i class="fa fa-check"></i><b>4.11.1</b> Exerc√≠cios</a></li>
<li class="chapter" data-level="4.11.2" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#lista-de-exerc%C3%ADcios-modelo-entidade-relacionamento-mer"><i class="fa fa-check"></i><b>4.11.2</b> üìù Lista de Exerc√≠cios ‚Äì Modelo Entidade-Relacionamento (MER)</a></li>
<li class="chapter" data-level="4.11.3" data-path="modelagem-de-bancos-de-dados-parte-01.html"><a href="modelagem-de-bancos-de-dados-parte-01.html#respostas-dos-exerc%C3%ADcios"><i class="fa fa-check"></i><b>4.11.3</b> Respostas dos Exerc√≠cios:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelagem-de-bancos-de-dados-parte-02.html"><a href="modelagem-de-bancos-de-dados-parte-02.html"><i class="fa fa-check"></i><b>5</b> Modelagem de Bancos de Dados parte 02</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelagem-de-bancos-de-dados-parte-02.html"><a href="modelagem-de-bancos-de-dados-parte-02.html#exerc%C3%ADcios-resolvidos-1"><i class="fa fa-check"></i><b>5.1</b> Exerc√≠cios RESOLVIDOS</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><i class="fa fa-check"></i><b>6</b> Administra√ß√£o e Gerenciamento de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="6.1" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#administra%C3%A7%C3%A3o-e-gerenciamento-de-banco-de-dados"><i class="fa fa-check"></i><b>6.1</b> Administra√ß√£o e Gerenciamento de Banco de Dados:</a></li>
<li class="chapter" data-level="6.2" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#papel-do-dba-database-administrator"><i class="fa fa-check"></i><b>6.2</b> Papel do DBA (Database Administrator)</a></li>
<li class="chapter" data-level="6.3" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#usu%C3%A1rios-grupos-e-esquemas-de-bancos-de-dados"><i class="fa fa-check"></i><b>6.3</b> Usu√°rios, Grupos e Esquemas de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#usu%C3%A1rios"><i class="fa fa-check"></i><b>6.3.1</b> Usu√°rios</a></li>
<li class="chapter" data-level="6.3.2" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#esquemas"><i class="fa fa-check"></i><b>6.3.2</b> Esquemas</a></li>
<li class="chapter" data-level="6.3.3" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#grupos-ou-roles"><i class="fa fa-check"></i><b>6.3.3</b> Grupos ou Roles</a></li>
<li class="chapter" data-level="6.3.4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#sistema-de-gerenciamento-de-banco-de-dados-s.g.b.d."><i class="fa fa-check"></i><b>6.3.4</b> Sistema de Gerenciamento de Banco de Dados (S.G.B.D.)</a></li>
<li class="chapter" data-level="6.3.5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#cria%C3%A7%C3%A3o-de-usu%C3%A1rios-no-mysql"><i class="fa fa-check"></i><b>6.3.5</b> Cria√ß√£o de usu√°rios no MySQL</a></li>
<li class="chapter" data-level="6.3.6" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#cria%C3%A7%C3%A3o-de-esquemas-de-banco-de-dados-no-mysql"><i class="fa fa-check"></i><b>6.3.6</b> Cria√ß√£o de Esquemas de Banco de Dados no MySQL</a></li>
<li class="chapter" data-level="6.3.7" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#criando-de-grupos-de-permiss%C3%B5es-no-mysql"><i class="fa fa-check"></i><b>6.3.7</b> Criando de Grupos de Permiss√µes no MySQL:</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#fazendo-tudo-funcionar-colocando-usu%C3%A1rios-em-grupos-e-concedendo-a-estes-acesso-a-esquemas-de-banco-de-dados"><i class="fa fa-check"></i><b>6.4</b> Fazendo tudo funcionar: Colocando usu√°rios em grupos e concedendo a estes acesso a Esquemas de Banco de Dados:</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#associando-os-esquemas-que-representam-cada-estado-a-cada-grupo-que-representa-cada-regi%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>6.4.1</b> Associando os esquemas que representam cada estado a cada grupo (que representa cada regi√ß√£o):</a></li>
<li class="chapter" data-level="6.4.2" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#associando-associando-alunos-a-cada-grupo-regi%C3%A3o"><i class="fa fa-check"></i><b>6.4.2</b> Associando associando alunos a cada grupo (regi√£o):</a></li>
<li class="chapter" data-level="6.4.3" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#associando-usu%C3%A1rios-aos-grupos"><i class="fa fa-check"></i><b>6.4.3</b> Associando usu√°rios aos grupos</a></li>
<li class="chapter" data-level="6.4.4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#concedendo-privil%C3%A9gios-aos-grupos"><i class="fa fa-check"></i><b>6.4.4</b> Concedendo privil√©gios aos grupos:</a></li>
<li class="chapter" data-level="6.4.5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#exemplo-no-mysql"><i class="fa fa-check"></i><b>6.4.5</b> Exemplo no MySQL</a></li>
<li class="chapter" data-level="6.4.6" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#exemplo-no-postgresql"><i class="fa fa-check"></i><b>6.4.6</b> Exemplo no PostGreSQL</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#feito"><i class="fa fa-check"></i><b>6.5</b> Feito</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados-1.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados-1.html"><i class="fa fa-check"></i><b>7</b> Administra√ß√£o e Gerenciamento de Bancos de Dados</a></li>
<li class="chapter" data-level="8" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html"><i class="fa fa-check"></i><b>8</b> Banco de Dados: Uma Aplica√ß√£o CRUD</a>
<ul>
<li class="chapter" data-level="8.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#feito-1"><i class="fa fa-check"></i><b>8.1</b> Feito</a></li>
<li class="chapter" data-level="8.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exerc%C3%ADcios-2"><i class="fa fa-check"></i><b>8.2</b> Exerc√≠cios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="banco-de-dados-mysql-mariadb.html"><a href="banco-de-dados-mysql-mariadb.html"><i class="fa fa-check"></i><b>9</b> Banco de Dados: MySQL (MariaDB)</a></li>
<li class="chapter" data-level="10" data-path="banco-de-dados-mysql-mariadb-1.html"><a href="banco-de-dados-mysql-mariadb-1.html"><i class="fa fa-check"></i><b>10</b> Banco de Dados: MySQL (MariaDB)</a></li>
<li class="chapter" data-level="11" data-path="banco-de-dados-postgres.html"><a href="banco-de-dados-postgres.html"><i class="fa fa-check"></i><b>11</b> Banco de Dados: Postgres</a></li>
<li class="chapter" data-level="12" data-path="banco-de-dados-postgres-1.html"><a href="banco-de-dados-postgres-1.html"><i class="fa fa-check"></i><b>12</b> Banco de Dados: Postgres</a></li>
<li class="chapter" data-level="13" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><i class="fa fa-check"></i><b>13</b> Banco de Dados: Uma Aplica√ß√£o CRUD</a>
<ul>
<li class="chapter" data-level="13.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#o-que-%C3%A9-uma-aplica%C3%A7%C3%A3o-crud"><i class="fa fa-check"></i><b>13.1</b> O que √© uma Aplica√ß√£o CRUD?</a></li>
<li class="chapter" data-level="13.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#conceito-de-crud"><i class="fa fa-check"></i><b>13.2</b> Conceito de CRUD</a></li>
<li class="chapter" data-level="13.3" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#o-padr%C3%A3o-de-design-de-sistemas-mvc-model-view-controller"><i class="fa fa-check"></i><b>13.3</b> O padr√£o de Design de Sistemas MVC (Model View Controller)</a></li>
<li class="chapter" data-level="13.4" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#construindo-uma-aplica%C3%A7%C3%A3o-crud-para-interfacear-com-a-tabela-pessoa"><i class="fa fa-check"></i><b>13.4</b> Construindo uma aplica√ß√£o CRUD para interfacear com a tabela ‚ÄúPessoa‚Äù</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#representa%C3%A7%C3%A3o-gr%C3%A1fica-no-modelo-f%C3%ADsico-relacional"><i class="fa fa-check"></i><b>13.4.1</b> Representa√ß√£o gr√°fica no modelo F√≠sico-Relacional</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cria%C3%A7%C3%A3o-de-uma-aplica%C3%A7%C3%A3o-crud"><i class="fa fa-check"></i><b>13.5</b> Cria√ß√£o de uma aplica√ß√£o CRUD</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#resultado-final"><i class="fa fa-check"></i><b>13.5.1</b> Resultado final:</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#feito-2"><i class="fa fa-check"></i><b>13.6</b> Feito</a></li>
<li class="chapter" data-level="13.7" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exerc%C3%ADcios-3"><i class="fa fa-check"></i><b>13.7</b> Exerc√≠cios</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#banco-de-dados-utilizado-nos-exemplos-de-aplica%C3%A7%C3%B5es-abaixo"><i class="fa fa-check"></i><b>13.7.1</b> Banco de Dados utilizado nos exemplos de aplica√ß√µes abaixo</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-01"><i class="fa fa-check"></i><b>13.8</b> Exemplo 01</a></li>
<li class="chapter" data-level="13.9" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-02---servidor-de-aplica%C3%A7%C3%A3o-python"><i class="fa fa-check"></i><b>13.9</b> Exemplo 02 - SERVIDOR DE APLICA√á√ÉO PYTHON</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#servidor-python"><i class="fa fa-check"></i><b>13.9.1</b> Servidor python</a></li>
<li class="chapter" data-level="13.9.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex%C3%A3o-restful"><i class="fa fa-check"></i><b>13.9.2</b> Cliente HTML (conex√£o Restful)</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-03---servidor-de-aplica%C3%A7%C3%A3o-perl"><i class="fa fa-check"></i><b>13.10</b> Exemplo 03 - SERVIDOR DE APLICA√á√ÉO PERL</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#servidor-perl"><i class="fa fa-check"></i><b>13.10.1</b> Servidor Perl</a></li>
<li class="chapter" data-level="13.10.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex%C3%A3o-restful-1"><i class="fa fa-check"></i><b>13.10.2</b> Cliente HTML (conex√£o Restful)</a></li>
</ul></li>
<li class="chapter" data-level="13.11" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-04---servidor-de-aplica%C3%A7%C3%A3o-java"><i class="fa fa-check"></i><b>13.11</b> Exemplo 04 - SERVIDOR DE APLICA√á√ÉO JAVA</a></li>
<li class="chapter" data-level="13.12" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-05---servidor-de-aplica%C3%A7%C3%A3o-c"><i class="fa fa-check"></i><b>13.12</b> Exemplo 05 - SERVIDOR DE APLICA√á√ÉO C++</a>
<ul>
<li class="chapter" data-level="13.12.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#criando-o-arquivo-c-do-servidor"><i class="fa fa-check"></i><b>13.12.1</b> Criando o arquivo C++ do servidor</a></li>
<li class="chapter" data-level="13.12.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#ferramenta-de-compila%C3%A7%C3%A3o-cmake"><i class="fa fa-check"></i><b>13.12.2</b> Ferramenta de compila√ß√£o CMAKE</a></li>
<li class="chapter" data-level="13.12.3" data-path="banco-de-dados-uma-aplica√ß√£o-crud-1.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex%C3%A3o-restful-2"><i class="fa fa-check"></i><b>13.12.3</b> Cliente HTML (conex√£o Restful)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="banco-de-dados-estat√≠stico---cliente-rstudio.html"><a href="banco-de-dados-estat√≠stico---cliente-rstudio.html"><i class="fa fa-check"></i><b>14</b> Banco de Dados Estat√≠stico - Cliente Rstudio</a></li>
<li class="chapter" data-level="15" data-path="banco-de-dados-estat√≠stico---cliente-rstudio-1.html"><a href="banco-de-dados-estat√≠stico---cliente-rstudio-1.html"><i class="fa fa-check"></i><b>15</b> Banco de Dados Estat√≠stico - Cliente Rstudio</a></li>
<li class="chapter" data-level="16" data-path="banco-de-dados---an√°lise-de-dados-parte-01.html"><a href="banco-de-dados---an√°lise-de-dados-parte-01.html"><i class="fa fa-check"></i><b>16</b> Banco de Dados - An√°lise de Dados Parte 01</a></li>
<li class="chapter" data-level="17" data-path="banco-de-dados---an√°lise-de-dados-parte-01-1.html"><a href="banco-de-dados---an√°lise-de-dados-parte-01-1.html"><i class="fa fa-check"></i><b>17</b> Banco de Dados - An√°lise de Dados Parte 01</a></li>
<li class="chapter" data-level="18" data-path="banco-de-dados---an√°lise-de-dados-parte-02.html"><a href="banco-de-dados---an√°lise-de-dados-parte-02.html"><i class="fa fa-check"></i><b>18</b> Banco de Dados - An√°lise de Dados Parte 02</a></li>
<li class="chapter" data-level="19" data-path="banco-de-dados---an√°lise-de-dados-parte-02-1.html"><a href="banco-de-dados---an√°lise-de-dados-parte-02-1.html"><i class="fa fa-check"></i><b>19</b> Banco de Dados - An√°lise de Dados Parte 02</a></li>
<li class="chapter" data-level="20" data-path="banco-de-dados---an√°lise-de-dados-parte-03.html"><a href="banco-de-dados---an√°lise-de-dados-parte-03.html"><i class="fa fa-check"></i><b>20</b> Banco de Dados - An√°lise de Dados Parte 03</a></li>
<li class="chapter" data-level="21" data-path="banco-de-dados---an√°lise-de-dados-parte-03-1.html"><a href="banco-de-dados---an√°lise-de-dados-parte-03-1.html"><i class="fa fa-check"></i><b>21</b> Banco de Dados - An√°lise de Dados Parte 03</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado com Biblioteca R bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ADS - Banco de dados e No-SQL - 2026 - Anota√ß√µes de aula</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="banco-de-dados-uma-aplica√ß√£o-crud-1" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Slide 13</span> Banco de Dados: Uma Aplica√ß√£o CRUD<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#banco-de-dados-uma-aplica%C3%A7%C3%A3o-crud-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="section-13" class="section level4 unnumbered hasAnchor">
<h4>21/04/2026<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#section-13" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="professor-migu√©l-suares-10" class="section level4 unnumbered hasAnchor">
<h4>Professor Migu√©l Suares<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#professor-migu%C3%A9l-suares-10" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="o-que-√©-uma-aplica√ß√£o-crud" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> O que √© uma Aplica√ß√£o CRUD?<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#o-que-%C3%A9-uma-aplica%C3%A7%C3%A3o-crud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hoje vamos desenvolver um cadastro web simples e entender o que √© o acronimo C.R.U.D.</p>
</div>
<div id="conceito-de-crud" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Conceito de CRUD<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#conceito-de-crud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>CRUD</strong> √© um acr√¥nimo para quatro opera√ß√µes fundamentais que um sistema realiza sobre dados em um banco de dados:</p>
<p><img src="images/2025-09-01/01-CRUD.jpg" /></p>
<p>Essas quatro opera√ß√µes comp√µem a base da maioria das <strong>aplica√ß√µes web</strong> que manipulam dados persistidos em um <strong>SGBD</strong> (Sistema Gerenciador de Banco de Dados).</p>
<hr />
</div>
<div id="o-padr√£o-de-design-de-sistemas-mvc-model-view-controller" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> O padr√£o de Design de Sistemas MVC (Model View Controller)<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#o-padr%C3%A3o-de-design-de-sistemas-mvc-model-view-controller" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uma aplica√ß√£o Cliente-Servidor (modelo 2 camadas) geralmente segue o <strong>padr√£o MVC</strong> ‚Äî <strong>Model, View, Controller</strong>:</p>
<p><img src="images/2025-09-01/03-MVC.jpg" /></p>
</div>
<div id="construindo-uma-aplica√ß√£o-crud-para-interfacear-com-a-tabela-pessoa" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Construindo uma aplica√ß√£o CRUD para interfacear com a tabela ‚ÄúPessoa‚Äù<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#construindo-uma-aplica%C3%A7%C3%A3o-crud-para-interfacear-com-a-tabela-pessoa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Considere o Diagrama Entidade-Relacionamento abaixo:</p>
<p><img src="images/aula-05-Exemplo-01-continua%C3%A7%C3%A3o.svg" /><!-- --></p>
<p>Vamos Converte-lo para o Modelo F√≠sico-Relacional em linguagem SQL:</p>
<div id="representa√ß√£o-gr√°fica-no-modelo-f√≠sico-relacional" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Representa√ß√£o gr√°fica no modelo F√≠sico-Relacional<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#representa%C3%A7%C3%A3o-gr%C3%A1fica-no-modelo-f%C3%ADsico-relacional" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos agora representa-lo em linguagem SQL:</p>
<p><img src="images/2025-09-01/02-TabelaPessoas.jpg" /></p>
</div>
</div>
<div id="cria√ß√£o-de-uma-aplica√ß√£o-crud" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Cria√ß√£o de uma aplica√ß√£o CRUD<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cria%C3%A7%C3%A3o-de-uma-aplica%C3%A7%C3%A3o-crud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vamos criar um <strong>microsas</strong> (micro Software As A Service) , ou seja, um site para inserir informa√ß√µes dentro da tabela acima.</p>
<p><img src="images/2025-09-01/04-Aplicacao.jpg" /></p>
<table>
<caption>Criando um Esquema de Banco de Dados - CRUD tabela Pessoas</caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Informa√ß√µes de Projeto</th>
<th>Tecnologias utilizadas no projeto CRUD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Servidor de banco de dados SGBD</td>
<td>MySQL 8</td>
</tr>
<tr class="even">
<td>Usu√°rio de Banco de Dados</td>
<td><strong>pessoas_user</strong></td>
</tr>
<tr class="odd">
<td>De onde pode ser acessado</td>
<td>Apenas M√°quina Local (localhost)</td>
</tr>
<tr class="even">
<td>Esquema de Banco de Dados</td>
<td><strong>pessoasdb</strong></td>
</tr>
<tr class="odd">
<td>Servidor de Aplica√ß√£o</td>
<td>Python 3</td>
</tr>
<tr class="even">
<td>Cliente da Aplica√ß√£o</td>
<td>HTML + Javascript</td>
</tr>
<tr class="odd">
<td>Tecnologia de API</td>
<td>RestuFul</td>
</tr>
<tr class="even">
<td><strong>Biblioteca de Javascript</strong> para criar API <strong>RestFul</strong></td>
<td>M√©todo <strong>Fetch</strong> (Biblioteca Padr√£o do JavaScript para API RestFul)</td>
</tr>
<tr class="odd">
<td>Formato de Dados entre Servidor de Aplica√ß√£o e Cliente de Aplica√ß√£o</td>
<td><strong>JSON</strong></td>
</tr>
</tbody>
</table>
<div id="cria√ß√£o-de-um-usu√°rio-para-interagir-com-o-esquema-de-banco-de-dados" class="section level4 hasAnchor" number="13.5.0.1">
<h4><span class="header-section-number">13.5.0.1</span> Cria√ß√£o de um usu√°rio para Interagir com o Esquema de Banco de Dados<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cria%C3%A7%C3%A3o-de-um-usu%C3%A1rio-para-interagir-com-o-esquema-de-banco-de-dados" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="images/2025-09-01/05-Usuario.jpg" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb61-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-1" tabindex="-1"></a></span>
<span id="cb61-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-2" tabindex="-1"></a><span class="co">-- CRIAR USU√ÅRIO LOCAL E CONCEDER PERMISS√ïES</span></span>
<span id="cb61-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-3" tabindex="-1"></a><span class="co">-- Troque &#39;MinhaSenhaForte&#39; por uma senha segura</span></span>
<span id="cb61-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-4" tabindex="-1"></a></span>
<span id="cb61-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-5" tabindex="-1"></a></span>
<span id="cb61-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-6" tabindex="-1"></a><span class="kw">CREATE</span> <span class="fu">USER</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> <span class="st">&#39;pessoas_user&#39;</span>@<span class="st">&#39;localhost&#39;</span> <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> <span class="st">&#39;MinhaSenhaForte&#39;</span>;</span>
<span id="cb61-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-7" tabindex="-1"></a></span>
<span id="cb61-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-8" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">ALL</span> <span class="kw">PRIVILEGES</span> <span class="kw">ON</span> pessoasdb.<span class="op">*</span> <span class="kw">TO</span> <span class="st">&#39;pessoas_user&#39;</span>@<span class="st">&#39;localhost&#39;</span>;</span>
<span id="cb61-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-9" tabindex="-1"></a></span>
<span id="cb61-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb61-10" tabindex="-1"></a><span class="kw">FLUSH</span> <span class="kw">PRIVILEGES</span>;</span></code></pre></div>
</div>
<div id="cria√ß√£o-do-esquema-de-banco-de-dados-no-sgbd-mysql" class="section level4 hasAnchor" number="13.5.0.2">
<h4><span class="header-section-number">13.5.0.2</span> Cria√ß√£o do Esquema de Banco de Dados no SGBD MySQL<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cria%C3%A7%C3%A3o-do-esquema-de-banco-de-dados-no-sgbd-mysql" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Agora vamos criar um esquema de Banco de Dados para abrigar nossa futura tabela:</p>
<p><img src="images/2025-09-01/06-Esquema.jpg" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb62-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb62-1" tabindex="-1"></a><span class="co">-- 1) CRIAR BANCO (ajuste o nome se quiser)</span></span>
<span id="cb62-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb62-2" tabindex="-1"></a></span>
<span id="cb62-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb62-3" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> pessoasdb</span>
<span id="cb62-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb62-4" tabindex="-1"></a>  <span class="dt">CHARACTER</span> <span class="kw">SET</span> utf8mb4</span>
<span id="cb62-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb62-5" tabindex="-1"></a>  COLLATE utf8mb4_0900_ai_ci;</span>
<span id="cb62-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb62-6" tabindex="-1"></a></span>
<span id="cb62-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb62-7" tabindex="-1"></a><span class="kw">USE</span> pessoasdb;</span></code></pre></div>
</div>
<div id="cria√ß√£o-da-tabela-pessoas" class="section level4 hasAnchor" number="13.5.0.3">
<h4><span class="header-section-number">13.5.0.3</span> Cria√ß√£o da Tabela ‚Äúpessoas‚Äù<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cria%C3%A7%C3%A3o-da-tabela-pessoas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="images/2025-09-01/07-Tabela_Pessoas.jpg" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb63-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-1" tabindex="-1"></a></span>
<span id="cb63-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-2" tabindex="-1"></a><span class="co">-- 3) TABELA &#39;pessoas&#39; COMPAT√çVEL COM O MODELO SQLAlchemy</span></span>
<span id="cb63-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-3" tabindex="-1"></a><span class="co">--    - cpf: chave prim√°ria (String(14))</span></span>
<span id="cb63-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-4" tabindex="-1"></a><span class="co">--    - nome, endereco, foto: TEXT</span></span>
<span id="cb63-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-5" tabindex="-1"></a><span class="co">--    - data_nascimento: DATE</span></span>
<span id="cb63-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-6" tabindex="-1"></a></span>
<span id="cb63-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-7" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> pessoas </span>
<span id="cb63-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-8" tabindex="-1"></a>(</span>
<span id="cb63-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-9" tabindex="-1"></a>  cpf             <span class="dt">VARCHAR</span>(<span class="dv">14</span>)  <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb63-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-10" tabindex="-1"></a>  nome            TEXT         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb63-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-11" tabindex="-1"></a>  endereco        TEXT         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb63-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-12" tabindex="-1"></a>  data_nascimento <span class="dt">DATE</span>         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb63-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-13" tabindex="-1"></a>  foto            TEXT         <span class="kw">NULL</span>,</span>
<span id="cb63-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-14" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (cpf)</span>
<span id="cb63-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-15" tabindex="-1"></a>) ENGINE<span class="op">=</span>InnoDB <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8mb4 COLLATE<span class="op">=</span>utf8mb4_0900_ai_ci;</span>
<span id="cb63-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-16" tabindex="-1"></a></span>
<span id="cb63-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-17" tabindex="-1"></a></span>
<span id="cb63-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-18" tabindex="-1"></a><span class="co">-- 4) (OPCIONAL) √çNDICES PARA BUSCA</span></span>
<span id="cb63-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-19" tabindex="-1"></a><span class="co">-- Seu endpoint usa LIKE/ILIKE em nome e cpf; cpf j√° √© PK.</span></span>
<span id="cb63-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-20" tabindex="-1"></a><span class="co">-- Para acelerar buscas por nome com LIKE, crie um √≠ndice por prefixo.</span></span>
<span id="cb63-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-21" tabindex="-1"></a><span class="co">-- OBS: √≠ndices em TEXT precisam de comprimento; 128 costuma ser um bom compromisso.</span></span>
<span id="cb63-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-22" tabindex="-1"></a></span>
<span id="cb63-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb63-23" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> idx_pessoas_nome_prefix <span class="kw">ON</span> pessoas (nome(<span class="dv">128</span>));</span></code></pre></div>
</div>
<div id="uma-aplica√ß√£o-cliente-servidor-no-formato-mvc-model-view-controller" class="section level4 hasAnchor" number="13.5.0.4">
<h4><span class="header-section-number">13.5.0.4</span> Uma aplica√ß√£o Cliente Servidor no formato MVC (Model View Controller)<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#uma-aplica%C3%A7%C3%A3o-cliente-servidor-no-formato-mvc-model-view-controller" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="images/Aplicacao-MVC-CRUD-Pessoas-01.svg" /><!-- --></p>
</div>
<div id="cria√ß√£o-do-servidor-de-aplica√ß√£o-em-linguagem-python" class="section level4 hasAnchor" number="13.5.0.5">
<h4><span class="header-section-number">13.5.0.5</span> Cria√ß√£o do Servidor de Aplica√ß√£o em Linguagem Python<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cria%C3%A7%C3%A3o-do-servidor-de-aplica%C3%A7%C3%A3o-em-linguagem-python" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vejamos a representa√ß√£o gr√°fica de nosso servidor utilizando o diagrama de classes da linguagem UML</p>
<p><img src="images/Servidor-CRUD-Pessoas-01.svg" /><!-- --></p>
<p>Para utilizar o MySQL como servidor, devemos instalar os drivers de MySQL para a biblioteca SQLAlchemy do Python atrav√©s da ferramenta de linha de comando PIP do python</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb64-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb64-1" tabindex="-1"></a>pip install flask flask<span class="at">-cors</span> sqlalchemy <span class="st">&quot;pymysql&gt;=1.1&quot;</span></span>
<span id="cb64-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb64-2" tabindex="-1"></a># (ou use mysqlclient: pip install mysqlclient e troque o driver para mysql+mysqlclient<span class="kw">)</span></span></code></pre></div>
<p>Agora vamos escrever o script python que criar√° o servidor de aplica√ß√£o para interfacear nosso Cliente no Navegador e nossa tabela pessoas dentro do SGBD MySQL:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-1" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb65-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-2" tabindex="-1"></a><span class="im">from</span> flask_cors <span class="im">import</span> CORS</span>
<span id="cb65-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-3" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine, Column, String, Date, Text</span>
<span id="cb65-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-4" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker, declarative_base</span>
<span id="cb65-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-5" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> date</span>
<span id="cb65-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-6" tabindex="-1"></a></span>
<span id="cb65-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-7" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-8" tabindex="-1"></a><span class="co"># Flask + CORS</span></span>
<span id="cb65-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-9" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-10" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb65-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-11" tabindex="-1"></a>CORS(app)  <span class="co"># em produ√ß√£o, restrinja as origens</span></span>
<span id="cb65-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-12" tabindex="-1"></a></span>
<span id="cb65-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-13" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-14" tabindex="-1"></a><span class="co"># Banco de Dados MySQL (localhost)</span></span>
<span id="cb65-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-15" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-16" tabindex="-1"></a><span class="co"># Par√¢metros do projeto:</span></span>
<span id="cb65-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-17" tabindex="-1"></a><span class="co">#   SGBD: MySQL 8</span></span>
<span id="cb65-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-18" tabindex="-1"></a><span class="co">#   Host: localhost</span></span>
<span id="cb65-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-19" tabindex="-1"></a><span class="co">#   Usu√°rio: pessoas_user</span></span>
<span id="cb65-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-20" tabindex="-1"></a><span class="co">#   DB/Schema: pessoasdb</span></span>
<span id="cb65-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-21" tabindex="-1"></a><span class="co">#   Tabela: pessoas</span></span>
<span id="cb65-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-22" tabindex="-1"></a>DATABASE_URL <span class="op">=</span> <span class="st">&quot;mysql+pymysql://pessoas_user:MinhaSenhaForte@localhost:3306/pessoasdb&quot;</span></span>
<span id="cb65-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-23" tabindex="-1"></a></span>
<span id="cb65-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-24" tabindex="-1"></a>engine <span class="op">=</span> create_engine(</span>
<span id="cb65-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-25" tabindex="-1"></a>    DATABASE_URL,</span>
<span id="cb65-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-26" tabindex="-1"></a>    pool_pre_ping<span class="op">=</span><span class="va">True</span>,        <span class="co"># evita &quot;MySQL server has gone away&quot;</span></span>
<span id="cb65-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-27" tabindex="-1"></a>    future<span class="op">=</span><span class="va">True</span></span>
<span id="cb65-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-28" tabindex="-1"></a>)</span>
<span id="cb65-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-29" tabindex="-1"></a>SessionLocal <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine, autoflush<span class="op">=</span><span class="va">False</span>, autocommit<span class="op">=</span><span class="va">False</span>, future<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-30" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb65-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-31" tabindex="-1"></a></span>
<span id="cb65-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-32" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-33" tabindex="-1"></a><span class="co"># Modelo Pessoa</span></span>
<span id="cb65-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-34" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-35" tabindex="-1"></a><span class="kw">class</span> Pessoa(Base):</span>
<span id="cb65-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-36" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">&quot;pessoas&quot;</span></span>
<span id="cb65-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-37" tabindex="-1"></a>    cpf <span class="op">=</span> Column(String(<span class="dv">14</span>), primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-38" tabindex="-1"></a>    nome <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb65-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-39" tabindex="-1"></a>    endereco <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb65-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-40" tabindex="-1"></a>    data_nascimento <span class="op">=</span> Column(Date, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb65-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-41" tabindex="-1"></a>    foto <span class="op">=</span> Column(Text)  <span class="co"># Base64 ou URL</span></span>
<span id="cb65-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-42" tabindex="-1"></a></span>
<span id="cb65-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-43" tabindex="-1"></a><span class="co"># Cria a tabela se n√£o existir (deve existir conforme seu script SQL)</span></span>
<span id="cb65-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-44" tabindex="-1"></a>Base.metadata.create_all(engine)</span>
<span id="cb65-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-45" tabindex="-1"></a></span>
<span id="cb65-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-46" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-47" tabindex="-1"></a><span class="co"># Helpers</span></span>
<span id="cb65-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-48" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-49" tabindex="-1"></a><span class="kw">def</span> to_dict(p: Pessoa):</span>
<span id="cb65-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-50" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb65-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-51" tabindex="-1"></a>        <span class="st">&quot;cpf&quot;</span>: p.cpf,</span>
<span id="cb65-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-52" tabindex="-1"></a>        <span class="st">&quot;nome&quot;</span>: p.nome,</span>
<span id="cb65-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-53" tabindex="-1"></a>        <span class="st">&quot;endereco&quot;</span>: p.endereco,</span>
<span id="cb65-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-54" tabindex="-1"></a>        <span class="st">&quot;data_nascimento&quot;</span>: p.data_nascimento.isoformat(),</span>
<span id="cb65-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-55" tabindex="-1"></a>        <span class="st">&quot;foto&quot;</span>: p.foto</span>
<span id="cb65-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-56" tabindex="-1"></a>    }</span>
<span id="cb65-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-57" tabindex="-1"></a></span>
<span id="cb65-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-58" tabindex="-1"></a><span class="kw">def</span> parse_date_iso(value):</span>
<span id="cb65-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-59" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(value, date):</span>
<span id="cb65-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-60" tabindex="-1"></a>        <span class="cf">return</span> value</span>
<span id="cb65-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-61" tabindex="-1"></a>    <span class="cf">return</span> date.fromisoformat(value)  <span class="co"># espera &quot;YYYY-MM-DD&quot;</span></span>
<span id="cb65-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-62" tabindex="-1"></a></span>
<span id="cb65-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-63" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-64" tabindex="-1"></a><span class="co"># CRUD</span></span>
<span id="cb65-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-65" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-66" tabindex="-1"></a></span>
<span id="cb65-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-67" tabindex="-1"></a><span class="co"># Listar todas as pessoas ou pesquisar por termo (?q=)</span></span>
<span id="cb65-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-68" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb65-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-69" tabindex="-1"></a><span class="kw">def</span> listar():</span>
<span id="cb65-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-70" tabindex="-1"></a>    termo <span class="op">=</span> (request.args.get(<span class="st">&#39;q&#39;</span>) <span class="kw">or</span> <span class="st">&#39;&#39;</span>).strip()</span>
<span id="cb65-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-71" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb65-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-72" tabindex="-1"></a>        query <span class="op">=</span> session.query(Pessoa)</span>
<span id="cb65-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-73" tabindex="-1"></a>        <span class="cf">if</span> termo:</span>
<span id="cb65-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-74" tabindex="-1"></a>            like <span class="op">=</span> <span class="ss">f&quot;%</span><span class="sc">{</span>termo<span class="sc">}</span><span class="ss">%&quot;</span></span>
<span id="cb65-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-75" tabindex="-1"></a>            <span class="co"># MySQL √© case-insensitive com collation *_ci; ilike √© traduzido para LIKE</span></span>
<span id="cb65-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-76" tabindex="-1"></a>            query <span class="op">=</span> query.<span class="bu">filter</span>((Pessoa.nome.ilike(like)) <span class="op">|</span> (Pessoa.cpf.ilike(like)))</span>
<span id="cb65-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-77" tabindex="-1"></a>        pessoas <span class="op">=</span> query.order_by(Pessoa.nome.asc()).<span class="bu">all</span>()</span>
<span id="cb65-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-78" tabindex="-1"></a>        <span class="cf">return</span> jsonify([to_dict(p) <span class="cf">for</span> p <span class="kw">in</span> pessoas])</span>
<span id="cb65-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-79" tabindex="-1"></a></span>
<span id="cb65-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-80" tabindex="-1"></a><span class="co"># Inserir nova pessoa</span></span>
<span id="cb65-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-81" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;POST&#39;</span>])</span>
<span id="cb65-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-82" tabindex="-1"></a><span class="kw">def</span> inserir():</span>
<span id="cb65-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-83" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json(force<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-84" tabindex="-1"></a>    required <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span>, <span class="st">&#39;nome&#39;</span>, <span class="st">&#39;endereco&#39;</span>, <span class="st">&#39;data_nascimento&#39;</span>]</span>
<span id="cb65-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-85" tabindex="-1"></a>    faltantes <span class="op">=</span> [k <span class="cf">for</span> k <span class="kw">in</span> required <span class="cf">if</span> <span class="kw">not</span> dados.get(k)]</span>
<span id="cb65-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-86" tabindex="-1"></a>    <span class="cf">if</span> faltantes:</span>
<span id="cb65-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-87" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;Campos obrigat√≥rios faltando&quot;</span>, <span class="st">&quot;fields&quot;</span>: faltantes}), <span class="dv">422</span></span>
<span id="cb65-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-88" tabindex="-1"></a></span>
<span id="cb65-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-89" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb65-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-90" tabindex="-1"></a>        dn <span class="op">=</span> parse_date_iso(dados[<span class="st">&#39;data_nascimento&#39;</span>])</span>
<span id="cb65-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-91" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb65-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-92" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;data_nascimento inv√°lida. Use YYYY-MM-DD&quot;</span>}), <span class="dv">422</span></span>
<span id="cb65-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-93" tabindex="-1"></a></span>
<span id="cb65-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-94" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb65-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-95" tabindex="-1"></a>        <span class="cf">if</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>]).first():</span>
<span id="cb65-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-96" tabindex="-1"></a>            <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF j√° cadastrado&quot;</span>}), <span class="dv">409</span></span>
<span id="cb65-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-97" tabindex="-1"></a>        pessoa <span class="op">=</span> Pessoa(</span>
<span id="cb65-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-98" tabindex="-1"></a>            cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>],</span>
<span id="cb65-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-99" tabindex="-1"></a>            nome<span class="op">=</span>dados[<span class="st">&#39;nome&#39;</span>],</span>
<span id="cb65-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-100" tabindex="-1"></a>            endereco<span class="op">=</span>dados[<span class="st">&#39;endereco&#39;</span>],</span>
<span id="cb65-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-101" tabindex="-1"></a>            data_nascimento<span class="op">=</span>dn,</span>
<span id="cb65-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-102" tabindex="-1"></a>            foto<span class="op">=</span>dados.get(<span class="st">&#39;foto&#39;</span>)</span>
<span id="cb65-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-103" tabindex="-1"></a>        )</span>
<span id="cb65-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-104" tabindex="-1"></a>        session.add(pessoa)</span>
<span id="cb65-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-105" tabindex="-1"></a>        session.commit()</span>
<span id="cb65-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-106" tabindex="-1"></a>        session.refresh(pessoa)</span>
<span id="cb65-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-107" tabindex="-1"></a>        <span class="cf">return</span> jsonify(to_dict(pessoa)), <span class="dv">201</span></span>
<span id="cb65-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-108" tabindex="-1"></a></span>
<span id="cb65-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-109" tabindex="-1"></a><span class="co"># Alterar pessoa (PUT)</span></span>
<span id="cb65-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-110" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;PUT&#39;</span>])</span>
<span id="cb65-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-111" tabindex="-1"></a><span class="kw">def</span> alterar(cpf):</span>
<span id="cb65-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-112" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json(force<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-113" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb65-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-114" tabindex="-1"></a>        pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb65-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-115" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb65-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-116" tabindex="-1"></a>            <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb65-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-117" tabindex="-1"></a></span>
<span id="cb65-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-118" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;nome&#39;</span> <span class="kw">in</span> dados <span class="kw">and</span> dados[<span class="st">&#39;nome&#39;</span>] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb65-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-119" tabindex="-1"></a>            pessoa.nome <span class="op">=</span> dados[<span class="st">&#39;nome&#39;</span>]</span>
<span id="cb65-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-120" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;endereco&#39;</span> <span class="kw">in</span> dados <span class="kw">and</span> dados[<span class="st">&#39;endereco&#39;</span>] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb65-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-121" tabindex="-1"></a>            pessoa.endereco <span class="op">=</span> dados[<span class="st">&#39;endereco&#39;</span>]</span>
<span id="cb65-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-122" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;data_nascimento&#39;</span> <span class="kw">in</span> dados <span class="kw">and</span> dados[<span class="st">&#39;data_nascimento&#39;</span>] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb65-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-123" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb65-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-124" tabindex="-1"></a>                pessoa.data_nascimento <span class="op">=</span> parse_date_iso(dados[<span class="st">&#39;data_nascimento&#39;</span>])</span>
<span id="cb65-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-125" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb65-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-126" tabindex="-1"></a>                <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;data_nascimento inv√°lida. Use YYYY-MM-DD&quot;</span>}), <span class="dv">422</span></span>
<span id="cb65-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-127" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;foto&#39;</span> <span class="kw">in</span> dados:</span>
<span id="cb65-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-128" tabindex="-1"></a>            pessoa.foto <span class="op">=</span> dados[<span class="st">&#39;foto&#39;</span>]</span>
<span id="cb65-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-129" tabindex="-1"></a></span>
<span id="cb65-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-130" tabindex="-1"></a>        session.commit()</span>
<span id="cb65-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-131" tabindex="-1"></a>        session.refresh(pessoa)</span>
<span id="cb65-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-132" tabindex="-1"></a>        <span class="cf">return</span> jsonify(to_dict(pessoa)), <span class="dv">200</span></span>
<span id="cb65-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-133" tabindex="-1"></a></span>
<span id="cb65-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-134" tabindex="-1"></a><span class="co"># Remover pessoa</span></span>
<span id="cb65-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-135" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;DELETE&#39;</span>])</span>
<span id="cb65-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-136" tabindex="-1"></a><span class="kw">def</span> remover(cpf):</span>
<span id="cb65-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-137" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb65-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-138" tabindex="-1"></a>        pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb65-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-139" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb65-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-140" tabindex="-1"></a>            <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb65-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-141" tabindex="-1"></a>        session.delete(pessoa)</span>
<span id="cb65-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-142" tabindex="-1"></a>        session.commit()</span>
<span id="cb65-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-143" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;&#39;</span>, <span class="dv">204</span></span>
<span id="cb65-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-144" tabindex="-1"></a></span>
<span id="cb65-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-145" tabindex="-1"></a><span class="co"># Buscar pessoa por CPF</span></span>
<span id="cb65-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-146" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb65-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-147" tabindex="-1"></a><span class="kw">def</span> buscar(cpf):</span>
<span id="cb65-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-148" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb65-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-149" tabindex="-1"></a>        pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb65-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-150" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb65-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-151" tabindex="-1"></a>            <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb65-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-152" tabindex="-1"></a>        <span class="cf">return</span> jsonify(to_dict(pessoa))</span>
<span id="cb65-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-153" tabindex="-1"></a></span>
<span id="cb65-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-154" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-155" tabindex="-1"></a><span class="co"># Inicia o servidor</span></span>
<span id="cb65-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-156" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb65-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-157" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb65-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb65-158" tabindex="-1"></a>    app.run(debug<span class="op">=</span><span class="va">True</span>, port<span class="op">=</span><span class="dv">5000</span>)</span></code></pre></div>
</div>
<div id="cria√ß√£o-do-cliente-de-aplica√ß√£o-em-html-parte-gr√°fica-e-javascript-programa√ß√£o-execut√°vel" class="section level4 hasAnchor" number="13.5.0.6">
<h4><span class="header-section-number">13.5.0.6</span> Cria√ß√£o do Cliente de Aplica√ß√£o em HTML (Parte Gr√°fica) e Javascript (Programa√ß√£o Execut√°vel)<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cria%C3%A7%C3%A3o-do-cliente-de-aplica%C3%A7%C3%A3o-em-html-parte-gr%C3%A1fica-e-javascript-programa%C3%A7%C3%A3o-execut%C3%A1vel" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vamos verificar como √© o Diagrama de Classes do Cliente que vai conversar com o servidor que vimos anteriormente:</p>
<p><img src="images/2025-09-01/09-cliente.jpg" /></p>
<p>Agora vamos verificar o c√≥digo-fonte.</p>
<p>Salve esse c√≥digo em um arquivo chamado <strong>cliente.html</strong>, para poder abrir-lo no navegador, juntamente com o servidor rodando:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb66-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb66-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb66-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb66-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb66-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas - Flask/MySQL<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb66-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb66-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">system-ui</span><span class="op">,</span> <span class="dv">-apple-system</span><span class="op">,</span> <span class="dv">Segoe UI</span><span class="op">,</span> <span class="dv">Roboto</span><span class="op">,</span> <span class="dv">Arial</span><span class="op">;</span> <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">980</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">24</span><span class="dt">px</span> <span class="bu">auto</span><span class="op">;</span> }</span>
<span id="cb66-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-8" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb66-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-9" tabindex="-1"></a>  button { <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin-right</span><span class="ch">:</span> <span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span> <span class="dv">12</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb66-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-10" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span><span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span><span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb66-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-11" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span><span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb66-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-12" tabindex="-1"></a>  img<span class="fu">.thumb</span> { <span class="kw">width</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">height</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">object-fit</span><span class="ch">:</span><span class="dv">cover</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span><span class="dv">4</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb66-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-13" tabindex="-1"></a>  <span class="fu">.row</span> { <span class="kw">display</span><span class="ch">:</span><span class="dv">flex</span><span class="op">;</span> <span class="kw">gap</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">align-items</span><span class="ch">:</span><span class="dv">center</span><span class="op">;</span> <span class="kw">flex-wrap</span><span class="ch">:</span><span class="dv">wrap</span><span class="op">;</span> }</span>
<span id="cb66-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-14" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb66-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-15" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb66-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-16" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb66-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-17" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas (Flask/MySQL)<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb66-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-18" tabindex="-1"></a></span>
<span id="cb66-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-19" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;formPessoa&quot;</span><span class="dt">&gt;</span></span>
<span id="cb66-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-20" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF (chave prim√°ria): <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb66-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-21" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb66-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-22" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb66-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-23" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data Nasc.: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;data_nascimento&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb66-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-24" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="ot"> accept</span><span class="op">=</span><span class="st">&quot;image/*&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb66-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-25" tabindex="-1"></a></span>
<span id="cb66-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-26" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb66-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-27" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnInserir&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;inserir()&quot;</span><span class="dt">&gt;</span>Inserir<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb66-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-28" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnAlterar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;alterar()&quot;</span><span class="dt">&gt;</span>Alterar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb66-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-29" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnRemover&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;remover()&quot;</span><span class="dt">&gt;</span>Remover<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb66-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-30" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb66-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-31" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb66-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-32" tabindex="-1"></a></span>
<span id="cb66-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-33" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb66-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-34" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb66-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-35" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pesquisa&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Digite nome ou CPF&quot;</span><span class="ot"> style</span><span class="op">=</span><span class="st">&quot;flex:1&quot;</span><span class="dt">&gt;</span></span>
<span id="cb66-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-36" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnPesquisar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;pesquisar()&quot;</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb66-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-37" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;listar()&quot;</span><span class="dt">&gt;</span>Listar tudo<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb66-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-38" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb66-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-39" tabindex="-1"></a></span>
<span id="cb66-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-40" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb66-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-41" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb66-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-42" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb66-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-43" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb66-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-44" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb66-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-45" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb66-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-46" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb66-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-47" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabela&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb66-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-48" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb66-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-49" tabindex="-1"></a></span>
<span id="cb66-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-50" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb66-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-51" tabindex="-1"></a><span class="kw">const</span> API <span class="op">=</span> <span class="st">&#39;http://localhost:5000/pessoas&#39;</span><span class="op">;</span></span>
<span id="cb66-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-52" tabindex="-1"></a></span>
<span id="cb66-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-53" tabindex="-1"></a><span class="co">/* ---------- Helpers ---------- */</span></span>
<span id="cb66-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-54" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setBusy</span>(busy) {</span>
<span id="cb66-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-55" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> [<span class="st">&#39;btnInserir&#39;</span><span class="op">,</span><span class="st">&#39;btnAlterar&#39;</span><span class="op">,</span><span class="st">&#39;btnRemover&#39;</span><span class="op">,</span><span class="st">&#39;btnPesquisar&#39;</span>]) {</span>
<span id="cb66-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-56" tabindex="-1"></a>    <span class="kw">const</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">;</span></span>
<span id="cb66-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-57" tabindex="-1"></a>    <span class="cf">if</span> (el) el<span class="op">.</span><span class="at">disabled</span> <span class="op">=</span> busy<span class="op">;</span></span>
<span id="cb66-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-58" tabindex="-1"></a>  }</span>
<span id="cb66-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-59" tabindex="-1"></a>}</span>
<span id="cb66-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-60" tabindex="-1"></a></span>
<span id="cb66-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-61" tabindex="-1"></a><span class="kw">function</span> <span class="fu">validaCampos</span>() {</span>
<span id="cb66-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-62" tabindex="-1"></a>  <span class="kw">const</span> campos <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span><span class="op">,</span><span class="st">&#39;nome&#39;</span><span class="op">,</span><span class="st">&#39;endereco&#39;</span><span class="op">,</span><span class="st">&#39;data_nascimento&#39;</span>]<span class="op">;</span></span>
<span id="cb66-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-63" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> campos) {</span>
<span id="cb66-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-64" tabindex="-1"></a>    <span class="kw">const</span> valor <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb66-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-65" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>valor) {</span>
<span id="cb66-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-66" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="vs">`O campo &quot;</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">&quot; n√£o pode ficar em branco.`</span>)<span class="op">;</span></span>
<span id="cb66-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-67" tabindex="-1"></a>      <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb66-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-68" tabindex="-1"></a>    }</span>
<span id="cb66-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-69" tabindex="-1"></a>  }</span>
<span id="cb66-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-70" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb66-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-71" tabindex="-1"></a>}</span>
<span id="cb66-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-72" tabindex="-1"></a></span>
<span id="cb66-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-73" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getFotoBase64</span>() {</span>
<span id="cb66-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-74" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;foto&#39;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb66-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-75" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>file) <span class="cf">return</span> <span class="bu">Promise</span><span class="op">.</span><span class="fu">resolve</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></span>
<span id="cb66-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-76" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span>reject)<span class="kw">=&gt;</span>{</span>
<span id="cb66-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-77" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb66-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-78" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb66-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-79" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb66-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-80" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb66-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-81" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb66-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-82" tabindex="-1"></a>}</span>
<span id="cb66-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-83" tabindex="-1"></a></span>
<span id="cb66-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-84" tabindex="-1"></a><span class="kw">function</span> <span class="fu">coletaDados</span>(base64Foto){</span>
<span id="cb66-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-85" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb66-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-86" tabindex="-1"></a>    <span class="dt">cpf</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb66-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-87" tabindex="-1"></a>    <span class="dt">nome</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb66-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-88" tabindex="-1"></a>    <span class="dt">endereco</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb66-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-89" tabindex="-1"></a>    <span class="dt">data_nascimento</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">,</span> <span class="co">// YYYY-MM-DD</span></span>
<span id="cb66-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-90" tabindex="-1"></a>    <span class="dt">foto</span><span class="op">:</span> base64Foto <span class="op">||</span> <span class="st">&#39;&#39;</span></span>
<span id="cb66-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-91" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb66-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-92" tabindex="-1"></a>}</span>
<span id="cb66-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-93" tabindex="-1"></a></span>
<span id="cb66-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-94" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">readJsonSafe</span>(res) {</span>
<span id="cb66-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-95" tabindex="-1"></a>  <span class="kw">const</span> ct <span class="op">=</span> res<span class="op">.</span><span class="at">headers</span><span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;content-type&#39;</span>) <span class="op">||</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb66-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-96" tabindex="-1"></a>  <span class="cf">if</span> (ct<span class="op">.</span><span class="fu">includes</span>(<span class="st">&#39;application/json&#39;</span>)) {</span>
<span id="cb66-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-97" tabindex="-1"></a>    <span class="cf">try</span> { <span class="cf">return</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span> } <span class="cf">catch</span> { <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span> }</span>
<span id="cb66-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-98" tabindex="-1"></a>  }</span>
<span id="cb66-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-99" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb66-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-100" tabindex="-1"></a>}</span>
<span id="cb66-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-101" tabindex="-1"></a></span>
<span id="cb66-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-102" tabindex="-1"></a><span class="co">/* ---------- CRUD ---------- */</span></span>
<span id="cb66-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-103" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">inserir</span>() {</span>
<span id="cb66-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-104" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb66-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-105" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb66-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-106" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb66-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-107" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb66-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-108" tabindex="-1"></a>    <span class="kw">const</span> pessoa <span class="op">=</span> <span class="fu">coletaDados</span>(base64)<span class="op">;</span></span>
<span id="cb66-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-109" tabindex="-1"></a></span>
<span id="cb66-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-110" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API<span class="op">,</span> {</span>
<span id="cb66-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-111" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></span>
<span id="cb66-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-112" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb66-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-113" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(pessoa)</span>
<span id="cb66-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-114" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb66-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-115" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb66-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-116" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb66-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-117" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Inserido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb66-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-118" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb66-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-119" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;formPessoa&#39;</span>)<span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb66-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-120" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb66-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-121" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb66-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-122" tabindex="-1"></a>    }</span>
<span id="cb66-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-123" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb66-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-124" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao inserir: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb66-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-125" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb66-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-126" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb66-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-127" tabindex="-1"></a>  }</span>
<span id="cb66-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-128" tabindex="-1"></a>}</span>
<span id="cb66-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-129" tabindex="-1"></a></span>
<span id="cb66-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-130" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">alterar</span>() {</span>
<span id="cb66-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-131" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb66-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-132" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb66-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-133" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb66-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-134" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb66-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-135" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb66-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-136" tabindex="-1"></a>    <span class="kw">const</span> novosDados <span class="op">=</span> <span class="fu">coletaDados</span>()<span class="op">;</span></span>
<span id="cb66-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-137" tabindex="-1"></a>    <span class="cf">if</span> (base64) novosDados<span class="op">.</span><span class="at">foto</span> <span class="op">=</span> base64<span class="op">;</span></span>
<span id="cb66-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-138" tabindex="-1"></a></span>
<span id="cb66-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-139" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {</span>
<span id="cb66-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-140" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></span>
<span id="cb66-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-141" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb66-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-142" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(novosDados)</span>
<span id="cb66-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-143" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb66-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-144" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb66-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-145" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb66-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-146" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Alterado com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb66-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-147" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb66-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-148" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb66-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-149" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb66-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-150" tabindex="-1"></a>    }</span>
<span id="cb66-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-151" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb66-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-152" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao alterar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb66-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-153" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb66-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-154" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb66-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-155" tabindex="-1"></a>  }</span>
<span id="cb66-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-156" tabindex="-1"></a>}</span>
<span id="cb66-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-157" tabindex="-1"></a></span>
<span id="cb66-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-158" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">remover</span>() {</span>
<span id="cb66-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-159" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb66-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-160" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>cpf) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Informe o CPF para remover.&#39;</span>)<span class="op">;</span></span>
<span id="cb66-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-161" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">confirm</span>(<span class="st">&#39;Confirma a exclus√£o?&#39;</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb66-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-162" tabindex="-1"></a></span>
<span id="cb66-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-163" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb66-164"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-164" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb66-165"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-165" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {<span class="dt">method</span><span class="op">:</span><span class="st">&#39;DELETE&#39;</span>})<span class="op">;</span></span>
<span id="cb66-166"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-166" tabindex="-1"></a>    <span class="co">// 204 =&gt; sem corpo; n√£o tente parsear JSON aqui</span></span>
<span id="cb66-167"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-167" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">status</span> <span class="op">===</span> <span class="dv">204</span>) {</span>
<span id="cb66-168"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-168" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb66-169"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-169" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb66-170"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-170" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
<span id="cb66-171"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-171" tabindex="-1"></a>    }</span>
<span id="cb66-172"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-172" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb66-173"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-173" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb66-174"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-174" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb66-175"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-175" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb66-176"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-176" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb66-177"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-177" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb66-178"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-178" tabindex="-1"></a>    }</span>
<span id="cb66-179"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-179" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb66-180"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-180" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao remover: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb66-181"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-181" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb66-182"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-182" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb66-183"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-183" tabindex="-1"></a>  }</span>
<span id="cb66-184"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-184" tabindex="-1"></a>}</span>
<span id="cb66-185"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-185" tabindex="-1"></a></span>
<span id="cb66-186"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-186" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">pesquisar</span>() {</span>
<span id="cb66-187"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-187" tabindex="-1"></a>  <span class="kw">const</span> termo <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;pesquisa&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb66-188"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-188" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb66-189"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-189" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb66-190"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-190" tabindex="-1"></a>    <span class="kw">const</span> url <span class="op">=</span> termo <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(termo)<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API<span class="op">;</span></span>
<span id="cb66-191"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-191" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb66-192"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-192" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb66-193"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-193" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb66-194"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-194" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb66-195"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-195" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb66-196"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-196" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb66-197"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-197" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb66-198"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-198" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb66-199"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-199" tabindex="-1"></a>  }</span>
<span id="cb66-200"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-200" tabindex="-1"></a>}</span>
<span id="cb66-201"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-201" tabindex="-1"></a></span>
<span id="cb66-202"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-202" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">listar</span>() {</span>
<span id="cb66-203"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-203" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb66-204"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-204" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb66-205"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-205" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API)<span class="op">;</span></span>
<span id="cb66-206"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-206" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb66-207"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-207" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb66-208"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-208" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb66-209"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-209" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb66-210"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-210" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb66-211"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-211" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb66-212"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-212" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb66-213"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-213" tabindex="-1"></a>  }</span>
<span id="cb66-214"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-214" tabindex="-1"></a>}</span>
<span id="cb66-215"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-215" tabindex="-1"></a></span>
<span id="cb66-216"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-216" tabindex="-1"></a><span class="co">/* ---------- UI ---------- */</span></span>
<span id="cb66-217"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-217" tabindex="-1"></a><span class="kw">function</span> <span class="fu">preencheTabela</span>(lista){</span>
<span id="cb66-218"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-218" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;tabela&#39;</span>)<span class="op">;</span></span>
<span id="cb66-219"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-219" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb66-220"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-220" tabindex="-1"></a>  (lista <span class="op">||</span> [])<span class="op">.</span><span class="fu">forEach</span>(p<span class="kw">=&gt;</span>{</span>
<span id="cb66-221"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-221" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;tr&#39;</span>)<span class="op">;</span></span>
<span id="cb66-222"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-222" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb66-223"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-223" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb66-224"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-224" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img class=&quot;thumb&quot; src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb66-225"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-225" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb66-226"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-226" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb66-227"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-227" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">data_nascimento</span><span class="sc">}</span><span class="vs">&lt;/td&gt;`</span><span class="op">;</span></span>
<span id="cb66-228"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-228" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb66-229"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-229" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">cpf</span><span class="op">;</span></span>
<span id="cb66-230"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-230" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">nome</span><span class="op">;</span></span>
<span id="cb66-231"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-231" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">endereco</span><span class="op">;</span></span>
<span id="cb66-232"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-232" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">data_nascimento</span><span class="op">;</span></span>
<span id="cb66-233"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-233" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb66-234"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-234" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb66-235"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-235" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb66-236"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-236" tabindex="-1"></a>}</span>
<span id="cb66-237"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-237" tabindex="-1"></a></span>
<span id="cb66-238"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-238" tabindex="-1"></a><span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb66-239"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-239" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb66-240"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-240" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb66-241"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb66-241" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
</div>
<div id="resultado-final" class="section level3 hasAnchor" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> Resultado final:<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#resultado-final" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="servidor-de-aplica√ß√£o-python-restful-rodando" class="section level4 hasAnchor" number="13.5.1.1">
<h4><span class="header-section-number">13.5.1.1</span> Servidor de aplica√ß√£o Python ‚ÄúRestful‚Äù rodando<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#servidor-de-aplica%C3%A7%C3%A3o-python-restful-rodando" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="images/2025-09-01/10-servidor_rodando.jpg" /></p>
</div>
<div id="cliente-html-javascript-p√°gina-est√°tica-aberta-no-navegador" class="section level4 hasAnchor" number="13.5.1.2">
<h4><span class="header-section-number">13.5.1.2</span> Cliente HTML + Javascript ( p√°gina EST√ÅTICA ) aberta no navegador<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-javascript-p%C3%A1gina-est%C3%A1tica-aberta-no-navegador" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="passo-1---preencher-dados-no-formul√°rio-do-cliente" class="section level5 hasAnchor" number="13.5.1.2.1">
<h5><span class="header-section-number">13.5.1.2.1</span> Passo 1 - Preencher dados no formul√°rio do cliente<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#passo-1---preencher-dados-no-formul%C3%A1rio-do-cliente" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Vamos inserir dados de exemplo no ‚Äúcliente WEB‚Äù abaixo</p>
<p><img src="images/2025-09-01/11-Cliente_Vazio.jpg" /></p>
</div>
<div id="passo-2---pressionar-o-bot√£o-inserir" class="section level5 hasAnchor" number="13.5.1.2.2">
<h5><span class="header-section-number">13.5.1.2.2</span> Passo 2 - Pressionar o Bot√£o INSERIR<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#passo-2---pressionar-o-bot%C3%A3o-inserir" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="images/2025-09-01/11-Cliente_Vazio-02.jpg" /></p>
<p>OBS: Na tela do servidor, √© poss√≠vel verificar as opera√ß√µes HTTP Equivalentes ao SQL que foram executadas entre o Servidor e o Cliente</p>
<p><img src="images/2025-09-01/10-servidor_rodando-01.jpg" /></p>
</div>
<div id="passo-3---verificar-se-o-dbgrid-do-cliente-espelhando-a-linha-da-tabela-pessoas-no-esquema-pessoasdb-do-sqbg-mysql" class="section level5 hasAnchor" number="13.5.1.2.3">
<h5><span class="header-section-number">13.5.1.2.3</span> Passo 3 - Verificar se o ‚ÄúDBGRID‚Äù do cliente ‚Äúespelhando‚Äù a linha da tabela ‚Äúpessoas‚Äù no esquema ‚Äúpessoasdb‚Äù do SQBG MySQL<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#passo-3---verificar-se-o-dbgrid-do-cliente-espelhando-a-linha-da-tabela-pessoas-no-esquema-pessoasdb-do-sqbg-mysql" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="images/2025-09-01/11-Cliente_03-Preenchido.jpg" /></p>
</div>
<div id="passo-4---verificar-na-tabela-pessoas-a-linha-que-o-cliente-preencheu-atrav√©s-da-api-da-aplica√ß√£o-clienteservidor" class="section level5 hasAnchor" number="13.5.1.2.4">
<h5><span class="header-section-number">13.5.1.2.4</span> Passo 4 - Verificar na tabela pessoas a linha que o cliente preencheu atrav√©s da API da aplica√ß√£o cliente/servidor<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#passo-4---verificar-na-tabela-pessoas-a-linha-que-o-cliente-preencheu-atrav%C3%A9s-da-api-da-aplica%C3%A7%C3%A3o-clienteservidor" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="images/2025-09-01/12-Dados_no_SGBD.jpg" /></p>
</div>
</div>
</div>
</div>
<div id="feito-2" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Feito<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#feito-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
<div id="exerc√≠cios-3" class="section level2 hasAnchor" number="13.7">
<h2><span class="header-section-number">13.7</span> Exerc√≠cios<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exerc%C3%ADcios-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-14" class="section level4 unnumbered hasAnchor">
<h4>01/09/2025<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#section-14" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="professor-migu√©l-suares-11" class="section level4 unnumbered hasAnchor">
<h4>Professor Migu√©l Suares<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#professor-migu%C3%A9l-suares-11" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="banco-de-dados-utilizado-nos-exemplos-de-aplica√ß√µes-abaixo" class="section level3 hasAnchor" number="13.7.1">
<h3><span class="header-section-number">13.7.1</span> Banco de Dados utilizado nos exemplos de aplica√ß√µes abaixo<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#banco-de-dados-utilizado-nos-exemplos-de-aplica%C3%A7%C3%B5es-abaixo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Crie o banco de dados abaixo em um servidor mysql 8 ou superior na sua m√°quina antes de testar os exemplos abaixo:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb67-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-1" tabindex="-1"></a><span class="co">-- 1) CRIAR BANCO (ajuste o nome se quiser)</span></span>
<span id="cb67-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-2" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> pessoasdb</span>
<span id="cb67-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-3" tabindex="-1"></a>  <span class="dt">CHARACTER</span> <span class="kw">SET</span> utf8mb4</span>
<span id="cb67-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-4" tabindex="-1"></a>  COLLATE utf8mb4_0900_ai_ci;</span>
<span id="cb67-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-5" tabindex="-1"></a></span>
<span id="cb67-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-6" tabindex="-1"></a><span class="kw">USE</span> pessoasdb;</span>
<span id="cb67-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-7" tabindex="-1"></a></span>
<span id="cb67-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-8" tabindex="-1"></a><span class="co">-- 2) (OPCIONAL) CRIAR USU√ÅRIO LOCAL E CONCEDER PERMISS√ïES</span></span>
<span id="cb67-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-9" tabindex="-1"></a><span class="co">--    Troque &#39;MinhaSenhaForte&#39; por uma senha segura</span></span>
<span id="cb67-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-10" tabindex="-1"></a><span class="kw">CREATE</span> <span class="fu">USER</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> <span class="st">&#39;pessoas_user&#39;</span>@<span class="st">&#39;localhost&#39;</span> <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> <span class="st">&#39;MinhaSenhaForte&#39;</span>;</span>
<span id="cb67-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-11" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">ALL</span> <span class="kw">PRIVILEGES</span> <span class="kw">ON</span> pessoasdb.<span class="op">*</span> <span class="kw">TO</span> <span class="st">&#39;pessoas_user&#39;</span>@<span class="st">&#39;localhost&#39;</span>;</span>
<span id="cb67-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-12" tabindex="-1"></a><span class="kw">FLUSH</span> <span class="kw">PRIVILEGES</span>;</span>
<span id="cb67-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-13" tabindex="-1"></a></span>
<span id="cb67-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-14" tabindex="-1"></a><span class="co">-- 3) TABELA &#39;pessoas&#39; COMPAT√çVEL COM O MODELO SQLAlchemy</span></span>
<span id="cb67-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-15" tabindex="-1"></a><span class="co">--    - cpf: chave prim√°ria (String(14))</span></span>
<span id="cb67-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-16" tabindex="-1"></a><span class="co">--    - nome, endereco, foto: TEXT</span></span>
<span id="cb67-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-17" tabindex="-1"></a><span class="co">--    - data_nascimento: DATE</span></span>
<span id="cb67-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-18" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> pessoas (</span>
<span id="cb67-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-19" tabindex="-1"></a>  cpf             <span class="dt">VARCHAR</span>(<span class="dv">14</span>)  <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb67-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-20" tabindex="-1"></a>  nome            TEXT         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb67-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-21" tabindex="-1"></a>  endereco        TEXT         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb67-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-22" tabindex="-1"></a>  data_nascimento <span class="dt">DATE</span>         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb67-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-23" tabindex="-1"></a>  foto            TEXT         <span class="kw">NULL</span>,</span>
<span id="cb67-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-24" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (cpf)</span>
<span id="cb67-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-25" tabindex="-1"></a>) ENGINE<span class="op">=</span>InnoDB <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8mb4 COLLATE<span class="op">=</span>utf8mb4_0900_ai_ci;</span>
<span id="cb67-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-26" tabindex="-1"></a></span>
<span id="cb67-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-27" tabindex="-1"></a><span class="co">-- 4) (OPCIONAL) √çNDICES PARA BUSCA</span></span>
<span id="cb67-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-28" tabindex="-1"></a><span class="co">-- Seu endpoint usa LIKE/ILIKE em nome e cpf; cpf j√° √© PK.</span></span>
<span id="cb67-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-29" tabindex="-1"></a><span class="co">-- Para acelerar buscas por nome com LIKE, crie um √≠ndice por prefixo.</span></span>
<span id="cb67-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-30" tabindex="-1"></a><span class="co">-- OBS: √≠ndices em TEXT precisam de comprimento; 128 costuma ser um bom compromisso.</span></span>
<span id="cb67-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb67-31" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> idx_pessoas_nome_prefix <span class="kw">ON</span> pessoas (nome(<span class="dv">128</span>));</span></code></pre></div>
</div>
</div>
<div id="exemplo-01" class="section level2 hasAnchor" number="13.8">
<h2><span class="header-section-number">13.8</span> Exemplo 01<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-01" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>servidor SUPABASE ‚Ä¶. a fazer</p>
</div>
<div id="exemplo-02---servidor-de-aplica√ß√£o-python" class="section level2 hasAnchor" number="13.9">
<h2><span class="header-section-number">13.9</span> Exemplo 02 - SERVIDOR DE APLICA√á√ÉO PYTHON<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-02---servidor-de-aplica%C3%A7%C3%A3o-python" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/clipboard-3666283714.png" /></p>
<p>Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</p>
<p>A interface do Cliente √© feita em HTML5</p>
<p>A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</p>
<p>CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</p>
<p>O servidor Restful √© feito em linguagem PYTHON</p>
<p>OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb68-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb68-1" tabindex="-1"></a>python <span class="at">-m</span> pip install -<span class="at">-user</span> -<span class="at">-upgrade</span> flask flask<span class="at">-cors</span> sqlalchemy psycopg2<span class="at">-binary</span></span></code></pre></div>
<div id="servidor-python" class="section level3 hasAnchor" number="13.9.1">
<h3><span class="header-section-number">13.9.1</span> Servidor python<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#servidor-python" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-1" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb69-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-2" tabindex="-1"></a><span class="im">from</span> flask_cors <span class="im">import</span> CORS</span>
<span id="cb69-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-3" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine, Column, String, Date, Text</span>
<span id="cb69-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-4" tabindex="-1"></a><span class="im">from</span> sqlalchemy.ext.declarative <span class="im">import</span> declarative_base</span>
<span id="cb69-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-5" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker</span>
<span id="cb69-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-6" tabindex="-1"></a></span>
<span id="cb69-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-7" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-8" tabindex="-1"></a><span class="co"># Configura√ß√£o do Flask e CORS</span></span>
<span id="cb69-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-9" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-10" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb69-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-11" tabindex="-1"></a>CORS(app)</span>
<span id="cb69-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-12" tabindex="-1"></a></span>
<span id="cb69-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-13" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-14" tabindex="-1"></a><span class="co"># Configura√ß√£o do banco PostgreSQL</span></span>
<span id="cb69-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-15" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-16" tabindex="-1"></a>DATABASE_URL <span class="op">=</span> <span class="st">&quot;postgresql://postgres:MinhaSuperSenha@db.pbbtfwmydxmxdibmtbqq.supabase.co:5432/postgres&quot;</span></span>
<span id="cb69-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-17" tabindex="-1"></a></span>
<span id="cb69-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-18" tabindex="-1"></a>engine <span class="op">=</span> create_engine(DATABASE_URL)</span>
<span id="cb69-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-19" tabindex="-1"></a>SessionLocal <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine)</span>
<span id="cb69-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-20" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb69-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-21" tabindex="-1"></a></span>
<span id="cb69-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-22" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-23" tabindex="-1"></a><span class="co"># Modelo Pessoa</span></span>
<span id="cb69-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-24" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-25" tabindex="-1"></a><span class="kw">class</span> Pessoa(Base):</span>
<span id="cb69-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-26" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">&quot;pessoas&quot;</span></span>
<span id="cb69-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-27" tabindex="-1"></a>    cpf <span class="op">=</span> Column(String(<span class="dv">14</span>), primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-28" tabindex="-1"></a>    nome <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb69-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-29" tabindex="-1"></a>    endereco <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb69-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-30" tabindex="-1"></a>    data_nascimento <span class="op">=</span> Column(Date, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb69-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-31" tabindex="-1"></a>    foto <span class="op">=</span> Column(Text)  <span class="co"># Base64 ou URL</span></span>
<span id="cb69-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-32" tabindex="-1"></a></span>
<span id="cb69-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-33" tabindex="-1"></a><span class="co"># Cria a tabela se n√£o existir</span></span>
<span id="cb69-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-34" tabindex="-1"></a>Base.metadata.create_all(engine)</span>
<span id="cb69-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-35" tabindex="-1"></a></span>
<span id="cb69-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-36" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-37" tabindex="-1"></a><span class="co"># CRUD</span></span>
<span id="cb69-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-38" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-39" tabindex="-1"></a></span>
<span id="cb69-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-40" tabindex="-1"></a><span class="co"># Listar todas as pessoas ou pesquisar por termo</span></span>
<span id="cb69-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-41" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb69-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-42" tabindex="-1"></a><span class="kw">def</span> listar():</span>
<span id="cb69-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-43" tabindex="-1"></a>    termo <span class="op">=</span> request.args.get(<span class="st">&#39;q&#39;</span>, <span class="st">&#39;&#39;</span>).lower()</span>
<span id="cb69-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-44" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb69-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-45" tabindex="-1"></a>    <span class="cf">if</span> termo:</span>
<span id="cb69-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-46" tabindex="-1"></a>        pessoas <span class="op">=</span> session.query(Pessoa).<span class="bu">filter</span>(</span>
<span id="cb69-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-47" tabindex="-1"></a>            (Pessoa.nome.ilike(<span class="ss">f&quot;%</span><span class="sc">{</span>termo<span class="sc">}</span><span class="ss">%&quot;</span>)) <span class="op">|</span> (Pessoa.cpf.ilike(<span class="ss">f&quot;%</span><span class="sc">{</span>termo<span class="sc">}</span><span class="ss">%&quot;</span>))</span>
<span id="cb69-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-48" tabindex="-1"></a>        ).<span class="bu">all</span>()</span>
<span id="cb69-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-49" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb69-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-50" tabindex="-1"></a>        pessoas <span class="op">=</span> session.query(Pessoa).<span class="bu">all</span>()</span>
<span id="cb69-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-51" tabindex="-1"></a>    session.close()</span>
<span id="cb69-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-52" tabindex="-1"></a>    <span class="cf">return</span> jsonify([{</span>
<span id="cb69-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-53" tabindex="-1"></a>        <span class="st">&quot;cpf&quot;</span>: p.cpf,</span>
<span id="cb69-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-54" tabindex="-1"></a>        <span class="st">&quot;nome&quot;</span>: p.nome,</span>
<span id="cb69-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-55" tabindex="-1"></a>        <span class="st">&quot;endereco&quot;</span>: p.endereco,</span>
<span id="cb69-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-56" tabindex="-1"></a>        <span class="st">&quot;data_nascimento&quot;</span>: p.data_nascimento.isoformat(),</span>
<span id="cb69-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-57" tabindex="-1"></a>        <span class="st">&quot;foto&quot;</span>: p.foto</span>
<span id="cb69-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-58" tabindex="-1"></a>    } <span class="cf">for</span> p <span class="kw">in</span> pessoas])</span>
<span id="cb69-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-59" tabindex="-1"></a></span>
<span id="cb69-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-60" tabindex="-1"></a><span class="co"># Inserir nova pessoa</span></span>
<span id="cb69-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-61" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;POST&#39;</span>])</span>
<span id="cb69-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-62" tabindex="-1"></a><span class="kw">def</span> inserir():</span>
<span id="cb69-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-63" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json()</span>
<span id="cb69-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-64" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb69-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-65" tabindex="-1"></a>    <span class="cf">if</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>]).first():</span>
<span id="cb69-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-66" tabindex="-1"></a>        session.close()</span>
<span id="cb69-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-67" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF j√° cadastrado&quot;</span>}), <span class="dv">400</span></span>
<span id="cb69-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-68" tabindex="-1"></a>    pessoa <span class="op">=</span> Pessoa(</span>
<span id="cb69-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-69" tabindex="-1"></a>        cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>],</span>
<span id="cb69-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-70" tabindex="-1"></a>        nome<span class="op">=</span>dados[<span class="st">&#39;nome&#39;</span>],</span>
<span id="cb69-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-71" tabindex="-1"></a>        endereco<span class="op">=</span>dados[<span class="st">&#39;endereco&#39;</span>],</span>
<span id="cb69-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-72" tabindex="-1"></a>        data_nascimento<span class="op">=</span>dados[<span class="st">&#39;data_nascimento&#39;</span>],</span>
<span id="cb69-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-73" tabindex="-1"></a>        foto<span class="op">=</span>dados.get(<span class="st">&#39;foto&#39;</span>)</span>
<span id="cb69-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-74" tabindex="-1"></a>    )</span>
<span id="cb69-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-75" tabindex="-1"></a>    session.add(pessoa)</span>
<span id="cb69-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-76" tabindex="-1"></a>    session.commit()</span>
<span id="cb69-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-77" tabindex="-1"></a>    session.close()</span>
<span id="cb69-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-78" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&quot;message&quot;</span>: <span class="st">&quot;Inserido com sucesso&quot;</span>}), <span class="dv">201</span></span>
<span id="cb69-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-79" tabindex="-1"></a></span>
<span id="cb69-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-80" tabindex="-1"></a><span class="co"># Alterar pessoa</span></span>
<span id="cb69-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-81" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;PUT&#39;</span>])</span>
<span id="cb69-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-82" tabindex="-1"></a><span class="kw">def</span> alterar(cpf):</span>
<span id="cb69-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-83" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json()</span>
<span id="cb69-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-84" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb69-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-85" tabindex="-1"></a>    pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb69-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-86" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb69-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-87" tabindex="-1"></a>        session.close()</span>
<span id="cb69-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-88" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb69-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-89" tabindex="-1"></a>    pessoa.nome <span class="op">=</span> dados.get(<span class="st">&#39;nome&#39;</span>, pessoa.nome)</span>
<span id="cb69-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-90" tabindex="-1"></a>    pessoa.endereco <span class="op">=</span> dados.get(<span class="st">&#39;endereco&#39;</span>, pessoa.endereco)</span>
<span id="cb69-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-91" tabindex="-1"></a>    pessoa.data_nascimento <span class="op">=</span> dados.get(<span class="st">&#39;data_nascimento&#39;</span>, pessoa.data_nascimento)</span>
<span id="cb69-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-92" tabindex="-1"></a>    pessoa.foto <span class="op">=</span> dados.get(<span class="st">&#39;foto&#39;</span>, pessoa.foto)</span>
<span id="cb69-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-93" tabindex="-1"></a>    session.commit()</span>
<span id="cb69-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-94" tabindex="-1"></a>    session.close()</span>
<span id="cb69-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-95" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&quot;message&quot;</span>: <span class="st">&quot;Alterado com sucesso&quot;</span>})</span>
<span id="cb69-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-96" tabindex="-1"></a></span>
<span id="cb69-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-97" tabindex="-1"></a><span class="co"># Remover pessoa</span></span>
<span id="cb69-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-98" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;DELETE&#39;</span>])</span>
<span id="cb69-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-99" tabindex="-1"></a><span class="kw">def</span> remover(cpf):</span>
<span id="cb69-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-100" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb69-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-101" tabindex="-1"></a>    pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb69-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-102" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb69-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-103" tabindex="-1"></a>        session.close()</span>
<span id="cb69-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-104" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb69-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-105" tabindex="-1"></a>    session.delete(pessoa)</span>
<span id="cb69-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-106" tabindex="-1"></a>    session.commit()</span>
<span id="cb69-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-107" tabindex="-1"></a>    session.close()</span>
<span id="cb69-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-108" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&quot;message&quot;</span>: <span class="st">&quot;Removido com sucesso&quot;</span>})</span>
<span id="cb69-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-109" tabindex="-1"></a></span>
<span id="cb69-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-110" tabindex="-1"></a><span class="co"># Buscar pessoa por CPF</span></span>
<span id="cb69-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-111" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb69-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-112" tabindex="-1"></a><span class="kw">def</span> buscar(cpf):</span>
<span id="cb69-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-113" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb69-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-114" tabindex="-1"></a>    pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb69-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-115" tabindex="-1"></a>    session.close()</span>
<span id="cb69-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-116" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb69-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-117" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb69-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-118" tabindex="-1"></a>    <span class="cf">return</span> jsonify({</span>
<span id="cb69-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-119" tabindex="-1"></a>        <span class="st">&quot;cpf&quot;</span>: pessoa.cpf,</span>
<span id="cb69-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-120" tabindex="-1"></a>        <span class="st">&quot;nome&quot;</span>: pessoa.nome,</span>
<span id="cb69-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-121" tabindex="-1"></a>        <span class="st">&quot;endereco&quot;</span>: pessoa.endereco,</span>
<span id="cb69-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-122" tabindex="-1"></a>        <span class="st">&quot;data_nascimento&quot;</span>: pessoa.data_nascimento.isoformat(),</span>
<span id="cb69-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-123" tabindex="-1"></a>        <span class="st">&quot;foto&quot;</span>: pessoa.foto</span>
<span id="cb69-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-124" tabindex="-1"></a>    })</span>
<span id="cb69-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-125" tabindex="-1"></a></span>
<span id="cb69-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-126" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-127" tabindex="-1"></a><span class="co"># Inicia o servidor</span></span>
<span id="cb69-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-128" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb69-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-129" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb69-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb69-130" tabindex="-1"></a>    app.run(debug<span class="op">=</span><span class="va">True</span>, port<span class="op">=</span><span class="dv">5000</span>)</span></code></pre></div>
<p>servidor estar√° rodando na porta 5000 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:5000/pessoas" class="uri">http://localhost:5000/pessoas</a> sem senha</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb70-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb70-1" tabindex="-1"></a>http<span class="in">:</span><span class="er">//localhost:5000/pessoas</span></span></code></pre></div>
</div>
<div id="cliente-html-conex√£o-restful" class="section level3 hasAnchor" number="13.9.2">
<h3><span class="header-section-number">13.9.2</span> Cliente HTML (conex√£o Restful)<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex%C3%A3o-restful" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>crie o arquivo index.html e abra-o no navegador</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb71-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb71-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb71-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb71-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb71-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas - Flask/MySQL<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb71-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb71-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">system-ui</span><span class="op">,</span> <span class="dv">-apple-system</span><span class="op">,</span> <span class="dv">Segoe UI</span><span class="op">,</span> <span class="dv">Roboto</span><span class="op">,</span> <span class="dv">Arial</span><span class="op">;</span> <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">980</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">24</span><span class="dt">px</span> <span class="bu">auto</span><span class="op">;</span> }</span>
<span id="cb71-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-8" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb71-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-9" tabindex="-1"></a>  button { <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin-right</span><span class="ch">:</span> <span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span> <span class="dv">12</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb71-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-10" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span><span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span><span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb71-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-11" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span><span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb71-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-12" tabindex="-1"></a>  img<span class="fu">.thumb</span> { <span class="kw">width</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">height</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">object-fit</span><span class="ch">:</span><span class="dv">cover</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span><span class="dv">4</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb71-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-13" tabindex="-1"></a>  <span class="fu">.row</span> { <span class="kw">display</span><span class="ch">:</span><span class="dv">flex</span><span class="op">;</span> <span class="kw">gap</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">align-items</span><span class="ch">:</span><span class="dv">center</span><span class="op">;</span> <span class="kw">flex-wrap</span><span class="ch">:</span><span class="dv">wrap</span><span class="op">;</span> }</span>
<span id="cb71-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-14" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb71-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-15" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb71-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-16" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb71-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-17" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas (Flask/MySQL)<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb71-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-18" tabindex="-1"></a></span>
<span id="cb71-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-19" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;formPessoa&quot;</span><span class="dt">&gt;</span></span>
<span id="cb71-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-20" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF (chave prim√°ria): <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb71-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-21" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb71-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-22" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb71-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-23" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data Nasc.: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;data_nascimento&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb71-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-24" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="ot"> accept</span><span class="op">=</span><span class="st">&quot;image/*&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb71-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-25" tabindex="-1"></a></span>
<span id="cb71-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-26" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb71-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-27" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnInserir&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;inserir()&quot;</span><span class="dt">&gt;</span>Inserir<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb71-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-28" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnAlterar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;alterar()&quot;</span><span class="dt">&gt;</span>Alterar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb71-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-29" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnRemover&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;remover()&quot;</span><span class="dt">&gt;</span>Remover<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb71-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-30" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb71-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-31" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb71-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-32" tabindex="-1"></a></span>
<span id="cb71-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-33" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb71-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-34" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb71-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-35" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pesquisa&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Digite nome ou CPF&quot;</span><span class="ot"> style</span><span class="op">=</span><span class="st">&quot;flex:1&quot;</span><span class="dt">&gt;</span></span>
<span id="cb71-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-36" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnPesquisar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;pesquisar()&quot;</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb71-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-37" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;listar()&quot;</span><span class="dt">&gt;</span>Listar tudo<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb71-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-38" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb71-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-39" tabindex="-1"></a></span>
<span id="cb71-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-40" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb71-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-41" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb71-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-42" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb71-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-43" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb71-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-44" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb71-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-45" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb71-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-46" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb71-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-47" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabela&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb71-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-48" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb71-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-49" tabindex="-1"></a></span>
<span id="cb71-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-50" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb71-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-51" tabindex="-1"></a><span class="kw">const</span> API <span class="op">=</span> <span class="st">&#39;http://localhost:5000/pessoas&#39;</span><span class="op">;</span></span>
<span id="cb71-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-52" tabindex="-1"></a></span>
<span id="cb71-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-53" tabindex="-1"></a><span class="co">/* ---------- Helpers ---------- */</span></span>
<span id="cb71-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-54" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setBusy</span>(busy) {</span>
<span id="cb71-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-55" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> [<span class="st">&#39;btnInserir&#39;</span><span class="op">,</span><span class="st">&#39;btnAlterar&#39;</span><span class="op">,</span><span class="st">&#39;btnRemover&#39;</span><span class="op">,</span><span class="st">&#39;btnPesquisar&#39;</span>]) {</span>
<span id="cb71-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-56" tabindex="-1"></a>    <span class="kw">const</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">;</span></span>
<span id="cb71-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-57" tabindex="-1"></a>    <span class="cf">if</span> (el) el<span class="op">.</span><span class="at">disabled</span> <span class="op">=</span> busy<span class="op">;</span></span>
<span id="cb71-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-58" tabindex="-1"></a>  }</span>
<span id="cb71-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-59" tabindex="-1"></a>}</span>
<span id="cb71-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-60" tabindex="-1"></a></span>
<span id="cb71-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-61" tabindex="-1"></a><span class="kw">function</span> <span class="fu">validaCampos</span>() {</span>
<span id="cb71-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-62" tabindex="-1"></a>  <span class="kw">const</span> campos <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span><span class="op">,</span><span class="st">&#39;nome&#39;</span><span class="op">,</span><span class="st">&#39;endereco&#39;</span><span class="op">,</span><span class="st">&#39;data_nascimento&#39;</span>]<span class="op">;</span></span>
<span id="cb71-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-63" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> campos) {</span>
<span id="cb71-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-64" tabindex="-1"></a>    <span class="kw">const</span> valor <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb71-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-65" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>valor) {</span>
<span id="cb71-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-66" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="vs">`O campo &quot;</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">&quot; n√£o pode ficar em branco.`</span>)<span class="op">;</span></span>
<span id="cb71-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-67" tabindex="-1"></a>      <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb71-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-68" tabindex="-1"></a>    }</span>
<span id="cb71-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-69" tabindex="-1"></a>  }</span>
<span id="cb71-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-70" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb71-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-71" tabindex="-1"></a>}</span>
<span id="cb71-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-72" tabindex="-1"></a></span>
<span id="cb71-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-73" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getFotoBase64</span>() {</span>
<span id="cb71-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-74" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;foto&#39;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb71-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-75" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>file) <span class="cf">return</span> <span class="bu">Promise</span><span class="op">.</span><span class="fu">resolve</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></span>
<span id="cb71-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-76" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span>reject)<span class="kw">=&gt;</span>{</span>
<span id="cb71-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-77" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb71-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-78" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb71-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-79" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb71-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-80" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb71-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-81" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb71-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-82" tabindex="-1"></a>}</span>
<span id="cb71-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-83" tabindex="-1"></a></span>
<span id="cb71-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-84" tabindex="-1"></a><span class="kw">function</span> <span class="fu">coletaDados</span>(base64Foto){</span>
<span id="cb71-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-85" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb71-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-86" tabindex="-1"></a>    <span class="dt">cpf</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb71-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-87" tabindex="-1"></a>    <span class="dt">nome</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb71-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-88" tabindex="-1"></a>    <span class="dt">endereco</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb71-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-89" tabindex="-1"></a>    <span class="dt">data_nascimento</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">,</span> <span class="co">// YYYY-MM-DD</span></span>
<span id="cb71-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-90" tabindex="-1"></a>    <span class="dt">foto</span><span class="op">:</span> base64Foto <span class="op">||</span> <span class="st">&#39;&#39;</span></span>
<span id="cb71-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-91" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb71-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-92" tabindex="-1"></a>}</span>
<span id="cb71-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-93" tabindex="-1"></a></span>
<span id="cb71-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-94" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">readJsonSafe</span>(res) {</span>
<span id="cb71-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-95" tabindex="-1"></a>  <span class="kw">const</span> ct <span class="op">=</span> res<span class="op">.</span><span class="at">headers</span><span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;content-type&#39;</span>) <span class="op">||</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb71-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-96" tabindex="-1"></a>  <span class="cf">if</span> (ct<span class="op">.</span><span class="fu">includes</span>(<span class="st">&#39;application/json&#39;</span>)) {</span>
<span id="cb71-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-97" tabindex="-1"></a>    <span class="cf">try</span> { <span class="cf">return</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span> } <span class="cf">catch</span> { <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span> }</span>
<span id="cb71-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-98" tabindex="-1"></a>  }</span>
<span id="cb71-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-99" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb71-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-100" tabindex="-1"></a>}</span>
<span id="cb71-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-101" tabindex="-1"></a></span>
<span id="cb71-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-102" tabindex="-1"></a><span class="co">/* ---------- CRUD ---------- */</span></span>
<span id="cb71-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-103" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">inserir</span>() {</span>
<span id="cb71-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-104" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb71-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-105" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb71-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-106" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb71-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-107" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb71-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-108" tabindex="-1"></a>    <span class="kw">const</span> pessoa <span class="op">=</span> <span class="fu">coletaDados</span>(base64)<span class="op">;</span></span>
<span id="cb71-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-109" tabindex="-1"></a></span>
<span id="cb71-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-110" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API<span class="op">,</span> {</span>
<span id="cb71-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-111" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></span>
<span id="cb71-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-112" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb71-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-113" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(pessoa)</span>
<span id="cb71-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-114" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb71-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-115" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb71-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-116" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb71-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-117" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Inserido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb71-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-118" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb71-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-119" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;formPessoa&#39;</span>)<span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb71-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-120" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb71-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-121" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb71-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-122" tabindex="-1"></a>    }</span>
<span id="cb71-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-123" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb71-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-124" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao inserir: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb71-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-125" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb71-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-126" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb71-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-127" tabindex="-1"></a>  }</span>
<span id="cb71-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-128" tabindex="-1"></a>}</span>
<span id="cb71-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-129" tabindex="-1"></a></span>
<span id="cb71-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-130" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">alterar</span>() {</span>
<span id="cb71-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-131" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb71-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-132" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb71-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-133" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb71-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-134" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb71-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-135" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb71-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-136" tabindex="-1"></a>    <span class="kw">const</span> novosDados <span class="op">=</span> <span class="fu">coletaDados</span>()<span class="op">;</span></span>
<span id="cb71-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-137" tabindex="-1"></a>    <span class="cf">if</span> (base64) novosDados<span class="op">.</span><span class="at">foto</span> <span class="op">=</span> base64<span class="op">;</span></span>
<span id="cb71-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-138" tabindex="-1"></a></span>
<span id="cb71-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-139" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {</span>
<span id="cb71-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-140" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></span>
<span id="cb71-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-141" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb71-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-142" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(novosDados)</span>
<span id="cb71-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-143" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb71-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-144" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb71-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-145" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb71-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-146" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Alterado com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb71-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-147" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb71-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-148" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb71-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-149" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb71-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-150" tabindex="-1"></a>    }</span>
<span id="cb71-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-151" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb71-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-152" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao alterar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb71-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-153" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb71-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-154" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb71-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-155" tabindex="-1"></a>  }</span>
<span id="cb71-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-156" tabindex="-1"></a>}</span>
<span id="cb71-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-157" tabindex="-1"></a></span>
<span id="cb71-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-158" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">remover</span>() {</span>
<span id="cb71-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-159" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb71-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-160" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>cpf) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Informe o CPF para remover.&#39;</span>)<span class="op">;</span></span>
<span id="cb71-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-161" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">confirm</span>(<span class="st">&#39;Confirma a exclus√£o?&#39;</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb71-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-162" tabindex="-1"></a></span>
<span id="cb71-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-163" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb71-164"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-164" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb71-165"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-165" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {<span class="dt">method</span><span class="op">:</span><span class="st">&#39;DELETE&#39;</span>})<span class="op">;</span></span>
<span id="cb71-166"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-166" tabindex="-1"></a>    <span class="co">// 204 =&gt; sem corpo; n√£o tente parsear JSON aqui</span></span>
<span id="cb71-167"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-167" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">status</span> <span class="op">===</span> <span class="dv">204</span>) {</span>
<span id="cb71-168"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-168" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb71-169"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-169" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb71-170"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-170" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
<span id="cb71-171"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-171" tabindex="-1"></a>    }</span>
<span id="cb71-172"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-172" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb71-173"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-173" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb71-174"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-174" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb71-175"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-175" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb71-176"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-176" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb71-177"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-177" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb71-178"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-178" tabindex="-1"></a>    }</span>
<span id="cb71-179"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-179" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb71-180"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-180" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao remover: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb71-181"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-181" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb71-182"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-182" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb71-183"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-183" tabindex="-1"></a>  }</span>
<span id="cb71-184"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-184" tabindex="-1"></a>}</span>
<span id="cb71-185"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-185" tabindex="-1"></a></span>
<span id="cb71-186"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-186" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">pesquisar</span>() {</span>
<span id="cb71-187"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-187" tabindex="-1"></a>  <span class="kw">const</span> termo <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;pesquisa&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb71-188"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-188" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb71-189"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-189" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb71-190"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-190" tabindex="-1"></a>    <span class="kw">const</span> url <span class="op">=</span> termo <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(termo)<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API<span class="op">;</span></span>
<span id="cb71-191"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-191" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb71-192"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-192" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb71-193"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-193" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb71-194"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-194" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb71-195"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-195" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb71-196"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-196" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb71-197"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-197" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb71-198"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-198" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb71-199"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-199" tabindex="-1"></a>  }</span>
<span id="cb71-200"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-200" tabindex="-1"></a>}</span>
<span id="cb71-201"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-201" tabindex="-1"></a></span>
<span id="cb71-202"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-202" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">listar</span>() {</span>
<span id="cb71-203"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-203" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb71-204"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-204" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb71-205"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-205" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API)<span class="op">;</span></span>
<span id="cb71-206"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-206" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb71-207"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-207" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb71-208"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-208" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb71-209"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-209" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb71-210"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-210" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb71-211"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-211" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb71-212"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-212" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb71-213"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-213" tabindex="-1"></a>  }</span>
<span id="cb71-214"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-214" tabindex="-1"></a>}</span>
<span id="cb71-215"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-215" tabindex="-1"></a></span>
<span id="cb71-216"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-216" tabindex="-1"></a><span class="co">/* ---------- UI ---------- */</span></span>
<span id="cb71-217"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-217" tabindex="-1"></a><span class="kw">function</span> <span class="fu">preencheTabela</span>(lista){</span>
<span id="cb71-218"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-218" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;tabela&#39;</span>)<span class="op">;</span></span>
<span id="cb71-219"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-219" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb71-220"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-220" tabindex="-1"></a>  (lista <span class="op">||</span> [])<span class="op">.</span><span class="fu">forEach</span>(p<span class="kw">=&gt;</span>{</span>
<span id="cb71-221"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-221" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;tr&#39;</span>)<span class="op">;</span></span>
<span id="cb71-222"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-222" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb71-223"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-223" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb71-224"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-224" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img class=&quot;thumb&quot; src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb71-225"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-225" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb71-226"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-226" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb71-227"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-227" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">data_nascimento</span><span class="sc">}</span><span class="vs">&lt;/td&gt;`</span><span class="op">;</span></span>
<span id="cb71-228"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-228" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb71-229"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-229" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">cpf</span><span class="op">;</span></span>
<span id="cb71-230"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-230" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">nome</span><span class="op">;</span></span>
<span id="cb71-231"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-231" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">endereco</span><span class="op">;</span></span>
<span id="cb71-232"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-232" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">data_nascimento</span><span class="op">;</span></span>
<span id="cb71-233"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-233" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb71-234"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-234" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb71-235"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-235" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb71-236"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-236" tabindex="-1"></a>}</span>
<span id="cb71-237"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-237" tabindex="-1"></a></span>
<span id="cb71-238"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-238" tabindex="-1"></a><span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb71-239"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-239" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb71-240"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-240" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb71-241"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb71-241" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="exemplo-03---servidor-de-aplica√ß√£o-perl" class="section level2 hasAnchor" number="13.10">
<h2><span class="header-section-number">13.10</span> Exemplo 03 - SERVIDOR DE APLICA√á√ÉO PERL<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-03---servidor-de-aplica%C3%A7%C3%A3o-perl" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/clipboard-2372699820.png" /></p>
<p>Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</p>
<p>A interface do Cliente √© feita em HTML5</p>
<p>A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</p>
<p>CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</p>
<p>O servidor Restful √© feito em linguagem PERL</p>
<p>OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb72-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb72-1" tabindex="-1"></a>cpan Dancer2 DBI DBD::Pg JSON</span></code></pre></div>
<div id="servidor-perl" class="section level3 hasAnchor" number="13.10.1">
<h3><span class="header-section-number">13.10.1</span> Servidor Perl<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#servidor-perl" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode perl"><code class="sourceCode perl"><span id="cb73-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-1" tabindex="-1"></a><span class="kw">#!/usr/bin/perl</span></span>
<span id="cb73-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-2" tabindex="-1"></a><span class="fu">use</span> <span class="kw">strict</span>;</span>
<span id="cb73-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-3" tabindex="-1"></a><span class="fu">use</span> <span class="kw">warnings</span>;</span>
<span id="cb73-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-4" tabindex="-1"></a><span class="fu">use</span> Dancer2;</span>
<span id="cb73-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-5" tabindex="-1"></a><span class="fu">use</span> DBI;</span>
<span id="cb73-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-6" tabindex="-1"></a><span class="fu">use</span> JSON;</span>
<span id="cb73-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-7" tabindex="-1"></a></span>
<span id="cb73-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-8" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb73-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-9" tabindex="-1"></a><span class="co"># Configura√ß√µes do banco</span></span>
<span id="cb73-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-10" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb73-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-11" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$dsn</span> = <span class="ot">&quot;</span><span class="st">dbi:Pg:dbname=postgres;host=db.pbbtfwmydxmxdibmtbqq.supabase.co;port=5432</span><span class="ot">&quot;</span>;</span>
<span id="cb73-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-12" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$db_user</span> = <span class="ot">&quot;</span><span class="st">postgres</span><span class="ot">&quot;</span>;</span>
<span id="cb73-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-13" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$db_pass</span> = <span class="ot">&quot;</span><span class="st">MinhaSuperSenha</span><span class="ot">&quot;</span>;</span>
<span id="cb73-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-14" tabindex="-1"></a></span>
<span id="cb73-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-15" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$dbh</span> = DBI-&gt;<span class="fu">connect</span>(<span class="dt">$dsn</span>, <span class="dt">$db_user</span>, <span class="dt">$db_pass</span>, { RaiseError =&gt; <span class="dv">1</span>, AutoCommit =&gt; <span class="dv">1</span> });</span>
<span id="cb73-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-16" tabindex="-1"></a></span>
<span id="cb73-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-17" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb73-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-18" tabindex="-1"></a><span class="co"># Helpers</span></span>
<span id="cb73-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-19" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb73-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-20" tabindex="-1"></a><span class="kw">sub </span><span class="fu">json_response</span> {</span>
<span id="cb73-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-21" tabindex="-1"></a>    content_type <span class="ot">&#39;</span><span class="ss">application/json</span><span class="ot">&#39;</span>;</span>
<span id="cb73-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-22" tabindex="-1"></a>    <span class="kw">return</span> encode_json(<span class="wa">$_</span>[<span class="dv">0</span>]);</span>
<span id="cb73-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-23" tabindex="-1"></a>}</span>
<span id="cb73-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-24" tabindex="-1"></a></span>
<span id="cb73-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-25" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb73-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-26" tabindex="-1"></a><span class="co"># Endpoints REST</span></span>
<span id="cb73-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-27" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb73-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-28" tabindex="-1"></a></span>
<span id="cb73-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-29" tabindex="-1"></a><span class="co"># Listar todas ou pesquisar</span></span>
<span id="cb73-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-30" tabindex="-1"></a>get <span class="ot">&#39;</span><span class="ss">/pessoas</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb73-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-31" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$q</span> = query_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">q</span><span class="ot">&#39;</span>) || <span class="ot">&#39;&#39;</span>;</span>
<span id="cb73-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-32" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sql</span> = <span class="ot">&quot;</span><span class="st">SELECT * FROM pessoas</span><span class="ot">&quot;</span>;</span>
<span id="cb73-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-33" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">@params</span>;</span>
<span id="cb73-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-34" tabindex="-1"></a>    <span class="kw">if</span> (<span class="dt">$q</span> <span class="ot">ne</span> <span class="ot">&#39;&#39;</span>) {</span>
<span id="cb73-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-35" tabindex="-1"></a>        <span class="dt">$sql</span> .= <span class="ot">&quot;</span><span class="st"> WHERE cpf ILIKE ? OR nome ILIKE ?</span><span class="ot">&quot;</span>;</span>
<span id="cb73-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-36" tabindex="-1"></a>        <span class="dt">@params</span> = (<span class="ot">&quot;</span><span class="st">%</span><span class="dt">$q</span><span class="st">%</span><span class="ot">&quot;</span>, <span class="ot">&quot;</span><span class="st">%</span><span class="dt">$q</span><span class="st">%</span><span class="ot">&quot;</span>);</span>
<span id="cb73-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-37" tabindex="-1"></a>    }</span>
<span id="cb73-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-38" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="dt">$sql</span>);</span>
<span id="cb73-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-39" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">@params</span>);</span>
<span id="cb73-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-40" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">@rows</span>;</span>
<span id="cb73-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-41" tabindex="-1"></a>    <span class="kw">while</span> (<span class="kw">my</span> <span class="dt">$row</span> = <span class="dt">$sth</span>-&gt;<span class="dt">fetchrow_hashref</span>) {</span>
<span id="cb73-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-42" tabindex="-1"></a>        <span class="fu">push</span> <span class="dt">@rows</span>, <span class="dt">$row</span>;</span>
<span id="cb73-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-43" tabindex="-1"></a>    }</span>
<span id="cb73-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-44" tabindex="-1"></a>    <span class="kw">return</span> json_response(\<span class="dt">@rows</span>);</span>
<span id="cb73-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-45" tabindex="-1"></a>};</span>
<span id="cb73-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-46" tabindex="-1"></a></span>
<span id="cb73-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-47" tabindex="-1"></a><span class="co"># Buscar por CPF</span></span>
<span id="cb73-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-48" tabindex="-1"></a>get <span class="ot">&#39;</span><span class="ss">/pessoas/:cpf</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb73-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-49" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = route_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">cpf</span><span class="ot">&#39;</span>);</span>
<span id="cb73-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-50" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">SELECT * FROM pessoas WHERE cpf = ?</span><span class="ot">&quot;</span>);</span>
<span id="cb73-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-51" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb73-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-52" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$row</span> = <span class="dt">$sth</span>-&gt;<span class="dt">fetchrow_hashref</span>;</span>
<span id="cb73-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-53" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">$row</span> ? json_response(<span class="dt">$row</span>) : status(<span class="dv">404</span>)-&gt;json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF n√£o encontrado</span><span class="ot">&quot;</span> });</span>
<span id="cb73-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-54" tabindex="-1"></a>};</span>
<span id="cb73-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-55" tabindex="-1"></a></span>
<span id="cb73-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-56" tabindex="-1"></a><span class="co"># Inserir</span></span>
<span id="cb73-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-57" tabindex="-1"></a>post <span class="ot">&#39;</span><span class="ss">/pessoas</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb73-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-58" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$data</span> = from_json(request-&gt;body);</span>
<span id="cb73-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-59" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = <span class="dt">$data</span>-&gt;{cpf};</span>
<span id="cb73-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-60" tabindex="-1"></a>    <span class="co"># Verifica se existe</span></span>
<span id="cb73-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-61" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$check</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">SELECT cpf FROM pessoas WHERE cpf = ?</span><span class="ot">&quot;</span>);</span>
<span id="cb73-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-62" tabindex="-1"></a>    <span class="dt">$check</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb73-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-63" tabindex="-1"></a>    <span class="kw">if</span> (<span class="dt">$check</span>-&gt;<span class="dt">fetchrow_array</span>) {</span>
<span id="cb73-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-64" tabindex="-1"></a>        status(<span class="dv">400</span>);</span>
<span id="cb73-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-65" tabindex="-1"></a>        <span class="kw">return</span> json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF j√° cadastrado</span><span class="ot">&quot;</span> });</span>
<span id="cb73-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-66" tabindex="-1"></a>    }</span>
<span id="cb73-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-67" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">INSERT INTO pessoas (cpf, nome, endereco, data_nascimento, foto) VALUES (?, ?, ?, ?, ?)</span><span class="ot">&quot;</span>);</span>
<span id="cb73-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-68" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>, <span class="dt">$data</span>-&gt;{nome}, <span class="dt">$data</span>-&gt;{endereco}, <span class="dt">$data</span>-&gt;{data_nascimento}, <span class="dt">$data</span>-&gt;{foto});</span>
<span id="cb73-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-69" tabindex="-1"></a>    status(<span class="dv">201</span>);</span>
<span id="cb73-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-70" tabindex="-1"></a>    <span class="kw">return</span> json_response({ message =&gt; <span class="ot">&quot;</span><span class="st">Inserido com sucesso</span><span class="ot">&quot;</span> });</span>
<span id="cb73-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-71" tabindex="-1"></a>};</span>
<span id="cb73-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-72" tabindex="-1"></a></span>
<span id="cb73-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-73" tabindex="-1"></a><span class="co"># Alterar</span></span>
<span id="cb73-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-74" tabindex="-1"></a>put <span class="ot">&#39;</span><span class="ss">/pessoas/:cpf</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb73-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-75" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = route_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">cpf</span><span class="ot">&#39;</span>);</span>
<span id="cb73-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-76" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$data</span> = from_json(request-&gt;body);</span>
<span id="cb73-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-77" tabindex="-1"></a>    <span class="co"># Verifica se existe</span></span>
<span id="cb73-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-78" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$check</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">SELECT cpf FROM pessoas WHERE cpf = ?</span><span class="ot">&quot;</span>);</span>
<span id="cb73-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-79" tabindex="-1"></a>    <span class="dt">$check</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb73-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-80" tabindex="-1"></a>    <span class="kw">unless</span> (<span class="dt">$check</span>-&gt;<span class="dt">fetchrow_array</span>) {</span>
<span id="cb73-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-81" tabindex="-1"></a>        status(<span class="dv">404</span>);</span>
<span id="cb73-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-82" tabindex="-1"></a>        <span class="kw">return</span> json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF n√£o encontrado</span><span class="ot">&quot;</span> });</span>
<span id="cb73-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-83" tabindex="-1"></a>    }</span>
<span id="cb73-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-84" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">UPDATE pessoas SET nome=?, endereco=?, data_nascimento=?, foto=? WHERE cpf=?</span><span class="ot">&quot;</span>);</span>
<span id="cb73-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-85" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$data</span>-&gt;{nome}, <span class="dt">$data</span>-&gt;{endereco}, <span class="dt">$data</span>-&gt;{data_nascimento}, <span class="dt">$data</span>-&gt;{foto}, <span class="dt">$cpf</span>);</span>
<span id="cb73-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-86" tabindex="-1"></a>    <span class="kw">return</span> json_response({ message =&gt; <span class="ot">&quot;</span><span class="st">Alterado com sucesso</span><span class="ot">&quot;</span> });</span>
<span id="cb73-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-87" tabindex="-1"></a>};</span>
<span id="cb73-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-88" tabindex="-1"></a></span>
<span id="cb73-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-89" tabindex="-1"></a><span class="co"># Remover</span></span>
<span id="cb73-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-90" tabindex="-1"></a>del <span class="ot">&#39;</span><span class="ss">/pessoas/:cpf</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb73-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-91" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = route_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">cpf</span><span class="ot">&#39;</span>);</span>
<span id="cb73-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-92" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">DELETE FROM pessoas WHERE cpf=?</span><span class="ot">&quot;</span>);</span>
<span id="cb73-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-93" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$rows</span> = <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb73-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-94" tabindex="-1"></a>    <span class="kw">if</span> (<span class="dt">$rows</span>) {</span>
<span id="cb73-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-95" tabindex="-1"></a>        <span class="kw">return</span> json_response({ message =&gt; <span class="ot">&quot;</span><span class="st">Removido com sucesso</span><span class="ot">&quot;</span> });</span>
<span id="cb73-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-96" tabindex="-1"></a>    } <span class="kw">else</span> {</span>
<span id="cb73-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-97" tabindex="-1"></a>        status(<span class="dv">404</span>);</span>
<span id="cb73-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-98" tabindex="-1"></a>        <span class="kw">return</span> json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF n√£o encontrado</span><span class="ot">&quot;</span> });</span>
<span id="cb73-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-99" tabindex="-1"></a>    }</span>
<span id="cb73-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-100" tabindex="-1"></a>};</span>
<span id="cb73-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-101" tabindex="-1"></a></span>
<span id="cb73-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-102" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb73-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-103" tabindex="-1"></a><span class="co"># Inicializa o servidor</span></span>
<span id="cb73-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-104" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb73-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-105" tabindex="-1"></a>set port =&gt; <span class="dv">5000</span>;</span>
<span id="cb73-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-106" tabindex="-1"></a>set serializer =&gt; <span class="ot">&#39;</span><span class="ss">JSON</span><span class="ot">&#39;</span>;</span>
<span id="cb73-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-107" tabindex="-1"></a></span>
<span id="cb73-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb73-108" tabindex="-1"></a>start;</span></code></pre></div>
<p>servidor estar√° rodando na porta 5000 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:5000/pessoas" class="uri">http://localhost:5000/pessoas</a> sem senha</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb74-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb74-1" tabindex="-1"></a>http<span class="in">:</span><span class="er">//localhost:5000/pessoas</span></span></code></pre></div>
</div>
<div id="cliente-html-conex√£o-restful-1" class="section level3 hasAnchor" number="13.10.2">
<h3><span class="header-section-number">13.10.2</span> Cliente HTML (conex√£o Restful)<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex%C3%A3o-restful-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>crie o arquivo index.html e abra-o no navegador</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb75-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb75-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb75-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb75-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb75-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas - Perl/PostgreSQL<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb75-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb75-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">sans-serif</span><span class="op">;</span> <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">800</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span> <span class="bu">auto</span><span class="op">;</span> }</span>
<span id="cb75-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-8" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb75-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-9" tabindex="-1"></a>  button { <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin-right</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb75-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-10" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span><span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span><span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb75-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-11" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ccc</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span><span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span><span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb75-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-12" tabindex="-1"></a>  img<span class="fu">.thumb</span> { <span class="kw">width</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">height</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">object-fit</span><span class="ch">:</span><span class="dv">cover</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span><span class="dv">4</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb75-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-13" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb75-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-14" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb75-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-15" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb75-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-16" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas (Perl/PostgreSQL)<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb75-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-17" tabindex="-1"></a></span>
<span id="cb75-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-18" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;formPessoa&quot;</span><span class="dt">&gt;</span></span>
<span id="cb75-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-19" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF (chave prim√°ria): <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb75-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-20" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb75-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-21" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb75-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-22" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data Nasc.: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;data_nascimento&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb75-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-23" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="ot"> accept</span><span class="op">=</span><span class="st">&quot;image/*&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb75-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-24" tabindex="-1"></a></span>
<span id="cb75-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-25" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;inserir()&quot;</span><span class="dt">&gt;</span>Inserir<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb75-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-26" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;alterar()&quot;</span><span class="dt">&gt;</span>Alterar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb75-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-27" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;remover()&quot;</span><span class="dt">&gt;</span>Remover<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb75-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-28" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb75-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-29" tabindex="-1"></a></span>
<span id="cb75-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-30" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb75-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-31" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pesquisa&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Digite nome ou CPF&quot;</span><span class="dt">&gt;</span></span>
<span id="cb75-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-32" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;pesquisar()&quot;</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb75-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-33" tabindex="-1"></a></span>
<span id="cb75-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-34" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb75-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-35" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb75-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-36" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb75-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-37" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb75-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-38" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb75-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-39" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb75-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-40" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb75-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-41" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabela&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb75-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-42" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb75-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-43" tabindex="-1"></a></span>
<span id="cb75-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-44" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb75-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-45" tabindex="-1"></a><span class="kw">const</span> API <span class="op">=</span> <span class="st">&#39;http://localhost:5000/pessoas&#39;</span><span class="op">;</span></span>
<span id="cb75-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-46" tabindex="-1"></a></span>
<span id="cb75-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-47" tabindex="-1"></a><span class="co">/* ---------- Fun√ß√µes utilit√°rias ---------- */</span></span>
<span id="cb75-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-48" tabindex="-1"></a><span class="kw">function</span> <span class="fu">validaCampos</span>() {</span>
<span id="cb75-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-49" tabindex="-1"></a>  <span class="kw">const</span> campos <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span><span class="op">,</span><span class="st">&#39;nome&#39;</span><span class="op">,</span><span class="st">&#39;endereco&#39;</span><span class="op">,</span><span class="st">&#39;data_nascimento&#39;</span>]<span class="op">;</span></span>
<span id="cb75-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-50" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> campos) {</span>
<span id="cb75-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-51" tabindex="-1"></a>    <span class="kw">const</span> valor <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb75-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-52" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>valor) {</span>
<span id="cb75-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-53" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="vs">`O campo &quot;</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">&quot; n√£o pode ficar em branco.`</span>)<span class="op">;</span></span>
<span id="cb75-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-54" tabindex="-1"></a>      <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb75-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-55" tabindex="-1"></a>    }</span>
<span id="cb75-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-56" tabindex="-1"></a>  }</span>
<span id="cb75-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-57" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb75-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-58" tabindex="-1"></a>}</span>
<span id="cb75-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-59" tabindex="-1"></a></span>
<span id="cb75-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-60" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getFotoBase64</span>() {</span>
<span id="cb75-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-61" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;foto&#39;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb75-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-62" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>file) <span class="cf">return</span> <span class="bu">Promise</span><span class="op">.</span><span class="fu">resolve</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></span>
<span id="cb75-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-63" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span>reject)<span class="kw">=&gt;</span>{</span>
<span id="cb75-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-64" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb75-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-65" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb75-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-66" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb75-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-67" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb75-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-68" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb75-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-69" tabindex="-1"></a>}</span>
<span id="cb75-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-70" tabindex="-1"></a></span>
<span id="cb75-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-71" tabindex="-1"></a><span class="kw">function</span> <span class="fu">coletaDados</span>(base64Foto){</span>
<span id="cb75-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-72" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb75-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-73" tabindex="-1"></a>    <span class="dt">cpf</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb75-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-74" tabindex="-1"></a>    <span class="dt">nome</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb75-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-75" tabindex="-1"></a>    <span class="dt">endereco</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb75-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-76" tabindex="-1"></a>    <span class="dt">data_nascimento</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">,</span></span>
<span id="cb75-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-77" tabindex="-1"></a>    <span class="dt">foto</span><span class="op">:</span> base64Foto <span class="op">||</span> <span class="st">&#39;&#39;</span></span>
<span id="cb75-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-78" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb75-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-79" tabindex="-1"></a>}</span>
<span id="cb75-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-80" tabindex="-1"></a></span>
<span id="cb75-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-81" tabindex="-1"></a><span class="co">/* ---------- CRUD ---------- */</span></span>
<span id="cb75-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-82" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">inserir</span>() {</span>
<span id="cb75-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-83" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb75-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-84" tabindex="-1"></a>  <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb75-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-85" tabindex="-1"></a>  <span class="kw">const</span> pessoa <span class="op">=</span> <span class="fu">coletaDados</span>(base64)<span class="op">;</span></span>
<span id="cb75-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-86" tabindex="-1"></a></span>
<span id="cb75-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-87" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API<span class="op">,</span> {</span>
<span id="cb75-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-88" tabindex="-1"></a>    <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></span>
<span id="cb75-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-89" tabindex="-1"></a>    <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb75-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-90" tabindex="-1"></a>    <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(pessoa)</span>
<span id="cb75-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-91" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb75-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-92" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb75-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-93" tabindex="-1"></a>  <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) <span class="fu">alert</span>(<span class="st">&#39;Inserido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb75-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-94" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">.</span><span class="at">error</span> <span class="op">||</span> <span class="st">&#39;&#39;</span>))<span class="op">;</span></span>
<span id="cb75-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-95" tabindex="-1"></a>  <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb75-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-96" tabindex="-1"></a>}</span>
<span id="cb75-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-97" tabindex="-1"></a></span>
<span id="cb75-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-98" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">alterar</span>() {</span>
<span id="cb75-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-99" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb75-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-100" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb75-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-101" tabindex="-1"></a>  <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb75-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-102" tabindex="-1"></a>  <span class="kw">const</span> novosDados <span class="op">=</span> <span class="fu">coletaDados</span>()<span class="op">;</span></span>
<span id="cb75-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-103" tabindex="-1"></a>  <span class="cf">if</span>(base64) novosDados<span class="op">.</span><span class="at">foto</span> <span class="op">=</span> base64<span class="op">;</span></span>
<span id="cb75-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-104" tabindex="-1"></a></span>
<span id="cb75-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-105" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {</span>
<span id="cb75-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-106" tabindex="-1"></a>    <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></span>
<span id="cb75-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-107" tabindex="-1"></a>    <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb75-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-108" tabindex="-1"></a>    <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(novosDados)</span>
<span id="cb75-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-109" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb75-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-110" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb75-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-111" tabindex="-1"></a>  <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) <span class="fu">alert</span>(<span class="st">&#39;Alterado com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb75-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-112" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">.</span><span class="at">error</span> <span class="op">||</span> <span class="st">&#39;&#39;</span>))<span class="op">;</span></span>
<span id="cb75-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-113" tabindex="-1"></a>  <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb75-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-114" tabindex="-1"></a>}</span>
<span id="cb75-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-115" tabindex="-1"></a></span>
<span id="cb75-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-116" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">remover</span>() {</span>
<span id="cb75-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-117" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb75-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-118" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>cpf) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Informe o CPF para remover.&#39;</span>)<span class="op">;</span></span>
<span id="cb75-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-119" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">confirm</span>(<span class="st">&#39;Confirma a exclus√£o?&#39;</span>)){</span>
<span id="cb75-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-120" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {<span class="dt">method</span><span class="op">:</span><span class="st">&#39;DELETE&#39;</span>})<span class="op">;</span></span>
<span id="cb75-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-121" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb75-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-122" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb75-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-123" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">.</span><span class="at">error</span> <span class="op">||</span> <span class="st">&#39;&#39;</span>))<span class="op">;</span></span>
<span id="cb75-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-124" tabindex="-1"></a>    <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb75-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-125" tabindex="-1"></a>  }</span>
<span id="cb75-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-126" tabindex="-1"></a>}</span>
<span id="cb75-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-127" tabindex="-1"></a></span>
<span id="cb75-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-128" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">pesquisar</span>() {</span>
<span id="cb75-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-129" tabindex="-1"></a>  <span class="kw">const</span> termo <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;pesquisa&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb75-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-130" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>termo){ <span class="fu">listar</span>()<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb75-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-131" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(termo)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb75-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-132" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb75-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-133" tabindex="-1"></a>  <span class="fu">preencheTabela</span>(data)<span class="op">;</span></span>
<span id="cb75-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-134" tabindex="-1"></a>}</span>
<span id="cb75-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-135" tabindex="-1"></a></span>
<span id="cb75-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-136" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">listar</span>() {</span>
<span id="cb75-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-137" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API)<span class="op">;</span></span>
<span id="cb75-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-138" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb75-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-139" tabindex="-1"></a>  <span class="fu">preencheTabela</span>(data)<span class="op">;</span></span>
<span id="cb75-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-140" tabindex="-1"></a>}</span>
<span id="cb75-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-141" tabindex="-1"></a></span>
<span id="cb75-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-142" tabindex="-1"></a><span class="co">/* ---------- UI ---------- */</span></span>
<span id="cb75-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-143" tabindex="-1"></a><span class="kw">function</span> <span class="fu">preencheTabela</span>(lista){</span>
<span id="cb75-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-144" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;tabela&#39;</span>)<span class="op">;</span></span>
<span id="cb75-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-145" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb75-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-146" tabindex="-1"></a>  lista<span class="op">.</span><span class="fu">forEach</span>(p<span class="kw">=&gt;</span>{</span>
<span id="cb75-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-147" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;tr&#39;</span>)<span class="op">;</span></span>
<span id="cb75-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-148" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb75-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-149" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb75-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-150" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img class=&quot;thumb&quot; src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb75-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-151" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb75-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-152" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb75-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-153" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">data_nascimento</span><span class="sc">}</span><span class="vs">&lt;/td&gt;`</span><span class="op">;</span></span>
<span id="cb75-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-154" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb75-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-155" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">cpf</span><span class="op">;</span></span>
<span id="cb75-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-156" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">nome</span><span class="op">;</span></span>
<span id="cb75-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-157" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">endereco</span><span class="op">;</span></span>
<span id="cb75-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-158" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">data_nascimento</span><span class="op">;</span></span>
<span id="cb75-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-159" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb75-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-160" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb75-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-161" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb75-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-162" tabindex="-1"></a>}</span>
<span id="cb75-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-163" tabindex="-1"></a></span>
<span id="cb75-164"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-164" tabindex="-1"></a><span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb75-165"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-165" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb75-166"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-166" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb75-167"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb75-167" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
</div>
</div>
<div id="exemplo-04---servidor-de-aplica√ß√£o-java" class="section level2 hasAnchor" number="13.11">
<h2><span class="header-section-number">13.11</span> Exemplo 04 - SERVIDOR DE APLICA√á√ÉO JAVA<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-04---servidor-de-aplica%C3%A7%C3%A3o-java" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/clipboard-3162947411.png" /></p>
<p>[ Vou refazer estes exemplo ]</p>
</div>
<div id="exemplo-05---servidor-de-aplica√ß√£o-c" class="section level2 hasAnchor" number="13.12">
<h2><span class="header-section-number">13.12</span> Exemplo 05 - SERVIDOR DE APLICA√á√ÉO C++<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#exemplo-05---servidor-de-aplica%C3%A7%C3%A3o-c" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/clipboard-2416235942.png" /></p>
<p>Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</p>
<p>A interface do Cliente √© feita em HTML5</p>
<p>A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</p>
<p>CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</p>
<p>O servidor Restful √© feito em linguagem C++</p>
<p>A linguagem C++ precisa ser compilada.</p>
<p>PORTANTO O C√ìDIGO DO SERVIDOR PRECISAR√Å SER COMPILADO.</p>
<p>EM C++ VAMOS USAR BIBLIOTECAS EXTERNAS libpqxx e crow</p>
<p>OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</p>
<p>estrutura de diret√≥rios:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb76-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb76-1" tabindex="-1"></a>pessoas-rest-cpp/</span>
<span id="cb76-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb76-2" tabindex="-1"></a>‚îú‚îÄ CMakeLists<span class="fu">.txt</span></span>
<span id="cb76-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb76-3" tabindex="-1"></a>‚îú‚îÄ src/</span>
<span id="cb76-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb76-4" tabindex="-1"></a>‚îÇ   ‚îî‚îÄ main<span class="fu">.cpp</span></span>
<span id="cb76-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb76-5" tabindex="-1"></a>‚îî‚îÄ include/</span>
<span id="cb76-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb76-6" tabindex="-1"></a>    ‚îî‚îÄ crow_all<span class="fu">.h</span>        ‚Üê header √∫nico da biblioteca Crow</span></code></pre></div>
<div id="criando-o-arquivo-c-do-servidor" class="section level3 hasAnchor" number="13.12.1">
<h3><span class="header-section-number">13.12.1</span> Criando o arquivo C++ do servidor<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#criando-o-arquivo-c-do-servidor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb77-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;crow_all.h&quot;</span></span>
<span id="cb77-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-2" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;pqxx/pqxx&gt;</span></span>
<span id="cb77-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-3" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb77-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-4" tabindex="-1"></a></span>
<span id="cb77-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-5" tabindex="-1"></a><span class="at">const</span> <span class="bu">std::</span>string CONN_STR <span class="op">=</span></span>
<span id="cb77-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-6" tabindex="-1"></a>    <span class="st">&quot;postgresql://postgres:MinhaSuperSenha@db.pbbtfwmydxmxdibmtbqq.supabase.co:5432/postgres&quot;</span><span class="op">;</span></span>
<span id="cb77-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-7" tabindex="-1"></a></span>
<span id="cb77-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-8" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb77-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-9" tabindex="-1"></a>    crow<span class="op">::</span>SimpleApp app<span class="op">;</span></span>
<span id="cb77-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-10" tabindex="-1"></a></span>
<span id="cb77-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-11" tabindex="-1"></a>    <span class="co">// GET /pessoas</span></span>
<span id="cb77-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-12" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;GET&quot;</span><span class="op">_method)</span></span>
<span id="cb77-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-13" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;</span> req<span class="op">){</span></span>
<span id="cb77-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-14" tabindex="-1"></a>        pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb77-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-15" tabindex="-1"></a>        pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb77-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-16" tabindex="-1"></a>        <span class="bu">std::</span>string q <span class="op">=</span> req<span class="op">.</span>url_params<span class="op">.</span>get<span class="op">(</span><span class="st">&quot;q&quot;</span><span class="op">)</span> <span class="op">?</span> req<span class="op">.</span>url_params<span class="op">.</span>get<span class="op">(</span><span class="st">&quot;q&quot;</span><span class="op">)</span> <span class="op">:</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb77-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-17" tabindex="-1"></a>        pqxx<span class="op">::</span>result r<span class="op">;</span></span>
<span id="cb77-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-18" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb77-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-19" tabindex="-1"></a>            r <span class="op">=</span> w<span class="op">.</span>exec_params<span class="op">(</span></span>
<span id="cb77-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-20" tabindex="-1"></a>                <span class="st">&quot;SELECT cpf,nome,endereco,data_nascimento,foto &quot;</span></span>
<span id="cb77-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-21" tabindex="-1"></a>                <span class="st">&quot;FROM pessoas WHERE lower(nome) LIKE lower(&#39;%&#39;||$1||&#39;%&#39;) OR cpf LIKE &#39;%&#39;||$1||&#39;%&#39;&quot;</span><span class="op">,</span></span>
<span id="cb77-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-22" tabindex="-1"></a>                q<span class="op">);</span></span>
<span id="cb77-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-23" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb77-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-24" tabindex="-1"></a>            r <span class="op">=</span> w<span class="op">.</span>exec<span class="op">(</span><span class="st">&quot;SELECT cpf,nome,endereco,data_nascimento,foto FROM pessoas&quot;</span><span class="op">);</span></span>
<span id="cb77-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-25" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb77-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-26" tabindex="-1"></a>        crow<span class="op">::</span>json<span class="op">::</span>wvalue out<span class="op">;</span></span>
<span id="cb77-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-27" tabindex="-1"></a>        <span class="dt">size_t</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb77-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-28" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> row <span class="op">:</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb77-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-29" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;cpf&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;cpf&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb77-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-30" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;nome&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;nome&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb77-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-31" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;endereco&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;endereco&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb77-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-32" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;dataNascimento&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;data_nascimento&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb77-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-33" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;foto&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span>is_null<span class="op">()</span> <span class="op">?</span> <span class="st">&quot;&quot;</span> <span class="op">:</span> row<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb77-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-34" tabindex="-1"></a>            <span class="op">++</span>i<span class="op">;</span></span>
<span id="cb77-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-35" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb77-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-36" tabindex="-1"></a>        <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span>out<span class="op">);</span></span>
<span id="cb77-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-37" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb77-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-38" tabindex="-1"></a></span>
<span id="cb77-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-39" tabindex="-1"></a>    <span class="co">// POST /pessoas</span></span>
<span id="cb77-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-40" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;POST&quot;</span><span class="op">_method)</span></span>
<span id="cb77-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-41" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;</span> req<span class="op">){</span></span>
<span id="cb77-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-42" tabindex="-1"></a>        <span class="kw">auto</span> body <span class="op">=</span> crow<span class="op">::</span>json<span class="op">::</span>load<span class="op">(</span>req<span class="op">.</span>body<span class="op">);</span></span>
<span id="cb77-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-43" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>body <span class="op">||</span> <span class="op">!</span>body<span class="op">.</span>has<span class="op">(</span><span class="st">&quot;cpf&quot;</span><span class="op">))</span></span>
<span id="cb77-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-44" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> <span class="st">&quot;CPF √© obrigat√≥rio&quot;</span><span class="op">);</span></span>
<span id="cb77-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-45" tabindex="-1"></a></span>
<span id="cb77-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-46" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb77-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-47" tabindex="-1"></a>            pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb77-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-48" tabindex="-1"></a>            pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb77-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-49" tabindex="-1"></a>            w<span class="op">.</span>exec_params<span class="op">(</span></span>
<span id="cb77-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-50" tabindex="-1"></a>                <span class="st">&quot;INSERT INTO pessoas (cpf,nome,endereco,data_nascimento,foto) &quot;</span></span>
<span id="cb77-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-51" tabindex="-1"></a>                <span class="st">&quot;VALUES ($1,$2,$3,$4,$5)&quot;</span><span class="op">,</span></span>
<span id="cb77-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-52" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;cpf&quot;</span><span class="op">].</span>s<span class="op">(),</span></span>
<span id="cb77-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-53" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;nome&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb77-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-54" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;endereco&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb77-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-55" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;dataNascimento&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb77-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-56" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">)</span></span>
<span id="cb77-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-57" tabindex="-1"></a>            <span class="op">);</span></span>
<span id="cb77-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-58" tabindex="-1"></a>            w<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb77-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-59" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">201</span><span class="op">,</span> <span class="st">&quot;Inserido&quot;</span><span class="op">);</span></span>
<span id="cb77-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-60" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span><span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>exception <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb77-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-61" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb77-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-62" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb77-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-63" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb77-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-64" tabindex="-1"></a></span>
<span id="cb77-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-65" tabindex="-1"></a>    <span class="co">// PUT /pessoas/&lt;cpf&gt;</span></span>
<span id="cb77-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-66" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas/&lt;string&gt;&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;PUT&quot;</span><span class="op">_method)</span></span>
<span id="cb77-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-67" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;</span> req<span class="op">,</span> <span class="bu">std::</span>string cpf<span class="op">){</span></span>
<span id="cb77-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-68" tabindex="-1"></a>        <span class="kw">auto</span> body <span class="op">=</span> crow<span class="op">::</span>json<span class="op">::</span>load<span class="op">(</span>req<span class="op">.</span>body<span class="op">);</span></span>
<span id="cb77-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-69" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>body<span class="op">)</span></span>
<span id="cb77-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-70" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> <span class="st">&quot;JSON inv√°lido&quot;</span><span class="op">);</span></span>
<span id="cb77-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-71" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb77-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-72" tabindex="-1"></a>            pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb77-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-73" tabindex="-1"></a>            pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb77-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-74" tabindex="-1"></a>            w<span class="op">.</span>exec_params<span class="op">(</span></span>
<span id="cb77-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-75" tabindex="-1"></a>                <span class="st">&quot;UPDATE pessoas SET nome=$1,endereco=$2,data_nascimento=$3,foto=$4 WHERE cpf=$5&quot;</span><span class="op">,</span></span>
<span id="cb77-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-76" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;nome&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb77-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-77" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;endereco&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb77-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-78" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;dataNascimento&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb77-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-79" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb77-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-80" tabindex="-1"></a>                cpf</span>
<span id="cb77-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-81" tabindex="-1"></a>            <span class="op">);</span></span>
<span id="cb77-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-82" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>w<span class="op">.</span>affected_rows<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">404</span><span class="op">,</span> <span class="st">&quot;CPF n√£o encontrado&quot;</span><span class="op">);</span></span>
<span id="cb77-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-83" tabindex="-1"></a>            w<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb77-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-84" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">200</span><span class="op">,</span> <span class="st">&quot;Alterado&quot;</span><span class="op">);</span></span>
<span id="cb77-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-85" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span><span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>exception <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb77-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-86" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb77-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-87" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb77-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-88" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb77-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-89" tabindex="-1"></a></span>
<span id="cb77-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-90" tabindex="-1"></a>    <span class="co">// DELETE /pessoas/&lt;cpf&gt;</span></span>
<span id="cb77-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-91" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas/&lt;string&gt;&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;DELETE&quot;</span><span class="op">_method)</span></span>
<span id="cb77-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-92" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;,</span> <span class="bu">std::</span>string cpf<span class="op">){</span></span>
<span id="cb77-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-93" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb77-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-94" tabindex="-1"></a>            pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb77-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-95" tabindex="-1"></a>            pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb77-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-96" tabindex="-1"></a>            w<span class="op">.</span>exec_params<span class="op">(</span><span class="st">&quot;DELETE FROM pessoas WHERE cpf=$1&quot;</span><span class="op">,</span> cpf<span class="op">);</span></span>
<span id="cb77-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-97" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>w<span class="op">.</span>affected_rows<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">404</span><span class="op">,</span> <span class="st">&quot;CPF n√£o encontrado&quot;</span><span class="op">);</span></span>
<span id="cb77-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-98" tabindex="-1"></a>            w<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb77-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-99" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">200</span><span class="op">,</span> <span class="st">&quot;Removido&quot;</span><span class="op">);</span></span>
<span id="cb77-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-100" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span><span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>exception <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb77-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-101" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb77-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-102" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb77-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-103" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb77-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-104" tabindex="-1"></a></span>
<span id="cb77-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-105" tabindex="-1"></a>    <span class="bu">std::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Servidor rodando em http://0.0.0.0:8080</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb77-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-106" tabindex="-1"></a>    app<span class="op">.</span>port<span class="op">(</span><span class="dv">8080</span><span class="op">).</span>multithreaded<span class="op">().</span>run<span class="op">();</span></span>
<span id="cb77-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb77-107" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="ferramenta-de-compila√ß√£o-cmake" class="section level3 hasAnchor" number="13.12.2">
<h3><span class="header-section-number">13.12.2</span> Ferramenta de compila√ß√£o CMAKE<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#ferramenta-de-compila%C3%A7%C3%A3o-cmake" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Preparando o arquivo de instru√ß√µes da ferramenta de projeto CMAKE</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb78-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-1" tabindex="-1"></a>cmake_minimum_required(VERSION 3.20)</span>
<span id="cb78-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-2" tabindex="-1"></a>project(PessoasRestCpp LANGUAGES CXX)</span>
<span id="cb78-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-3" tabindex="-1"></a></span>
<span id="cb78-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-4" tabindex="-1"></a>set(CMAKE_CXX_STANDARD 17)</span>
<span id="cb78-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-5" tabindex="-1"></a>set(CMAKE_CXX_STANDARD_REQUIRED ON)</span>
<span id="cb78-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-6" tabindex="-1"></a></span>
<span id="cb78-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-7" tabindex="-1"></a># Caminho para os headers (Crow e outros)</span>
<span id="cb78-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-8" tabindex="-1"></a>include_directories(${CMAKE_SOURCE_DIR}/include)</span>
<span id="cb78-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-9" tabindex="-1"></a></span>
<span id="cb78-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-10" tabindex="-1"></a># Localiza√ß√£o de libpqxx (ajuste se estiver em pasta diferente)</span>
<span id="cb78-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-11" tabindex="-1"></a>find_package(PostgreSQL REQUIRED)</span>
<span id="cb78-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-12" tabindex="-1"></a>find_path(PQXX_INCLUDE_DIR pqxx/pqxx)</span>
<span id="cb78-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-13" tabindex="-1"></a>find_library(PQXX_LIBRARY pqxx)</span>
<span id="cb78-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-14" tabindex="-1"></a></span>
<span id="cb78-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-15" tabindex="-1"></a>if(NOT PQXX_INCLUDE_DIR OR NOT PQXX_LIBRARY)</span>
<span id="cb78-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-16" tabindex="-1"></a>    message(FATAL_ERROR &quot;libpqxx n√£o encontrada. Instale com vcpkg ou aponte manualmente.&quot;)</span>
<span id="cb78-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-17" tabindex="-1"></a>endif()</span>
<span id="cb78-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-18" tabindex="-1"></a></span>
<span id="cb78-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-19" tabindex="-1"></a>add_executable(pessoas-rest</span>
<span id="cb78-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-20" tabindex="-1"></a>    src/main.cpp</span>
<span id="cb78-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-21" tabindex="-1"></a>)</span>
<span id="cb78-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-22" tabindex="-1"></a></span>
<span id="cb78-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-23" tabindex="-1"></a>target_include_directories(pessoas-rest PRIVATE ${PQXX_INCLUDE_DIR})</span>
<span id="cb78-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-24" tabindex="-1"></a>target_link_libraries(pessoas-rest</span>
<span id="cb78-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-25" tabindex="-1"></a>    ${PQXX_LIBRARY}</span>
<span id="cb78-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-26" tabindex="-1"></a>    PostgreSQL::PostgreSQL</span>
<span id="cb78-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb78-27" tabindex="-1"></a>)</span></code></pre></div>
<p>Adicionando biblioteca extra no compilador C++ do windows</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb79-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb79-1" tabindex="-1"></a>vcpkg install libpqxx</span></code></pre></div>
<p>Gere o projeto do servidor para ‚ÄúVisual Studio 17 2022‚Äù E ARQUITETURA x64</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb80-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb80-1" tabindex="-1"></a>cmake <span class="at">-B</span> build <span class="at">-G</span> <span class="st">&quot;Visual Studio 17 2022&quot;</span> <span class="at">-A</span> x64  <span class="at">-DCMAKE_TOOLCHAIN_FILE</span>=C:<span class="at">/path/to/vcpkg/scripts/buildsystems/vcpkg</span>.cmake</span></code></pre></div>
<p>Compile e linque todo o projeto</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb81-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb81-1" tabindex="-1"></a>cmake -<span class="at">-build</span> build -<span class="at">-config</span> Release</span></code></pre></div>
<p>execute o servidor</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb82-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb82-1" tabindex="-1"></a>build/Release/pessoas-rest.exe</span></code></pre></div>
<p>servidor estar√° rodando na porta 8080 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:8080/pessoas" class="uri">http://localhost:8080/pessoas</a> sem senha</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb83-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb83-1" tabindex="-1"></a>http<span class="in">:</span><span class="er">//localhost:8080/pessoas</span></span></code></pre></div>
</div>
<div id="cliente-html-conex√£o-restful-2" class="section level3 hasAnchor" number="13.12.3">
<h3><span class="header-section-number">13.12.3</span> Cliente HTML (conex√£o Restful)<a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cliente-html-conex%C3%A3o-restful-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>crie o arquivo index.html e abra-o no navegador</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb84-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb84-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb84-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb84-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb84-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb84-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb84-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">Arial</span><span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb84-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-8" tabindex="-1"></a>  h1 { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#333</span><span class="op">;</span> }</span>
<span id="cb84-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-9" tabindex="-1"></a>  form { <span class="kw">margin-bottom</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb84-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-10" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb84-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-11" tabindex="-1"></a>  input<span class="ex">[</span><span class="ss">type</span><span class="op">=</span><span class="st">text</span><span class="ex">]</span><span class="op">,</span> input<span class="ex">[</span><span class="ss">type</span><span class="op">=</span><span class="st">date</span><span class="ex">]</span><span class="op">,</span> input<span class="ex">[</span><span class="ss">type</span><span class="op">=</span><span class="st">file</span><span class="ex">]</span> {</span>
<span id="cb84-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-12" tabindex="-1"></a>    <span class="kw">width</span><span class="ch">:</span> <span class="dv">300</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb84-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-13" tabindex="-1"></a>  }</span>
<span id="cb84-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-14" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span> <span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb84-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-15" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#aaa</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span> <span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb84-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-16" tabindex="-1"></a>  img { <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">80</span><span class="dt">px</span><span class="op">;</span> <span class="kw">max-height</span><span class="ch">:</span> <span class="dv">80</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb84-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-17" tabindex="-1"></a>  <span class="fu">.btn</span> { <span class="kw">padding</span><span class="ch">:</span> <span class="dv">4</span><span class="dt">px</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">cursor</span><span class="ch">:</span> <span class="dv">pointer</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">0</span> <span class="dv">2</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb84-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-18" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb84-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-19" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb84-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-20" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb84-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-21" tabindex="-1"></a></span>
<span id="cb84-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-22" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb84-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-23" tabindex="-1"></a></span>
<span id="cb84-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-24" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pessoaForm&quot;</span><span class="dt">&gt;</span></span>
<span id="cb84-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-25" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF*:</span>
<span id="cb84-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-26" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;</span></span>
<span id="cb84-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-27" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb84-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-28" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome:</span>
<span id="cb84-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-29" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="dt">&gt;</span></span>
<span id="cb84-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-30" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb84-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-31" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo:</span>
<span id="cb84-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-32" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="dt">&gt;</span></span>
<span id="cb84-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-33" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb84-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-34" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data de Nascimento:</span>
<span id="cb84-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-35" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;dataNascimento&quot;</span><span class="dt">&gt;</span></span>
<span id="cb84-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-36" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb84-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-37" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto:</span>
<span id="cb84-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-38" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="dt">&gt;</span></span>
<span id="cb84-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-39" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb84-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-40" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;submit&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn&quot;</span><span class="dt">&gt;</span>Salvar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb84-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-41" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb84-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-42" tabindex="-1"></a></span>
<span id="cb84-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-43" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb84-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-44" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;search&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Buscar por CPF ou Nome&quot;</span><span class="dt">&gt;</span></span>
<span id="cb84-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-45" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnBuscar&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn&quot;</span><span class="dt">&gt;</span>Buscar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb84-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-46" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnListar&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn&quot;</span><span class="dt">&gt;</span>Listar Todos<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb84-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-47" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb84-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-48" tabindex="-1"></a></span>
<span id="cb84-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-49" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabelaPessoas&quot;</span><span class="dt">&gt;</span></span>
<span id="cb84-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-50" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb84-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-51" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb84-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-52" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>A√ß√µes<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb84-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-53" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb84-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-54" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb84-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-55" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb84-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-56" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb84-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-57" tabindex="-1"></a></span>
<span id="cb84-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-58" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb84-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-59" tabindex="-1"></a><span class="kw">const</span> API_URL <span class="op">=</span> <span class="st">&quot;http://localhost:8080/pessoas&quot;</span><span class="op">;</span></span>
<span id="cb84-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-60" tabindex="-1"></a></span>
<span id="cb84-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-61" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">carregarPessoas</span>(query<span class="op">=</span><span class="st">&quot;&quot;</span>) {</span>
<span id="cb84-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-62" tabindex="-1"></a>  <span class="kw">const</span> url <span class="op">=</span> query <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(query)<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API_URL<span class="op">;</span></span>
<span id="cb84-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-63" tabindex="-1"></a>  <span class="kw">const</span> resp <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb84-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-64" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> resp<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb84-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-65" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&quot;#tabelaPessoas tbody&quot;</span>)<span class="op">;</span></span>
<span id="cb84-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-66" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb84-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-67" tabindex="-1"></a>  data<span class="op">.</span><span class="fu">forEach</span>(p <span class="kw">=&gt;</span> {</span>
<span id="cb84-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-68" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&quot;tr&quot;</span>)<span class="op">;</span></span>
<span id="cb84-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-69" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb84-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-70" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb84-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-71" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span> <span class="op">||</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb84-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-72" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span> <span class="op">||</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb84-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-73" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">dataNascimento</span> <span class="op">||</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb84-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-74" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb84-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-75" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span></span>
<span id="cb84-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-76" tabindex="-1"></a><span class="vs">        &lt;button class=&quot;btn&quot; onclick=&quot;editar(&#39;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&#39;)&quot;&gt;Editar&lt;/button&gt;</span></span>
<span id="cb84-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-77" tabindex="-1"></a><span class="vs">        &lt;button class=&quot;btn&quot; onclick=&quot;excluir(&#39;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&#39;)&quot;&gt;Excluir&lt;/button&gt;</span></span>
<span id="cb84-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-78" tabindex="-1"></a><span class="vs">      &lt;/td&gt;</span></span>
<span id="cb84-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-79" tabindex="-1"></a><span class="vs">    `</span><span class="op">;</span></span>
<span id="cb84-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-80" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb84-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-81" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb84-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-82" tabindex="-1"></a>}</span>
<span id="cb84-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-83" tabindex="-1"></a></span>
<span id="cb84-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-84" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">toBase64</span>(file) {</span>
<span id="cb84-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-85" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> {</span>
<span id="cb84-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-86" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb84-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-87" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb84-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-88" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb84-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-89" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb84-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-90" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb84-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-91" tabindex="-1"></a>}</span>
<span id="cb84-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-92" tabindex="-1"></a></span>
<span id="cb84-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-93" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;pessoaForm&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;submit&quot;</span><span class="op">,</span> <span class="kw">async</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb84-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-94" tabindex="-1"></a>  e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb84-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-95" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb84-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-96" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>cpf) { <span class="fu">alert</span>(<span class="st">&quot;CPF √© obrigat√≥rio.&quot;</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb84-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-97" tabindex="-1"></a></span>
<span id="cb84-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-98" tabindex="-1"></a>  <span class="kw">const</span> nome <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;nome&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb84-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-99" tabindex="-1"></a>  <span class="kw">const</span> endereco <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;endereco&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb84-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-100" tabindex="-1"></a>  <span class="kw">const</span> dataNascimento <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;dataNascimento&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb84-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-101" tabindex="-1"></a>  <span class="kw">const</span> fotoFile <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;foto&quot;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb84-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-102" tabindex="-1"></a>  <span class="kw">let</span> fotoBase64 <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb84-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-103" tabindex="-1"></a>  <span class="cf">if</span> (fotoFile) {</span>
<span id="cb84-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-104" tabindex="-1"></a>    fotoBase64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">toBase64</span>(fotoFile)<span class="op">;</span></span>
<span id="cb84-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-105" tabindex="-1"></a>  }</span>
<span id="cb84-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-106" tabindex="-1"></a></span>
<span id="cb84-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-107" tabindex="-1"></a>  <span class="co">// Se j√° existe, usa PUT, sen√£o POST</span></span>
<span id="cb84-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-108" tabindex="-1"></a>  <span class="kw">const</span> method <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">dataset</span><span class="op">.</span><span class="at">editing</span> <span class="op">?</span> <span class="st">&quot;PUT&quot;</span> <span class="op">:</span> <span class="st">&quot;POST&quot;</span><span class="op">;</span></span>
<span id="cb84-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-109" tabindex="-1"></a>  <span class="kw">const</span> url <span class="op">=</span> method <span class="op">===</span> <span class="st">&quot;PUT&quot;</span> <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>cpf<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API_URL<span class="op">;</span></span>
<span id="cb84-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-110" tabindex="-1"></a></span>
<span id="cb84-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-111" tabindex="-1"></a>  <span class="kw">const</span> resp <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url<span class="op">,</span> {</span>
<span id="cb84-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-112" tabindex="-1"></a>    method<span class="op">,</span></span>
<span id="cb84-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-113" tabindex="-1"></a>    <span class="dt">headers</span><span class="op">:</span> { <span class="st">&quot;Content-Type&quot;</span><span class="op">:</span> <span class="st">&quot;application/json&quot;</span> }<span class="op">,</span></span>
<span id="cb84-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-114" tabindex="-1"></a>    <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>({ cpf<span class="op">,</span> nome<span class="op">,</span> endereco<span class="op">,</span> dataNascimento<span class="op">,</span> <span class="dt">foto</span><span class="op">:</span> fotoBase64 })</span>
<span id="cb84-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-115" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb84-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-116" tabindex="-1"></a></span>
<span id="cb84-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-117" tabindex="-1"></a>  <span class="cf">if</span> (resp<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb84-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-118" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;Salvo com sucesso!&quot;</span>)<span class="op">;</span></span>
<span id="cb84-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-119" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;pessoaForm&quot;</span>)<span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb84-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-120" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">dataset</span><span class="op">.</span><span class="at">editing</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb84-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-121" tabindex="-1"></a>    <span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb84-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-122" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb84-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-123" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;Erro: &quot;</span> <span class="op">+</span> <span class="cf">await</span> resp<span class="op">.</span><span class="fu">text</span>())<span class="op">;</span></span>
<span id="cb84-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-124" tabindex="-1"></a>  }</span>
<span id="cb84-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-125" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb84-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-126" tabindex="-1"></a></span>
<span id="cb84-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-127" tabindex="-1"></a><span class="kw">function</span> <span class="fu">editar</span>(cpf) {</span>
<span id="cb84-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-128" tabindex="-1"></a>  <span class="kw">const</span> row <span class="op">=</span> [<span class="op">...</span><span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&quot;#tabelaPessoas tbody tr&quot;</span>)]</span>
<span id="cb84-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-129" tabindex="-1"></a>    <span class="op">.</span><span class="fu">find</span>(tr <span class="kw">=&gt;</span> tr<span class="op">.</span><span class="at">children</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">textContent</span> <span class="op">===</span> cpf)<span class="op">;</span></span>
<span id="cb84-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-130" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>row) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb84-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-131" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> cpf<span class="op">;</span></span>
<span id="cb84-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-132" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;nome&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> row<span class="op">.</span><span class="at">children</span>[<span class="dv">1</span>]<span class="op">.</span><span class="at">textContent</span><span class="op">;</span></span>
<span id="cb84-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-133" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;endereco&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> row<span class="op">.</span><span class="at">children</span>[<span class="dv">2</span>]<span class="op">.</span><span class="at">textContent</span><span class="op">;</span></span>
<span id="cb84-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-134" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;dataNascimento&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> row<span class="op">.</span><span class="at">children</span>[<span class="dv">3</span>]<span class="op">.</span><span class="at">textContent</span><span class="op">;</span></span>
<span id="cb84-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-135" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">dataset</span><span class="op">.</span><span class="at">editing</span> <span class="op">=</span> <span class="st">&quot;true&quot;</span><span class="op">;</span></span>
<span id="cb84-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-136" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">scrollTo</span>({ <span class="dt">top</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">behavior</span><span class="op">:</span> <span class="st">&#39;smooth&#39;</span> })<span class="op">;</span></span>
<span id="cb84-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-137" tabindex="-1"></a>}</span>
<span id="cb84-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-138" tabindex="-1"></a></span>
<span id="cb84-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-139" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">excluir</span>(cpf) {</span>
<span id="cb84-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-140" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="fu">confirm</span>(<span class="vs">`Excluir CPF </span><span class="sc">${</span>cpf<span class="sc">}</span><span class="vs">?`</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb84-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-141" tabindex="-1"></a>  <span class="kw">const</span> resp <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>cpf<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> { <span class="dt">method</span><span class="op">:</span> <span class="st">&quot;DELETE&quot;</span> })<span class="op">;</span></span>
<span id="cb84-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-142" tabindex="-1"></a>  <span class="cf">if</span> (resp<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb84-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-143" tabindex="-1"></a>    <span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb84-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-144" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb84-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-145" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;Erro: &quot;</span> <span class="op">+</span> <span class="cf">await</span> resp<span class="op">.</span><span class="fu">text</span>())<span class="op">;</span></span>
<span id="cb84-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-146" tabindex="-1"></a>  }</span>
<span id="cb84-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-147" tabindex="-1"></a>}</span>
<span id="cb84-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-148" tabindex="-1"></a></span>
<span id="cb84-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-149" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;btnBuscar&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb84-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-150" tabindex="-1"></a>  <span class="kw">const</span> q <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;search&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb84-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-151" tabindex="-1"></a>  <span class="fu">carregarPessoas</span>(q)<span class="op">;</span></span>
<span id="cb84-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-152" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb84-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-153" tabindex="-1"></a></span>
<span id="cb84-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-154" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;btnListar&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb84-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-155" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;search&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb84-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-156" tabindex="-1"></a>  <span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb84-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-157" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb84-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-158" tabindex="-1"></a></span>
<span id="cb84-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-159" tabindex="-1"></a><span class="co">// Carregar lista inicial</span></span>
<span id="cb84-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-160" tabindex="-1"></a><span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb84-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-161" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb84-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-162" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb84-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud-1.html#cb84-163" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="banco-de-dados-postgres-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="banco-de-dados-estat√≠stico---cliente-rstudio.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/miguel7penteado/2025-2sem-GTI-BancoDeDados/edit/main/09-aula09/09-2026-2026-04-21_CRUD-1-aula.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["2026-ADS-1sem-BancoDeDados.pdf", "2026-ADS-1sem-BancoDeDados.epub", "2026-ADS-1sem-BancoDeDados.word", "2026-ADS-1sem-BancoDeDados.html"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
