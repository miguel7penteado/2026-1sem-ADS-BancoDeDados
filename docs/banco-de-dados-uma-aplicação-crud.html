<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Slide 7 Banco de Dados: Uma Aplica√ß√£o CRUD | GTI - Banco de dados - 2025 - Anota√ß√µes de aula</title>
  <meta name="description" content="Este livreto re√∫ne anota√ß√µes, reflex√µes e conte√∫dos desenvolvidos ao longo das aulas da disciplina Banco de Dados, ministrada pelo Professor Migu√©l Suares. Elaborado com base em experi√™ncias pr√°ticas, refer√™ncias acad√™micas e diretrizes atualizadas sobre o tema, o material busca fornecer uma vis√£o cr√≠tica e aplicada sobre an√°lise de dados nas organiza√ß√µes contempor√¢neas." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Slide 7 Banco de Dados: Uma Aplica√ß√£o CRUD | GTI - Banco de dados - 2025 - Anota√ß√µes de aula" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="your book url like https://bookdown.org/yihui/bookdown/images/cover.jpg" />
  <meta property="og:description" content="Este livreto re√∫ne anota√ß√µes, reflex√µes e conte√∫dos desenvolvidos ao longo das aulas da disciplina Banco de Dados, ministrada pelo Professor Migu√©l Suares. Elaborado com base em experi√™ncias pr√°ticas, refer√™ncias acad√™micas e diretrizes atualizadas sobre o tema, o material busca fornecer uma vis√£o cr√≠tica e aplicada sobre an√°lise de dados nas organiza√ß√µes contempor√¢neas." />
  <meta name="github-repo" content="miguel7penteado/2025-2sem-GTI-BancoDeDados" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Slide 7 Banco de Dados: Uma Aplica√ß√£o CRUD | GTI - Banco de dados - 2025 - Anota√ß√µes de aula" />
  
  <meta name="twitter:description" content="Este livreto re√∫ne anota√ß√µes, reflex√µes e conte√∫dos desenvolvidos ao longo das aulas da disciplina Banco de Dados, ministrada pelo Professor Migu√©l Suares. Elaborado com base em experi√™ncias pr√°ticas, refer√™ncias acad√™micas e diretrizes atualizadas sobre o tema, o material busca fornecer uma vis√£o cr√≠tica e aplicada sobre an√°lise de dados nas organiza√ß√µes contempor√¢neas." />
  <meta name="twitter:image" content="your book url like https://bookdown.org/yihui/bookdown/images/cover.jpg" />

<meta name="author" content="Professor Migu√©l Suares" />


<meta name="date" content="2026-02-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados-1.html"/>
<link rel="next" href="banco-de-dados-mysql-mariadb.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">2026-ADS- Disciplina de Banco de Dados - Anota√ß√µes de Aula</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Sobre estas anota√ß√µes</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#acesso-ao-gitbook-celular"><i class="fa fa-check"></i><b>0.1</b> ACESSO AO GITBOOK CELULAR</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#leitores-de-formato-de-arquivo-epub-para-smartphone"><i class="fa fa-check"></i><b>0.2</b> Leitores de formato de arquivo EPUB para SmartPhone</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#android"><i class="fa fa-check"></i><b>0.2.1</b> ANDROID</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#livros-texto-da-disciplina"><i class="fa fa-check"></i><b>0.3</b> Livros Texto da Disciplina</a>
<ul>
<li class="chapter" data-level="0.3.1" data-path="index.html"><a href="index.html#introdu%C3%A7%C3%A3o-a-sistemas-de-bancos-de-dados-do-autor-christopher-john-date"><i class="fa fa-check"></i><b>0.3.1</b> ‚ÄúIntrodu√ß√£o a sistemas de bancos de dados‚Äù do autor ‚Äú<strong>Christopher John Date</strong>‚Äù</a></li>
<li class="chapter" data-level="0.3.2" data-path="index.html"><a href="index.html#projeto-de-bancos-de-dados-do-autor-carlos-alberto-heuser"><i class="fa fa-check"></i><b>0.3.2</b> ‚Äú<strong>Projeto de bancos de dados</strong>‚Äù do autor ‚ÄúCarlos Alberto HEUSER‚Äù</a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#calend%C3%A1rio-das-aulas"><i class="fa fa-check"></i><b>0.4</b> Calend√°rio das aulas</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#alunos-2025---2o-semestre"><i class="fa fa-check"></i><b>0.5</b> Alunos 2025 - 2o Semestre</a>
<ul>
<li class="chapter" data-level="0.5.1" data-path="index.html"><a href="index.html#campus-ch%C3%A1cara-santo-ant%C3%B4nio"><i class="fa fa-check"></i><b>0.5.1</b> Campus Ch√°cara Santo Ant√¥nio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="postgres-zip-version-windows-starting-guide.html"><a href="postgres-zip-version-windows-starting-guide.html"><i class="fa fa-check"></i><b>1</b> Postgres (Zip Version) Windows Starting Guide</a></li>
<li class="chapter" data-level="2" data-path="aula-inaugural.html"><a href="aula-inaugural.html"><i class="fa fa-check"></i><b>2</b> Aula Inaugural</a>
<ul>
<li class="chapter" data-level="2.1" data-path="aula-inaugural.html"><a href="aula-inaugural.html#disciplina-banco-de-dados"><i class="fa fa-check"></i><b>2.1</b> Disciplina: <strong>Banco de Dados</strong></a></li>
<li class="chapter" data-level="2.2" data-path="aula-inaugural.html"><a href="aula-inaugural.html#sobre-o-professor"><i class="fa fa-check"></i><b>2.2</b> üë®‚Äçüè´ Sobre o Professor</a></li>
<li class="chapter" data-level="2.3" data-path="aula-inaugural.html"><a href="aula-inaugural.html#objetivos-da-disciplina"><i class="fa fa-check"></i><b>2.3</b> üéØ Objetivos da Disciplina</a></li>
<li class="chapter" data-level="2.4" data-path="aula-inaugural.html"><a href="aula-inaugural.html#calend%C3%A1rio-da-disciplina"><i class="fa fa-check"></i><b>2.4</b> üìÖ Calend√°rio da Disciplina</a></li>
<li class="chapter" data-level="2.5" data-path="aula-inaugural.html"><a href="aula-inaugural.html#ementa-resumida"><i class="fa fa-check"></i><b>2.5</b> üìö Ementa Resumida</a></li>
<li class="chapter" data-level="2.6" data-path="aula-inaugural.html"><a href="aula-inaugural.html#avalia%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>2.6</b> üìù Avalia√ß√£o</a></li>
<li class="chapter" data-level="2.7" data-path="aula-inaugural.html"><a href="aula-inaugural.html#ferramentas-da-disciplina"><i class="fa fa-check"></i><b>2.7</b> üõ†Ô∏è Ferramentas da Disciplina</a></li>
<li class="chapter" data-level="2.8" data-path="aula-inaugural.html"><a href="aula-inaugural.html#expectativas-e-regras"><i class="fa fa-check"></i><b>2.8</b> üìå Expectativas e Regras</a></li>
<li class="chapter" data-level="2.9" data-path="aula-inaugural.html"><a href="aula-inaugural.html#dicas-para-mandar-bem"><i class="fa fa-check"></i><b>2.9</b> üí° Dicas para Mandar Bem</a></li>
<li class="chapter" data-level="2.10" data-path="aula-inaugural.html"><a href="aula-inaugural.html#encerramento"><i class="fa fa-check"></i><b>2.10</b> üôå Encerramento</a></li>
<li class="chapter" data-level="2.11" data-path="aula-inaugural.html"><a href="aula-inaugural.html#estamos-prontos"><i class="fa fa-check"></i><b>2.11</b> Estamos prontos?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html"><i class="fa fa-check"></i><b>3</b> Fundamentos de Sistemas de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#o-in%C3%ADcio-edgar-frank-ted-codd-19081923-18042003"><i class="fa fa-check"></i><b>3.1</b> O in√≠cio : Edgar Frank ‚ÄúTed‚Äù Codd (19/08/1923 ‚Äì 18/04/2003)</a></li>
<li class="chapter" data-level="3.2" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-1970-ibm-entra-no-modelo-relacional-systemr-e-sequelsql"><i class="fa fa-check"></i><b>3.2</b> Anos 1970: IBM entra no Modelo relacional: SystemR e SEQUEL/SQL</a></li>
<li class="chapter" data-level="3.3" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-1970-prof-codd-inspira-prof-stonebraker-banco-ingres"><i class="fa fa-check"></i><b>3.3</b> Anos 1970: Prof Codd inspira Prof StoneBraker: BANCO INGRES</a></li>
<li class="chapter" data-level="3.4" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-1980-ingres-semi-livre-vs-ibm-system-r-pago-vs-oracle"><i class="fa fa-check"></i><b>3.4</b> Anos 1980: INGRES (SEMI-LIVRE) vs IBM System R ( pago ) vs ORACLE</a></li>
<li class="chapter" data-level="3.5" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-1990-mysql-e-postgres-que-vira-postgresql"><i class="fa fa-check"></i><b>3.5</b> Anos 1990: MySQL e POSTGRES que vira POSTGRESQL</a></li>
<li class="chapter" data-level="3.6" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#anos-2000-sybase-eo-no-sql"><i class="fa fa-check"></i><b>3.6</b> Anos 2000: Sybase eo No-SQL</a></li>
<li class="chapter" data-level="3.7" data-path="fundamentos-de-sistemas-de-bancos-de-dados.html"><a href="fundamentos-de-sistemas-de-bancos-de-dados.html#exerc%C3%ADcios"><i class="fa fa-check"></i><b>3.7</b> Exerc√≠cios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html"><i class="fa fa-check"></i><b>4</b> Modelagem de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#introdu%C3%A7%C3%A3o-visitando-a-teoria-de-bancos-de-dados"><i class="fa fa-check"></i><b>4.1</b> Introdu√ß√£o: Visitando a teoria de Bancos de Dados</a></li>
<li class="chapter" data-level="4.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-matem%C3%A1tico-de-um-banco-de-dados"><i class="fa fa-check"></i><b>4.2</b> Modelo Matem√°tico de um Banco de Dados</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#podemos-representa-lo-matem%C3%A1ticamente-utilizando-a-teoria-dos-conjuntos"><i class="fa fa-check"></i><b>4.2.1</b> Podemos representa-lo matem√°ticamente utilizando a teoria dos conjuntos</a></li>
<li class="chapter" data-level="4.2.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#ent%C3%A3o-para-podemos-relacionar-estes-dois-conjuntos-funcion%C3%A1rios-e-departamentos-utilizando-a-teoria-das-fun%C3%A7%C3%B5es"><i class="fa fa-check"></i><b>4.2.2</b> Ent√£o para podemos relacionar estes dois conjuntos (Funcion√°rios e Departamentos) utilizando a Teoria das Fun√ß√µes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-l%C3%B3gico-de-banco-de-dados"><i class="fa fa-check"></i><b>4.3</b> Modelo L√≥gico de Banco de Dados</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-conceitual-entidade-relacionamento-de-banco-de-dados"><i class="fa fa-check"></i><b>4.3.1</b> Modelo Conceitual ‚ÄúEntidade Relacionamento‚Äù de Banco de Dados</a></li>
<li class="chapter" data-level="4.3.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#composi%C3%A7%C3%A3o-e-significado-do-diagrama-entidade-relacionamento-der"><i class="fa fa-check"></i><b>4.3.2</b> Composi√ß√£o e Significado do Diagrama Entidade Relacionamento (DER)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-f%C3%ADsico-de-banco-de-dados"><i class="fa fa-check"></i><b>4.4</b> Modelo F√≠sico de Banco de Dados</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#gera%C3%A7%C3%A3o-do-modelo-f%C3%ADsico-para-aplica-lo-ao-sgbd-sistema-de-gerenciamento-de-banco-de-dados"><i class="fa fa-check"></i><b>4.4.1</b> Gera√ß√£o do modelo F√≠sico para aplica-lo ao SGBD (Sistema de Gerenciamento de Banco de Dados):</a></li>
<li class="chapter" data-level="4.4.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#interagindo-com-o-modelo-f%C3%ADsico---a-linguagem-sql-structured-query-language"><i class="fa fa-check"></i><b>4.4.2</b> Interagindo com o Modelo F√≠sico - A linguagem SQL (Structured Query Language)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#exemplo-revenda-de-ve%C3%ADculos-multi-marcas"><i class="fa fa-check"></i><b>4.5</b> EXEMPLO: REVENDA DE VE√çCULOS MULTI-MARCAS</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#passo-1---visualizando-matem%C3%A1ticamente-os-dados"><i class="fa fa-check"></i><b>4.5.1</b> Passo 1 - Visualizando matem√°ticamente os dados:</a></li>
<li class="chapter" data-level="4.5.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#modelo-l%C3%B3gico-modelo-entidade-relacionamento"><i class="fa fa-check"></i><b>4.5.2</b> Modelo L√≥gico: Modelo Entidade Relacionamento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#verbos-relacionamentos-e-cardinalidade"><i class="fa fa-check"></i><b>4.6</b> VERBOS: Relacionamentos e Cardinalidade</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#tipos-principais-de-cardinalidade"><i class="fa fa-check"></i><b>4.6.1</b> üîπ Tipos principais de cardinalidade</a></li>
<li class="chapter" data-level="4.6.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#relacionamento-11-um-para-um"><i class="fa fa-check"></i><b>4.6.2</b> 1. Relacionamento <strong>1:1 (Um para Um)</strong></a></li>
<li class="chapter" data-level="4.6.3" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#relacionamento-1n-um-para-muitos"><i class="fa fa-check"></i><b>4.6.3</b> Relacionamento <strong>1:N (Um para Muitos)</strong></a></li>
<li class="chapter" data-level="4.6.4" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#relacionamento-nn-muitos-para-muitos"><i class="fa fa-check"></i><b>4.6.4</b> Relacionamento N:N (Muitos para Muitos)</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#entidade-dominante-e-entidade-subordinada"><i class="fa fa-check"></i><b>4.7</b> Entidade Dominante e Entidade Subordinada</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#defini%C3%A7%C3%B5es"><i class="fa fa-check"></i><b>4.7.1</b> Defini√ß√µes:</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#cardinalidade-do-modelo-l%C3%B3gico-e-a-cria%C3%A7%C3%A3o-de-chaves-estrangeiras-no-modelo-f%C3%ADsico-relacional"><i class="fa fa-check"></i><b>4.8</b> CARDINALIDADE DO MODELO L√ìGICO E A CRIA√á√ÉO DE CHAVES ESTRANGEIRAS NO MODELO F√çSICO-RELACIONAL</a></li>
<li class="chapter" data-level="4.9" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#normaliza%C3%A7%C3%A3o-em-bancos-de-dados-relaionais"><i class="fa fa-check"></i><b>4.9</b> Normaliza√ß√£o em Bancos de Dados Relaionais</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#tabela-desnormalizada"><i class="fa fa-check"></i><b>4.9.1</b> Tabela Desnormalizada</a></li>
<li class="chapter" data-level="4.9.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#tabela-normalizada"><i class="fa fa-check"></i><b>4.9.2</b> Tabela Normalizada</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#refer%C3%AAncias"><i class="fa fa-check"></i><b>4.10</b> Refer√™ncias</a></li>
<li class="chapter" data-level="4.11" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#exerc%C3%ADcios-resolvidos"><i class="fa fa-check"></i><b>4.11</b> Exerc√≠cios RESOLVIDOS</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#exerc%C3%ADcios-1"><i class="fa fa-check"></i><b>4.11.1</b> Exerc√≠cios</a></li>
<li class="chapter" data-level="4.11.2" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#lista-de-exerc%C3%ADcios-modelo-entidade-relacionamento-mer"><i class="fa fa-check"></i><b>4.11.2</b> üìù Lista de Exerc√≠cios ‚Äì Modelo Entidade-Relacionamento (MER)</a></li>
<li class="chapter" data-level="4.11.3" data-path="modelagem-de-bancos-de-dados.html"><a href="modelagem-de-bancos-de-dados.html#respostas-dos-exerc%C3%ADcios"><i class="fa fa-check"></i><b>4.11.3</b> Respostas dos Exerc√≠cios:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><i class="fa fa-check"></i><b>5</b> Administra√ß√£o e Gerenciamento de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="5.1" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#administra%C3%A7%C3%A3o-e-gerenciamento-de-banco-de-dados"><i class="fa fa-check"></i><b>5.1</b> Administra√ß√£o e Gerenciamento de Banco de Dados:</a></li>
<li class="chapter" data-level="5.2" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#papel-do-dba-database-administrator"><i class="fa fa-check"></i><b>5.2</b> Papel do DBA (Database Administrator)</a></li>
<li class="chapter" data-level="5.3" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#usu%C3%A1rios-grupos-e-esquemas-de-bancos-de-dados"><i class="fa fa-check"></i><b>5.3</b> Usu√°rios, Grupos e Esquemas de Bancos de Dados</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#usu%C3%A1rios"><i class="fa fa-check"></i><b>5.3.1</b> Usu√°rios</a></li>
<li class="chapter" data-level="5.3.2" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#esquemas"><i class="fa fa-check"></i><b>5.3.2</b> Esquemas</a></li>
<li class="chapter" data-level="5.3.3" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#grupos-ou-roles"><i class="fa fa-check"></i><b>5.3.3</b> Grupos ou Roles</a></li>
<li class="chapter" data-level="5.3.4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#sistema-de-gerenciamento-de-banco-de-dados-s.g.b.d."><i class="fa fa-check"></i><b>5.3.4</b> Sistema de Gerenciamento de Banco de Dados (S.G.B.D.)</a></li>
<li class="chapter" data-level="5.3.5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#cria%C3%A7%C3%A3o-de-usu%C3%A1rios-no-mysql"><i class="fa fa-check"></i><b>5.3.5</b> Cria√ß√£o de usu√°rios no MySQL</a></li>
<li class="chapter" data-level="5.3.6" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#cria%C3%A7%C3%A3o-de-esquemas-de-banco-de-dados-no-mysql"><i class="fa fa-check"></i><b>5.3.6</b> Cria√ß√£o de Esquemas de Banco de Dados no MySQL</a></li>
<li class="chapter" data-level="5.3.7" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#criando-de-grupos-de-permiss%C3%B5es-no-mysql"><i class="fa fa-check"></i><b>5.3.7</b> Criando de Grupos de Permiss√µes no MySQL:</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#fazendo-tudo-funcionar-colocando-usu%C3%A1rios-em-grupos-e-concedendo-a-estes-acesso-a-esquemas-de-banco-de-dados"><i class="fa fa-check"></i><b>5.4</b> Fazendo tudo funcionar: Colocando usu√°rios em grupos e concedendo a estes acesso a Esquemas de Banco de Dados:</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#associando-os-esquemas-que-representam-cada-estado-a-cada-grupo-que-representa-cada-regi%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>5.4.1</b> Associando os esquemas que representam cada estado a cada grupo (que representa cada regi√ß√£o):</a></li>
<li class="chapter" data-level="5.4.2" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#associando-associando-alunos-a-cada-grupo-regi%C3%A3o"><i class="fa fa-check"></i><b>5.4.2</b> Associando associando alunos a cada grupo (regi√£o):</a></li>
<li class="chapter" data-level="5.4.3" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#associando-usu%C3%A1rios-aos-grupos"><i class="fa fa-check"></i><b>5.4.3</b> Associando usu√°rios aos grupos</a></li>
<li class="chapter" data-level="5.4.4" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#concedendo-privil%C3%A9gios-aos-grupos"><i class="fa fa-check"></i><b>5.4.4</b> Concedendo privil√©gios aos grupos:</a></li>
<li class="chapter" data-level="5.4.5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#exemplo-no-mysql"><i class="fa fa-check"></i><b>5.4.5</b> Exemplo no MySQL</a></li>
<li class="chapter" data-level="5.4.6" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#exemplo-no-postgresql"><i class="fa fa-check"></i><b>5.4.6</b> Exemplo no PostGreSQL</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados.html#feito"><i class="fa fa-check"></i><b>5.5</b> Feito</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="administra√ß√£o-e-gerenciamento-de-bancos-de-dados-1.html"><a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados-1.html"><i class="fa fa-check"></i><b>6</b> Administra√ß√£o e Gerenciamento de Bancos de Dados</a></li>
<li class="chapter" data-level="7" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html"><i class="fa fa-check"></i><b>7</b> Banco de Dados: Uma Aplica√ß√£o CRUD</a>
<ul>
<li class="chapter" data-level="7.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#o-que-%C3%A9-uma-aplica%C3%A7%C3%A3o-crud"><i class="fa fa-check"></i><b>7.1</b> O que √© uma Aplica√ß√£o CRUD?</a></li>
<li class="chapter" data-level="7.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#conceito-de-crud"><i class="fa fa-check"></i><b>7.2</b> Conceito de CRUD</a></li>
<li class="chapter" data-level="7.3" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#o-padr%C3%A3o-de-design-de-sistemas-mvc-model-view-controller"><i class="fa fa-check"></i><b>7.3</b> O padr√£o de Design de Sistemas MVC (Model View Controller)</a></li>
<li class="chapter" data-level="7.4" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#construindo-uma-aplica%C3%A7%C3%A3o-crud-para-interfacear-com-a-tabela-pessoa"><i class="fa fa-check"></i><b>7.4</b> Construindo uma aplica√ß√£o CRUD para interfacear com a tabela ‚ÄúPessoa‚Äù</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#representa%C3%A7%C3%A3o-gr%C3%A1fica-no-modelo-f%C3%ADsico-relacional"><i class="fa fa-check"></i><b>7.4.1</b> Representa√ß√£o gr√°fica no modelo F√≠sico-Relacional</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cria%C3%A7%C3%A3o-de-uma-aplica%C3%A7%C3%A3o-crud"><i class="fa fa-check"></i><b>7.5</b> Cria√ß√£o de uma aplica√ß√£o CRUD</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#resultado-final"><i class="fa fa-check"></i><b>7.5.1</b> Resultado final:</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#feito-1"><i class="fa fa-check"></i><b>7.6</b> Feito</a></li>
<li class="chapter" data-level="7.7" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exerc%C3%ADcios-2"><i class="fa fa-check"></i><b>7.7</b> Exerc√≠cios</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#banco-de-dados-utilizado-nos-exemplos-de-aplica%C3%A7%C3%B5es-abaixo"><i class="fa fa-check"></i><b>7.7.1</b> Banco de Dados utilizado nos exemplos de aplica√ß√µes abaixo</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-01"><i class="fa fa-check"></i><b>7.8</b> Exemplo 01</a></li>
<li class="chapter" data-level="7.9" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-02---servidor-de-aplica%C3%A7%C3%A3o-python"><i class="fa fa-check"></i><b>7.9</b> Exemplo 02 - SERVIDOR DE APLICA√á√ÉO PYTHON</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#servidor-python"><i class="fa fa-check"></i><b>7.9.1</b> Servidor python</a></li>
<li class="chapter" data-level="7.9.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cliente-html-conex%C3%A3o-restful"><i class="fa fa-check"></i><b>7.9.2</b> Cliente HTML (conex√£o Restful)</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-03---servidor-de-aplica%C3%A7%C3%A3o-perl"><i class="fa fa-check"></i><b>7.10</b> Exemplo 03 - SERVIDOR DE APLICA√á√ÉO PERL</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#servidor-perl"><i class="fa fa-check"></i><b>7.10.1</b> Servidor Perl</a></li>
<li class="chapter" data-level="7.10.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cliente-html-conex%C3%A3o-restful-1"><i class="fa fa-check"></i><b>7.10.2</b> Cliente HTML (conex√£o Restful)</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-04---servidor-de-aplica%C3%A7%C3%A3o-java"><i class="fa fa-check"></i><b>7.11</b> Exemplo 04 - SERVIDOR DE APLICA√á√ÉO JAVA</a></li>
<li class="chapter" data-level="7.12" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-05---servidor-de-aplica%C3%A7%C3%A3o-c"><i class="fa fa-check"></i><b>7.12</b> Exemplo 05 - SERVIDOR DE APLICA√á√ÉO C++</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#criando-o-arquivo-c-do-servidor"><i class="fa fa-check"></i><b>7.12.1</b> Criando o arquivo C++ do servidor</a></li>
<li class="chapter" data-level="7.12.2" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#ferramenta-de-compila%C3%A7%C3%A3o-cmake"><i class="fa fa-check"></i><b>7.12.2</b> Ferramenta de compila√ß√£o CMAKE</a></li>
<li class="chapter" data-level="7.12.3" data-path="banco-de-dados-uma-aplica√ß√£o-crud.html"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cliente-html-conex%C3%A3o-restful-2"><i class="fa fa-check"></i><b>7.12.3</b> Cliente HTML (conex√£o Restful)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="banco-de-dados-mysql-mariadb.html"><a href="banco-de-dados-mysql-mariadb.html"><i class="fa fa-check"></i><b>8</b> Banco de Dados: MySQL (MariaDB)</a></li>
<li class="chapter" data-level="9" data-path="banco-de-dados-mysql-mariadb-1.html"><a href="banco-de-dados-mysql-mariadb-1.html"><i class="fa fa-check"></i><b>9</b> Banco de Dados: MySQL (MariaDB)</a></li>
<li class="chapter" data-level="10" data-path="banco-de-dados-postgres.html"><a href="banco-de-dados-postgres.html"><i class="fa fa-check"></i><b>10</b> Banco de Dados: Postgres</a></li>
<li class="chapter" data-level="11" data-path="banco-de-dados-postgres-1.html"><a href="banco-de-dados-postgres-1.html"><i class="fa fa-check"></i><b>11</b> Banco de Dados: Postgres</a></li>
<li class="chapter" data-level="12" data-path="banco-de-dados-espaciais---cliente-qgis.html"><a href="banco-de-dados-espaciais---cliente-qgis.html"><i class="fa fa-check"></i><b>12</b> Banco de Dados Espaciais - Cliente QGIS</a></li>
<li class="chapter" data-level="13" data-path="banco-de-dados-espaciais---cliente-qgis-1.html"><a href="banco-de-dados-espaciais---cliente-qgis-1.html"><i class="fa fa-check"></i><b>13</b> Banco de Dados Espaciais - Cliente QGIS</a></li>
<li class="chapter" data-level="14" data-path="banco-de-dados-estat√≠stico---cliente-rstudio.html"><a href="banco-de-dados-estat√≠stico---cliente-rstudio.html"><i class="fa fa-check"></i><b>14</b> Banco de Dados Estat√≠stico - Cliente Rstudio</a></li>
<li class="chapter" data-level="15" data-path="banco-de-dados-estat√≠stico---cliente-rstudio-1.html"><a href="banco-de-dados-estat√≠stico---cliente-rstudio-1.html"><i class="fa fa-check"></i><b>15</b> Banco de Dados Estat√≠stico - Cliente Rstudio</a></li>
<li class="chapter" data-level="16" data-path="banco-de-dados---an√°lise-de-dados-parte-01.html"><a href="banco-de-dados---an√°lise-de-dados-parte-01.html"><i class="fa fa-check"></i><b>16</b> Banco de Dados - An√°lise de Dados Parte 01</a></li>
<li class="chapter" data-level="17" data-path="banco-de-dados---an√°lise-de-dados-parte-01-1.html"><a href="banco-de-dados---an√°lise-de-dados-parte-01-1.html"><i class="fa fa-check"></i><b>17</b> Banco de Dados - An√°lise de Dados Parte 01</a></li>
<li class="chapter" data-level="18" data-path="banco-de-dados---an√°lise-de-dados-parte-02.html"><a href="banco-de-dados---an√°lise-de-dados-parte-02.html"><i class="fa fa-check"></i><b>18</b> Banco de Dados - An√°lise de Dados Parte 02</a></li>
<li class="chapter" data-level="19" data-path="banco-de-dados---an√°lise-de-dados-parte-02-1.html"><a href="banco-de-dados---an√°lise-de-dados-parte-02-1.html"><i class="fa fa-check"></i><b>19</b> Banco de Dados - An√°lise de Dados Parte 02</a></li>
<li class="chapter" data-level="20" data-path="banco-de-dados---an√°lise-de-dados-parte-03.html"><a href="banco-de-dados---an√°lise-de-dados-parte-03.html"><i class="fa fa-check"></i><b>20</b> Banco de Dados - An√°lise de Dados Parte 03</a></li>
<li class="chapter" data-level="21" data-path="banco-de-dados---an√°lise-de-dados-parte-03-1.html"><a href="banco-de-dados---an√°lise-de-dados-parte-03-1.html"><i class="fa fa-check"></i><b>21</b> Banco de Dados - An√°lise de Dados Parte 03</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado com Biblioteca R bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GTI - Banco de dados - 2025 - Anota√ß√µes de aula</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="banco-de-dados-uma-aplica√ß√£o-crud" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Slide 7</span> Banco de Dados: Uma Aplica√ß√£o CRUD<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#banco-de-dados-uma-aplica%C3%A7%C3%A3o-crud" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="section-5" class="section level4 unnumbered hasAnchor">
<h4>01/09/2025<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#section-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="professor-migu√©l-suares-5" class="section level4 unnumbered hasAnchor">
<h4>Professor Migu√©l Suares<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#professor-migu%C3%A9l-suares-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="o-que-√©-uma-aplica√ß√£o-crud" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> O que √© uma Aplica√ß√£o CRUD?<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#o-que-%C3%A9-uma-aplica%C3%A7%C3%A3o-crud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hoje vamos desenvolver um cadastro web simples e entender o que √© o acronimo C.R.U.D.</p>
</div>
<div id="conceito-de-crud" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Conceito de CRUD<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#conceito-de-crud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>CRUD</strong> √© um acr√¥nimo para quatro opera√ß√µes fundamentais que um sistema realiza sobre dados em um banco de dados:</p>
<p><img src="images/2025-09-01/01-CRUD.jpg" /></p>
<p>Essas quatro opera√ß√µes comp√µem a base da maioria das <strong>aplica√ß√µes web</strong> que manipulam dados persistidos em um <strong>SGBD</strong> (Sistema Gerenciador de Banco de Dados).</p>
<hr />
</div>
<div id="o-padr√£o-de-design-de-sistemas-mvc-model-view-controller" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> O padr√£o de Design de Sistemas MVC (Model View Controller)<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#o-padr%C3%A3o-de-design-de-sistemas-mvc-model-view-controller" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uma aplica√ß√£o Cliente-Servidor (modelo 2 camadas) geralmente segue o <strong>padr√£o MVC</strong> ‚Äî <strong>Model, View, Controller</strong>:</p>
<p><img src="images/2025-09-01/03-MVC.jpg" /></p>
</div>
<div id="construindo-uma-aplica√ß√£o-crud-para-interfacear-com-a-tabela-pessoa" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Construindo uma aplica√ß√£o CRUD para interfacear com a tabela ‚ÄúPessoa‚Äù<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#construindo-uma-aplica%C3%A7%C3%A3o-crud-para-interfacear-com-a-tabela-pessoa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Considere o Diagrama Entidade-Relacionamento abaixo:</p>
<p><img src="images/aula-05-Exemplo-01-continua%C3%A7%C3%A3o.svg" /><!-- --></p>
<p>Vamos Converte-lo para o Modelo F√≠sico-Relacional em linguagem SQL:</p>
<div id="representa√ß√£o-gr√°fica-no-modelo-f√≠sico-relacional" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Representa√ß√£o gr√°fica no modelo F√≠sico-Relacional<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#representa%C3%A7%C3%A3o-gr%C3%A1fica-no-modelo-f%C3%ADsico-relacional" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos agora representa-lo em linguagem SQL:</p>
<p><img src="images/2025-09-01/02-TabelaPessoas.jpg" /></p>
</div>
</div>
<div id="cria√ß√£o-de-uma-aplica√ß√£o-crud" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Cria√ß√£o de uma aplica√ß√£o CRUD<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cria%C3%A7%C3%A3o-de-uma-aplica%C3%A7%C3%A3o-crud" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vamos criar um <strong>microsas</strong> (micro Software As A Service) , ou seja, um site para inserir informa√ß√µes dentro da tabela acima.</p>
<p><img src="images/2025-09-01/04-Aplicacao.jpg" /></p>
<table>
<caption>Criando um Esquema de Banco de Dados - CRUD tabela Pessoas</caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Informa√ß√µes de Projeto</th>
<th>Tecnologias utilizadas no projeto CRUD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Servidor de banco de dados SGBD</td>
<td>MySQL 8</td>
</tr>
<tr class="even">
<td>Usu√°rio de Banco de Dados</td>
<td><strong>pessoas_user</strong></td>
</tr>
<tr class="odd">
<td>De onde pode ser acessado</td>
<td>Apenas M√°quina Local (localhost)</td>
</tr>
<tr class="even">
<td>Esquema de Banco de Dados</td>
<td><strong>pessoasdb</strong></td>
</tr>
<tr class="odd">
<td>Servidor de Aplica√ß√£o</td>
<td>Python 3</td>
</tr>
<tr class="even">
<td>Cliente da Aplica√ß√£o</td>
<td>HTML + Javascript</td>
</tr>
<tr class="odd">
<td>Tecnologia de API</td>
<td>RestuFul</td>
</tr>
<tr class="even">
<td><strong>Biblioteca de Javascript</strong> para criar API <strong>RestFul</strong></td>
<td>M√©todo <strong>Fetch</strong> (Biblioteca Padr√£o do JavaScript para API RestFul)</td>
</tr>
<tr class="odd">
<td>Formato de Dados entre Servidor de Aplica√ß√£o e Cliente de Aplica√ß√£o</td>
<td><strong>JSON</strong></td>
</tr>
</tbody>
</table>
<div id="cria√ß√£o-de-um-usu√°rio-para-interagir-com-o-esquema-de-banco-de-dados" class="section level4 hasAnchor" number="7.5.0.1">
<h4><span class="header-section-number">7.5.0.1</span> Cria√ß√£o de um usu√°rio para Interagir com o Esquema de Banco de Dados<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cria%C3%A7%C3%A3o-de-um-usu%C3%A1rio-para-interagir-com-o-esquema-de-banco-de-dados" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="images/2025-09-01/05-Usuario.jpg" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb50-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-1" tabindex="-1"></a></span>
<span id="cb50-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-2" tabindex="-1"></a><span class="co">-- CRIAR USU√ÅRIO LOCAL E CONCEDER PERMISS√ïES</span></span>
<span id="cb50-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-3" tabindex="-1"></a><span class="co">-- Troque &#39;MinhaSenhaForte&#39; por uma senha segura</span></span>
<span id="cb50-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-4" tabindex="-1"></a></span>
<span id="cb50-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-5" tabindex="-1"></a></span>
<span id="cb50-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-6" tabindex="-1"></a><span class="kw">CREATE</span> <span class="fu">USER</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> <span class="st">&#39;pessoas_user&#39;</span>@<span class="st">&#39;localhost&#39;</span> <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> <span class="st">&#39;MinhaSenhaForte&#39;</span>;</span>
<span id="cb50-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-7" tabindex="-1"></a></span>
<span id="cb50-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-8" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">ALL</span> <span class="kw">PRIVILEGES</span> <span class="kw">ON</span> pessoasdb.<span class="op">*</span> <span class="kw">TO</span> <span class="st">&#39;pessoas_user&#39;</span>@<span class="st">&#39;localhost&#39;</span>;</span>
<span id="cb50-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-9" tabindex="-1"></a></span>
<span id="cb50-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb50-10" tabindex="-1"></a><span class="kw">FLUSH</span> <span class="kw">PRIVILEGES</span>;</span></code></pre></div>
</div>
<div id="cria√ß√£o-do-esquema-de-banco-de-dados-no-sgbd-mysql" class="section level4 hasAnchor" number="7.5.0.2">
<h4><span class="header-section-number">7.5.0.2</span> Cria√ß√£o do Esquema de Banco de Dados no SGBD MySQL<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cria%C3%A7%C3%A3o-do-esquema-de-banco-de-dados-no-sgbd-mysql" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Agora vamos criar um esquema de Banco de Dados para abrigar nossa futura tabela:</p>
<p><img src="images/2025-09-01/06-Esquema.jpg" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb51-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb51-1" tabindex="-1"></a><span class="co">-- 1) CRIAR BANCO (ajuste o nome se quiser)</span></span>
<span id="cb51-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb51-2" tabindex="-1"></a></span>
<span id="cb51-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb51-3" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> pessoasdb</span>
<span id="cb51-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb51-4" tabindex="-1"></a>  <span class="dt">CHARACTER</span> <span class="kw">SET</span> utf8mb4</span>
<span id="cb51-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb51-5" tabindex="-1"></a>  COLLATE utf8mb4_0900_ai_ci;</span>
<span id="cb51-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb51-6" tabindex="-1"></a></span>
<span id="cb51-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb51-7" tabindex="-1"></a><span class="kw">USE</span> pessoasdb;</span></code></pre></div>
</div>
<div id="cria√ß√£o-da-tabela-pessoas" class="section level4 hasAnchor" number="7.5.0.3">
<h4><span class="header-section-number">7.5.0.3</span> Cria√ß√£o da Tabela ‚Äúpessoas‚Äù<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cria%C3%A7%C3%A3o-da-tabela-pessoas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="images/2025-09-01/07-Tabela_Pessoas.jpg" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb52-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-1" tabindex="-1"></a></span>
<span id="cb52-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-2" tabindex="-1"></a><span class="co">-- 3) TABELA &#39;pessoas&#39; COMPAT√çVEL COM O MODELO SQLAlchemy</span></span>
<span id="cb52-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-3" tabindex="-1"></a><span class="co">--    - cpf: chave prim√°ria (String(14))</span></span>
<span id="cb52-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-4" tabindex="-1"></a><span class="co">--    - nome, endereco, foto: TEXT</span></span>
<span id="cb52-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-5" tabindex="-1"></a><span class="co">--    - data_nascimento: DATE</span></span>
<span id="cb52-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-6" tabindex="-1"></a></span>
<span id="cb52-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-7" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> pessoas </span>
<span id="cb52-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-8" tabindex="-1"></a>(</span>
<span id="cb52-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-9" tabindex="-1"></a>  cpf             <span class="dt">VARCHAR</span>(<span class="dv">14</span>)  <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb52-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-10" tabindex="-1"></a>  nome            TEXT         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb52-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-11" tabindex="-1"></a>  endereco        TEXT         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb52-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-12" tabindex="-1"></a>  data_nascimento <span class="dt">DATE</span>         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb52-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-13" tabindex="-1"></a>  foto            TEXT         <span class="kw">NULL</span>,</span>
<span id="cb52-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-14" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (cpf)</span>
<span id="cb52-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-15" tabindex="-1"></a>) ENGINE<span class="op">=</span>InnoDB <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8mb4 COLLATE<span class="op">=</span>utf8mb4_0900_ai_ci;</span>
<span id="cb52-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-16" tabindex="-1"></a></span>
<span id="cb52-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-17" tabindex="-1"></a></span>
<span id="cb52-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-18" tabindex="-1"></a><span class="co">-- 4) (OPCIONAL) √çNDICES PARA BUSCA</span></span>
<span id="cb52-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-19" tabindex="-1"></a><span class="co">-- Seu endpoint usa LIKE/ILIKE em nome e cpf; cpf j√° √© PK.</span></span>
<span id="cb52-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-20" tabindex="-1"></a><span class="co">-- Para acelerar buscas por nome com LIKE, crie um √≠ndice por prefixo.</span></span>
<span id="cb52-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-21" tabindex="-1"></a><span class="co">-- OBS: √≠ndices em TEXT precisam de comprimento; 128 costuma ser um bom compromisso.</span></span>
<span id="cb52-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-22" tabindex="-1"></a></span>
<span id="cb52-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb52-23" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> idx_pessoas_nome_prefix <span class="kw">ON</span> pessoas (nome(<span class="dv">128</span>));</span></code></pre></div>
</div>
<div id="uma-aplica√ß√£o-cliente-servidor-no-formato-mvc-model-view-controller" class="section level4 hasAnchor" number="7.5.0.4">
<h4><span class="header-section-number">7.5.0.4</span> Uma aplica√ß√£o Cliente Servidor no formato MVC (Model View Controller)<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#uma-aplica%C3%A7%C3%A3o-cliente-servidor-no-formato-mvc-model-view-controller" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="images/Aplicacao-MVC-CRUD-Pessoas-01.svg" /><!-- --></p>
</div>
<div id="cria√ß√£o-do-servidor-de-aplica√ß√£o-em-linguagem-python" class="section level4 hasAnchor" number="7.5.0.5">
<h4><span class="header-section-number">7.5.0.5</span> Cria√ß√£o do Servidor de Aplica√ß√£o em Linguagem Python<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cria%C3%A7%C3%A3o-do-servidor-de-aplica%C3%A7%C3%A3o-em-linguagem-python" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vejamos a representa√ß√£o gr√°fica de nosso servidor utilizando o diagrama de classes da linguagem UML</p>
<p><img src="images/Servidor-CRUD-Pessoas-01.svg" /><!-- --></p>
<p>Para utilizar o MySQL como servidor, devemos instalar os drivers de MySQL para a biblioteca SQLAlchemy do Python atrav√©s da ferramenta de linha de comando PIP do python</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb53-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb53-1" tabindex="-1"></a>pip install flask flask<span class="at">-cors</span> sqlalchemy <span class="st">&quot;pymysql&gt;=1.1&quot;</span></span>
<span id="cb53-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb53-2" tabindex="-1"></a># (ou use mysqlclient: pip install mysqlclient e troque o driver para mysql+mysqlclient<span class="kw">)</span></span></code></pre></div>
<p>Agora vamos escrever o script python que criar√° o servidor de aplica√ß√£o para interfacear nosso Cliente no Navegador e nossa tabela pessoas dentro do SGBD MySQL:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-1" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb54-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-2" tabindex="-1"></a><span class="im">from</span> flask_cors <span class="im">import</span> CORS</span>
<span id="cb54-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-3" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine, Column, String, Date, Text</span>
<span id="cb54-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-4" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker, declarative_base</span>
<span id="cb54-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-5" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> date</span>
<span id="cb54-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-6" tabindex="-1"></a></span>
<span id="cb54-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-7" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-8" tabindex="-1"></a><span class="co"># Flask + CORS</span></span>
<span id="cb54-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-9" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-10" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb54-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-11" tabindex="-1"></a>CORS(app)  <span class="co"># em produ√ß√£o, restrinja as origens</span></span>
<span id="cb54-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-12" tabindex="-1"></a></span>
<span id="cb54-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-13" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-14" tabindex="-1"></a><span class="co"># Banco de Dados MySQL (localhost)</span></span>
<span id="cb54-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-15" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-16" tabindex="-1"></a><span class="co"># Par√¢metros do projeto:</span></span>
<span id="cb54-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-17" tabindex="-1"></a><span class="co">#   SGBD: MySQL 8</span></span>
<span id="cb54-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-18" tabindex="-1"></a><span class="co">#   Host: localhost</span></span>
<span id="cb54-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-19" tabindex="-1"></a><span class="co">#   Usu√°rio: pessoas_user</span></span>
<span id="cb54-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-20" tabindex="-1"></a><span class="co">#   DB/Schema: pessoasdb</span></span>
<span id="cb54-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-21" tabindex="-1"></a><span class="co">#   Tabela: pessoas</span></span>
<span id="cb54-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-22" tabindex="-1"></a>DATABASE_URL <span class="op">=</span> <span class="st">&quot;mysql+pymysql://pessoas_user:MinhaSenhaForte@localhost:3306/pessoasdb&quot;</span></span>
<span id="cb54-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-23" tabindex="-1"></a></span>
<span id="cb54-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-24" tabindex="-1"></a>engine <span class="op">=</span> create_engine(</span>
<span id="cb54-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-25" tabindex="-1"></a>    DATABASE_URL,</span>
<span id="cb54-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-26" tabindex="-1"></a>    pool_pre_ping<span class="op">=</span><span class="va">True</span>,        <span class="co"># evita &quot;MySQL server has gone away&quot;</span></span>
<span id="cb54-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-27" tabindex="-1"></a>    future<span class="op">=</span><span class="va">True</span></span>
<span id="cb54-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-28" tabindex="-1"></a>)</span>
<span id="cb54-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-29" tabindex="-1"></a>SessionLocal <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine, autoflush<span class="op">=</span><span class="va">False</span>, autocommit<span class="op">=</span><span class="va">False</span>, future<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-30" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb54-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-31" tabindex="-1"></a></span>
<span id="cb54-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-32" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-33" tabindex="-1"></a><span class="co"># Modelo Pessoa</span></span>
<span id="cb54-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-34" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-35" tabindex="-1"></a><span class="kw">class</span> Pessoa(Base):</span>
<span id="cb54-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-36" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">&quot;pessoas&quot;</span></span>
<span id="cb54-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-37" tabindex="-1"></a>    cpf <span class="op">=</span> Column(String(<span class="dv">14</span>), primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-38" tabindex="-1"></a>    nome <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb54-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-39" tabindex="-1"></a>    endereco <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb54-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-40" tabindex="-1"></a>    data_nascimento <span class="op">=</span> Column(Date, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb54-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-41" tabindex="-1"></a>    foto <span class="op">=</span> Column(Text)  <span class="co"># Base64 ou URL</span></span>
<span id="cb54-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-42" tabindex="-1"></a></span>
<span id="cb54-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-43" tabindex="-1"></a><span class="co"># Cria a tabela se n√£o existir (deve existir conforme seu script SQL)</span></span>
<span id="cb54-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-44" tabindex="-1"></a>Base.metadata.create_all(engine)</span>
<span id="cb54-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-45" tabindex="-1"></a></span>
<span id="cb54-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-46" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-47" tabindex="-1"></a><span class="co"># Helpers</span></span>
<span id="cb54-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-48" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-49" tabindex="-1"></a><span class="kw">def</span> to_dict(p: Pessoa):</span>
<span id="cb54-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-50" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb54-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-51" tabindex="-1"></a>        <span class="st">&quot;cpf&quot;</span>: p.cpf,</span>
<span id="cb54-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-52" tabindex="-1"></a>        <span class="st">&quot;nome&quot;</span>: p.nome,</span>
<span id="cb54-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-53" tabindex="-1"></a>        <span class="st">&quot;endereco&quot;</span>: p.endereco,</span>
<span id="cb54-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-54" tabindex="-1"></a>        <span class="st">&quot;data_nascimento&quot;</span>: p.data_nascimento.isoformat(),</span>
<span id="cb54-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-55" tabindex="-1"></a>        <span class="st">&quot;foto&quot;</span>: p.foto</span>
<span id="cb54-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-56" tabindex="-1"></a>    }</span>
<span id="cb54-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-57" tabindex="-1"></a></span>
<span id="cb54-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-58" tabindex="-1"></a><span class="kw">def</span> parse_date_iso(value):</span>
<span id="cb54-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-59" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(value, date):</span>
<span id="cb54-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-60" tabindex="-1"></a>        <span class="cf">return</span> value</span>
<span id="cb54-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-61" tabindex="-1"></a>    <span class="cf">return</span> date.fromisoformat(value)  <span class="co"># espera &quot;YYYY-MM-DD&quot;</span></span>
<span id="cb54-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-62" tabindex="-1"></a></span>
<span id="cb54-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-63" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-64" tabindex="-1"></a><span class="co"># CRUD</span></span>
<span id="cb54-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-65" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-66" tabindex="-1"></a></span>
<span id="cb54-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-67" tabindex="-1"></a><span class="co"># Listar todas as pessoas ou pesquisar por termo (?q=)</span></span>
<span id="cb54-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-68" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb54-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-69" tabindex="-1"></a><span class="kw">def</span> listar():</span>
<span id="cb54-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-70" tabindex="-1"></a>    termo <span class="op">=</span> (request.args.get(<span class="st">&#39;q&#39;</span>) <span class="kw">or</span> <span class="st">&#39;&#39;</span>).strip()</span>
<span id="cb54-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-71" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb54-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-72" tabindex="-1"></a>        query <span class="op">=</span> session.query(Pessoa)</span>
<span id="cb54-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-73" tabindex="-1"></a>        <span class="cf">if</span> termo:</span>
<span id="cb54-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-74" tabindex="-1"></a>            like <span class="op">=</span> <span class="ss">f&quot;%</span><span class="sc">{</span>termo<span class="sc">}</span><span class="ss">%&quot;</span></span>
<span id="cb54-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-75" tabindex="-1"></a>            <span class="co"># MySQL √© case-insensitive com collation *_ci; ilike √© traduzido para LIKE</span></span>
<span id="cb54-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-76" tabindex="-1"></a>            query <span class="op">=</span> query.<span class="bu">filter</span>((Pessoa.nome.ilike(like)) <span class="op">|</span> (Pessoa.cpf.ilike(like)))</span>
<span id="cb54-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-77" tabindex="-1"></a>        pessoas <span class="op">=</span> query.order_by(Pessoa.nome.asc()).<span class="bu">all</span>()</span>
<span id="cb54-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-78" tabindex="-1"></a>        <span class="cf">return</span> jsonify([to_dict(p) <span class="cf">for</span> p <span class="kw">in</span> pessoas])</span>
<span id="cb54-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-79" tabindex="-1"></a></span>
<span id="cb54-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-80" tabindex="-1"></a><span class="co"># Inserir nova pessoa</span></span>
<span id="cb54-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-81" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;POST&#39;</span>])</span>
<span id="cb54-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-82" tabindex="-1"></a><span class="kw">def</span> inserir():</span>
<span id="cb54-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-83" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json(force<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-84" tabindex="-1"></a>    required <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span>, <span class="st">&#39;nome&#39;</span>, <span class="st">&#39;endereco&#39;</span>, <span class="st">&#39;data_nascimento&#39;</span>]</span>
<span id="cb54-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-85" tabindex="-1"></a>    faltantes <span class="op">=</span> [k <span class="cf">for</span> k <span class="kw">in</span> required <span class="cf">if</span> <span class="kw">not</span> dados.get(k)]</span>
<span id="cb54-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-86" tabindex="-1"></a>    <span class="cf">if</span> faltantes:</span>
<span id="cb54-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-87" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;Campos obrigat√≥rios faltando&quot;</span>, <span class="st">&quot;fields&quot;</span>: faltantes}), <span class="dv">422</span></span>
<span id="cb54-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-88" tabindex="-1"></a></span>
<span id="cb54-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-89" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb54-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-90" tabindex="-1"></a>        dn <span class="op">=</span> parse_date_iso(dados[<span class="st">&#39;data_nascimento&#39;</span>])</span>
<span id="cb54-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-91" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb54-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-92" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;data_nascimento inv√°lida. Use YYYY-MM-DD&quot;</span>}), <span class="dv">422</span></span>
<span id="cb54-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-93" tabindex="-1"></a></span>
<span id="cb54-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-94" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb54-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-95" tabindex="-1"></a>        <span class="cf">if</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>]).first():</span>
<span id="cb54-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-96" tabindex="-1"></a>            <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF j√° cadastrado&quot;</span>}), <span class="dv">409</span></span>
<span id="cb54-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-97" tabindex="-1"></a>        pessoa <span class="op">=</span> Pessoa(</span>
<span id="cb54-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-98" tabindex="-1"></a>            cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>],</span>
<span id="cb54-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-99" tabindex="-1"></a>            nome<span class="op">=</span>dados[<span class="st">&#39;nome&#39;</span>],</span>
<span id="cb54-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-100" tabindex="-1"></a>            endereco<span class="op">=</span>dados[<span class="st">&#39;endereco&#39;</span>],</span>
<span id="cb54-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-101" tabindex="-1"></a>            data_nascimento<span class="op">=</span>dn,</span>
<span id="cb54-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-102" tabindex="-1"></a>            foto<span class="op">=</span>dados.get(<span class="st">&#39;foto&#39;</span>)</span>
<span id="cb54-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-103" tabindex="-1"></a>        )</span>
<span id="cb54-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-104" tabindex="-1"></a>        session.add(pessoa)</span>
<span id="cb54-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-105" tabindex="-1"></a>        session.commit()</span>
<span id="cb54-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-106" tabindex="-1"></a>        session.refresh(pessoa)</span>
<span id="cb54-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-107" tabindex="-1"></a>        <span class="cf">return</span> jsonify(to_dict(pessoa)), <span class="dv">201</span></span>
<span id="cb54-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-108" tabindex="-1"></a></span>
<span id="cb54-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-109" tabindex="-1"></a><span class="co"># Alterar pessoa (PUT)</span></span>
<span id="cb54-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-110" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;PUT&#39;</span>])</span>
<span id="cb54-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-111" tabindex="-1"></a><span class="kw">def</span> alterar(cpf):</span>
<span id="cb54-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-112" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json(force<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-113" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb54-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-114" tabindex="-1"></a>        pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb54-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-115" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb54-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-116" tabindex="-1"></a>            <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb54-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-117" tabindex="-1"></a></span>
<span id="cb54-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-118" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;nome&#39;</span> <span class="kw">in</span> dados <span class="kw">and</span> dados[<span class="st">&#39;nome&#39;</span>] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb54-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-119" tabindex="-1"></a>            pessoa.nome <span class="op">=</span> dados[<span class="st">&#39;nome&#39;</span>]</span>
<span id="cb54-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-120" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;endereco&#39;</span> <span class="kw">in</span> dados <span class="kw">and</span> dados[<span class="st">&#39;endereco&#39;</span>] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb54-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-121" tabindex="-1"></a>            pessoa.endereco <span class="op">=</span> dados[<span class="st">&#39;endereco&#39;</span>]</span>
<span id="cb54-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-122" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;data_nascimento&#39;</span> <span class="kw">in</span> dados <span class="kw">and</span> dados[<span class="st">&#39;data_nascimento&#39;</span>] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb54-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-123" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb54-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-124" tabindex="-1"></a>                pessoa.data_nascimento <span class="op">=</span> parse_date_iso(dados[<span class="st">&#39;data_nascimento&#39;</span>])</span>
<span id="cb54-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-125" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb54-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-126" tabindex="-1"></a>                <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;data_nascimento inv√°lida. Use YYYY-MM-DD&quot;</span>}), <span class="dv">422</span></span>
<span id="cb54-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-127" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;foto&#39;</span> <span class="kw">in</span> dados:</span>
<span id="cb54-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-128" tabindex="-1"></a>            pessoa.foto <span class="op">=</span> dados[<span class="st">&#39;foto&#39;</span>]</span>
<span id="cb54-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-129" tabindex="-1"></a></span>
<span id="cb54-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-130" tabindex="-1"></a>        session.commit()</span>
<span id="cb54-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-131" tabindex="-1"></a>        session.refresh(pessoa)</span>
<span id="cb54-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-132" tabindex="-1"></a>        <span class="cf">return</span> jsonify(to_dict(pessoa)), <span class="dv">200</span></span>
<span id="cb54-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-133" tabindex="-1"></a></span>
<span id="cb54-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-134" tabindex="-1"></a><span class="co"># Remover pessoa</span></span>
<span id="cb54-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-135" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;DELETE&#39;</span>])</span>
<span id="cb54-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-136" tabindex="-1"></a><span class="kw">def</span> remover(cpf):</span>
<span id="cb54-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-137" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb54-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-138" tabindex="-1"></a>        pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb54-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-139" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb54-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-140" tabindex="-1"></a>            <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb54-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-141" tabindex="-1"></a>        session.delete(pessoa)</span>
<span id="cb54-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-142" tabindex="-1"></a>        session.commit()</span>
<span id="cb54-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-143" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;&#39;</span>, <span class="dv">204</span></span>
<span id="cb54-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-144" tabindex="-1"></a></span>
<span id="cb54-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-145" tabindex="-1"></a><span class="co"># Buscar pessoa por CPF</span></span>
<span id="cb54-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-146" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb54-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-147" tabindex="-1"></a><span class="kw">def</span> buscar(cpf):</span>
<span id="cb54-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-148" tabindex="-1"></a>    <span class="cf">with</span> SessionLocal() <span class="im">as</span> session:</span>
<span id="cb54-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-149" tabindex="-1"></a>        pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb54-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-150" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb54-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-151" tabindex="-1"></a>            <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb54-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-152" tabindex="-1"></a>        <span class="cf">return</span> jsonify(to_dict(pessoa))</span>
<span id="cb54-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-153" tabindex="-1"></a></span>
<span id="cb54-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-154" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-155" tabindex="-1"></a><span class="co"># Inicia o servidor</span></span>
<span id="cb54-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-156" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb54-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-157" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb54-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb54-158" tabindex="-1"></a>    app.run(debug<span class="op">=</span><span class="va">True</span>, port<span class="op">=</span><span class="dv">5000</span>)</span></code></pre></div>
</div>
<div id="cria√ß√£o-do-cliente-de-aplica√ß√£o-em-html-parte-gr√°fica-e-javascript-programa√ß√£o-execut√°vel" class="section level4 hasAnchor" number="7.5.0.6">
<h4><span class="header-section-number">7.5.0.6</span> Cria√ß√£o do Cliente de Aplica√ß√£o em HTML (Parte Gr√°fica) e Javascript (Programa√ß√£o Execut√°vel)<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cria%C3%A7%C3%A3o-do-cliente-de-aplica%C3%A7%C3%A3o-em-html-parte-gr%C3%A1fica-e-javascript-programa%C3%A7%C3%A3o-execut%C3%A1vel" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vamos verificar como √© o Diagrama de Classes do Cliente que vai conversar com o servidor que vimos anteriormente:</p>
<p><img src="images/2025-09-01/09-cliente.jpg" /></p>
<p>Agora vamos verificar o c√≥digo-fonte.</p>
<p>Salve esse c√≥digo em um arquivo chamado <strong>cliente.html</strong>, para poder abrir-lo no navegador, juntamente com o servidor rodando:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb55-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb55-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb55-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb55-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb55-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas - Flask/MySQL<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb55-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb55-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">system-ui</span><span class="op">,</span> <span class="dv">-apple-system</span><span class="op">,</span> <span class="dv">Segoe UI</span><span class="op">,</span> <span class="dv">Roboto</span><span class="op">,</span> <span class="dv">Arial</span><span class="op">;</span> <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">980</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">24</span><span class="dt">px</span> <span class="bu">auto</span><span class="op">;</span> }</span>
<span id="cb55-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-8" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb55-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-9" tabindex="-1"></a>  button { <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin-right</span><span class="ch">:</span> <span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span> <span class="dv">12</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb55-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-10" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span><span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span><span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb55-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-11" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span><span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb55-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-12" tabindex="-1"></a>  img<span class="fu">.thumb</span> { <span class="kw">width</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">height</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">object-fit</span><span class="ch">:</span><span class="dv">cover</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span><span class="dv">4</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb55-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-13" tabindex="-1"></a>  <span class="fu">.row</span> { <span class="kw">display</span><span class="ch">:</span><span class="dv">flex</span><span class="op">;</span> <span class="kw">gap</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">align-items</span><span class="ch">:</span><span class="dv">center</span><span class="op">;</span> <span class="kw">flex-wrap</span><span class="ch">:</span><span class="dv">wrap</span><span class="op">;</span> }</span>
<span id="cb55-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-14" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb55-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-15" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb55-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-16" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb55-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-17" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas (Flask/MySQL)<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb55-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-18" tabindex="-1"></a></span>
<span id="cb55-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-19" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;formPessoa&quot;</span><span class="dt">&gt;</span></span>
<span id="cb55-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-20" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF (chave prim√°ria): <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb55-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-21" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb55-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-22" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb55-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-23" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data Nasc.: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;data_nascimento&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb55-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-24" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="ot"> accept</span><span class="op">=</span><span class="st">&quot;image/*&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb55-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-25" tabindex="-1"></a></span>
<span id="cb55-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-26" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb55-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-27" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnInserir&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;inserir()&quot;</span><span class="dt">&gt;</span>Inserir<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb55-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-28" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnAlterar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;alterar()&quot;</span><span class="dt">&gt;</span>Alterar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb55-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-29" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnRemover&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;remover()&quot;</span><span class="dt">&gt;</span>Remover<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb55-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-30" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb55-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-31" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb55-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-32" tabindex="-1"></a></span>
<span id="cb55-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-33" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb55-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-34" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb55-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-35" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pesquisa&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Digite nome ou CPF&quot;</span><span class="ot"> style</span><span class="op">=</span><span class="st">&quot;flex:1&quot;</span><span class="dt">&gt;</span></span>
<span id="cb55-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-36" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnPesquisar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;pesquisar()&quot;</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb55-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-37" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;listar()&quot;</span><span class="dt">&gt;</span>Listar tudo<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb55-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-38" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb55-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-39" tabindex="-1"></a></span>
<span id="cb55-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-40" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb55-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-41" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb55-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-42" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb55-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-43" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb55-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-44" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb55-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-45" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb55-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-46" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb55-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-47" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabela&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb55-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-48" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb55-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-49" tabindex="-1"></a></span>
<span id="cb55-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-50" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb55-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-51" tabindex="-1"></a><span class="kw">const</span> API <span class="op">=</span> <span class="st">&#39;http://localhost:5000/pessoas&#39;</span><span class="op">;</span></span>
<span id="cb55-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-52" tabindex="-1"></a></span>
<span id="cb55-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-53" tabindex="-1"></a><span class="co">/* ---------- Helpers ---------- */</span></span>
<span id="cb55-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-54" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setBusy</span>(busy) {</span>
<span id="cb55-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-55" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> [<span class="st">&#39;btnInserir&#39;</span><span class="op">,</span><span class="st">&#39;btnAlterar&#39;</span><span class="op">,</span><span class="st">&#39;btnRemover&#39;</span><span class="op">,</span><span class="st">&#39;btnPesquisar&#39;</span>]) {</span>
<span id="cb55-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-56" tabindex="-1"></a>    <span class="kw">const</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">;</span></span>
<span id="cb55-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-57" tabindex="-1"></a>    <span class="cf">if</span> (el) el<span class="op">.</span><span class="at">disabled</span> <span class="op">=</span> busy<span class="op">;</span></span>
<span id="cb55-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-58" tabindex="-1"></a>  }</span>
<span id="cb55-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-59" tabindex="-1"></a>}</span>
<span id="cb55-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-60" tabindex="-1"></a></span>
<span id="cb55-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-61" tabindex="-1"></a><span class="kw">function</span> <span class="fu">validaCampos</span>() {</span>
<span id="cb55-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-62" tabindex="-1"></a>  <span class="kw">const</span> campos <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span><span class="op">,</span><span class="st">&#39;nome&#39;</span><span class="op">,</span><span class="st">&#39;endereco&#39;</span><span class="op">,</span><span class="st">&#39;data_nascimento&#39;</span>]<span class="op">;</span></span>
<span id="cb55-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-63" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> campos) {</span>
<span id="cb55-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-64" tabindex="-1"></a>    <span class="kw">const</span> valor <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb55-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-65" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>valor) {</span>
<span id="cb55-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-66" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="vs">`O campo &quot;</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">&quot; n√£o pode ficar em branco.`</span>)<span class="op">;</span></span>
<span id="cb55-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-67" tabindex="-1"></a>      <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb55-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-68" tabindex="-1"></a>    }</span>
<span id="cb55-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-69" tabindex="-1"></a>  }</span>
<span id="cb55-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-70" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb55-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-71" tabindex="-1"></a>}</span>
<span id="cb55-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-72" tabindex="-1"></a></span>
<span id="cb55-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-73" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getFotoBase64</span>() {</span>
<span id="cb55-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-74" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;foto&#39;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb55-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-75" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>file) <span class="cf">return</span> <span class="bu">Promise</span><span class="op">.</span><span class="fu">resolve</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></span>
<span id="cb55-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-76" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span>reject)<span class="kw">=&gt;</span>{</span>
<span id="cb55-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-77" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb55-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-78" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb55-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-79" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb55-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-80" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb55-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-81" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb55-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-82" tabindex="-1"></a>}</span>
<span id="cb55-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-83" tabindex="-1"></a></span>
<span id="cb55-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-84" tabindex="-1"></a><span class="kw">function</span> <span class="fu">coletaDados</span>(base64Foto){</span>
<span id="cb55-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-85" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb55-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-86" tabindex="-1"></a>    <span class="dt">cpf</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb55-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-87" tabindex="-1"></a>    <span class="dt">nome</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb55-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-88" tabindex="-1"></a>    <span class="dt">endereco</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb55-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-89" tabindex="-1"></a>    <span class="dt">data_nascimento</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">,</span> <span class="co">// YYYY-MM-DD</span></span>
<span id="cb55-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-90" tabindex="-1"></a>    <span class="dt">foto</span><span class="op">:</span> base64Foto <span class="op">||</span> <span class="st">&#39;&#39;</span></span>
<span id="cb55-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-91" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb55-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-92" tabindex="-1"></a>}</span>
<span id="cb55-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-93" tabindex="-1"></a></span>
<span id="cb55-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-94" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">readJsonSafe</span>(res) {</span>
<span id="cb55-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-95" tabindex="-1"></a>  <span class="kw">const</span> ct <span class="op">=</span> res<span class="op">.</span><span class="at">headers</span><span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;content-type&#39;</span>) <span class="op">||</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb55-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-96" tabindex="-1"></a>  <span class="cf">if</span> (ct<span class="op">.</span><span class="fu">includes</span>(<span class="st">&#39;application/json&#39;</span>)) {</span>
<span id="cb55-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-97" tabindex="-1"></a>    <span class="cf">try</span> { <span class="cf">return</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span> } <span class="cf">catch</span> { <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span> }</span>
<span id="cb55-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-98" tabindex="-1"></a>  }</span>
<span id="cb55-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-99" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb55-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-100" tabindex="-1"></a>}</span>
<span id="cb55-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-101" tabindex="-1"></a></span>
<span id="cb55-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-102" tabindex="-1"></a><span class="co">/* ---------- CRUD ---------- */</span></span>
<span id="cb55-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-103" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">inserir</span>() {</span>
<span id="cb55-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-104" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb55-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-105" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb55-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-106" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb55-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-107" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb55-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-108" tabindex="-1"></a>    <span class="kw">const</span> pessoa <span class="op">=</span> <span class="fu">coletaDados</span>(base64)<span class="op">;</span></span>
<span id="cb55-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-109" tabindex="-1"></a></span>
<span id="cb55-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-110" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API<span class="op">,</span> {</span>
<span id="cb55-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-111" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></span>
<span id="cb55-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-112" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb55-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-113" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(pessoa)</span>
<span id="cb55-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-114" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb55-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-115" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb55-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-116" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb55-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-117" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Inserido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb55-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-118" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb55-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-119" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;formPessoa&#39;</span>)<span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb55-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-120" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb55-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-121" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb55-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-122" tabindex="-1"></a>    }</span>
<span id="cb55-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-123" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb55-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-124" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao inserir: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb55-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-125" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb55-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-126" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb55-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-127" tabindex="-1"></a>  }</span>
<span id="cb55-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-128" tabindex="-1"></a>}</span>
<span id="cb55-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-129" tabindex="-1"></a></span>
<span id="cb55-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-130" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">alterar</span>() {</span>
<span id="cb55-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-131" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb55-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-132" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb55-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-133" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb55-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-134" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb55-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-135" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb55-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-136" tabindex="-1"></a>    <span class="kw">const</span> novosDados <span class="op">=</span> <span class="fu">coletaDados</span>()<span class="op">;</span></span>
<span id="cb55-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-137" tabindex="-1"></a>    <span class="cf">if</span> (base64) novosDados<span class="op">.</span><span class="at">foto</span> <span class="op">=</span> base64<span class="op">;</span></span>
<span id="cb55-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-138" tabindex="-1"></a></span>
<span id="cb55-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-139" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {</span>
<span id="cb55-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-140" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></span>
<span id="cb55-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-141" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb55-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-142" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(novosDados)</span>
<span id="cb55-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-143" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb55-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-144" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb55-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-145" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb55-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-146" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Alterado com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb55-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-147" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb55-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-148" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb55-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-149" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb55-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-150" tabindex="-1"></a>    }</span>
<span id="cb55-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-151" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb55-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-152" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao alterar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb55-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-153" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb55-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-154" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb55-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-155" tabindex="-1"></a>  }</span>
<span id="cb55-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-156" tabindex="-1"></a>}</span>
<span id="cb55-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-157" tabindex="-1"></a></span>
<span id="cb55-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-158" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">remover</span>() {</span>
<span id="cb55-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-159" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb55-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-160" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>cpf) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Informe o CPF para remover.&#39;</span>)<span class="op">;</span></span>
<span id="cb55-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-161" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">confirm</span>(<span class="st">&#39;Confirma a exclus√£o?&#39;</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb55-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-162" tabindex="-1"></a></span>
<span id="cb55-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-163" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb55-164"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-164" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb55-165"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-165" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {<span class="dt">method</span><span class="op">:</span><span class="st">&#39;DELETE&#39;</span>})<span class="op">;</span></span>
<span id="cb55-166"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-166" tabindex="-1"></a>    <span class="co">// 204 =&gt; sem corpo; n√£o tente parsear JSON aqui</span></span>
<span id="cb55-167"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-167" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">status</span> <span class="op">===</span> <span class="dv">204</span>) {</span>
<span id="cb55-168"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-168" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb55-169"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-169" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb55-170"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-170" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
<span id="cb55-171"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-171" tabindex="-1"></a>    }</span>
<span id="cb55-172"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-172" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb55-173"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-173" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb55-174"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-174" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb55-175"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-175" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb55-176"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-176" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb55-177"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-177" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb55-178"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-178" tabindex="-1"></a>    }</span>
<span id="cb55-179"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-179" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb55-180"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-180" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao remover: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb55-181"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-181" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb55-182"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-182" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb55-183"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-183" tabindex="-1"></a>  }</span>
<span id="cb55-184"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-184" tabindex="-1"></a>}</span>
<span id="cb55-185"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-185" tabindex="-1"></a></span>
<span id="cb55-186"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-186" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">pesquisar</span>() {</span>
<span id="cb55-187"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-187" tabindex="-1"></a>  <span class="kw">const</span> termo <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;pesquisa&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb55-188"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-188" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb55-189"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-189" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb55-190"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-190" tabindex="-1"></a>    <span class="kw">const</span> url <span class="op">=</span> termo <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(termo)<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API<span class="op">;</span></span>
<span id="cb55-191"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-191" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb55-192"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-192" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb55-193"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-193" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb55-194"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-194" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb55-195"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-195" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb55-196"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-196" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb55-197"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-197" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb55-198"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-198" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb55-199"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-199" tabindex="-1"></a>  }</span>
<span id="cb55-200"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-200" tabindex="-1"></a>}</span>
<span id="cb55-201"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-201" tabindex="-1"></a></span>
<span id="cb55-202"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-202" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">listar</span>() {</span>
<span id="cb55-203"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-203" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb55-204"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-204" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb55-205"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-205" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API)<span class="op">;</span></span>
<span id="cb55-206"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-206" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb55-207"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-207" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb55-208"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-208" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb55-209"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-209" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb55-210"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-210" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb55-211"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-211" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb55-212"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-212" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb55-213"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-213" tabindex="-1"></a>  }</span>
<span id="cb55-214"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-214" tabindex="-1"></a>}</span>
<span id="cb55-215"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-215" tabindex="-1"></a></span>
<span id="cb55-216"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-216" tabindex="-1"></a><span class="co">/* ---------- UI ---------- */</span></span>
<span id="cb55-217"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-217" tabindex="-1"></a><span class="kw">function</span> <span class="fu">preencheTabela</span>(lista){</span>
<span id="cb55-218"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-218" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;tabela&#39;</span>)<span class="op">;</span></span>
<span id="cb55-219"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-219" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb55-220"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-220" tabindex="-1"></a>  (lista <span class="op">||</span> [])<span class="op">.</span><span class="fu">forEach</span>(p<span class="kw">=&gt;</span>{</span>
<span id="cb55-221"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-221" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;tr&#39;</span>)<span class="op">;</span></span>
<span id="cb55-222"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-222" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb55-223"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-223" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb55-224"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-224" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img class=&quot;thumb&quot; src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb55-225"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-225" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb55-226"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-226" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb55-227"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-227" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">data_nascimento</span><span class="sc">}</span><span class="vs">&lt;/td&gt;`</span><span class="op">;</span></span>
<span id="cb55-228"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-228" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb55-229"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-229" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">cpf</span><span class="op">;</span></span>
<span id="cb55-230"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-230" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">nome</span><span class="op">;</span></span>
<span id="cb55-231"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-231" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">endereco</span><span class="op">;</span></span>
<span id="cb55-232"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-232" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">data_nascimento</span><span class="op">;</span></span>
<span id="cb55-233"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-233" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb55-234"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-234" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb55-235"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-235" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb55-236"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-236" tabindex="-1"></a>}</span>
<span id="cb55-237"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-237" tabindex="-1"></a></span>
<span id="cb55-238"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-238" tabindex="-1"></a><span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb55-239"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-239" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb55-240"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-240" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb55-241"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb55-241" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
</div>
<div id="resultado-final" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Resultado final:<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#resultado-final" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="servidor-de-aplica√ß√£o-python-restful-rodando" class="section level4 hasAnchor" number="7.5.1.1">
<h4><span class="header-section-number">7.5.1.1</span> Servidor de aplica√ß√£o Python ‚ÄúRestful‚Äù rodando<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#servidor-de-aplica%C3%A7%C3%A3o-python-restful-rodando" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="images/2025-09-01/10-servidor_rodando.jpg" /></p>
</div>
<div id="cliente-html-javascript-p√°gina-est√°tica-aberta-no-navegador" class="section level4 hasAnchor" number="7.5.1.2">
<h4><span class="header-section-number">7.5.1.2</span> Cliente HTML + Javascript ( p√°gina EST√ÅTICA ) aberta no navegador<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cliente-html-javascript-p%C3%A1gina-est%C3%A1tica-aberta-no-navegador" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="passo-1---preencher-dados-no-formul√°rio-do-cliente" class="section level5 hasAnchor" number="7.5.1.2.1">
<h5><span class="header-section-number">7.5.1.2.1</span> Passo 1 - Preencher dados no formul√°rio do cliente<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#passo-1---preencher-dados-no-formul%C3%A1rio-do-cliente" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Vamos inserir dados de exemplo no ‚Äúcliente WEB‚Äù abaixo</p>
<p><img src="images/2025-09-01/11-Cliente_Vazio.jpg" /></p>
</div>
<div id="passo-2---pressionar-o-bot√£o-inserir" class="section level5 hasAnchor" number="7.5.1.2.2">
<h5><span class="header-section-number">7.5.1.2.2</span> Passo 2 - Pressionar o Bot√£o INSERIR<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#passo-2---pressionar-o-bot%C3%A3o-inserir" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="images/2025-09-01/11-Cliente_Vazio-02.jpg" /></p>
<p>OBS: Na tela do servidor, √© poss√≠vel verificar as opera√ß√µes HTTP Equivalentes ao SQL que foram executadas entre o Servidor e o Cliente</p>
<p><img src="images/2025-09-01/10-servidor_rodando-01.jpg" /></p>
</div>
<div id="passo-3---verificar-se-o-dbgrid-do-cliente-espelhando-a-linha-da-tabela-pessoas-no-esquema-pessoasdb-do-sqbg-mysql" class="section level5 hasAnchor" number="7.5.1.2.3">
<h5><span class="header-section-number">7.5.1.2.3</span> Passo 3 - Verificar se o ‚ÄúDBGRID‚Äù do cliente ‚Äúespelhando‚Äù a linha da tabela ‚Äúpessoas‚Äù no esquema ‚Äúpessoasdb‚Äù do SQBG MySQL<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#passo-3---verificar-se-o-dbgrid-do-cliente-espelhando-a-linha-da-tabela-pessoas-no-esquema-pessoasdb-do-sqbg-mysql" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="images/2025-09-01/11-Cliente_03-Preenchido.jpg" /></p>
</div>
<div id="passo-4---verificar-na-tabela-pessoas-a-linha-que-o-cliente-preencheu-atrav√©s-da-api-da-aplica√ß√£o-clienteservidor" class="section level5 hasAnchor" number="7.5.1.2.4">
<h5><span class="header-section-number">7.5.1.2.4</span> Passo 4 - Verificar na tabela pessoas a linha que o cliente preencheu atrav√©s da API da aplica√ß√£o cliente/servidor<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#passo-4---verificar-na-tabela-pessoas-a-linha-que-o-cliente-preencheu-atrav%C3%A9s-da-api-da-aplica%C3%A7%C3%A3o-clienteservidor" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="images/2025-09-01/12-Dados_no_SGBD.jpg" /></p>
</div>
</div>
</div>
</div>
<div id="feito-1" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Feito<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#feito-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
<div id="exerc√≠cios-2" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Exerc√≠cios<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exerc%C3%ADcios-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="section-6" class="section level4 unnumbered hasAnchor">
<h4>01/09/2025<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#section-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="professor-migu√©l-suares-6" class="section level4 unnumbered hasAnchor">
<h4>Professor Migu√©l Suares<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#professor-migu%C3%A9l-suares-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="banco-de-dados-utilizado-nos-exemplos-de-aplica√ß√µes-abaixo" class="section level3 hasAnchor" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> Banco de Dados utilizado nos exemplos de aplica√ß√µes abaixo<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#banco-de-dados-utilizado-nos-exemplos-de-aplica%C3%A7%C3%B5es-abaixo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Crie o banco de dados abaixo em um servidor mysql 8 ou superior na sua m√°quina antes de testar os exemplos abaixo:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb56-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-1" tabindex="-1"></a><span class="co">-- 1) CRIAR BANCO (ajuste o nome se quiser)</span></span>
<span id="cb56-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-2" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">DATABASE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> pessoasdb</span>
<span id="cb56-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-3" tabindex="-1"></a>  <span class="dt">CHARACTER</span> <span class="kw">SET</span> utf8mb4</span>
<span id="cb56-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-4" tabindex="-1"></a>  COLLATE utf8mb4_0900_ai_ci;</span>
<span id="cb56-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-5" tabindex="-1"></a></span>
<span id="cb56-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-6" tabindex="-1"></a><span class="kw">USE</span> pessoasdb;</span>
<span id="cb56-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-7" tabindex="-1"></a></span>
<span id="cb56-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-8" tabindex="-1"></a><span class="co">-- 2) (OPCIONAL) CRIAR USU√ÅRIO LOCAL E CONCEDER PERMISS√ïES</span></span>
<span id="cb56-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-9" tabindex="-1"></a><span class="co">--    Troque &#39;MinhaSenhaForte&#39; por uma senha segura</span></span>
<span id="cb56-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-10" tabindex="-1"></a><span class="kw">CREATE</span> <span class="fu">USER</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> <span class="st">&#39;pessoas_user&#39;</span>@<span class="st">&#39;localhost&#39;</span> <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> <span class="st">&#39;MinhaSenhaForte&#39;</span>;</span>
<span id="cb56-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-11" tabindex="-1"></a><span class="kw">GRANT</span> <span class="kw">ALL</span> <span class="kw">PRIVILEGES</span> <span class="kw">ON</span> pessoasdb.<span class="op">*</span> <span class="kw">TO</span> <span class="st">&#39;pessoas_user&#39;</span>@<span class="st">&#39;localhost&#39;</span>;</span>
<span id="cb56-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-12" tabindex="-1"></a><span class="kw">FLUSH</span> <span class="kw">PRIVILEGES</span>;</span>
<span id="cb56-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-13" tabindex="-1"></a></span>
<span id="cb56-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-14" tabindex="-1"></a><span class="co">-- 3) TABELA &#39;pessoas&#39; COMPAT√çVEL COM O MODELO SQLAlchemy</span></span>
<span id="cb56-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-15" tabindex="-1"></a><span class="co">--    - cpf: chave prim√°ria (String(14))</span></span>
<span id="cb56-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-16" tabindex="-1"></a><span class="co">--    - nome, endereco, foto: TEXT</span></span>
<span id="cb56-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-17" tabindex="-1"></a><span class="co">--    - data_nascimento: DATE</span></span>
<span id="cb56-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-18" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> pessoas (</span>
<span id="cb56-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-19" tabindex="-1"></a>  cpf             <span class="dt">VARCHAR</span>(<span class="dv">14</span>)  <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb56-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-20" tabindex="-1"></a>  nome            TEXT         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb56-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-21" tabindex="-1"></a>  endereco        TEXT         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb56-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-22" tabindex="-1"></a>  data_nascimento <span class="dt">DATE</span>         <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb56-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-23" tabindex="-1"></a>  foto            TEXT         <span class="kw">NULL</span>,</span>
<span id="cb56-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-24" tabindex="-1"></a>  <span class="kw">PRIMARY</span> <span class="kw">KEY</span> (cpf)</span>
<span id="cb56-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-25" tabindex="-1"></a>) ENGINE<span class="op">=</span>InnoDB <span class="kw">DEFAULT</span> CHARSET<span class="op">=</span>utf8mb4 COLLATE<span class="op">=</span>utf8mb4_0900_ai_ci;</span>
<span id="cb56-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-26" tabindex="-1"></a></span>
<span id="cb56-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-27" tabindex="-1"></a><span class="co">-- 4) (OPCIONAL) √çNDICES PARA BUSCA</span></span>
<span id="cb56-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-28" tabindex="-1"></a><span class="co">-- Seu endpoint usa LIKE/ILIKE em nome e cpf; cpf j√° √© PK.</span></span>
<span id="cb56-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-29" tabindex="-1"></a><span class="co">-- Para acelerar buscas por nome com LIKE, crie um √≠ndice por prefixo.</span></span>
<span id="cb56-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-30" tabindex="-1"></a><span class="co">-- OBS: √≠ndices em TEXT precisam de comprimento; 128 costuma ser um bom compromisso.</span></span>
<span id="cb56-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb56-31" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> idx_pessoas_nome_prefix <span class="kw">ON</span> pessoas (nome(<span class="dv">128</span>));</span></code></pre></div>
</div>
</div>
<div id="exemplo-01" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Exemplo 01<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-01" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>servidor SUPABASE ‚Ä¶. a fazer</p>
</div>
<div id="exemplo-02---servidor-de-aplica√ß√£o-python" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> Exemplo 02 - SERVIDOR DE APLICA√á√ÉO PYTHON<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-02---servidor-de-aplica%C3%A7%C3%A3o-python" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/clipboard-3666283714.png" /></p>
<p>Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</p>
<p>A interface do Cliente √© feita em HTML5</p>
<p>A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</p>
<p>CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</p>
<p>O servidor Restful √© feito em linguagem PYTHON</p>
<p>OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb57-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb57-1" tabindex="-1"></a>python <span class="at">-m</span> pip install -<span class="at">-user</span> -<span class="at">-upgrade</span> flask flask<span class="at">-cors</span> sqlalchemy psycopg2<span class="at">-binary</span></span></code></pre></div>
<div id="servidor-python" class="section level3 hasAnchor" number="7.9.1">
<h3><span class="header-section-number">7.9.1</span> Servidor python<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#servidor-python" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-1" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb58-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-2" tabindex="-1"></a><span class="im">from</span> flask_cors <span class="im">import</span> CORS</span>
<span id="cb58-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-3" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine, Column, String, Date, Text</span>
<span id="cb58-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-4" tabindex="-1"></a><span class="im">from</span> sqlalchemy.ext.declarative <span class="im">import</span> declarative_base</span>
<span id="cb58-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-5" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker</span>
<span id="cb58-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-7" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-8" tabindex="-1"></a><span class="co"># Configura√ß√£o do Flask e CORS</span></span>
<span id="cb58-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-9" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-10" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb58-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-11" tabindex="-1"></a>CORS(app)</span>
<span id="cb58-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-12" tabindex="-1"></a></span>
<span id="cb58-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-13" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-14" tabindex="-1"></a><span class="co"># Configura√ß√£o do banco PostgreSQL</span></span>
<span id="cb58-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-15" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-16" tabindex="-1"></a>DATABASE_URL <span class="op">=</span> <span class="st">&quot;postgresql://postgres:MinhaSuperSenha@db.pbbtfwmydxmxdibmtbqq.supabase.co:5432/postgres&quot;</span></span>
<span id="cb58-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-17" tabindex="-1"></a></span>
<span id="cb58-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-18" tabindex="-1"></a>engine <span class="op">=</span> create_engine(DATABASE_URL)</span>
<span id="cb58-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-19" tabindex="-1"></a>SessionLocal <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine)</span>
<span id="cb58-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-20" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb58-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-21" tabindex="-1"></a></span>
<span id="cb58-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-22" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-23" tabindex="-1"></a><span class="co"># Modelo Pessoa</span></span>
<span id="cb58-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-24" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-25" tabindex="-1"></a><span class="kw">class</span> Pessoa(Base):</span>
<span id="cb58-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-26" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">&quot;pessoas&quot;</span></span>
<span id="cb58-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-27" tabindex="-1"></a>    cpf <span class="op">=</span> Column(String(<span class="dv">14</span>), primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-28" tabindex="-1"></a>    nome <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb58-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-29" tabindex="-1"></a>    endereco <span class="op">=</span> Column(Text, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb58-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-30" tabindex="-1"></a>    data_nascimento <span class="op">=</span> Column(Date, nullable<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb58-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-31" tabindex="-1"></a>    foto <span class="op">=</span> Column(Text)  <span class="co"># Base64 ou URL</span></span>
<span id="cb58-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-32" tabindex="-1"></a></span>
<span id="cb58-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-33" tabindex="-1"></a><span class="co"># Cria a tabela se n√£o existir</span></span>
<span id="cb58-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-34" tabindex="-1"></a>Base.metadata.create_all(engine)</span>
<span id="cb58-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-35" tabindex="-1"></a></span>
<span id="cb58-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-36" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-37" tabindex="-1"></a><span class="co"># CRUD</span></span>
<span id="cb58-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-38" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-39" tabindex="-1"></a></span>
<span id="cb58-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-40" tabindex="-1"></a><span class="co"># Listar todas as pessoas ou pesquisar por termo</span></span>
<span id="cb58-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-41" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb58-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-42" tabindex="-1"></a><span class="kw">def</span> listar():</span>
<span id="cb58-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-43" tabindex="-1"></a>    termo <span class="op">=</span> request.args.get(<span class="st">&#39;q&#39;</span>, <span class="st">&#39;&#39;</span>).lower()</span>
<span id="cb58-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-44" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb58-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-45" tabindex="-1"></a>    <span class="cf">if</span> termo:</span>
<span id="cb58-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-46" tabindex="-1"></a>        pessoas <span class="op">=</span> session.query(Pessoa).<span class="bu">filter</span>(</span>
<span id="cb58-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-47" tabindex="-1"></a>            (Pessoa.nome.ilike(<span class="ss">f&quot;%</span><span class="sc">{</span>termo<span class="sc">}</span><span class="ss">%&quot;</span>)) <span class="op">|</span> (Pessoa.cpf.ilike(<span class="ss">f&quot;%</span><span class="sc">{</span>termo<span class="sc">}</span><span class="ss">%&quot;</span>))</span>
<span id="cb58-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-48" tabindex="-1"></a>        ).<span class="bu">all</span>()</span>
<span id="cb58-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-49" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb58-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-50" tabindex="-1"></a>        pessoas <span class="op">=</span> session.query(Pessoa).<span class="bu">all</span>()</span>
<span id="cb58-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-51" tabindex="-1"></a>    session.close()</span>
<span id="cb58-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-52" tabindex="-1"></a>    <span class="cf">return</span> jsonify([{</span>
<span id="cb58-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-53" tabindex="-1"></a>        <span class="st">&quot;cpf&quot;</span>: p.cpf,</span>
<span id="cb58-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-54" tabindex="-1"></a>        <span class="st">&quot;nome&quot;</span>: p.nome,</span>
<span id="cb58-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-55" tabindex="-1"></a>        <span class="st">&quot;endereco&quot;</span>: p.endereco,</span>
<span id="cb58-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-56" tabindex="-1"></a>        <span class="st">&quot;data_nascimento&quot;</span>: p.data_nascimento.isoformat(),</span>
<span id="cb58-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-57" tabindex="-1"></a>        <span class="st">&quot;foto&quot;</span>: p.foto</span>
<span id="cb58-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-58" tabindex="-1"></a>    } <span class="cf">for</span> p <span class="kw">in</span> pessoas])</span>
<span id="cb58-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-59" tabindex="-1"></a></span>
<span id="cb58-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-60" tabindex="-1"></a><span class="co"># Inserir nova pessoa</span></span>
<span id="cb58-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-61" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;POST&#39;</span>])</span>
<span id="cb58-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-62" tabindex="-1"></a><span class="kw">def</span> inserir():</span>
<span id="cb58-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-63" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json()</span>
<span id="cb58-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-64" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb58-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-65" tabindex="-1"></a>    <span class="cf">if</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>]).first():</span>
<span id="cb58-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-66" tabindex="-1"></a>        session.close()</span>
<span id="cb58-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-67" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF j√° cadastrado&quot;</span>}), <span class="dv">400</span></span>
<span id="cb58-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-68" tabindex="-1"></a>    pessoa <span class="op">=</span> Pessoa(</span>
<span id="cb58-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-69" tabindex="-1"></a>        cpf<span class="op">=</span>dados[<span class="st">&#39;cpf&#39;</span>],</span>
<span id="cb58-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-70" tabindex="-1"></a>        nome<span class="op">=</span>dados[<span class="st">&#39;nome&#39;</span>],</span>
<span id="cb58-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-71" tabindex="-1"></a>        endereco<span class="op">=</span>dados[<span class="st">&#39;endereco&#39;</span>],</span>
<span id="cb58-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-72" tabindex="-1"></a>        data_nascimento<span class="op">=</span>dados[<span class="st">&#39;data_nascimento&#39;</span>],</span>
<span id="cb58-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-73" tabindex="-1"></a>        foto<span class="op">=</span>dados.get(<span class="st">&#39;foto&#39;</span>)</span>
<span id="cb58-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-74" tabindex="-1"></a>    )</span>
<span id="cb58-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-75" tabindex="-1"></a>    session.add(pessoa)</span>
<span id="cb58-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-76" tabindex="-1"></a>    session.commit()</span>
<span id="cb58-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-77" tabindex="-1"></a>    session.close()</span>
<span id="cb58-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-78" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&quot;message&quot;</span>: <span class="st">&quot;Inserido com sucesso&quot;</span>}), <span class="dv">201</span></span>
<span id="cb58-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-79" tabindex="-1"></a></span>
<span id="cb58-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-80" tabindex="-1"></a><span class="co"># Alterar pessoa</span></span>
<span id="cb58-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-81" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;PUT&#39;</span>])</span>
<span id="cb58-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-82" tabindex="-1"></a><span class="kw">def</span> alterar(cpf):</span>
<span id="cb58-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-83" tabindex="-1"></a>    dados <span class="op">=</span> request.get_json()</span>
<span id="cb58-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-84" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb58-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-85" tabindex="-1"></a>    pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb58-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-86" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb58-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-87" tabindex="-1"></a>        session.close()</span>
<span id="cb58-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-88" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb58-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-89" tabindex="-1"></a>    pessoa.nome <span class="op">=</span> dados.get(<span class="st">&#39;nome&#39;</span>, pessoa.nome)</span>
<span id="cb58-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-90" tabindex="-1"></a>    pessoa.endereco <span class="op">=</span> dados.get(<span class="st">&#39;endereco&#39;</span>, pessoa.endereco)</span>
<span id="cb58-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-91" tabindex="-1"></a>    pessoa.data_nascimento <span class="op">=</span> dados.get(<span class="st">&#39;data_nascimento&#39;</span>, pessoa.data_nascimento)</span>
<span id="cb58-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-92" tabindex="-1"></a>    pessoa.foto <span class="op">=</span> dados.get(<span class="st">&#39;foto&#39;</span>, pessoa.foto)</span>
<span id="cb58-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-93" tabindex="-1"></a>    session.commit()</span>
<span id="cb58-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-94" tabindex="-1"></a>    session.close()</span>
<span id="cb58-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-95" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&quot;message&quot;</span>: <span class="st">&quot;Alterado com sucesso&quot;</span>})</span>
<span id="cb58-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-96" tabindex="-1"></a></span>
<span id="cb58-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-97" tabindex="-1"></a><span class="co"># Remover pessoa</span></span>
<span id="cb58-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-98" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;DELETE&#39;</span>])</span>
<span id="cb58-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-99" tabindex="-1"></a><span class="kw">def</span> remover(cpf):</span>
<span id="cb58-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-100" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb58-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-101" tabindex="-1"></a>    pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb58-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-102" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb58-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-103" tabindex="-1"></a>        session.close()</span>
<span id="cb58-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-104" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb58-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-105" tabindex="-1"></a>    session.delete(pessoa)</span>
<span id="cb58-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-106" tabindex="-1"></a>    session.commit()</span>
<span id="cb58-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-107" tabindex="-1"></a>    session.close()</span>
<span id="cb58-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-108" tabindex="-1"></a>    <span class="cf">return</span> jsonify({<span class="st">&quot;message&quot;</span>: <span class="st">&quot;Removido com sucesso&quot;</span>})</span>
<span id="cb58-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-109" tabindex="-1"></a></span>
<span id="cb58-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-110" tabindex="-1"></a><span class="co"># Buscar pessoa por CPF</span></span>
<span id="cb58-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-111" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">&#39;/pessoas/&lt;cpf&gt;&#39;</span>, methods<span class="op">=</span>[<span class="st">&#39;GET&#39;</span>])</span>
<span id="cb58-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-112" tabindex="-1"></a><span class="kw">def</span> buscar(cpf):</span>
<span id="cb58-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-113" tabindex="-1"></a>    session <span class="op">=</span> SessionLocal()</span>
<span id="cb58-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-114" tabindex="-1"></a>    pessoa <span class="op">=</span> session.query(Pessoa).filter_by(cpf<span class="op">=</span>cpf).first()</span>
<span id="cb58-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-115" tabindex="-1"></a>    session.close()</span>
<span id="cb58-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-116" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pessoa:</span>
<span id="cb58-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-117" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">&quot;error&quot;</span>: <span class="st">&quot;CPF n√£o encontrado&quot;</span>}), <span class="dv">404</span></span>
<span id="cb58-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-118" tabindex="-1"></a>    <span class="cf">return</span> jsonify({</span>
<span id="cb58-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-119" tabindex="-1"></a>        <span class="st">&quot;cpf&quot;</span>: pessoa.cpf,</span>
<span id="cb58-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-120" tabindex="-1"></a>        <span class="st">&quot;nome&quot;</span>: pessoa.nome,</span>
<span id="cb58-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-121" tabindex="-1"></a>        <span class="st">&quot;endereco&quot;</span>: pessoa.endereco,</span>
<span id="cb58-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-122" tabindex="-1"></a>        <span class="st">&quot;data_nascimento&quot;</span>: pessoa.data_nascimento.isoformat(),</span>
<span id="cb58-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-123" tabindex="-1"></a>        <span class="st">&quot;foto&quot;</span>: pessoa.foto</span>
<span id="cb58-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-124" tabindex="-1"></a>    })</span>
<span id="cb58-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-125" tabindex="-1"></a></span>
<span id="cb58-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-126" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-127" tabindex="-1"></a><span class="co"># Inicia o servidor</span></span>
<span id="cb58-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-128" tabindex="-1"></a><span class="co"># ------------------------------</span></span>
<span id="cb58-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-129" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</span>
<span id="cb58-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb58-130" tabindex="-1"></a>    app.run(debug<span class="op">=</span><span class="va">True</span>, port<span class="op">=</span><span class="dv">5000</span>)</span></code></pre></div>
<p>servidor estar√° rodando na porta 5000 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:5000/pessoas" class="uri">http://localhost:5000/pessoas</a> sem senha</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb59-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb59-1" tabindex="-1"></a>http<span class="in">:</span><span class="er">//localhost:5000/pessoas</span></span></code></pre></div>
</div>
<div id="cliente-html-conex√£o-restful" class="section level3 hasAnchor" number="7.9.2">
<h3><span class="header-section-number">7.9.2</span> Cliente HTML (conex√£o Restful)<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cliente-html-conex%C3%A3o-restful" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>crie o arquivo index.html e abra-o no navegador</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb60-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb60-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb60-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb60-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb60-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas - Flask/MySQL<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb60-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb60-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">system-ui</span><span class="op">,</span> <span class="dv">-apple-system</span><span class="op">,</span> <span class="dv">Segoe UI</span><span class="op">,</span> <span class="dv">Roboto</span><span class="op">,</span> <span class="dv">Arial</span><span class="op">;</span> <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">980</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">24</span><span class="dt">px</span> <span class="bu">auto</span><span class="op">;</span> }</span>
<span id="cb60-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-8" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb60-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-9" tabindex="-1"></a>  button { <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin-right</span><span class="ch">:</span> <span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span> <span class="dv">12</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb60-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-10" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span><span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span><span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb60-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-11" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span><span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb60-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-12" tabindex="-1"></a>  img<span class="fu">.thumb</span> { <span class="kw">width</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">height</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">object-fit</span><span class="ch">:</span><span class="dv">cover</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span><span class="dv">4</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb60-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-13" tabindex="-1"></a>  <span class="fu">.row</span> { <span class="kw">display</span><span class="ch">:</span><span class="dv">flex</span><span class="op">;</span> <span class="kw">gap</span><span class="ch">:</span><span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">align-items</span><span class="ch">:</span><span class="dv">center</span><span class="op">;</span> <span class="kw">flex-wrap</span><span class="ch">:</span><span class="dv">wrap</span><span class="op">;</span> }</span>
<span id="cb60-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-14" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb60-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-15" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb60-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-16" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb60-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-17" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas (Flask/MySQL)<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb60-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-18" tabindex="-1"></a></span>
<span id="cb60-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-19" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;formPessoa&quot;</span><span class="dt">&gt;</span></span>
<span id="cb60-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-20" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF (chave prim√°ria): <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb60-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-21" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb60-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-22" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb60-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-23" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data Nasc.: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;data_nascimento&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb60-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-24" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="ot"> accept</span><span class="op">=</span><span class="st">&quot;image/*&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb60-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-25" tabindex="-1"></a></span>
<span id="cb60-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-26" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb60-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-27" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnInserir&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;inserir()&quot;</span><span class="dt">&gt;</span>Inserir<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb60-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-28" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnAlterar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;alterar()&quot;</span><span class="dt">&gt;</span>Alterar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb60-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-29" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnRemover&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;remover()&quot;</span><span class="dt">&gt;</span>Remover<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb60-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-30" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb60-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-31" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb60-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-32" tabindex="-1"></a></span>
<span id="cb60-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-33" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb60-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-34" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="dt">&gt;</span></span>
<span id="cb60-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-35" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pesquisa&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Digite nome ou CPF&quot;</span><span class="ot"> style</span><span class="op">=</span><span class="st">&quot;flex:1&quot;</span><span class="dt">&gt;</span></span>
<span id="cb60-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-36" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnPesquisar&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;pesquisar()&quot;</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb60-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-37" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;listar()&quot;</span><span class="dt">&gt;</span>Listar tudo<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb60-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-38" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb60-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-39" tabindex="-1"></a></span>
<span id="cb60-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-40" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb60-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-41" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb60-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-42" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb60-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-43" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb60-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-44" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb60-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-45" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb60-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-46" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb60-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-47" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabela&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb60-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-48" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb60-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-49" tabindex="-1"></a></span>
<span id="cb60-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-50" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb60-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-51" tabindex="-1"></a><span class="kw">const</span> API <span class="op">=</span> <span class="st">&#39;http://localhost:5000/pessoas&#39;</span><span class="op">;</span></span>
<span id="cb60-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-52" tabindex="-1"></a></span>
<span id="cb60-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-53" tabindex="-1"></a><span class="co">/* ---------- Helpers ---------- */</span></span>
<span id="cb60-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-54" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setBusy</span>(busy) {</span>
<span id="cb60-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-55" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> [<span class="st">&#39;btnInserir&#39;</span><span class="op">,</span><span class="st">&#39;btnAlterar&#39;</span><span class="op">,</span><span class="st">&#39;btnRemover&#39;</span><span class="op">,</span><span class="st">&#39;btnPesquisar&#39;</span>]) {</span>
<span id="cb60-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-56" tabindex="-1"></a>    <span class="kw">const</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">;</span></span>
<span id="cb60-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-57" tabindex="-1"></a>    <span class="cf">if</span> (el) el<span class="op">.</span><span class="at">disabled</span> <span class="op">=</span> busy<span class="op">;</span></span>
<span id="cb60-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-58" tabindex="-1"></a>  }</span>
<span id="cb60-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-59" tabindex="-1"></a>}</span>
<span id="cb60-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-60" tabindex="-1"></a></span>
<span id="cb60-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-61" tabindex="-1"></a><span class="kw">function</span> <span class="fu">validaCampos</span>() {</span>
<span id="cb60-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-62" tabindex="-1"></a>  <span class="kw">const</span> campos <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span><span class="op">,</span><span class="st">&#39;nome&#39;</span><span class="op">,</span><span class="st">&#39;endereco&#39;</span><span class="op">,</span><span class="st">&#39;data_nascimento&#39;</span>]<span class="op">;</span></span>
<span id="cb60-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-63" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> campos) {</span>
<span id="cb60-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-64" tabindex="-1"></a>    <span class="kw">const</span> valor <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb60-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-65" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>valor) {</span>
<span id="cb60-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-66" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="vs">`O campo &quot;</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">&quot; n√£o pode ficar em branco.`</span>)<span class="op">;</span></span>
<span id="cb60-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-67" tabindex="-1"></a>      <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb60-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-68" tabindex="-1"></a>    }</span>
<span id="cb60-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-69" tabindex="-1"></a>  }</span>
<span id="cb60-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-70" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb60-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-71" tabindex="-1"></a>}</span>
<span id="cb60-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-72" tabindex="-1"></a></span>
<span id="cb60-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-73" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getFotoBase64</span>() {</span>
<span id="cb60-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-74" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;foto&#39;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb60-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-75" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>file) <span class="cf">return</span> <span class="bu">Promise</span><span class="op">.</span><span class="fu">resolve</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></span>
<span id="cb60-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-76" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span>reject)<span class="kw">=&gt;</span>{</span>
<span id="cb60-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-77" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb60-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-78" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb60-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-79" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb60-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-80" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb60-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-81" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb60-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-82" tabindex="-1"></a>}</span>
<span id="cb60-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-83" tabindex="-1"></a></span>
<span id="cb60-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-84" tabindex="-1"></a><span class="kw">function</span> <span class="fu">coletaDados</span>(base64Foto){</span>
<span id="cb60-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-85" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb60-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-86" tabindex="-1"></a>    <span class="dt">cpf</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb60-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-87" tabindex="-1"></a>    <span class="dt">nome</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb60-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-88" tabindex="-1"></a>    <span class="dt">endereco</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb60-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-89" tabindex="-1"></a>    <span class="dt">data_nascimento</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">,</span> <span class="co">// YYYY-MM-DD</span></span>
<span id="cb60-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-90" tabindex="-1"></a>    <span class="dt">foto</span><span class="op">:</span> base64Foto <span class="op">||</span> <span class="st">&#39;&#39;</span></span>
<span id="cb60-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-91" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb60-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-92" tabindex="-1"></a>}</span>
<span id="cb60-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-93" tabindex="-1"></a></span>
<span id="cb60-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-94" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">readJsonSafe</span>(res) {</span>
<span id="cb60-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-95" tabindex="-1"></a>  <span class="kw">const</span> ct <span class="op">=</span> res<span class="op">.</span><span class="at">headers</span><span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;content-type&#39;</span>) <span class="op">||</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb60-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-96" tabindex="-1"></a>  <span class="cf">if</span> (ct<span class="op">.</span><span class="fu">includes</span>(<span class="st">&#39;application/json&#39;</span>)) {</span>
<span id="cb60-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-97" tabindex="-1"></a>    <span class="cf">try</span> { <span class="cf">return</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span> } <span class="cf">catch</span> { <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span> }</span>
<span id="cb60-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-98" tabindex="-1"></a>  }</span>
<span id="cb60-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-99" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb60-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-100" tabindex="-1"></a>}</span>
<span id="cb60-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-101" tabindex="-1"></a></span>
<span id="cb60-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-102" tabindex="-1"></a><span class="co">/* ---------- CRUD ---------- */</span></span>
<span id="cb60-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-103" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">inserir</span>() {</span>
<span id="cb60-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-104" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb60-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-105" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb60-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-106" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb60-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-107" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb60-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-108" tabindex="-1"></a>    <span class="kw">const</span> pessoa <span class="op">=</span> <span class="fu">coletaDados</span>(base64)<span class="op">;</span></span>
<span id="cb60-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-109" tabindex="-1"></a></span>
<span id="cb60-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-110" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API<span class="op">,</span> {</span>
<span id="cb60-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-111" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></span>
<span id="cb60-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-112" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb60-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-113" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(pessoa)</span>
<span id="cb60-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-114" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb60-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-115" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb60-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-116" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb60-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-117" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Inserido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb60-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-118" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb60-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-119" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;formPessoa&#39;</span>)<span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb60-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-120" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb60-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-121" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb60-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-122" tabindex="-1"></a>    }</span>
<span id="cb60-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-123" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb60-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-124" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao inserir: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb60-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-125" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb60-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-126" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb60-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-127" tabindex="-1"></a>  }</span>
<span id="cb60-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-128" tabindex="-1"></a>}</span>
<span id="cb60-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-129" tabindex="-1"></a></span>
<span id="cb60-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-130" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">alterar</span>() {</span>
<span id="cb60-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-131" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb60-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-132" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb60-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-133" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb60-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-134" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb60-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-135" tabindex="-1"></a>    <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb60-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-136" tabindex="-1"></a>    <span class="kw">const</span> novosDados <span class="op">=</span> <span class="fu">coletaDados</span>()<span class="op">;</span></span>
<span id="cb60-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-137" tabindex="-1"></a>    <span class="cf">if</span> (base64) novosDados<span class="op">.</span><span class="at">foto</span> <span class="op">=</span> base64<span class="op">;</span></span>
<span id="cb60-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-138" tabindex="-1"></a></span>
<span id="cb60-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-139" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {</span>
<span id="cb60-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-140" tabindex="-1"></a>      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></span>
<span id="cb60-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-141" tabindex="-1"></a>      <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb60-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-142" tabindex="-1"></a>      <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(novosDados)</span>
<span id="cb60-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-143" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb60-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-144" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb60-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-145" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb60-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-146" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Alterado com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb60-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-147" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb60-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-148" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb60-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-149" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb60-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-150" tabindex="-1"></a>    }</span>
<span id="cb60-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-151" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb60-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-152" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao alterar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb60-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-153" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb60-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-154" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb60-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-155" tabindex="-1"></a>  }</span>
<span id="cb60-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-156" tabindex="-1"></a>}</span>
<span id="cb60-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-157" tabindex="-1"></a></span>
<span id="cb60-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-158" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">remover</span>() {</span>
<span id="cb60-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-159" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb60-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-160" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>cpf) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Informe o CPF para remover.&#39;</span>)<span class="op">;</span></span>
<span id="cb60-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-161" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">confirm</span>(<span class="st">&#39;Confirma a exclus√£o?&#39;</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb60-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-162" tabindex="-1"></a></span>
<span id="cb60-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-163" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb60-164"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-164" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb60-165"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-165" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {<span class="dt">method</span><span class="op">:</span><span class="st">&#39;DELETE&#39;</span>})<span class="op">;</span></span>
<span id="cb60-166"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-166" tabindex="-1"></a>    <span class="co">// 204 =&gt; sem corpo; n√£o tente parsear JSON aqui</span></span>
<span id="cb60-167"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-167" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">status</span> <span class="op">===</span> <span class="dv">204</span>) {</span>
<span id="cb60-168"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-168" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb60-169"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-169" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb60-170"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-170" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
<span id="cb60-171"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-171" tabindex="-1"></a>    }</span>
<span id="cb60-172"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-172" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb60-173"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-173" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb60-174"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-174" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb60-175"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-175" tabindex="-1"></a>      <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb60-176"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-176" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb60-177"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-177" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb60-178"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-178" tabindex="-1"></a>    }</span>
<span id="cb60-179"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-179" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb60-180"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-180" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao remover: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb60-181"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-181" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb60-182"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-182" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb60-183"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-183" tabindex="-1"></a>  }</span>
<span id="cb60-184"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-184" tabindex="-1"></a>}</span>
<span id="cb60-185"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-185" tabindex="-1"></a></span>
<span id="cb60-186"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-186" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">pesquisar</span>() {</span>
<span id="cb60-187"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-187" tabindex="-1"></a>  <span class="kw">const</span> termo <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;pesquisa&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb60-188"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-188" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb60-189"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-189" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb60-190"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-190" tabindex="-1"></a>    <span class="kw">const</span> url <span class="op">=</span> termo <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(termo)<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API<span class="op">;</span></span>
<span id="cb60-191"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-191" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb60-192"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-192" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb60-193"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-193" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb60-194"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-194" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb60-195"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-195" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb60-196"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-196" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha na pesquisa: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb60-197"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-197" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb60-198"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-198" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb60-199"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-199" tabindex="-1"></a>  }</span>
<span id="cb60-200"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-200" tabindex="-1"></a>}</span>
<span id="cb60-201"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-201" tabindex="-1"></a></span>
<span id="cb60-202"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-202" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">listar</span>() {</span>
<span id="cb60-203"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-203" tabindex="-1"></a>  <span class="fu">setBusy</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb60-204"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-204" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb60-205"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-205" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API)<span class="op">;</span></span>
<span id="cb60-206"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-206" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> <span class="fu">readJsonSafe</span>(res)<span class="op">;</span></span>
<span id="cb60-207"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-207" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>res<span class="op">.</span><span class="at">ok</span>) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> (data<span class="op">?.</span><span class="at">error</span> <span class="op">||</span> res<span class="op">.</span><span class="at">statusText</span>))<span class="op">;</span></span>
<span id="cb60-208"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-208" tabindex="-1"></a>    <span class="fu">preencheTabela</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(data) <span class="op">?</span> data <span class="op">:</span> (data<span class="op">?.</span><span class="at">items</span> <span class="op">??</span> []))<span class="op">;</span></span>
<span id="cb60-209"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-209" tabindex="-1"></a>  } <span class="cf">catch</span> (e) {</span>
<span id="cb60-210"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-210" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&#39;Falha ao listar: &#39;</span> <span class="op">+</span> e<span class="op">.</span><span class="at">message</span>)<span class="op">;</span></span>
<span id="cb60-211"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-211" tabindex="-1"></a>  } <span class="cf">finally</span> {</span>
<span id="cb60-212"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-212" tabindex="-1"></a>    <span class="fu">setBusy</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb60-213"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-213" tabindex="-1"></a>  }</span>
<span id="cb60-214"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-214" tabindex="-1"></a>}</span>
<span id="cb60-215"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-215" tabindex="-1"></a></span>
<span id="cb60-216"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-216" tabindex="-1"></a><span class="co">/* ---------- UI ---------- */</span></span>
<span id="cb60-217"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-217" tabindex="-1"></a><span class="kw">function</span> <span class="fu">preencheTabela</span>(lista){</span>
<span id="cb60-218"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-218" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;tabela&#39;</span>)<span class="op">;</span></span>
<span id="cb60-219"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-219" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb60-220"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-220" tabindex="-1"></a>  (lista <span class="op">||</span> [])<span class="op">.</span><span class="fu">forEach</span>(p<span class="kw">=&gt;</span>{</span>
<span id="cb60-221"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-221" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;tr&#39;</span>)<span class="op">;</span></span>
<span id="cb60-222"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-222" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb60-223"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-223" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb60-224"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-224" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img class=&quot;thumb&quot; src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb60-225"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-225" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb60-226"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-226" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb60-227"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-227" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">data_nascimento</span><span class="sc">}</span><span class="vs">&lt;/td&gt;`</span><span class="op">;</span></span>
<span id="cb60-228"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-228" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb60-229"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-229" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">cpf</span><span class="op">;</span></span>
<span id="cb60-230"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-230" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">nome</span><span class="op">;</span></span>
<span id="cb60-231"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-231" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">endereco</span><span class="op">;</span></span>
<span id="cb60-232"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-232" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">data_nascimento</span><span class="op">;</span></span>
<span id="cb60-233"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-233" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb60-234"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-234" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb60-235"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-235" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb60-236"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-236" tabindex="-1"></a>}</span>
<span id="cb60-237"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-237" tabindex="-1"></a></span>
<span id="cb60-238"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-238" tabindex="-1"></a><span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb60-239"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-239" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb60-240"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-240" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb60-241"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb60-241" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="exemplo-03---servidor-de-aplica√ß√£o-perl" class="section level2 hasAnchor" number="7.10">
<h2><span class="header-section-number">7.10</span> Exemplo 03 - SERVIDOR DE APLICA√á√ÉO PERL<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-03---servidor-de-aplica%C3%A7%C3%A3o-perl" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/clipboard-2372699820.png" /></p>
<p>Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</p>
<p>A interface do Cliente √© feita em HTML5</p>
<p>A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</p>
<p>CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</p>
<p>O servidor Restful √© feito em linguagem PERL</p>
<p>OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb61-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb61-1" tabindex="-1"></a>cpan Dancer2 DBI DBD::Pg JSON</span></code></pre></div>
<div id="servidor-perl" class="section level3 hasAnchor" number="7.10.1">
<h3><span class="header-section-number">7.10.1</span> Servidor Perl<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#servidor-perl" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode perl"><code class="sourceCode perl"><span id="cb62-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-1" tabindex="-1"></a><span class="kw">#!/usr/bin/perl</span></span>
<span id="cb62-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-2" tabindex="-1"></a><span class="fu">use</span> <span class="kw">strict</span>;</span>
<span id="cb62-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-3" tabindex="-1"></a><span class="fu">use</span> <span class="kw">warnings</span>;</span>
<span id="cb62-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-4" tabindex="-1"></a><span class="fu">use</span> Dancer2;</span>
<span id="cb62-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-5" tabindex="-1"></a><span class="fu">use</span> DBI;</span>
<span id="cb62-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-6" tabindex="-1"></a><span class="fu">use</span> JSON;</span>
<span id="cb62-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-7" tabindex="-1"></a></span>
<span id="cb62-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-8" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb62-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-9" tabindex="-1"></a><span class="co"># Configura√ß√µes do banco</span></span>
<span id="cb62-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-10" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb62-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-11" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$dsn</span> = <span class="ot">&quot;</span><span class="st">dbi:Pg:dbname=postgres;host=db.pbbtfwmydxmxdibmtbqq.supabase.co;port=5432</span><span class="ot">&quot;</span>;</span>
<span id="cb62-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-12" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$db_user</span> = <span class="ot">&quot;</span><span class="st">postgres</span><span class="ot">&quot;</span>;</span>
<span id="cb62-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-13" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$db_pass</span> = <span class="ot">&quot;</span><span class="st">MinhaSuperSenha</span><span class="ot">&quot;</span>;</span>
<span id="cb62-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-14" tabindex="-1"></a></span>
<span id="cb62-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-15" tabindex="-1"></a><span class="kw">my</span> <span class="dt">$dbh</span> = DBI-&gt;<span class="fu">connect</span>(<span class="dt">$dsn</span>, <span class="dt">$db_user</span>, <span class="dt">$db_pass</span>, { RaiseError =&gt; <span class="dv">1</span>, AutoCommit =&gt; <span class="dv">1</span> });</span>
<span id="cb62-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-16" tabindex="-1"></a></span>
<span id="cb62-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-17" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb62-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-18" tabindex="-1"></a><span class="co"># Helpers</span></span>
<span id="cb62-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-19" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb62-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-20" tabindex="-1"></a><span class="kw">sub </span><span class="fu">json_response</span> {</span>
<span id="cb62-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-21" tabindex="-1"></a>    content_type <span class="ot">&#39;</span><span class="ss">application/json</span><span class="ot">&#39;</span>;</span>
<span id="cb62-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-22" tabindex="-1"></a>    <span class="kw">return</span> encode_json(<span class="wa">$_</span>[<span class="dv">0</span>]);</span>
<span id="cb62-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-23" tabindex="-1"></a>}</span>
<span id="cb62-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-24" tabindex="-1"></a></span>
<span id="cb62-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-25" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb62-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-26" tabindex="-1"></a><span class="co"># Endpoints REST</span></span>
<span id="cb62-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-27" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb62-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-28" tabindex="-1"></a></span>
<span id="cb62-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-29" tabindex="-1"></a><span class="co"># Listar todas ou pesquisar</span></span>
<span id="cb62-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-30" tabindex="-1"></a>get <span class="ot">&#39;</span><span class="ss">/pessoas</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb62-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-31" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$q</span> = query_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">q</span><span class="ot">&#39;</span>) || <span class="ot">&#39;&#39;</span>;</span>
<span id="cb62-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-32" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sql</span> = <span class="ot">&quot;</span><span class="st">SELECT * FROM pessoas</span><span class="ot">&quot;</span>;</span>
<span id="cb62-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-33" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">@params</span>;</span>
<span id="cb62-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-34" tabindex="-1"></a>    <span class="kw">if</span> (<span class="dt">$q</span> <span class="ot">ne</span> <span class="ot">&#39;&#39;</span>) {</span>
<span id="cb62-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-35" tabindex="-1"></a>        <span class="dt">$sql</span> .= <span class="ot">&quot;</span><span class="st"> WHERE cpf ILIKE ? OR nome ILIKE ?</span><span class="ot">&quot;</span>;</span>
<span id="cb62-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-36" tabindex="-1"></a>        <span class="dt">@params</span> = (<span class="ot">&quot;</span><span class="st">%</span><span class="dt">$q</span><span class="st">%</span><span class="ot">&quot;</span>, <span class="ot">&quot;</span><span class="st">%</span><span class="dt">$q</span><span class="st">%</span><span class="ot">&quot;</span>);</span>
<span id="cb62-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-37" tabindex="-1"></a>    }</span>
<span id="cb62-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-38" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="dt">$sql</span>);</span>
<span id="cb62-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-39" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">@params</span>);</span>
<span id="cb62-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-40" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">@rows</span>;</span>
<span id="cb62-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-41" tabindex="-1"></a>    <span class="kw">while</span> (<span class="kw">my</span> <span class="dt">$row</span> = <span class="dt">$sth</span>-&gt;<span class="dt">fetchrow_hashref</span>) {</span>
<span id="cb62-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-42" tabindex="-1"></a>        <span class="fu">push</span> <span class="dt">@rows</span>, <span class="dt">$row</span>;</span>
<span id="cb62-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-43" tabindex="-1"></a>    }</span>
<span id="cb62-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-44" tabindex="-1"></a>    <span class="kw">return</span> json_response(\<span class="dt">@rows</span>);</span>
<span id="cb62-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-45" tabindex="-1"></a>};</span>
<span id="cb62-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-46" tabindex="-1"></a></span>
<span id="cb62-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-47" tabindex="-1"></a><span class="co"># Buscar por CPF</span></span>
<span id="cb62-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-48" tabindex="-1"></a>get <span class="ot">&#39;</span><span class="ss">/pessoas/:cpf</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb62-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-49" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = route_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">cpf</span><span class="ot">&#39;</span>);</span>
<span id="cb62-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-50" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">SELECT * FROM pessoas WHERE cpf = ?</span><span class="ot">&quot;</span>);</span>
<span id="cb62-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-51" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb62-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-52" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$row</span> = <span class="dt">$sth</span>-&gt;<span class="dt">fetchrow_hashref</span>;</span>
<span id="cb62-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-53" tabindex="-1"></a>    <span class="kw">return</span> <span class="dt">$row</span> ? json_response(<span class="dt">$row</span>) : status(<span class="dv">404</span>)-&gt;json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF n√£o encontrado</span><span class="ot">&quot;</span> });</span>
<span id="cb62-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-54" tabindex="-1"></a>};</span>
<span id="cb62-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-55" tabindex="-1"></a></span>
<span id="cb62-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-56" tabindex="-1"></a><span class="co"># Inserir</span></span>
<span id="cb62-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-57" tabindex="-1"></a>post <span class="ot">&#39;</span><span class="ss">/pessoas</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb62-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-58" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$data</span> = from_json(request-&gt;body);</span>
<span id="cb62-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-59" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = <span class="dt">$data</span>-&gt;{cpf};</span>
<span id="cb62-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-60" tabindex="-1"></a>    <span class="co"># Verifica se existe</span></span>
<span id="cb62-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-61" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$check</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">SELECT cpf FROM pessoas WHERE cpf = ?</span><span class="ot">&quot;</span>);</span>
<span id="cb62-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-62" tabindex="-1"></a>    <span class="dt">$check</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb62-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-63" tabindex="-1"></a>    <span class="kw">if</span> (<span class="dt">$check</span>-&gt;<span class="dt">fetchrow_array</span>) {</span>
<span id="cb62-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-64" tabindex="-1"></a>        status(<span class="dv">400</span>);</span>
<span id="cb62-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-65" tabindex="-1"></a>        <span class="kw">return</span> json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF j√° cadastrado</span><span class="ot">&quot;</span> });</span>
<span id="cb62-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-66" tabindex="-1"></a>    }</span>
<span id="cb62-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-67" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">INSERT INTO pessoas (cpf, nome, endereco, data_nascimento, foto) VALUES (?, ?, ?, ?, ?)</span><span class="ot">&quot;</span>);</span>
<span id="cb62-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-68" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>, <span class="dt">$data</span>-&gt;{nome}, <span class="dt">$data</span>-&gt;{endereco}, <span class="dt">$data</span>-&gt;{data_nascimento}, <span class="dt">$data</span>-&gt;{foto});</span>
<span id="cb62-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-69" tabindex="-1"></a>    status(<span class="dv">201</span>);</span>
<span id="cb62-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-70" tabindex="-1"></a>    <span class="kw">return</span> json_response({ message =&gt; <span class="ot">&quot;</span><span class="st">Inserido com sucesso</span><span class="ot">&quot;</span> });</span>
<span id="cb62-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-71" tabindex="-1"></a>};</span>
<span id="cb62-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-72" tabindex="-1"></a></span>
<span id="cb62-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-73" tabindex="-1"></a><span class="co"># Alterar</span></span>
<span id="cb62-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-74" tabindex="-1"></a>put <span class="ot">&#39;</span><span class="ss">/pessoas/:cpf</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb62-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-75" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = route_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">cpf</span><span class="ot">&#39;</span>);</span>
<span id="cb62-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-76" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$data</span> = from_json(request-&gt;body);</span>
<span id="cb62-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-77" tabindex="-1"></a>    <span class="co"># Verifica se existe</span></span>
<span id="cb62-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-78" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$check</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">SELECT cpf FROM pessoas WHERE cpf = ?</span><span class="ot">&quot;</span>);</span>
<span id="cb62-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-79" tabindex="-1"></a>    <span class="dt">$check</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb62-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-80" tabindex="-1"></a>    <span class="kw">unless</span> (<span class="dt">$check</span>-&gt;<span class="dt">fetchrow_array</span>) {</span>
<span id="cb62-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-81" tabindex="-1"></a>        status(<span class="dv">404</span>);</span>
<span id="cb62-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-82" tabindex="-1"></a>        <span class="kw">return</span> json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF n√£o encontrado</span><span class="ot">&quot;</span> });</span>
<span id="cb62-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-83" tabindex="-1"></a>    }</span>
<span id="cb62-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-84" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">UPDATE pessoas SET nome=?, endereco=?, data_nascimento=?, foto=? WHERE cpf=?</span><span class="ot">&quot;</span>);</span>
<span id="cb62-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-85" tabindex="-1"></a>    <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$data</span>-&gt;{nome}, <span class="dt">$data</span>-&gt;{endereco}, <span class="dt">$data</span>-&gt;{data_nascimento}, <span class="dt">$data</span>-&gt;{foto}, <span class="dt">$cpf</span>);</span>
<span id="cb62-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-86" tabindex="-1"></a>    <span class="kw">return</span> json_response({ message =&gt; <span class="ot">&quot;</span><span class="st">Alterado com sucesso</span><span class="ot">&quot;</span> });</span>
<span id="cb62-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-87" tabindex="-1"></a>};</span>
<span id="cb62-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-88" tabindex="-1"></a></span>
<span id="cb62-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-89" tabindex="-1"></a><span class="co"># Remover</span></span>
<span id="cb62-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-90" tabindex="-1"></a>del <span class="ot">&#39;</span><span class="ss">/pessoas/:cpf</span><span class="ot">&#39;</span> =&gt; <span class="kw">sub </span>{</span>
<span id="cb62-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-91" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$cpf</span> = route_parameters-&gt;get(<span class="ot">&#39;</span><span class="ss">cpf</span><span class="ot">&#39;</span>);</span>
<span id="cb62-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-92" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$sth</span> = <span class="dt">$dbh</span>-&gt;<span class="dt">prepare</span>(<span class="ot">&quot;</span><span class="st">DELETE FROM pessoas WHERE cpf=?</span><span class="ot">&quot;</span>);</span>
<span id="cb62-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-93" tabindex="-1"></a>    <span class="kw">my</span> <span class="dt">$rows</span> = <span class="dt">$sth</span>-&gt;<span class="dt">execute</span>(<span class="dt">$cpf</span>);</span>
<span id="cb62-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-94" tabindex="-1"></a>    <span class="kw">if</span> (<span class="dt">$rows</span>) {</span>
<span id="cb62-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-95" tabindex="-1"></a>        <span class="kw">return</span> json_response({ message =&gt; <span class="ot">&quot;</span><span class="st">Removido com sucesso</span><span class="ot">&quot;</span> });</span>
<span id="cb62-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-96" tabindex="-1"></a>    } <span class="kw">else</span> {</span>
<span id="cb62-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-97" tabindex="-1"></a>        status(<span class="dv">404</span>);</span>
<span id="cb62-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-98" tabindex="-1"></a>        <span class="kw">return</span> json_response({ error =&gt; <span class="ot">&quot;</span><span class="st">CPF n√£o encontrado</span><span class="ot">&quot;</span> });</span>
<span id="cb62-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-99" tabindex="-1"></a>    }</span>
<span id="cb62-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-100" tabindex="-1"></a>};</span>
<span id="cb62-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-101" tabindex="-1"></a></span>
<span id="cb62-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-102" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb62-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-103" tabindex="-1"></a><span class="co"># Inicializa o servidor</span></span>
<span id="cb62-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-104" tabindex="-1"></a><span class="co"># -----------------------------</span></span>
<span id="cb62-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-105" tabindex="-1"></a>set port =&gt; <span class="dv">5000</span>;</span>
<span id="cb62-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-106" tabindex="-1"></a>set serializer =&gt; <span class="ot">&#39;</span><span class="ss">JSON</span><span class="ot">&#39;</span>;</span>
<span id="cb62-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-107" tabindex="-1"></a></span>
<span id="cb62-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb62-108" tabindex="-1"></a>start;</span></code></pre></div>
<p>servidor estar√° rodando na porta 5000 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:5000/pessoas" class="uri">http://localhost:5000/pessoas</a> sem senha</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb63-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb63-1" tabindex="-1"></a>http<span class="in">:</span><span class="er">//localhost:5000/pessoas</span></span></code></pre></div>
</div>
<div id="cliente-html-conex√£o-restful-1" class="section level3 hasAnchor" number="7.10.2">
<h3><span class="header-section-number">7.10.2</span> Cliente HTML (conex√£o Restful)<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cliente-html-conex%C3%A3o-restful-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>crie o arquivo index.html e abra-o no navegador</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb64-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb64-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb64-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb64-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb64-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas - Perl/PostgreSQL<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb64-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb64-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">sans-serif</span><span class="op">;</span> <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">800</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span> <span class="bu">auto</span><span class="op">;</span> }</span>
<span id="cb64-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-8" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb64-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-9" tabindex="-1"></a>  button { <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> <span class="kw">margin-right</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb64-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-10" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span><span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span><span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb64-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-11" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span><span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ccc</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span><span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span><span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb64-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-12" tabindex="-1"></a>  img<span class="fu">.thumb</span> { <span class="kw">width</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">height</span><span class="ch">:</span><span class="dv">60</span><span class="dt">px</span><span class="op">;</span> <span class="kw">object-fit</span><span class="ch">:</span><span class="dv">cover</span><span class="op">;</span> <span class="kw">border-radius</span><span class="ch">:</span><span class="dv">4</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb64-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-13" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb64-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-14" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb64-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-15" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb64-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-16" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas (Perl/PostgreSQL)<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb64-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-17" tabindex="-1"></a></span>
<span id="cb64-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-18" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;formPessoa&quot;</span><span class="dt">&gt;</span></span>
<span id="cb64-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-19" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF (chave prim√°ria): <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb64-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-20" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb64-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-21" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb64-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-22" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data Nasc.: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;data_nascimento&quot;</span><span class="ot"> required</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb64-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-23" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto: <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="ot"> accept</span><span class="op">=</span><span class="st">&quot;image/*&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb64-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-24" tabindex="-1"></a></span>
<span id="cb64-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-25" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;inserir()&quot;</span><span class="dt">&gt;</span>Inserir<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb64-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-26" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;alterar()&quot;</span><span class="dt">&gt;</span>Alterar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb64-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-27" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;remover()&quot;</span><span class="dt">&gt;</span>Remover<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb64-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-28" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb64-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-29" tabindex="-1"></a></span>
<span id="cb64-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-30" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb64-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-31" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pesquisa&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Digite nome ou CPF&quot;</span><span class="dt">&gt;</span></span>
<span id="cb64-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-32" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;button&quot;</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;pesquisar()&quot;</span><span class="dt">&gt;</span>Pesquisar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb64-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-33" tabindex="-1"></a></span>
<span id="cb64-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-34" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb64-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-35" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb64-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-36" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb64-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-37" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb64-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-38" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb64-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-39" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb64-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-40" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb64-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-41" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabela&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb64-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-42" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb64-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-43" tabindex="-1"></a></span>
<span id="cb64-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-44" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb64-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-45" tabindex="-1"></a><span class="kw">const</span> API <span class="op">=</span> <span class="st">&#39;http://localhost:5000/pessoas&#39;</span><span class="op">;</span></span>
<span id="cb64-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-46" tabindex="-1"></a></span>
<span id="cb64-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-47" tabindex="-1"></a><span class="co">/* ---------- Fun√ß√µes utilit√°rias ---------- */</span></span>
<span id="cb64-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-48" tabindex="-1"></a><span class="kw">function</span> <span class="fu">validaCampos</span>() {</span>
<span id="cb64-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-49" tabindex="-1"></a>  <span class="kw">const</span> campos <span class="op">=</span> [<span class="st">&#39;cpf&#39;</span><span class="op">,</span><span class="st">&#39;nome&#39;</span><span class="op">,</span><span class="st">&#39;endereco&#39;</span><span class="op">,</span><span class="st">&#39;data_nascimento&#39;</span>]<span class="op">;</span></span>
<span id="cb64-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-50" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> id <span class="kw">of</span> campos) {</span>
<span id="cb64-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-51" tabindex="-1"></a>    <span class="kw">const</span> valor <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(id)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb64-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-52" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>valor) {</span>
<span id="cb64-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-53" tabindex="-1"></a>      <span class="fu">alert</span>(<span class="vs">`O campo &quot;</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">&quot; n√£o pode ficar em branco.`</span>)<span class="op">;</span></span>
<span id="cb64-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-54" tabindex="-1"></a>      <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb64-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-55" tabindex="-1"></a>    }</span>
<span id="cb64-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-56" tabindex="-1"></a>  }</span>
<span id="cb64-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-57" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb64-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-58" tabindex="-1"></a>}</span>
<span id="cb64-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-59" tabindex="-1"></a></span>
<span id="cb64-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-60" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getFotoBase64</span>() {</span>
<span id="cb64-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-61" tabindex="-1"></a>  <span class="kw">const</span> file <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;foto&#39;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb64-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-62" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>file) <span class="cf">return</span> <span class="bu">Promise</span><span class="op">.</span><span class="fu">resolve</span>(<span class="st">&#39;&#39;</span>)<span class="op">;</span></span>
<span id="cb64-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-63" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span>reject)<span class="kw">=&gt;</span>{</span>
<span id="cb64-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-64" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb64-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-65" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb64-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-66" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb64-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-67" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb64-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-68" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb64-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-69" tabindex="-1"></a>}</span>
<span id="cb64-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-70" tabindex="-1"></a></span>
<span id="cb64-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-71" tabindex="-1"></a><span class="kw">function</span> <span class="fu">coletaDados</span>(base64Foto){</span>
<span id="cb64-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-72" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb64-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-73" tabindex="-1"></a>    <span class="dt">cpf</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb64-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-74" tabindex="-1"></a>    <span class="dt">nome</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb64-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-75" tabindex="-1"></a>    <span class="dt">endereco</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">,</span></span>
<span id="cb64-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-76" tabindex="-1"></a>    <span class="dt">data_nascimento</span><span class="op">:</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">,</span></span>
<span id="cb64-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-77" tabindex="-1"></a>    <span class="dt">foto</span><span class="op">:</span> base64Foto <span class="op">||</span> <span class="st">&#39;&#39;</span></span>
<span id="cb64-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-78" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb64-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-79" tabindex="-1"></a>}</span>
<span id="cb64-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-80" tabindex="-1"></a></span>
<span id="cb64-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-81" tabindex="-1"></a><span class="co">/* ---------- CRUD ---------- */</span></span>
<span id="cb64-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-82" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">inserir</span>() {</span>
<span id="cb64-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-83" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb64-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-84" tabindex="-1"></a>  <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb64-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-85" tabindex="-1"></a>  <span class="kw">const</span> pessoa <span class="op">=</span> <span class="fu">coletaDados</span>(base64)<span class="op">;</span></span>
<span id="cb64-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-86" tabindex="-1"></a></span>
<span id="cb64-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-87" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API<span class="op">,</span> {</span>
<span id="cb64-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-88" tabindex="-1"></a>    <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></span>
<span id="cb64-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-89" tabindex="-1"></a>    <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb64-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-90" tabindex="-1"></a>    <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(pessoa)</span>
<span id="cb64-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-91" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb64-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-92" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb64-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-93" tabindex="-1"></a>  <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) <span class="fu">alert</span>(<span class="st">&#39;Inserido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb64-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-94" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">.</span><span class="at">error</span> <span class="op">||</span> <span class="st">&#39;&#39;</span>))<span class="op">;</span></span>
<span id="cb64-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-95" tabindex="-1"></a>  <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb64-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-96" tabindex="-1"></a>}</span>
<span id="cb64-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-97" tabindex="-1"></a></span>
<span id="cb64-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-98" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">alterar</span>() {</span>
<span id="cb64-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-99" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="fu">validaCampos</span>()) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb64-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-100" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb64-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-101" tabindex="-1"></a>  <span class="kw">const</span> base64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getFotoBase64</span>()<span class="op">;</span></span>
<span id="cb64-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-102" tabindex="-1"></a>  <span class="kw">const</span> novosDados <span class="op">=</span> <span class="fu">coletaDados</span>()<span class="op">;</span></span>
<span id="cb64-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-103" tabindex="-1"></a>  <span class="cf">if</span>(base64) novosDados<span class="op">.</span><span class="at">foto</span> <span class="op">=</span> base64<span class="op">;</span></span>
<span id="cb64-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-104" tabindex="-1"></a></span>
<span id="cb64-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-105" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {</span>
<span id="cb64-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-106" tabindex="-1"></a>    <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></span>
<span id="cb64-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-107" tabindex="-1"></a>    <span class="dt">headers</span><span class="op">:</span> {<span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span>}<span class="op">,</span></span>
<span id="cb64-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-108" tabindex="-1"></a>    <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(novosDados)</span>
<span id="cb64-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-109" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb64-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-110" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb64-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-111" tabindex="-1"></a>  <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) <span class="fu">alert</span>(<span class="st">&#39;Alterado com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb64-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-112" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">.</span><span class="at">error</span> <span class="op">||</span> <span class="st">&#39;&#39;</span>))<span class="op">;</span></span>
<span id="cb64-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-113" tabindex="-1"></a>  <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb64-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-114" tabindex="-1"></a>}</span>
<span id="cb64-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-115" tabindex="-1"></a></span>
<span id="cb64-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-116" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">remover</span>() {</span>
<span id="cb64-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-117" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb64-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-118" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>cpf) <span class="cf">return</span> <span class="fu">alert</span>(<span class="st">&#39;Informe o CPF para remover.&#39;</span>)<span class="op">;</span></span>
<span id="cb64-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-119" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">confirm</span>(<span class="st">&#39;Confirma a exclus√£o?&#39;</span>)){</span>
<span id="cb64-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-120" tabindex="-1"></a>    <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(cpf)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> {<span class="dt">method</span><span class="op">:</span><span class="st">&#39;DELETE&#39;</span>})<span class="op">;</span></span>
<span id="cb64-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-121" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb64-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-122" tabindex="-1"></a>    <span class="cf">if</span>(res<span class="op">.</span><span class="at">ok</span>) <span class="fu">alert</span>(<span class="st">&#39;Removido com sucesso!&#39;</span>)<span class="op">;</span></span>
<span id="cb64-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-123" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">alert</span>(<span class="st">&#39;Erro: &#39;</span> <span class="op">+</span> (data<span class="op">.</span><span class="at">error</span> <span class="op">||</span> <span class="st">&#39;&#39;</span>))<span class="op">;</span></span>
<span id="cb64-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-124" tabindex="-1"></a>    <span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb64-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-125" tabindex="-1"></a>  }</span>
<span id="cb64-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-126" tabindex="-1"></a>}</span>
<span id="cb64-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-127" tabindex="-1"></a></span>
<span id="cb64-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-128" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">pesquisar</span>() {</span>
<span id="cb64-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-129" tabindex="-1"></a>  <span class="kw">const</span> termo <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;pesquisa&#39;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb64-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-130" tabindex="-1"></a>  <span class="cf">if</span>(<span class="op">!</span>termo){ <span class="fu">listar</span>()<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb64-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-131" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(termo)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb64-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-132" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb64-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-133" tabindex="-1"></a>  <span class="fu">preencheTabela</span>(data)<span class="op">;</span></span>
<span id="cb64-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-134" tabindex="-1"></a>}</span>
<span id="cb64-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-135" tabindex="-1"></a></span>
<span id="cb64-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-136" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">listar</span>() {</span>
<span id="cb64-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-137" tabindex="-1"></a>  <span class="kw">const</span> res <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(API)<span class="op">;</span></span>
<span id="cb64-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-138" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> res<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb64-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-139" tabindex="-1"></a>  <span class="fu">preencheTabela</span>(data)<span class="op">;</span></span>
<span id="cb64-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-140" tabindex="-1"></a>}</span>
<span id="cb64-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-141" tabindex="-1"></a></span>
<span id="cb64-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-142" tabindex="-1"></a><span class="co">/* ---------- UI ---------- */</span></span>
<span id="cb64-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-143" tabindex="-1"></a><span class="kw">function</span> <span class="fu">preencheTabela</span>(lista){</span>
<span id="cb64-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-144" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;tabela&#39;</span>)<span class="op">;</span></span>
<span id="cb64-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-145" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb64-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-146" tabindex="-1"></a>  lista<span class="op">.</span><span class="fu">forEach</span>(p<span class="kw">=&gt;</span>{</span>
<span id="cb64-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-147" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&#39;tr&#39;</span>)<span class="op">;</span></span>
<span id="cb64-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-148" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb64-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-149" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb64-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-150" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img class=&quot;thumb&quot; src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&#39;&#39;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb64-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-151" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb64-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-152" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb64-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-153" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">data_nascimento</span><span class="sc">}</span><span class="vs">&lt;/td&gt;`</span><span class="op">;</span></span>
<span id="cb64-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-154" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb64-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-155" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;cpf&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">cpf</span><span class="op">;</span></span>
<span id="cb64-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-156" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;nome&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">nome</span><span class="op">;</span></span>
<span id="cb64-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-157" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;endereco&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">endereco</span><span class="op">;</span></span>
<span id="cb64-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-158" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;data_nascimento&#39;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> p<span class="op">.</span><span class="at">data_nascimento</span><span class="op">;</span></span>
<span id="cb64-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-159" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb64-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-160" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb64-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-161" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb64-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-162" tabindex="-1"></a>}</span>
<span id="cb64-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-163" tabindex="-1"></a></span>
<span id="cb64-164"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-164" tabindex="-1"></a><span class="fu">listar</span>()<span class="op">;</span></span>
<span id="cb64-165"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-165" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb64-166"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-166" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb64-167"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb64-167" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
</div>
</div>
<div id="exemplo-04---servidor-de-aplica√ß√£o-java" class="section level2 hasAnchor" number="7.11">
<h2><span class="header-section-number">7.11</span> Exemplo 04 - SERVIDOR DE APLICA√á√ÉO JAVA<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-04---servidor-de-aplica%C3%A7%C3%A3o-java" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/clipboard-3162947411.png" /></p>
<p>[ Vou refazer estes exemplo ]</p>
</div>
<div id="exemplo-05---servidor-de-aplica√ß√£o-c" class="section level2 hasAnchor" number="7.12">
<h2><span class="header-section-number">7.12</span> Exemplo 05 - SERVIDOR DE APLICA√á√ÉO C++<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#exemplo-05---servidor-de-aplica%C3%A7%C3%A3o-c" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/clipboard-2416235942.png" /></p>
<p>Neste exemplo, temos uma aplica√ß√£o cliente feita html e javascript</p>
<p>A interface do Cliente √© feita em HTML5</p>
<p>A conex√£o com o servidor √© feita pelo javascript incorporado no HTML:</p>
<p>CRUD no cliente √© feito peloa javascript utilizando metodologia Restful sobre protocolo HTTP 2.0</p>
<p>O servidor Restful √© feito em linguagem C++</p>
<p>A linguagem C++ precisa ser compilada.</p>
<p>PORTANTO O C√ìDIGO DO SERVIDOR PRECISAR√Å SER COMPILADO.</p>
<p>EM C++ VAMOS USAR BIBLIOTECAS EXTERNAS libpqxx e crow</p>
<p>OBS: N√ÉO TEMOS CONTROLE DE SESS√ÉO DE CLIENTE IMPLEMENTADO.</p>
<p>estrutura de diret√≥rios:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb65-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb65-1" tabindex="-1"></a>pessoas-rest-cpp/</span>
<span id="cb65-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb65-2" tabindex="-1"></a>‚îú‚îÄ CMakeLists<span class="fu">.txt</span></span>
<span id="cb65-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb65-3" tabindex="-1"></a>‚îú‚îÄ src/</span>
<span id="cb65-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb65-4" tabindex="-1"></a>‚îÇ   ‚îî‚îÄ main<span class="fu">.cpp</span></span>
<span id="cb65-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb65-5" tabindex="-1"></a>‚îî‚îÄ include/</span>
<span id="cb65-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb65-6" tabindex="-1"></a>    ‚îî‚îÄ crow_all<span class="fu">.h</span>        ‚Üê header √∫nico da biblioteca Crow</span></code></pre></div>
<div id="criando-o-arquivo-c-do-servidor" class="section level3 hasAnchor" number="7.12.1">
<h3><span class="header-section-number">7.12.1</span> Criando o arquivo C++ do servidor<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#criando-o-arquivo-c-do-servidor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb66-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;crow_all.h&quot;</span></span>
<span id="cb66-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-2" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;pqxx/pqxx&gt;</span></span>
<span id="cb66-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-3" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb66-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-4" tabindex="-1"></a></span>
<span id="cb66-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-5" tabindex="-1"></a><span class="at">const</span> <span class="bu">std::</span>string CONN_STR <span class="op">=</span></span>
<span id="cb66-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-6" tabindex="-1"></a>    <span class="st">&quot;postgresql://postgres:MinhaSuperSenha@db.pbbtfwmydxmxdibmtbqq.supabase.co:5432/postgres&quot;</span><span class="op">;</span></span>
<span id="cb66-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-7" tabindex="-1"></a></span>
<span id="cb66-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-8" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb66-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-9" tabindex="-1"></a>    crow<span class="op">::</span>SimpleApp app<span class="op">;</span></span>
<span id="cb66-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-10" tabindex="-1"></a></span>
<span id="cb66-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-11" tabindex="-1"></a>    <span class="co">// GET /pessoas</span></span>
<span id="cb66-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-12" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;GET&quot;</span><span class="op">_method)</span></span>
<span id="cb66-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-13" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;</span> req<span class="op">){</span></span>
<span id="cb66-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-14" tabindex="-1"></a>        pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb66-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-15" tabindex="-1"></a>        pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb66-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-16" tabindex="-1"></a>        <span class="bu">std::</span>string q <span class="op">=</span> req<span class="op">.</span>url_params<span class="op">.</span>get<span class="op">(</span><span class="st">&quot;q&quot;</span><span class="op">)</span> <span class="op">?</span> req<span class="op">.</span>url_params<span class="op">.</span>get<span class="op">(</span><span class="st">&quot;q&quot;</span><span class="op">)</span> <span class="op">:</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb66-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-17" tabindex="-1"></a>        pqxx<span class="op">::</span>result r<span class="op">;</span></span>
<span id="cb66-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-18" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>q<span class="op">.</span>empty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb66-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-19" tabindex="-1"></a>            r <span class="op">=</span> w<span class="op">.</span>exec_params<span class="op">(</span></span>
<span id="cb66-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-20" tabindex="-1"></a>                <span class="st">&quot;SELECT cpf,nome,endereco,data_nascimento,foto &quot;</span></span>
<span id="cb66-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-21" tabindex="-1"></a>                <span class="st">&quot;FROM pessoas WHERE lower(nome) LIKE lower(&#39;%&#39;||$1||&#39;%&#39;) OR cpf LIKE &#39;%&#39;||$1||&#39;%&#39;&quot;</span><span class="op">,</span></span>
<span id="cb66-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-22" tabindex="-1"></a>                q<span class="op">);</span></span>
<span id="cb66-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-23" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb66-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-24" tabindex="-1"></a>            r <span class="op">=</span> w<span class="op">.</span>exec<span class="op">(</span><span class="st">&quot;SELECT cpf,nome,endereco,data_nascimento,foto FROM pessoas&quot;</span><span class="op">);</span></span>
<span id="cb66-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-25" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb66-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-26" tabindex="-1"></a>        crow<span class="op">::</span>json<span class="op">::</span>wvalue out<span class="op">;</span></span>
<span id="cb66-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-27" tabindex="-1"></a>        <span class="dt">size_t</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb66-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-28" tabindex="-1"></a>        <span class="cf">for</span><span class="op">(</span><span class="kw">auto</span> row <span class="op">:</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb66-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-29" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;cpf&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;cpf&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb66-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-30" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;nome&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;nome&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb66-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-31" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;endereco&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;endereco&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb66-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-32" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;dataNascimento&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;data_nascimento&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb66-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-33" tabindex="-1"></a>            out<span class="op">[</span>i<span class="op">][</span><span class="st">&quot;foto&quot;</span><span class="op">]</span> <span class="op">=</span> row<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span>is_null<span class="op">()</span> <span class="op">?</span> <span class="st">&quot;&quot;</span> <span class="op">:</span> row<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span>c_str<span class="op">();</span></span>
<span id="cb66-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-34" tabindex="-1"></a>            <span class="op">++</span>i<span class="op">;</span></span>
<span id="cb66-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-35" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb66-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-36" tabindex="-1"></a>        <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span>out<span class="op">);</span></span>
<span id="cb66-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-37" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb66-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-38" tabindex="-1"></a></span>
<span id="cb66-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-39" tabindex="-1"></a>    <span class="co">// POST /pessoas</span></span>
<span id="cb66-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-40" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;POST&quot;</span><span class="op">_method)</span></span>
<span id="cb66-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-41" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;</span> req<span class="op">){</span></span>
<span id="cb66-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-42" tabindex="-1"></a>        <span class="kw">auto</span> body <span class="op">=</span> crow<span class="op">::</span>json<span class="op">::</span>load<span class="op">(</span>req<span class="op">.</span>body<span class="op">);</span></span>
<span id="cb66-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-43" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>body <span class="op">||</span> <span class="op">!</span>body<span class="op">.</span>has<span class="op">(</span><span class="st">&quot;cpf&quot;</span><span class="op">))</span></span>
<span id="cb66-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-44" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> <span class="st">&quot;CPF √© obrigat√≥rio&quot;</span><span class="op">);</span></span>
<span id="cb66-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-45" tabindex="-1"></a></span>
<span id="cb66-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-46" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb66-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-47" tabindex="-1"></a>            pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb66-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-48" tabindex="-1"></a>            pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb66-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-49" tabindex="-1"></a>            w<span class="op">.</span>exec_params<span class="op">(</span></span>
<span id="cb66-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-50" tabindex="-1"></a>                <span class="st">&quot;INSERT INTO pessoas (cpf,nome,endereco,data_nascimento,foto) &quot;</span></span>
<span id="cb66-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-51" tabindex="-1"></a>                <span class="st">&quot;VALUES ($1,$2,$3,$4,$5)&quot;</span><span class="op">,</span></span>
<span id="cb66-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-52" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;cpf&quot;</span><span class="op">].</span>s<span class="op">(),</span></span>
<span id="cb66-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-53" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;nome&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb66-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-54" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;endereco&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb66-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-55" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;dataNascimento&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb66-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-56" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">)</span></span>
<span id="cb66-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-57" tabindex="-1"></a>            <span class="op">);</span></span>
<span id="cb66-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-58" tabindex="-1"></a>            w<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb66-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-59" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">201</span><span class="op">,</span> <span class="st">&quot;Inserido&quot;</span><span class="op">);</span></span>
<span id="cb66-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-60" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span><span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>exception <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb66-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-61" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb66-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-62" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb66-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-63" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb66-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-64" tabindex="-1"></a></span>
<span id="cb66-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-65" tabindex="-1"></a>    <span class="co">// PUT /pessoas/&lt;cpf&gt;</span></span>
<span id="cb66-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-66" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas/&lt;string&gt;&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;PUT&quot;</span><span class="op">_method)</span></span>
<span id="cb66-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-67" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;</span> req<span class="op">,</span> <span class="bu">std::</span>string cpf<span class="op">){</span></span>
<span id="cb66-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-68" tabindex="-1"></a>        <span class="kw">auto</span> body <span class="op">=</span> crow<span class="op">::</span>json<span class="op">::</span>load<span class="op">(</span>req<span class="op">.</span>body<span class="op">);</span></span>
<span id="cb66-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-69" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(!</span>body<span class="op">)</span></span>
<span id="cb66-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-70" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> <span class="st">&quot;JSON inv√°lido&quot;</span><span class="op">);</span></span>
<span id="cb66-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-71" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb66-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-72" tabindex="-1"></a>            pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb66-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-73" tabindex="-1"></a>            pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb66-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-74" tabindex="-1"></a>            w<span class="op">.</span>exec_params<span class="op">(</span></span>
<span id="cb66-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-75" tabindex="-1"></a>                <span class="st">&quot;UPDATE pessoas SET nome=$1,endereco=$2,data_nascimento=$3,foto=$4 WHERE cpf=$5&quot;</span><span class="op">,</span></span>
<span id="cb66-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-76" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;nome&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb66-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-77" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;endereco&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb66-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-78" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;dataNascimento&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb66-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-79" tabindex="-1"></a>                body<span class="op">[</span><span class="st">&quot;foto&quot;</span><span class="op">].</span><span class="va">s_or</span><span class="op">(</span><span class="st">&quot;&quot;</span><span class="op">),</span></span>
<span id="cb66-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-80" tabindex="-1"></a>                cpf</span>
<span id="cb66-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-81" tabindex="-1"></a>            <span class="op">);</span></span>
<span id="cb66-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-82" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>w<span class="op">.</span>affected_rows<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">404</span><span class="op">,</span> <span class="st">&quot;CPF n√£o encontrado&quot;</span><span class="op">);</span></span>
<span id="cb66-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-83" tabindex="-1"></a>            w<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb66-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-84" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">200</span><span class="op">,</span> <span class="st">&quot;Alterado&quot;</span><span class="op">);</span></span>
<span id="cb66-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-85" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span><span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>exception <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb66-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-86" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb66-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-87" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb66-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-88" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb66-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-89" tabindex="-1"></a></span>
<span id="cb66-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-90" tabindex="-1"></a>    <span class="co">// DELETE /pessoas/&lt;cpf&gt;</span></span>
<span id="cb66-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-91" tabindex="-1"></a>    CROW_ROUTE<span class="op">(</span>app<span class="op">,</span> <span class="st">&quot;/pessoas/&lt;string&gt;&quot;</span><span class="op">).</span>methods<span class="op">(</span><span class="st">&quot;DELETE&quot;</span><span class="op">_method)</span></span>
<span id="cb66-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-92" tabindex="-1"></a>    <span class="op">([](</span><span class="at">const</span> crow<span class="op">::</span>request<span class="op">&amp;,</span> <span class="bu">std::</span>string cpf<span class="op">){</span></span>
<span id="cb66-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-93" tabindex="-1"></a>        <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb66-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-94" tabindex="-1"></a>            pqxx<span class="op">::</span>connection c<span class="op">(</span>CONN_STR<span class="op">);</span></span>
<span id="cb66-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-95" tabindex="-1"></a>            pqxx<span class="op">::</span>work w<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb66-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-96" tabindex="-1"></a>            w<span class="op">.</span>exec_params<span class="op">(</span><span class="st">&quot;DELETE FROM pessoas WHERE cpf=$1&quot;</span><span class="op">,</span> cpf<span class="op">);</span></span>
<span id="cb66-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-97" tabindex="-1"></a>            <span class="cf">if</span><span class="op">(</span>w<span class="op">.</span>affected_rows<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">404</span><span class="op">,</span> <span class="st">&quot;CPF n√£o encontrado&quot;</span><span class="op">);</span></span>
<span id="cb66-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-98" tabindex="-1"></a>            w<span class="op">.</span>commit<span class="op">();</span></span>
<span id="cb66-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-99" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">200</span><span class="op">,</span> <span class="st">&quot;Removido&quot;</span><span class="op">);</span></span>
<span id="cb66-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-100" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">catch</span><span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>exception <span class="op">&amp;</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb66-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-101" tabindex="-1"></a>            <span class="cf">return</span> crow<span class="op">::</span>response<span class="op">(</span><span class="dv">400</span><span class="op">,</span> e<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb66-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-102" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb66-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-103" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb66-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-104" tabindex="-1"></a></span>
<span id="cb66-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-105" tabindex="-1"></a>    <span class="bu">std::</span>cout <span class="op">&lt;&lt;</span> <span class="st">&quot;Servidor rodando em http://0.0.0.0:8080</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></span>
<span id="cb66-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-106" tabindex="-1"></a>    app<span class="op">.</span>port<span class="op">(</span><span class="dv">8080</span><span class="op">).</span>multithreaded<span class="op">().</span>run<span class="op">();</span></span>
<span id="cb66-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb66-107" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="ferramenta-de-compila√ß√£o-cmake" class="section level3 hasAnchor" number="7.12.2">
<h3><span class="header-section-number">7.12.2</span> Ferramenta de compila√ß√£o CMAKE<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#ferramenta-de-compila%C3%A7%C3%A3o-cmake" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Preparando o arquivo de instru√ß√µes da ferramenta de projeto CMAKE</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb67-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-1" tabindex="-1"></a>cmake_minimum_required(VERSION 3.20)</span>
<span id="cb67-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-2" tabindex="-1"></a>project(PessoasRestCpp LANGUAGES CXX)</span>
<span id="cb67-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-3" tabindex="-1"></a></span>
<span id="cb67-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-4" tabindex="-1"></a>set(CMAKE_CXX_STANDARD 17)</span>
<span id="cb67-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-5" tabindex="-1"></a>set(CMAKE_CXX_STANDARD_REQUIRED ON)</span>
<span id="cb67-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-6" tabindex="-1"></a></span>
<span id="cb67-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-7" tabindex="-1"></a># Caminho para os headers (Crow e outros)</span>
<span id="cb67-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-8" tabindex="-1"></a>include_directories(${CMAKE_SOURCE_DIR}/include)</span>
<span id="cb67-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-9" tabindex="-1"></a></span>
<span id="cb67-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-10" tabindex="-1"></a># Localiza√ß√£o de libpqxx (ajuste se estiver em pasta diferente)</span>
<span id="cb67-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-11" tabindex="-1"></a>find_package(PostgreSQL REQUIRED)</span>
<span id="cb67-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-12" tabindex="-1"></a>find_path(PQXX_INCLUDE_DIR pqxx/pqxx)</span>
<span id="cb67-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-13" tabindex="-1"></a>find_library(PQXX_LIBRARY pqxx)</span>
<span id="cb67-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-14" tabindex="-1"></a></span>
<span id="cb67-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-15" tabindex="-1"></a>if(NOT PQXX_INCLUDE_DIR OR NOT PQXX_LIBRARY)</span>
<span id="cb67-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-16" tabindex="-1"></a>    message(FATAL_ERROR &quot;libpqxx n√£o encontrada. Instale com vcpkg ou aponte manualmente.&quot;)</span>
<span id="cb67-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-17" tabindex="-1"></a>endif()</span>
<span id="cb67-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-18" tabindex="-1"></a></span>
<span id="cb67-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-19" tabindex="-1"></a>add_executable(pessoas-rest</span>
<span id="cb67-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-20" tabindex="-1"></a>    src/main.cpp</span>
<span id="cb67-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-21" tabindex="-1"></a>)</span>
<span id="cb67-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-22" tabindex="-1"></a></span>
<span id="cb67-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-23" tabindex="-1"></a>target_include_directories(pessoas-rest PRIVATE ${PQXX_INCLUDE_DIR})</span>
<span id="cb67-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-24" tabindex="-1"></a>target_link_libraries(pessoas-rest</span>
<span id="cb67-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-25" tabindex="-1"></a>    ${PQXX_LIBRARY}</span>
<span id="cb67-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-26" tabindex="-1"></a>    PostgreSQL::PostgreSQL</span>
<span id="cb67-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb67-27" tabindex="-1"></a>)</span></code></pre></div>
<p>Adicionando biblioteca extra no compilador C++ do windows</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb68-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb68-1" tabindex="-1"></a>vcpkg install libpqxx</span></code></pre></div>
<p>Gere o projeto do servidor para ‚ÄúVisual Studio 17 2022‚Äù E ARQUITETURA x64</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb69-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb69-1" tabindex="-1"></a>cmake <span class="at">-B</span> build <span class="at">-G</span> <span class="st">&quot;Visual Studio 17 2022&quot;</span> <span class="at">-A</span> x64  <span class="at">-DCMAKE_TOOLCHAIN_FILE</span>=C:<span class="at">/path/to/vcpkg/scripts/buildsystems/vcpkg</span>.cmake</span></code></pre></div>
<p>Compile e linque todo o projeto</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb70-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb70-1" tabindex="-1"></a>cmake -<span class="at">-build</span> build -<span class="at">-config</span> Release</span></code></pre></div>
<p>execute o servidor</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb71-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb71-1" tabindex="-1"></a>build/Release/pessoas-rest.exe</span></code></pre></div>
<p>servidor estar√° rodando na porta 8080 e EXP√ïE A API de opera√ß√µes na URI <a href="http://localhost:8080/pessoas" class="uri">http://localhost:8080/pessoas</a> sem senha</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb72-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb72-1" tabindex="-1"></a>http<span class="in">:</span><span class="er">//localhost:8080/pessoas</span></span></code></pre></div>
</div>
<div id="cliente-html-conex√£o-restful-2" class="section level3 hasAnchor" number="7.12.3">
<h3><span class="header-section-number">7.12.3</span> Cliente HTML (conex√£o Restful)<a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cliente-html-conex%C3%A3o-restful-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>crie o arquivo index.html e abra-o no navegador</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb73-1"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-1" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb73-2"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;pt-BR&quot;</span><span class="dt">&gt;</span></span>
<span id="cb73-3"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb73-4"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-4" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="dt">&gt;</span></span>
<span id="cb73-5"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-5" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>Cadastro de Pessoas<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb73-6"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-6" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb73-7"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-7" tabindex="-1"></a>  body { <span class="kw">font-family</span><span class="ch">:</span> <span class="dv">Arial</span><span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb73-8"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-8" tabindex="-1"></a>  h1 { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#333</span><span class="op">;</span> }</span>
<span id="cb73-9"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-9" tabindex="-1"></a>  form { <span class="kw">margin-bottom</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb73-10"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-10" tabindex="-1"></a>  label { <span class="kw">display</span><span class="ch">:</span> <span class="dv">block</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb73-11"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-11" tabindex="-1"></a>  input<span class="ex">[</span><span class="ss">type</span><span class="op">=</span><span class="st">text</span><span class="ex">]</span><span class="op">,</span> input<span class="ex">[</span><span class="ss">type</span><span class="op">=</span><span class="st">date</span><span class="ex">]</span><span class="op">,</span> input<span class="ex">[</span><span class="ss">type</span><span class="op">=</span><span class="st">file</span><span class="ex">]</span> {</span>
<span id="cb73-12"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-12" tabindex="-1"></a>    <span class="kw">width</span><span class="ch">:</span> <span class="dv">300</span><span class="dt">px</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb73-13"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-13" tabindex="-1"></a>  }</span>
<span id="cb73-14"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-14" tabindex="-1"></a>  table { <span class="kw">border-collapse</span><span class="ch">:</span> <span class="dv">collapse</span><span class="op">;</span> <span class="kw">width</span><span class="ch">:</span> <span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="kw">margin-top</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb73-15"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-15" tabindex="-1"></a>  th<span class="op">,</span> td { <span class="kw">border</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#aaa</span><span class="op">;</span> <span class="kw">padding</span><span class="ch">:</span> <span class="dv">6</span><span class="dt">px</span><span class="op">;</span> <span class="kw">text-align</span><span class="ch">:</span> <span class="dv">left</span><span class="op">;</span> }</span>
<span id="cb73-16"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-16" tabindex="-1"></a>  img { <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">80</span><span class="dt">px</span><span class="op">;</span> <span class="kw">max-height</span><span class="ch">:</span> <span class="dv">80</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb73-17"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-17" tabindex="-1"></a>  <span class="fu">.btn</span> { <span class="kw">padding</span><span class="ch">:</span> <span class="dv">4</span><span class="dt">px</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span> <span class="kw">cursor</span><span class="ch">:</span> <span class="dv">pointer</span><span class="op">;</span> <span class="kw">margin</span><span class="ch">:</span> <span class="dv">0</span> <span class="dv">2</span><span class="dt">px</span><span class="op">;</span> }</span>
<span id="cb73-18"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-18" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb73-19"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-19" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb73-20"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-20" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb73-21"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-21" tabindex="-1"></a></span>
<span id="cb73-22"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-22" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Cadastro de Pessoas<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb73-23"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-23" tabindex="-1"></a></span>
<span id="cb73-24"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-24" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">form</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;pessoaForm&quot;</span><span class="dt">&gt;</span></span>
<span id="cb73-25"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-25" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>CPF*:</span>
<span id="cb73-26"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-26" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;cpf&quot;</span><span class="ot"> required</span><span class="dt">&gt;</span></span>
<span id="cb73-27"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-27" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb73-28"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-28" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Nome:</span>
<span id="cb73-29"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-29" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;nome&quot;</span><span class="dt">&gt;</span></span>
<span id="cb73-30"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-30" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb73-31"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-31" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Endere√ßo:</span>
<span id="cb73-32"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-32" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;endereco&quot;</span><span class="dt">&gt;</span></span>
<span id="cb73-33"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-33" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb73-34"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-34" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Data de Nascimento:</span>
<span id="cb73-35"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-35" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;date&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;dataNascimento&quot;</span><span class="dt">&gt;</span></span>
<span id="cb73-36"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-36" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb73-37"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-37" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">label</span><span class="dt">&gt;</span>Foto:</span>
<span id="cb73-38"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-38" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;file&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;foto&quot;</span><span class="dt">&gt;</span></span>
<span id="cb73-39"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-39" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb73-40"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-40" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;submit&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn&quot;</span><span class="dt">&gt;</span>Salvar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb73-41"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-41" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">form</span><span class="dt">&gt;</span></span>
<span id="cb73-42"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-42" tabindex="-1"></a></span>
<span id="cb73-43"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-43" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb73-44"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-44" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;search&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Buscar por CPF ou Nome&quot;</span><span class="dt">&gt;</span></span>
<span id="cb73-45"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-45" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnBuscar&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn&quot;</span><span class="dt">&gt;</span>Buscar<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb73-46"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-46" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;btnListar&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn&quot;</span><span class="dt">&gt;</span>Listar Todos<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb73-47"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-47" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb73-48"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-48" tabindex="-1"></a></span>
<span id="cb73-49"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-49" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">table</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;tabelaPessoas&quot;</span><span class="dt">&gt;</span></span>
<span id="cb73-50"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-50" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb73-51"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-51" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb73-52"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-52" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>CPF<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nome<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Endere√ßo<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Nascimento<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>Foto<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;&lt;</span><span class="kw">th</span><span class="dt">&gt;</span>A√ß√µes<span class="dt">&lt;/</span><span class="kw">th</span><span class="dt">&gt;</span></span>
<span id="cb73-53"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-53" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">tr</span><span class="dt">&gt;</span></span>
<span id="cb73-54"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-54" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">thead</span><span class="dt">&gt;</span></span>
<span id="cb73-55"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-55" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">tbody</span><span class="dt">&gt;&lt;/</span><span class="kw">tbody</span><span class="dt">&gt;</span></span>
<span id="cb73-56"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-56" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">table</span><span class="dt">&gt;</span></span>
<span id="cb73-57"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-57" tabindex="-1"></a></span>
<span id="cb73-58"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-58" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb73-59"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-59" tabindex="-1"></a><span class="kw">const</span> API_URL <span class="op">=</span> <span class="st">&quot;http://localhost:8080/pessoas&quot;</span><span class="op">;</span></span>
<span id="cb73-60"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-60" tabindex="-1"></a></span>
<span id="cb73-61"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-61" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">carregarPessoas</span>(query<span class="op">=</span><span class="st">&quot;&quot;</span>) {</span>
<span id="cb73-62"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-62" tabindex="-1"></a>  <span class="kw">const</span> url <span class="op">=</span> query <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">?q=</span><span class="sc">${</span><span class="pp">encodeURIComponent</span>(query)<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API_URL<span class="op">;</span></span>
<span id="cb73-63"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-63" tabindex="-1"></a>  <span class="kw">const</span> resp <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb73-64"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-64" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> resp<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb73-65"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-65" tabindex="-1"></a>  <span class="kw">const</span> tbody <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&quot;#tabelaPessoas tbody&quot;</span>)<span class="op">;</span></span>
<span id="cb73-66"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-66" tabindex="-1"></a>  tbody<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb73-67"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-67" tabindex="-1"></a>  data<span class="op">.</span><span class="fu">forEach</span>(p <span class="kw">=&gt;</span> {</span>
<span id="cb73-68"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-68" tabindex="-1"></a>    <span class="kw">const</span> tr <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&quot;tr&quot;</span>)<span class="op">;</span></span>
<span id="cb73-69"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-69" tabindex="-1"></a>    tr<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb73-70"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-70" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb73-71"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-71" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">nome</span> <span class="op">||</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb73-72"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-72" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">endereco</span> <span class="op">||</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb73-73"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-73" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">dataNascimento</span> <span class="op">||</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb73-74"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-74" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span> <span class="op">?</span> <span class="vs">`&lt;img src=&quot;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">foto</span><span class="sc">}</span><span class="vs">&quot; alt=&quot;foto&quot;&gt;`</span> <span class="op">:</span> <span class="st">&quot;&quot;</span><span class="sc">}</span><span class="vs">&lt;/td&gt;</span></span>
<span id="cb73-75"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-75" tabindex="-1"></a><span class="vs">      &lt;td&gt;</span></span>
<span id="cb73-76"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-76" tabindex="-1"></a><span class="vs">        &lt;button class=&quot;btn&quot; onclick=&quot;editar(&#39;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&#39;)&quot;&gt;Editar&lt;/button&gt;</span></span>
<span id="cb73-77"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-77" tabindex="-1"></a><span class="vs">        &lt;button class=&quot;btn&quot; onclick=&quot;excluir(&#39;</span><span class="sc">${</span>p<span class="op">.</span><span class="at">cpf</span><span class="sc">}</span><span class="vs">&#39;)&quot;&gt;Excluir&lt;/button&gt;</span></span>
<span id="cb73-78"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-78" tabindex="-1"></a><span class="vs">      &lt;/td&gt;</span></span>
<span id="cb73-79"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-79" tabindex="-1"></a><span class="vs">    `</span><span class="op">;</span></span>
<span id="cb73-80"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-80" tabindex="-1"></a>    tbody<span class="op">.</span><span class="fu">appendChild</span>(tr)<span class="op">;</span></span>
<span id="cb73-81"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-81" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb73-82"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-82" tabindex="-1"></a>}</span>
<span id="cb73-83"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-83" tabindex="-1"></a></span>
<span id="cb73-84"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-84" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">toBase64</span>(file) {</span>
<span id="cb73-85"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-85" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> {</span>
<span id="cb73-86"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-86" tabindex="-1"></a>    <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="bu">FileReader</span>()<span class="op">;</span></span>
<span id="cb73-87"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-87" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">resolve</span>(reader<span class="op">.</span><span class="at">result</span>)<span class="op">;</span></span>
<span id="cb73-88"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-88" tabindex="-1"></a>    reader<span class="op">.</span><span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></span>
<span id="cb73-89"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-89" tabindex="-1"></a>    reader<span class="op">.</span><span class="fu">readAsDataURL</span>(file)<span class="op">;</span></span>
<span id="cb73-90"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-90" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb73-91"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-91" tabindex="-1"></a>}</span>
<span id="cb73-92"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-92" tabindex="-1"></a></span>
<span id="cb73-93"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-93" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;pessoaForm&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;submit&quot;</span><span class="op">,</span> <span class="kw">async</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb73-94"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-94" tabindex="-1"></a>  e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb73-95"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-95" tabindex="-1"></a>  <span class="kw">const</span> cpf <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb73-96"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-96" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>cpf) { <span class="fu">alert</span>(<span class="st">&quot;CPF √© obrigat√≥rio.&quot;</span>)<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> }</span>
<span id="cb73-97"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-97" tabindex="-1"></a></span>
<span id="cb73-98"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-98" tabindex="-1"></a>  <span class="kw">const</span> nome <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;nome&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb73-99"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-99" tabindex="-1"></a>  <span class="kw">const</span> endereco <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;endereco&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb73-100"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-100" tabindex="-1"></a>  <span class="kw">const</span> dataNascimento <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;dataNascimento&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb73-101"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-101" tabindex="-1"></a>  <span class="kw">const</span> fotoFile <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;foto&quot;</span>)<span class="op">.</span><span class="at">files</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb73-102"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-102" tabindex="-1"></a>  <span class="kw">let</span> fotoBase64 <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb73-103"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-103" tabindex="-1"></a>  <span class="cf">if</span> (fotoFile) {</span>
<span id="cb73-104"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-104" tabindex="-1"></a>    fotoBase64 <span class="op">=</span> <span class="cf">await</span> <span class="fu">toBase64</span>(fotoFile)<span class="op">;</span></span>
<span id="cb73-105"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-105" tabindex="-1"></a>  }</span>
<span id="cb73-106"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-106" tabindex="-1"></a></span>
<span id="cb73-107"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-107" tabindex="-1"></a>  <span class="co">// Se j√° existe, usa PUT, sen√£o POST</span></span>
<span id="cb73-108"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-108" tabindex="-1"></a>  <span class="kw">const</span> method <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">dataset</span><span class="op">.</span><span class="at">editing</span> <span class="op">?</span> <span class="st">&quot;PUT&quot;</span> <span class="op">:</span> <span class="st">&quot;POST&quot;</span><span class="op">;</span></span>
<span id="cb73-109"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-109" tabindex="-1"></a>  <span class="kw">const</span> url <span class="op">=</span> method <span class="op">===</span> <span class="st">&quot;PUT&quot;</span> <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>cpf<span class="sc">}</span><span class="vs">`</span> <span class="op">:</span> API_URL<span class="op">;</span></span>
<span id="cb73-110"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-110" tabindex="-1"></a></span>
<span id="cb73-111"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-111" tabindex="-1"></a>  <span class="kw">const</span> resp <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(url<span class="op">,</span> {</span>
<span id="cb73-112"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-112" tabindex="-1"></a>    method<span class="op">,</span></span>
<span id="cb73-113"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-113" tabindex="-1"></a>    <span class="dt">headers</span><span class="op">:</span> { <span class="st">&quot;Content-Type&quot;</span><span class="op">:</span> <span class="st">&quot;application/json&quot;</span> }<span class="op">,</span></span>
<span id="cb73-114"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-114" tabindex="-1"></a>    <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>({ cpf<span class="op">,</span> nome<span class="op">,</span> endereco<span class="op">,</span> dataNascimento<span class="op">,</span> <span class="dt">foto</span><span class="op">:</span> fotoBase64 })</span>
<span id="cb73-115"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-115" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb73-116"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-116" tabindex="-1"></a></span>
<span id="cb73-117"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-117" tabindex="-1"></a>  <span class="cf">if</span> (resp<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb73-118"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-118" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;Salvo com sucesso!&quot;</span>)<span class="op">;</span></span>
<span id="cb73-119"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-119" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;pessoaForm&quot;</span>)<span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb73-120"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-120" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">dataset</span><span class="op">.</span><span class="at">editing</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb73-121"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-121" tabindex="-1"></a>    <span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb73-122"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-122" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb73-123"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-123" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;Erro: &quot;</span> <span class="op">+</span> <span class="cf">await</span> resp<span class="op">.</span><span class="fu">text</span>())<span class="op">;</span></span>
<span id="cb73-124"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-124" tabindex="-1"></a>  }</span>
<span id="cb73-125"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-125" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb73-126"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-126" tabindex="-1"></a></span>
<span id="cb73-127"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-127" tabindex="-1"></a><span class="kw">function</span> <span class="fu">editar</span>(cpf) {</span>
<span id="cb73-128"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-128" tabindex="-1"></a>  <span class="kw">const</span> row <span class="op">=</span> [<span class="op">...</span><span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&quot;#tabelaPessoas tbody tr&quot;</span>)]</span>
<span id="cb73-129"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-129" tabindex="-1"></a>    <span class="op">.</span><span class="fu">find</span>(tr <span class="kw">=&gt;</span> tr<span class="op">.</span><span class="at">children</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">textContent</span> <span class="op">===</span> cpf)<span class="op">;</span></span>
<span id="cb73-130"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-130" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>row) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb73-131"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-131" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> cpf<span class="op">;</span></span>
<span id="cb73-132"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-132" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;nome&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> row<span class="op">.</span><span class="at">children</span>[<span class="dv">1</span>]<span class="op">.</span><span class="at">textContent</span><span class="op">;</span></span>
<span id="cb73-133"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-133" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;endereco&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> row<span class="op">.</span><span class="at">children</span>[<span class="dv">2</span>]<span class="op">.</span><span class="at">textContent</span><span class="op">;</span></span>
<span id="cb73-134"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-134" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;dataNascimento&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> row<span class="op">.</span><span class="at">children</span>[<span class="dv">3</span>]<span class="op">.</span><span class="at">textContent</span><span class="op">;</span></span>
<span id="cb73-135"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-135" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;cpf&quot;</span>)<span class="op">.</span><span class="at">dataset</span><span class="op">.</span><span class="at">editing</span> <span class="op">=</span> <span class="st">&quot;true&quot;</span><span class="op">;</span></span>
<span id="cb73-136"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-136" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">scrollTo</span>({ <span class="dt">top</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">behavior</span><span class="op">:</span> <span class="st">&#39;smooth&#39;</span> })<span class="op">;</span></span>
<span id="cb73-137"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-137" tabindex="-1"></a>}</span>
<span id="cb73-138"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-138" tabindex="-1"></a></span>
<span id="cb73-139"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-139" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">excluir</span>(cpf) {</span>
<span id="cb73-140"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-140" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="fu">confirm</span>(<span class="vs">`Excluir CPF </span><span class="sc">${</span>cpf<span class="sc">}</span><span class="vs">?`</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb73-141"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-141" tabindex="-1"></a>  <span class="kw">const</span> resp <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>cpf<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> { <span class="dt">method</span><span class="op">:</span> <span class="st">&quot;DELETE&quot;</span> })<span class="op">;</span></span>
<span id="cb73-142"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-142" tabindex="-1"></a>  <span class="cf">if</span> (resp<span class="op">.</span><span class="at">ok</span>) {</span>
<span id="cb73-143"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-143" tabindex="-1"></a>    <span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb73-144"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-144" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb73-145"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-145" tabindex="-1"></a>    <span class="fu">alert</span>(<span class="st">&quot;Erro: &quot;</span> <span class="op">+</span> <span class="cf">await</span> resp<span class="op">.</span><span class="fu">text</span>())<span class="op">;</span></span>
<span id="cb73-146"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-146" tabindex="-1"></a>  }</span>
<span id="cb73-147"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-147" tabindex="-1"></a>}</span>
<span id="cb73-148"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-148" tabindex="-1"></a></span>
<span id="cb73-149"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-149" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;btnBuscar&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb73-150"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-150" tabindex="-1"></a>  <span class="kw">const</span> q <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;search&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="fu">trim</span>()<span class="op">;</span></span>
<span id="cb73-151"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-151" tabindex="-1"></a>  <span class="fu">carregarPessoas</span>(q)<span class="op">;</span></span>
<span id="cb73-152"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-152" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb73-153"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-153" tabindex="-1"></a></span>
<span id="cb73-154"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-154" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;btnListar&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb73-155"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-155" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;search&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb73-156"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-156" tabindex="-1"></a>  <span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb73-157"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-157" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb73-158"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-158" tabindex="-1"></a></span>
<span id="cb73-159"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-159" tabindex="-1"></a><span class="co">// Carregar lista inicial</span></span>
<span id="cb73-160"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-160" tabindex="-1"></a><span class="fu">carregarPessoas</span>()<span class="op">;</span></span>
<span id="cb73-161"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-161" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb73-162"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-162" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb73-163"><a href="banco-de-dados-uma-aplica√ß√£o-crud.html#cb73-163" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="administra√ß√£o-e-gerenciamento-de-bancos-de-dados-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="banco-de-dados-mysql-mariadb.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/miguel7penteado/2025-2sem-GTI-BancoDeDados/edit/main/05-2026-03-17_Aplicacao_CRUD-aula.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["2026-ADS-1sem-BancoDeDados.pdf", "2026-ADS-1sem-BancoDeDados.epub", "2026-ADS-1sem-BancoDeDados.word", "2026-ADS-1sem-BancoDeDados.html"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
